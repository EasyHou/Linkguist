!function() {
    "use strict";
    function a(a, b, c, d, e, f) {
        b[a] && (c.push(a), (b[a] === !0 || 1 === b[a]) && d.push(e + a + "/" + f));
    }
    function b(a, b, c, d, e) {
        var f = d + b + "/" + e;
        require._fileExists(a.toUrl(f + ".js")) && c.push(f);
    }
    function c(a, b, d) {
        var e;
        for (e in b) !b.hasOwnProperty(e) || a.hasOwnProperty(e) && !d ? "object" == typeof b[e] && (!a[e] && b[e] && (a[e] = {}), 
        c(a[e], b[e], d)) : a[e] = b[e];
    }
    var d = /(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;
    define("i18n", [ "module" ], function(e) {
        var f = e.config ? e.config() : {};
        return {
            version: "2.0.4",
            load: function(e, g, h, i) {
                i = i || {}, i.locale && (f.locale = i.locale);
                var j, k, l, m = d.exec(e), n = m[1], o = m[4], p = m[5], q = o.split("-"), r = [], s = {}, t = "";
                if (m[5] ? (n = m[1], j = n + p) : (j = e, p = m[4], o = f.locale, o || (o = f.locale = "undefined" == typeof navigator ? "root" : (navigator.language || navigator.userLanguage || "root").toLowerCase()), 
                q = o.split("-")), i.isBuild) {
                    for (r.push(j), b(g, "root", r, n, p), k = 0; k < q.length; k++) l = q[k], t += (t ? "-" : "") + l, 
                    b(g, t, r, n, p);
                    g(r, function() {
                        h();
                    });
                } else g([ j ], function(b) {
                    var d, e = [];
                    for (a("root", b, e, r, n, p), k = 0; k < q.length; k++) d = q[k], t += (t ? "-" : "") + d, 
                    a(t, b, e, r, n, p);
                    g(r, function() {
                        var a, d, f;
                        for (a = e.length - 1; a > -1 && e[a]; a--) f = e[a], d = b[f], (d === !0 || 1 === d) && (d = g(n + f + "/" + p)), 
                        c(s, d);
                        h(s);
                    });
                });
            }
        };
    });
}(), define("nls/lang", {
    root: {
        saml_email_domain: "SAML email domain",
        saml_email_domain_token: "SAML email domain token",
        sso_form_title: "SAML Single Sign-on",
        configure_new: "New",
        admin_idpConf_cert: "Certificate",
        admin_cert_info: "(copy and paste from .pem or .crt file)",
        transfer: "Transfer",
        transfer_all: "Transfer All",
        transfer_binder_to: "Transfer binder to",
        transfer_binders_to: "Transfer binders to",
        confirm_transfer_binder: "Do you want to transfer this binder?",
        confirm_transfer_binders: "Do you want to transfer {0} binders?",
        transfer_binder_success: "Binder transferred",
        transfer_binder_failed: "Unable to transfer binder",
        transfer_binders_success: "Binders transferred",
        transfer_binders_failed: "Unable to transfer binders",
        shared_binders_with_parentheses: "Shared Binders ({0})",
        owned_binders_with_parentheses: "Binders Owned ({0})",
        no_owned_binder: "User doesn't own any binders.",
        no_shared_binder: "User doesn't have any shared binders.",
        invite_user_success: "User invited",
        invite_user_failed: "Unable to invite user",
        invite_user_existing_member: "User already exists.",
        invite_user_duplicate: "User has already been invited.",
        update_user_success: "User updated",
        update_user_failed: "Unable to update user",
        confirm_remove_user: 'Are you sure you want to remove user "{0}"?',
        remove_user_success: "User removed",
        remove_user_failed: "Unable to remove user",
        remove_username_failed: 'Unable to remove user "{0}". Please try again.',
        delete_user_success: "User deleted",
        delete_user_failed: "Unable to delete user. Please try again.",
        confirm_delete_user: "Are you sure you want to delete this user?",
        change_user_email: "Change User Email",
        activate_user: "Activate User",
        activate_user_tip: "User will get access to the account.",
        deactivate_user: "Deactivate User",
        deactivate_user_tip: "User will lose access to the account.",
        delete_user: "Delete User",
        delete_user_tip: "User account details and data will be permanently deleted from the system.",
        remove_user: "Remove User",
        remove_user_tip: "The user will be removed from the organization and will not have access to the business directory and library.",
        activate_user_success: "User activated",
        activate_user_failed: "Unable to activate user",
        deactivate_user_success: "User deactivated",
        deactivate_user_failed: "Unable to deactivate user",
        get_account_failed: "Unable to get your account info.",
        update_config_success: "Settings updated",
        update_config_failed: "Unable to update settings",
        create_config_success: "Settings added",
        create_config_failed: "Unable to add settings",
        verify_domain_success: "Email domain verified",
        verify_domain_failed: "Unable to verify Email domain",
        domain_not_verified: "Email domain is not verified",
        confirm_remove_config: "Do you want to delete this setting?",
        remove_config_success: "Settings Deleted",
        remove_config_failed: "Unable to delete SSO settings",
        org_id_colon: "Salesforce Organization ID:",
        enable_auto_account_provisioning: "Enable auto account provisioning",
        active_licenses: "Active Licenses",
        billing_plan: "Billing Plan",
        billing_information: "Billing Information",
        cancel_plan: "Cancel Plan",
        cancel_plan_message: "Please help us improve our service by sharing your experience.",
        confirm_cancel_service: "Are you sure you want to cancel service?",
        cancel_service: "Cancel Service",
        business_edition: "Business Edition",
        business_edition_trial: "Business Edition Trial",
        join_group_title: "Invitation to join {0}",
        join_group_already_member: "You are already a member of {0}.",
        join_group_be_member: "You are now a member of {0}.",
        join_group_subscription_invited_or_expired: "Business Edition subscription is either expired or canceled.",
        join_group_token_invited_or_expired: "Invitation expired, or you have already accepted the invitation.",
        join_group_conflict: "You are already a member of another organization.",
        join_group_accept_title: "Accept the invitation and get Moxtra Business Edition sponsored by your organization: [b]{0}[/b]",
        join_group_accept_acknowledge: "Moxtra Business Edition is a Power Messaging service for your business. By accepting the invitation, you acknowledge that all your content will be manageable by [b]{0}[/b]",
        join_sf_group_success: "[url=https://login.salesforce.com/]Login to Salesforce and start using Moxtra.[/url]",
        admin_label_plan_selection: "Plan Selection",
        admin_label_payment_plan: "Payment Plan",
        admin_label_pay_monthly: "Moxtra Business - Monthly ($20/month per user)",
        admin_label_pay_annual: "Moxtra Business - Annual ($220/year per user)",
        admin_label_pay_credit_card: "Pay with credit card",
        admin_label_pay_without_credit_card: "Pay without credit card",
        admin_msg_no_credit_card: "Contact sales@moxtra.com for other payment options.",
        admin_label_pay_not_ready: "Not ready yet to subscribe?",
        admin_label_pay_stay_trial: "Stay on Trial",
        admin_msg_update_billing_success: "Billing information updated",
        cancel_service_success: "Service canceled",
        cancel_service_error: "Unable to cancel service",
        admin_msg_removeuser_warning: "Please ensure that you have transferred binders to another team member before you delete this user.",
        admin_label_business_edition_trial_expired: "(Expired)",
        admin_label_business_edition_trial_1_day: "(1 day left)",
        admin_label_business_edition_trial_n_days: "({0} days left)",
        admin_msg_sf_find_orgID: "Login to Salesforce.com. Salesforce Org ID for your Salesforce implementation can be found under Administration Setup > Company Information > Company Profile.",
        admin_msg_sf_learn_auto_provision: "Auto provisioning eliminates manual steps in adding user accounts in Moxtra. When enabled, new Moxtra accounts will be automatically created when a Salesforce.com user uses Moxtra, subject to the minimum committed licenses purchased by the business.",
        admin_label_sf_download: "Download Moxtra for Salesforce.com",
        admin_label_sf_install_guide: "Installation Guide",
        csv_import: "Import CSV file",
        csv_file: "CSV file",
        import_csv_success: "CSV file imported",
        import_csv_failed: "Unable to import CSV file. Please try again.",
        import_csv_conflict: "Only new users can be imported through a CSV file. Please remove existing users from CSV file and try again.",
        import_csv_invalid_format: "Unable to import CSV file. Invalid CSV format.",
        admin_idpid_conflict: "IdP Entity ID already exists.",
        admin_moxtra_org_id: "Moxtra Org ID",
        this_field_is_required: "This field is required.",
        invalid_certificate_format: "Invalid certificate format",
        to_add_users_in_bulk: "To add users in bulk",
        csv_file_note_1: "Create a CSV file with the user information in the Sample CSV format",
        csv_file_note_2: "Click on [Import CSV File] and select the CSV file",
        csv_file_note_3: "No space between two fields",
        csv_file_note_4: "CSV file needs to be UTF-8 encoding. You can use popular text editors like Notepad++ to change CSV file to UTF-8 encoding.",
        sample_csv_format: "Sample CSV Format",
        donwload_sample_csv_file: "Download Sample CSV File",
        payment: "Payment",
        subscribe: "Subscribe",
        subscribing_ellipsis: "Subscribing...",
        buy: "Buy",
        standard: "Standard",
        pro: "Pro",
        total: "Total",
        card_number: "Card Number",
        cvc: "CVC",
        expiration_date: "Expiration Date",
        address: "Address",
        apt_or_suite: "Apt/Suite",
        city: "City",
        state: "State",
        zip: "Zip",
        purchase_complete: "Purchase Completed",
        purchase_complete_welcome: "Enjoy your new ...",
        go_to_my_account: "Go to My Account",
        billed_monthly: "Billed Monthly",
        billed_annual: "Billed Annual",
        change_plan: "Change Plan",
        change_my_plan_to: "Change my plan to",
        your_current_plan: "Your Current Plan",
        your_billing_cycle: "Your Billing Cycle",
        seats_used: "Seats Used",
        recurring_amount: "Recurring Amount",
        last_payment_date: "Last Payment Date",
        next_payment_date: "Next Payment Date",
        total_users: "Total Users",
        active_users: "Active Users",
        inactive_users: "Inactive Users",
        pending_users: "Pending Users",
        usage_report: "Usage Report",
        plan_and_billing: "Plan and Billing",
        num_of_binders: "# of Binders",
        num_of_meets: "# of Meets",
        num_of_contacts: "# of Contacts",
        storage_used: "Storage Used",
        plan_desc_messaging: "Unlimited 1:1 & Team Messaging",
        plan_desc_binder: "Unlimited Binders",
        plan_desc_page: "Unlimited Pages per Binder",
        plan_desc_meet: "Unlimited Meet",
        plan_desc_meet_limited: "120 Min Meet; up to 10 Participants",
        plan_desc_storage_1T: "1 TB storage",
        plan_desc_storage_10G: "10 GB storage",
        plan_desc_search: "Unlimited Search",
        plan_desc_team_management: "Team Management Features",
        plan_desc_team_ownership: "Binder Ownership Transfer",
        plan_desc_team_shelf: "Team Shelf",
        plan_desc_team_usage: "Team Usage Stats",
        keep_current_plan: "Keep current plan",
        buy_subscribe_success: "Subscribe success",
        buy_subscribe_failed: "Unable to subscribe, please try again.",
        change_plan_success: "Plan changed",
        change_plan_failed: "Unable to change plan, please try again.",
        load_credit_card_failed: "Unable to load credit card info, please try again.",
        edit_credit_card: "Edit Credit Card",
        edit_credit_card_success: "Credit card updated",
        edit_credit_card_failed: "Unabled to update credit card, please try again.",
        upgrade_but_not_be_owner: "You are not the owner of <strong>{0}</strong>, please contact owner.",
        plan_downgrade_alert: "All users will get Standard plan. You will get credit for $XX for the current billing cycle that...",
        paln_upgrade_alert: "All users will get the Pro plan. You will be charged for $XX for the current billing cycle that...",
        binder_chats: "Chat",
        binder_not_found: "Binder not found",
        binder_item_not_found: "The item cannot be found either because it has been deleted or you don't have access to the binder.",
        binder_is_empty: "This binder is empty [b]:)[/b]",
        binder_options: "Binder Options",
        chat_options: "Chat Options",
        new_category: "New Category",
        select_category: "Select Category",
        manage_category: "Manage Category",
        please_enter_category_name: "Please enter category name",
        category_name_reqired: "Category name is required",
        confirm_delete_category: "Do you want to delete this category?",
        delete_category_success: "Category deleted",
        delete_category_failed: "Unable to delete category",
        update_category_success: "Category updated",
        update_category_failed: "Unable to update category",
        create_category_success: "Category created",
        create_category_failed: "Unable to create category",
        group_chat: "Group Chat",
        select_one_binder: "Please select one binder",
        add_description: "Set description",
        push_notification: "Push Notification",
        choose_photo: "Choose Photo",
        please_enter_binder_name: "Please enter a topic",
        cover_image: "Cover Image",
        confirm_remove_cover: "Are you sure you want to remove the cover image?",
        binder_invite_cannot_accept: "Sorry, you cannot accept this invitation.",
        binder_invite_need_correct_login_to_accept: "Login as {invitee_email} to accept this invitation.",
        new_group_name: "Group Name",
        last_modified: "Last Modified",
        size: "Size",
        type: "Type",
        create_folder: "New Folder",
        folder_is_empty: "There is no file",
        binder_delete_a_page: "Delete Binder Page",
        binder_delete_pages: "Delete Binder Pages",
        binder_delete_file: "Delete File",
        binder_delete_files: "Delete Files",
        binder_delete_folder: "Delete Folder",
        binder_delete_folders: "Delete Folders",
        binder_delete_this_file: "Are you sure you want to delete this file?",
        binder_delete_this_folder: "Are you sure you want to delete this folder?",
        binder_delete_page_success: "Page deleted",
        binder_delete_pages_success: "Pages deleted",
        binder_delete_file_success: "File deleted",
        binder_delete_files_success: "Files deleted",
        binder_delete_folder_success: "Folder deleted",
        binder_delete_folders_success: "Folders deleted",
        binder_delete_resource_file_success: "File deleted",
        binder_delete_page_failed: "Unable to delete page",
        binder_delete_pages_failed: "Unable to delete pages",
        binder_delete_resource_file_failed: "Unable to delete file. Please try again.",
        binder_confirm_delete_a_page: "Do you want to delete the selected page?",
        binder_confirm_delete_pages: "Do you want to delete the selected pages?",
        binder_confirm_delete_resource_file: "Pages related with this file also will be deleted.",
        binder_confirm_delete_files: "Are you sure you want to delete the selected files?",
        binder_confirm_delete_a_file: "Are you sure you want to delete the selected file?",
        binder_confirm_delete_folders: "Are you sure you want to delete the selected folders?",
        binder_confirm_delete_a_folder: "Are you sure you want to delete the selected folder?",
        binder_copy_a_page_to: "Copy Page to",
        binder_copy_pages_to: "Copy Pages to",
        binder_move_a_page_to: "Move Page to",
        binder_move_pages_to: "Move Pages to",
        binder_copy_a_file_to: "Copy File to",
        binder_copy_files_to: "Copy Files to",
        binder_move_a_file_to: "Move File to",
        binder_move_files_to: "Move Files to",
        binder_create_whiteboard_failed: "Unable to create new page",
        binder_import_dropbox_success: "File(s) imported from Dropbox.",
        upload_file_exceed_size_limit: "Exceeded maximum file size (500MB) allowed.",
        upload_file_exceed_size_limit_binder_owner: "You have reached file size limit {0}MB allowed for the binder owner.",
        upload_file_exceed_size_limit_self: "You have reached file size limit {0}MB allowed for your account.",
        upload_file_success: "File(s) uploaded",
        upload_file_failed: "Upload failed. Please try again.",
        upload_file_success_with_actor: "{0} uploaded file - {1}",
        upload_file_has_same_file_name: 'This file "{0}" has the same file name with the file in this binder. Do you want to replace the old file with this new file?',
        converting_file_progress: "{1}/{2}:Converting {0}",
        convert_file_failed: "Unable to convert file.",
        binder_add_from_binder: "Add files from binder",
        add_from_desktop: "Add from Desktop",
        binder_confirm_delete_one_page: "Do you want to delete this page?",
        binder_move_page_success: "Page moved",
        binder_move_pages_success: "Pages moved",
        binder_move_page_fail: "Unable to move page",
        binder_move_file_success: "File moved",
        binder_move_files_success: "Files moved",
        binder_move_file_fail: "Unable to move file. Please try again.",
        binder_copy_page_success: "Page copied",
        binder_copy_pages_success: "Pages copied",
        binder_copy_file_success: "File copied",
        binder_copy_files_success: "Files copied",
        binder_copy_file_fail: "Unable to copy file. Please try again.",
        binder_copy_page_fail: "Unable to copy page",
        binder_delete_a_comment: "Delete message",
        binder_delete_a_comment_confirm: "Do you want to delete this message?",
        binder_delete_a_comment_succeed: "Message deleted",
        binder_delete_a_comment_failed: "Unable to delete the message",
        binder_add_a_comment_failed: "Unable to post a message, please try again.",
        change_user_role_failed: "Unable to change role for {0}.",
        change_user_role_success: "User role changed",
        update_binder_name_success: "Binder name updated",
        update_binder_name_failed: "Unable to update binder name",
        update_category_success: "Category updated",
        update_category_failed: "Unable to update category",
        notification_on: "Notification turned on",
        notification_off: "Notification turned off",
        update_notification_failed: "Unable to change notification setting.",
        silent_message: "Send Messages Silently",
        silent_message_on: "Silent messages ON",
        silent_message_off: "Silent messages OFF",
        silent_message_failed: "Unable to change silent message setting.",
        confirm_delete_binder: "Do you want to delete this binder?",
        delete_binder_success: "Binder deleted",
        delete_binder_failed: "Unable to delete this binder",
        confirm_leave_binder: "Do you want to leave this binder?",
        leave_binder_success: "You've left the binder successfully.",
        leave_binder_failed: "Unable to leave this binder",
        confirm_delete_chat: "Do you want to delete this chat?",
        delete_chat_success: "Chat deleted",
        delete_chat_failed: "Unable to delete this chat",
        confirm_leave_chat: "Do you want to leave this chat?",
        leave_chat_success: "You've left chat successfully.",
        leave_chat_failed: "Unable to leave this chat",
        duplicate_binder_success: "Binder duplicated",
        duplicate_binder_failed: "Unable to duplicate the binder",
        create_binder_failed: "Unable to create binder.",
        create_binder_success: "Binder created",
        create_folder_success: "Folder created",
        create_folder_failed: "Unable to create folder. Please try again.",
        rotate_a_page_success: "Page rotated",
        rotate_file_success: "File rotated",
        rotate_a_page_failed: "Unable to rotate page",
        rotate_file_failed: "Unable to rotate file",
        rename_file_success: "File renamed",
        rename_file_failed: "Unable to rename file. Please try again.",
        rename_folder_success: "Folder renamed",
        rename_folder_failed: "Unable to rename folder. Please try again.",
        group_pages: "Group Pages",
        binder_action_needs_one_or_more_files: "Please select one or more files.",
        create_page_group_success: "Group created",
        create_page_group_failed: "Unable to create group. Please try again.",
        select_page_group: "Select from existing groups",
        save_webdoc_success: "Note saved",
        save_webdoc_failed: "Unable to save note. Please try again.",
        read_webdoc_failed: "Unable to load note. Please try again.",
        save_webdoc_conflict: "Another member is currently editing this note.",
        auto_save_webdoc_conflict: "Another member is currently editing this note. Your changes will not be saved automatically.",
        leave_webdoc_save_failed_confirm: "Changes to this note are not saved. Are you sure you want to exit?",
        computer_status_online: "This computer is online.",
        computer_status_offline: "This computer is offline.",
        computer_drive: "This is a drive.",
        item_or_items: "Item(s)",
        updated_colon: "Updated:",
        no_moxtra_desktop_installed: "You do not have Moxtra Desktop installed. It is free and easy to setup.",
        get_remote_files_failed: "Unable to retrieve files from remote desktop.",
        confirm_unlink_desktop: "Are you sure you want to unlink this desktop?",
        unlink_desktop_success: "Desktop unlinked",
        unlink_desktop_failed: "Unable to unlink desktop",
        tooltips_share_flattened: "Use this option to send a copy of the flattened document with annotations.",
        tooltips_share_original: "Use this option to share a copy of the content in original format, without annotations.",
        link_copied_to_clipboard: "Link copied to clipboard.",
        link_posted_to_facebook: "Link posted to Facebook.",
        email_copied_to_clipboard: "Email address copied to clipboard.",
        binder_flattened_pdf: "Flattened PDF",
        share_original_content_failed: "Unable to share original content.",
        link_sent_success: "Link sent",
        link_sent_failed: "Unable to send link. Please try again.",
        join_binder_token_invited_or_expired: "You are not invited or invitation has expired.",
        join_binder_conflict: "You are currently logged in as [i]{0}[/i], but the invitation is for [b]{1}[/b].",
        join_binder_conflict_note: "Please login with the email address [b]{0}[/b] to accept this invitation.",
        transform_chat_message: "Keep your group conversations and content together.",
        show_complete_binder: "Show the complete binder",
        turn_off_email_messages_confirm: "Do you want to turn off email messages from this topic?",
        email_preference: "Email Preference",
        email_messages_are_turned_off: "Email messages from this topic are turned off.",
        choose_binder_permission_error: "You need to be an owner or an editor to choose this binder. Contact your binder owner to change your role.",
        choose_binder_failed: "Unable to choose this binder. Please try again.",
        binder_pages_empty_headline: "Drag and drop files",
        binder_pages_empty_subtitle: "Create, add or upload a file with a single click. Create annotations on uploaded files and share with your team.",
        binder_email_help: "You can email notes, photos, and files from your computer or phone right into this binder.",
        binder_email_address: "Binder Email Address",
        no_binder_in_shelf: "You don't have project and team binders to manage.",
        what_can_do_in_shelf: "When you have binders, you can manage and access them here.",
        what_can_do_in_shelf_1st: "You can create new categories and categorize the binders",
        what_can_do_in_shelf_2nd: "By default, the newest binders are shown on top. You can drag the binders to arrange them in order you like.",
        create_binder: "Create Binder",
        create_binder_to_get_started: "Create a binder to get started.",
        team_name: "Add a team name",
        you_are_viewer_of_this_binder: "You are a viewer of this binder.",
        add_new_binder_tagline: "A Binder is a team workspace for collaboration and communication.",
        create_binder_without_value_warning: "Please enter a topic or select a user",
        invite_binder_member_conflict: "The user you are trying to invite is already a member of this binder.",
        invite_binder_members_conflict: "The users you are trying to invite are already members of this binder.",
        similar_binder_description: 'Would you rather use these existing binders having same members? Or, just click "Create" to proceed.',
        choose_cover_image: "Choose Cover Image",
        pin_header: "Pinned Items",
        binder_meet_tab_description_title: "Meet with binder members.",
        binder_meet_tab_description: "Instantly meet or schedule a meet with other binder members.",
        binder_meet_tab_viewer_tip: "You have view only privilege. You can't host meetings.",
        header_logo: "Header Logo",
        header_background_color: "Header Background Color",
        header_text_color: "Header Text Color",
        show_watermark: "Show Watermark",
        show_clip_watermark: "Show Clip Watermark",
        clip_watermark_image: "Clip Watermark Image",
        default_binder_cover: "Default Binder Cover",
        web_notification_icon: "Web Notification Icon",
        default_user_avatar: "Default User Avatar",
        show_add_file: 'Show "Add File"',
        add_file_options: "Add File Options",
        show_todo: "Show To-Do",
        start_meet_from_binder: "Start Meet from Binder",
        show_app_review: 'Show "App Review"',
        show_send_feedback: 'Show "Send Feedback"',
        show_binder_options: 'Show "Binder options"',
        show_binder_name: 'Show "Binder name"',
        show_binder_email_address: 'Show "Binder Email Address"',
        show_new_binder: 'Show "New Binder"',
        show_meet_now: 'Show "Meet Now"',
        show_schedule_meet: 'Show "Schedule Meet"',
        show_meet_share_screen: 'Show Meet "Share Screen"',
        show_meet_audio: 'Show Meet "Audio"',
        show_meet_video: 'Show Meet "Video"',
        enable_meet_telephony: 'Enable Meet "Telephony"',
        disable_auto_join_audio: "Disable auto join audio in meet",
        webdav_url: "WebDAV URL",
        webdav_domain: "WebDAV Domain",
        ios_app: "iOS App",
        android_app: "Android App",
        desktop_local: "Desktop (Local)",
        desktop_remote: "Desktop (Remote)",
        gallery: "Gallery",
        camera: "Camera",
        web_clip: "Web Clip",
        webdav: "WebDAV",
        box: "Box",
        dropbox: "Dropbox",
        evernote: "Evernote",
        google_drive: "Google Drive",
        icloud_drive: "iCloud Drive",
        confirm_reset_branding: "Do you want to reset settings?",
        reset_branding_success: "Settings reset",
        reset_branding_failed: "Unable to reset settings. Please try again.",
        calendar: "Calendar",
        account_settings: "Account",
        admin_console: "Admin Console",
        binder_shelf: "Shelf",
        loading: "Loading...",
        chat: "Chat",
        binder: "Binder",
        binders: "Binders",
        timeline: "Timeline",
        page: "Page",
        pages: "Pages",
        tab_pages: "Pages",
        group: "Group",
        groups: "Groups",
        folder: "Folder",
        folders: "Folders",
        root_folder: "Root folder",
        comment: "Comment",
        comments: "Comments",
        file: "File",
        files: "Files",
        contact: "Contact",
        contacts: "Contacts",
        user: "User",
        users: "Users",
        member: "Member",
        members: "Members",
        meet: "Meet",
        note: "Note",
        video: "Video",
        audio: "Audio",
        url: "Web link",
        pending: "Pending",
        pendings: "Pendings",
        pending_with_parentheses: "(Pending)",
        attachments: "Attachments",
        completed: "Completed",
        assign_to: "Assign to",
        set_due_date: "Set due date",
        remind_me: "Remind me",
        add_attachment: "Add Attachment",
        in_progress: "In progress",
        save_to: "Save to",
        direct_download: "Direct download",
        save_to_my_moxtra: "Save to my Moxtra",
        dismiss: "Dismiss",
        second: "second",
        seconds: "seconds",
        minute: "minute",
        minutes: "minutes",
        hour: "hour",
        hours: "hours",
        hr: "hr",
        min: "min",
        day: "day",
        days: "days",
        month: "Month",
        year: "Year",
        per_month: "per Month",
        per_year: "per Year",
        monthly: "Monthly",
        annual: "Annual",
        invitation: "Invitation",
        invitations: "Invitations",
        binder_invitation: "Binder Invitation",
        chat_invitation: "Chat Invitation",
        conatct_invitation: "Contact Invitation",
        meet_invitation: "Meet Invitation",
        binder_owner: "Owner",
        binder_editor: "Editor",
        binder_viewer: "Viewer",
        meet_host: "Host",
        meet_guest: "Guest",
        meet_presenter: "Presenter",
        meet_participants: "Participants",
        group_owner: "Owner",
        group_admin: "Admin",
        administrator: "Administrator",
        me_lower_case: "me",
        me_with_parentheses: "(Me)",
        duplicate_binder: "Duplicate this Binder",
        delete_binder: "Delete this Binder",
        leave_binder: "Leave this Binder",
        start_chat: "Start Chat",
        leave_chat: "Leave this Chat",
        delete_chat: "Delete this Chat",
        meet_now: "Meet Now",
        start_meet: "Start Meet",
        join_meet: "Join Meet",
        join_as_colon: "Join as:",
        leave_meet: "Leave Meet",
        end_meet: "End Meet",
        end_and_save: "End & Save",
        click_and_move: "Click & Move",
        create_note: "Create Clip",
        save_note: "Save Clip",
        end_note: "End Clip",
        schedule_meet: "Schedule Meet",
        start_date: "Start Date",
        end_date: "End Date",
        delete_meet: "Delete Meet",
        meet_info: "Meet Info",
        reclaim_host: "Reclaim Host",
        sign_in: "Sign In",
        sign_up: "Sign Up",
        log_in: "Log In",
        login_with_facebook: "Login with Facebook",
        login_with_google: "Login with Google",
        post_to_facebook: "Post to Facebook",
        logout: "Log Out",
        confirm_logout: "Confirm Logout",
        try_again: "Try Again",
        meet_id: "Meet ID",
        meet_id_colon: "Meet ID:",
        share_screen: "Share Screen",
        share_file: "Share File",
        end_share: "End Share",
        invite_contact: "Invite Contact",
        "new": "New",
        start_a_new_conversation: "Start a new conversation",
        view_profile: "View profile",
        binder_topic: "Binder Topic",
        add_comment: "Add a comment...",
        add_member: "Add Member",
        invite_member: "Invite Member",
        enter_invitation_message: "Enter invitation message...",
        include_invitation_message: "Include Invitation Message",
        add_file: "Add File",
        mic_on: "Mic On",
        mic_off: "Mic Off",
        accept: "Accept",
        activate: "Activate",
        add: "Add",
        cancel: "Cancel",
        replace: "Replace",
        keep_both: "Keep Both",
        copy: "Copy",
        copy_to: "Copy To...",
        create: "Create",
        retry: "Retry",
        deactivate: "Deactivate",
        decline: "Decline",
        "delete": "Delete",
        download: "Download",
        download_binder: "Download this Binder",
        download_started: "Download started...",
        duplicate: "Duplicate",
        edit: "Edit",
        "export": "Export",
        invite: "Invite",
        leave: "Leave",
        end: "End",
        move: "Move",
        move_to: "Move To...",
        mute: "Mute",
        muted: "Muted",
        mute_all: "Mute All",
        remove: "Remove",
        rotate: "Rotate",
        save: "Save",
        search: "Search",
        search_all: "Search all",
        share: "Share",
        unmute: "Unmute",
        unmuted: "Unmuted",
        update: "Update",
        upload: "Upload",
        name: "Name",
        rename: "Rename",
        ungroup: "Ungroup",
        enable: "Enable",
        start: "Start",
        join: "Join",
        view: "View",
        schedule: "Schedule",
        starts: "Starts",
        ends: "Ends",
        participant: "Participant",
        agenda: "Agenda",
        invited: "Invited",
        owned: "Owned",
        hosted: "Hosted",
        accepted: "Accepted",
        declined: "Declined",
        recordings: "Recordings",
        recording: "Recording...",
        start_record: "Start Record",
        dial: "Dial",
        participant_number: "Participant Number",
        phase_one: "Phase one",
        phase_two: "Phase two",
        enable_voice: "Enable Voice",
        leave_audio: "Leave Audio",
        test_audio: "Test Audio",
        unmute_to_talk: "Your microphone is muted.",
        call_using_phone: "Call using Phone",
        call_using_computer: "Call using Internet Audio",
        join_audio: "Join Audio",
        phone: "Phone",
        computer: "Internet Audio",
        verify: "Verify",
        submit: "Submit",
        send: "Send",
        change: "Change",
        "continue": "Continue",
        annotate: "Annotate",
        saving_ellipsis: "Saving...",
        ending_ellipsis: "Ending...",
        leaving_ellipsis: "Leaving...",
        connecting_ellipsis: "Connecting...",
        changing_ellipsis: "Changing...",
        updating_ellipsis: "Updating...",
        creating_ellipsis: "Creating...",
        ok: "Ok",
        okay: "Okay",
        yes: "Yes",
        no: "No",
        on: "On",
        off: "Off",
        all: "All",
        back: "Back",
        close: "Close",
        refresh: "Refresh",
        reset: "Reset",
        total: "Total",
        open: "Open",
        review: "Review",
        choose: "Choose",
        optional: "Optional",
        transparent: "Transparent",
        email: "Email",
        email_address: "Email Address",
        first_name: "First Name",
        last_name: "Last Name",
        password: "Password",
        new_password: "New Password",
        confirm_password: "Confirm Password",
        old_password: "Old Password",
        phone_number: "Phone Number",
        forgot_password: "Forgot password?",
        reset_password: "Reset Password",
        timezone_colon: "Timezone:",
        binder_name: "Binder Name",
        category_name: "Category Name",
        company_name: "Company Name",
        passcode: "Passcode",
        tweet: "Tweet",
        username: "Username",
        user_role: "Role",
        user_status: "Status",
        division: "Division",
        department: "Department",
        topic: "Topic",
        category: "Category",
        default_category: "Default Category",
        options: "Options",
        thumbnail: "Thumbnail",
        prev: "Prev",
        next: "Next",
        done: "Done",
        select_user: "Select User",
        select_page: "Select Page",
        select_folder: "Select Folder",
        select_file: "Select File",
        select_all: "Select All",
        unselect_all: "Deselect All",
        selected_users: "Selected Users",
        added_somebody: "Added {0}",
        pending_invitations: "Pending Invitations",
        business_directory: "Business Directory",
        invitations_sent: "Invitations Sent",
        moxtra_contacts: "Moxtra Contacts",
        resend_invitation: "Resend Invitation",
        cancel_invitation: "Cancel Invitation",
        new_page: "New Page",
        desktop: "Desktop",
        remote_desktop: "Remote Desktop",
        whiteboard: "Whiteboard",
        web_page: "Web Page",
        web_document: "Web Document",
        auto_save: "Auto Save",
        salesforce: "Salesforce",
        salesforce_document: "Salesforce Document",
        salesforce_integration: "Salesforce.com Integration",
        billing: "Billing",
        branding: "Branding",
        settings: "Settings",
        configuration: "Configuration",
        user_management: "User Management",
        add_user: "Add User",
        active: "Active",
        disabled: "Disabled",
        more_options: "More Options",
        powered_by_moxtra: "Powered by Moxtra",
        explore_moxtra: "Explore Moxtra",
        web: "Web",
        mobile: "Mobile",
        other: "Other",
        size: "Size",
        preview: "Preview",
        no_contacts: "No Contacts",
        search_no_contact_found: "No contact found",
        search_no_binder_found: "No binder found",
        search_no_result: "No result",
        link: "Link",
        information: "Information",
        image_files: "Image files",
        image_file: "Image File",
        video_file: "Video File",
        pdf_file: "PDF File",
        video_options: "Video Options",
        turn_on_camera: "Turn on camera",
        turn_off_camera: "Turn off camera",
        installation_error: "Installation Error",
        not_verified_with_parentheses: "(Not verified)",
        user_verify_email_resend_failed: "Unable to resend verification email. Please try again.",
        user_verify_email_resend_success: "Verification email sent.",
        user_verify_email_undo_tip: "Moxtra has sent an email to ",
        user_verify_email_undo_tip_2: "to verify the email address. Follow the instructions in your email to confirm the email address.",
        user_verify_email_resend_tip: "Resend Email",
        user_verify_email_have_comfirmed: "I've completed this step",
        do_not_get_email: "Didn't get the email message?",
        remind_me_later: "Remind me later",
        need_refresh_browser: "System error, please refresh your browser and try again.",
        common_msg_browser_info_suggestion: "You are using an unsupported browser. Please switch to supported browsers like",
        common_msg_reach_limit_binders_title: "Limit reached on the number of binders",
        common_msg_reach_limit_binders: "You have reached the number of binders allowed for this account.",
        common_msg_reach_limit_pages_title: "Limit reached on the number of pages",
        common_msg_reach_limit_pages: "You have reached the limit on the number of pages allowed in a binder.",
        common_msg_reach_limit_members_title: "Limit reached on number of members",
        common_msg_reach_limit_members: "You have reached the limit on number of members allowed in a binder.",
        common_msg_reach_limit_participants_title: "Limit reached on number of participants",
        common_msg_reach_limit_participatns: "You have reached the limit on number of participants allowed.",
        common_msg_reach_limit_monthly_upload: "You have reached the limit on upload size ({{size}}) allowed for this account in a month.",
        common_msg_reach_limit_team_members: "You have reached the limit on maximum {0} members allowed in a team.",
        browser_not_support_audio_tag: "Your browser does not support audio tag.",
        browser_not_support_video_tag: "Your browser does not support video tag.",
        invite_decline_confirm: "Are you sure you want to decline this invitation?",
        invite_accept_success: "Invitation accepted",
        invite_accept_failed: "Unable to accept invitation. Please try again later.",
        invite_decline_success: "Invitation declined",
        invite_decline_failed: "Unable to decline the invitation. Please try again later.",
        please_select_one_user: "Please select one user",
        favorite: "Favorite",
        favorites: "Favorites",
        unread: "Unread",
        all_binders: "All Binders",
        upgrading: "Upgrading...",
        search_or_enter_email: "Search user, or enter email addresses",
        enter_email: "Enter email addresses",
        enter_email_tip: "(Separate multiple email addresses with comma or space)",
        system_unknown_error: "Oops! Something went wrong. Please try again.",
        overwrite: "Overwrite",
        storage_usage: "Storage Usage",
        drop_your_file_to_upload: "Drop your file to upload",
        view_original_file: "View Original",
        member_invited: "Member invited",
        similar_binders_uppercase: "SIMILAR BINDERS",
        input_selector_help: "<b>↑ ↓</b> to navigate <b>↵</b> to select <b>esc</b> to dismiss",
        favorite_header: "Favorited Items",
        mention_header: "Mentions",
        clear_all: "Clear All",
        confirm_clear_all_favorite: "Are you sure you want to clear all favorited items?",
        empty_mention_list: "You don't have any mentions yet. When you are mentioned in a message, that will appear here.",
        empty_favorite_list: "You haven't favorited anything yet. You can favorite messages and files. Favoriting makes things easier to find: they'll show up right here in this list.",
        empty_favorite_binder_list: "You haven't favorited any binders yet. Favoriting makes it easier to find the binder: they'll show up right here in this list.",
        empty_pin_list: "No items have been pinned yet! Pin important messages or files to draw attention of other binder members.",
        what_do_you_want_to_do: "What do you want to do?",
        search_or_enter_to_invite: "Search or enter email to invite",
        invite_by_email: "Invite by Email",
        confirm_delete_contact: "Are you sure you want to delete this contact?",
        contact_delete_success: "Contact Deleted",
        contact_delete_failed: "Unable to delete contact. Please try again later.",
        contact_invitation_title: "[b]{0}[/b] wants to connect with you",
        contact_start_meet_failed: "Unable to start Meet. Please try again later.",
        contact_start_chat_failed: "Unable to start Chat. Please try again later.",
        contact_invite_success: "Invitation sent",
        contact_invite_failed: "Unable to send invitation. Please try again later.",
        contact_resend_success: "Invitation resent",
        contact_resend_failed: "Unable to resend invitation. Please try again later.",
        contact_lable_cancel_confirm: "Are you sure you want to cancel this invitation?",
        contact_cancel_success: "Invitation canceled",
        contact_cancel_failed: "Unable to cancel the invitation. Please try again later.",
        team: "Team",
        teams: "Teams",
        team_members: "Team Members",
        set_as_team_owner: "Set as Team Owner",
        confirm_leave_team: "Are you sure you want to leave this team?",
        confirm_reassing_team_owner: "Are you sure you want to set this member as team owner?",
        confirm_delete_team: "Are you sure you want to delete this team?",
        confirm_delete_member: "Are you sure you want to delete this member?",
        delete_team_condition_warning: "You need to remove all team members before you can delete the team.",
        delete_team_success: "Team deleted",
        delete_team_failed: "Unable to delete the team. Please try again.",
        leave_team_success: "You have left the team successfully.",
        leave_team_failed: "Unable to leave team. Please try again.",
        create_team: "Create Team",
        create_team_success: "Team created",
        create_team_failed: "Unable to create the team. Please try again.",
        update_team_name_success: "Team name updated",
        update_team_name_failed: "Unable to update team name. Please try again.",
        add_member_success: "Member added",
        add_member_failed: "Unable to add member. Please try again.",
        delete_member_confirm: "Are you sure you want to delete this member?",
        delete_member_success: "Member deleted",
        delete_member_failed: "Unable to delete member. Please try again.",
        set_team_owner_success: "You have set new team owner.",
        set_team_owner_failed: "Unable to set team owner. Please try again.",
        team_owner_responsibility_description: "Team owner can rename or delete the team.",
        feed_board_create: "{{user}} created this {{target}}.",
        feed_board_create_chat: "{{user}} has started a conversation.",
        feed_board_begining: 'This is the beginning of the "{{binder}}" conversation, which was created by {{user}} on {{created_time}}.',
        feed_pages_create: "{{user}} added {{target}}.",
        feed_target_name: ' "{{name}}"',
        feed_folder_create: '{{user}} created a folder "{{folder}}".',
        feed_folder_rename: '{{user}} renamed a folder to "{{folder}}".',
        feed_folder_delete: '{{user}} deleted a folder "{{folder}}".',
        feed_pages_move: '{{user}} moved file "{{file}}" to folder "{{folder}}".',
        feed_pages_move_without_name: '{{user}} moved file to folder "{{folder}}".',
        feed_pages_rename: '{{user}} renamed a file to "{{file}}".',
        feed_clip_create: "{{user}} recorded a video clip.",
        feed_pages_annotation: "{{user}} annotated a page.",
        feed_pages_delete: "{{user}} deleted {{target}}.",
        feed_pages_comment: "{{user}} commented on a page",
        feed_pages_voice_comment: "{{user}} added a voice comment on a page.",
        feed_pages_comment_deleted: "{{user}} deleted a comment from a page.",
        feed_pages_update: "{{user}} updated a note.",
        feed_board_comment: "{{user}}: {{comment}}",
        feed_board_comment_deleted: "{{user}} deleted a message.",
        feed_board_comment_voice: "{{user}}: [Voice]",
        feed_board_comment_voice_message: "[Voice]",
        feed_board_name_change: '{{user}} renamed the {{board_type}} to "{{newName}}".',
        feed_relationship_join: "{{user}} joined this {{board_type}}.",
        feed_relationship_join_directly: "{{user}} added {{member}} to this {{board_type}}.",
        feed_relationship_leave: "{{user}} left this {{board_type}}.",
        feed_relationship_invite: "{{user}} invited {{invitee}} to join this {{board_type}}.",
        feed_relationship_cancel: "{{user}} canceled the invitation to {{invitee}}.",
        feed_relationship_remove: "{{user}} removed {{member}} from this {{board_type}}.",
        feed_relationship_decline: "{{user}} declined to join this {{board_type}}.",
        feed_relationship_change_role_editor: "{{user}} made {{member}} an editor.",
        feed_relationship_change_role_viewer: "{{user}} made {{member}} a viewer.",
        feed_email_receive: "{{user}} sent a message via email.",
        feed_todo_create: "{{user}} added a to-do item",
        feed_todo_update: "{{user}} updated a to-do item",
        feed_todo_assign: "Assigned to {{member}}",
        feed_todo_remove_assign: "{{user}} removed an assignee from a to-do item.",
        feed_todo_comment: "{{user}} commented:",
        feed_todo_attachment: "{{user}} added an attachment",
        feed_todo_attachment_deleted: "{{user}} deleted an attachment",
        feed_todo_due_date_arrive: '"{{todo_name}}" is due',
        feed_pin: "{{user}} pinned {{target}}",
        timeline_feed_todo_create: "{{user}} added a to-do item.",
        timeline_feed_todo_update: "{{user}} updated a to-do item.",
        timeline_feed_todo_delete: "{{user}} deleted a to-do item.",
        timeline_feed_todo_assign: "{{user}} assigned a to-do item to {{member}}.",
        timeline_feed_todo_comment: "{{user}} commented on a to-do item",
        timeline_feed_todo_attachment: "{{user}} added an attachment to a to-do item.",
        timeline_feed_todo_complete: "{{user}} completed a to-do item.",
        timeline_feed_todo_reopen: "{{user}} reopened a to-do item.",
        timeline_feed_todo_due_date: "{{user}} set a due date for a to-do item.",
        timeline_feed_todo_due_date_removed: "{{user}} removed due date from a to-do item.",
        timeline_feed_todo_attachment_deleted: "{{user}} deleted an attachment from a to-do item.",
        feed_todo_updated: "{{user}} updated:",
        feed_todo_added: "{{user}} added:",
        feed_todo_complete: "Completed",
        feed_todo_reopen: "Reopened",
        feed_todo_delete: "Deleted",
        feed_todo_due_on: "Due on {{due_date}}",
        feed_todo_due_removed: "Due date was removed.",
        timeline_feed_session_schedule: '{{user}} scheduled a meet "{{topic}}"',
        timeline_feed_session_reschedule: '{{user}} rescheduled the meet "{{topic}}"',
        timeline_feed_session_start: 'meet "{{topic}}" has started',
        timeline_feed_session_end: 'meet "{{topic}}" has ended',
        timeline_feed_session_recording_ready: 'The recording for Meet "{{topic}}" is ready.',
        timeline_feed_session_cancel: '{{user}} removed a meet "{{topic}}"',
        timeline_feed_session_rename: '{{user}} renamed the meet to "{{topic}}"',
        feed_session_schedule: "Scheduled a Meet",
        feed_session_rename: "Renamed Meet",
        feed_session_reschedule: "Rescheduled a Meet",
        feed_session_cancel: "Removed Meet",
        feed_session_end: "Ended Meet",
        feed_session_start: "Started a Meet",
        feed_session_recording_ready: "Meet recording is ready.",
        play_recording: "Play Now",
        join_now: "Join Now",
        meet_has_canceled: "Meet has been canceled",
        new_messages: "New Messages",
        feed_pages_create_url: "a web link",
        feed_param_one_page: "a page",
        feed_param_a_resource: "a file",
        feed_param_a_whiteboard: "a whiteboard",
        feed_param_a_note: "a note",
        feed_param_file_complex: "{{count}} files",
        feed_param_an_image: "an image",
        feed_binder: "binder",
        feed_chat: "chat",
        feed_conversation: "conversation",
        feed_an_audio_page: "an audio file",
        feed_a_video_page: "a video file",
        feed_a_moxtra_note: "a video clip",
        feed_pin_a_message: "a message",
        feed_pin_a_page_message: "a page message",
        chat_placeholder_write_comment: "Send message... (Shift + Enter to insert a new line)",
        delivery_failed: "(Delivery failed)",
        resend: "Resend",
        feed_empty_email: "This message has no content.",
        feed_new_messages: "{{count}} new messages",
        feed_new_message: "{{count}} new message",
        favorite_success: "Item favorited",
        favorite_failed: "Unable to favorite the item. Please try again.",
        remove_favorite_success: "Item unfavorited",
        remove_favorite_failed: "Unable to unfavorite the item. Please try again.",
        pin_success: "Item pinned",
        pin_failed: "Unable to pin the item. Please try again.",
        remove_all_pin_success: "All items are unpinned.",
        remove_all_pin_failed: "Unable to unpin all items. Please try again.",
        confirm_clear_all_pin: "Are you sure you want to unpin all items from this binder?",
        remove_pin_success: "Unpinned",
        remove_pin_failed: "Unable to unpin the item. Please try again.",
        mentioned_me_dismissed: "Mention dismissed",
        mentioned_me_not_dismissed: "Unable to dismiss this mention. Please try again.",
        feed_not_found: "The item cannot be found either because it has been deleted or this item had merged by new updated.",
        sign_in_and_accept: "Sign In & Accept",
        sign_in_and_start: "Sign In & Start",
        sign_up_and_accept: "Sign Up & Accept",
        sign_in_failed: "Sign in failed.",
        sign_up_failed: "Sign up failed.",
        signup_conflict: "It seems that you already have an account.",
        Facebook_login_failed: "Facebook login failed.",
        login_failed_user_pass: "Invalid email or password.",
        login_failed_unexpected: "Login failed (error_code={{code}})",
        login_other_options: "Other Login Options",
        create_business_account_failed: "Unable to create trial account.",
        login_remember_me: "Remember me",
        login_form_label: "Account Sign In",
        signup_form_label: "Account Sign Up",
        login_link_sign_up: "Sign up for an account",
        forgetpass_form_label: "Forgot your password?",
        forgetpass_label_note: "Enter the email address associated with your Moxtra account. You will receive an email with a secure link to set your new password.",
        forgetpass_reset_success_title: "Please check your email {{email}}",
        check_email_spam_folder: "Check your spam / junk folder if you do not receive the email in five minutes.",
        changepass_form_label: "Enter your new password",
        change_password: "Change Password",
        changepass_success: "Password updated. Please login with new password.",
        changepass_failed: "Token expired or invalid. Please reset the password again.",
        signup_disclaimer: "By signing up, I agree to the [url=http://www.moxtra.com/terms.html]Terms of Service[/url] and [url=http://www.moxtra.com/privacy.html]Privacy Policy[/url].",
        signup_does_have_account: "Have an acount?",
        signup_login_here: "Log in here.",
        company_required: "Company name is required",
        verify_welcome_title: "Thank You!",
        user_verify_email_success: "Your email, {{email}}, is now verified.",
        user_verify_email_success_desc: "Discover new ways to Collaborate, Share & Present with your fully enabled Moxtra account.",
        user_verify_email_expired: "You have already verified your email address. Go ahead and login to your Moxtra account.",
        user_verify_email_expired_desc: "Oops - the link you clicked to confirm your email has expired. Your email may already have been validated.",
        user_email_not_verified: "Your email is not verified. Click the link in the verification email sent to you.",
        user_verify_email_required_for_join_group: "You have to verify the email before you can accept the invitation",
        are_you_sure_to_logout: "Are you sure you want to logout?",
        start_free_trial: "Start Free Trial",
        label_free_trial: "Free Trial",
        label_30_days: "30 days",
        label_free_trial_login_tip: "Already have an account?",
        label_free_trial_login_to_get_started: "Login to get started.",
        label_large_meets: "More participants per Meet",
        label_user_management: "User Management",
        label_binder_management: "Binder Management",
        label_more_binders: "More storage, and advanced features",
        get_sso_options_failed: "Unable to get SSO options",
        user_lookup_email_error: "Unable to lookup login options. Please try again.",
        user_lookup_email_no_sso: "This email is not configured to use Single Sign On. Please verify the email address or try using <a href='#login'>direct login</a> to Moxtra.",
        admin_msg_sflink_one_step_left: "You are just one step away from using Moxtra from Salesforce. An email was sent to your email address,",
        admin_msg_sflink_inviting_of: "inviting to be part of",
        admin_msg_sflink_click_to_validate: "Click on the link in the email to validate your email address and accept your invitation.",
        admin_msg_sflink_have_accepted: "I've accepted the invitation",
        admin_msg_sflink_contact_admin: "Please contact your administrator",
        admin_msg_sflink_warn_not_have_account: "Sorry, you do not have a Moxtra account.",
        admin_msg_sflink_require_business_account: "Moxtra Business Edition is required for using Moxtra within Salesforce.",
        sso_signup_fail: "Your organization has restricted self sign up. Please contact your administrator.",
        sso_reset_password_fail: "Your account is setup for login using your business credential. Please contact your administrator to reset the password.",
        admin_msg_sflink_business_account_expired: "Moxtra Business Edition subscription has expired.",
        admin_msg_sflink_sf_session_expired: "Salesforce session has expired or system error.",
        admin_msg_sflink_logout_retry: "Please logout and try again.",
        admin_msg_sflink_logged_outside_of_sf: "You've already logged into Moxtra using another account outside of Salesforce.",
        admin_msg_sflink_users_reach_limits: "Sorry, number of Moxtra users for <b>{0}</b> has reached the licensed limit.",
        admin_msg_sflink_for_more_details: "See [url=https://www.moxtra.com/business/sales]Moxtra for Sales[/url] for more details.",
        session_expired: "Session has expired. Please login again.",
        meet_id_required: "Please enter Meet ID",
        meet_id_format_error: "Meet ID should be numbers",
        meet_hosted_by: "Hosted by {{name}}",
        meet_topic: "{{name}}'s Meet",
        meet_change_presenter: "Change to Presenter",
        meet_invite_participants: "Invite to Meet",
        meet_invite_participants_success: "Invitation Sent",
        meet_invite_participants_failed: "Unable to send the invitation. Please try again.",
        meet_save_failed: "Unable to save Meet. Please try again later.",
        meet_msg_end_confirm: "Do you want to end your Meet?",
        meet_msg_leave_confirm: "Do you want to leave this Meet?",
        meet_msg_in_progress: "You are in Meet.",
        meet_click_copy_link_success: "Meet Link copied to clipboard",
        meet_tooltip_show_panel: "Show participants",
        meet_tooltip_hide_panel: "Hide participants",
        one_participant: "1 Participant",
        multi_participants: "{0} Participants",
        meet_who_is_speaking: "{0} is speaking",
        meet_who_are_speaking: "{0} are speaking",
        meet_ended: "Meet Ended",
        meet_has_not_started: "Meet hasn't started",
        meet_id_invalid: "Invalid Meet ID",
        meet_id_invalid_check_tip: "Please check your Meet ID",
        meet_attendee_name_optional: "Name (optional)",
        meet_invitation_invalid_id: "Invalid Meet ID: [b]{0}[/b]. Please check your Meet ID.",
        meet_invitation_id_required: "Meet ID is required. Please check your invitation email.",
        meet_invitation_if_host: "Meet has not started. If you are the host",
        meet_invitation_click_to_start: "Click here to start Meet",
        meet_invitation_click_start_button: "Meet has not started. Cick the button to start Meet.",
        meet_invitation_click_join_button: "Meet has started. Click the button to join Meet now.",
        meet_invitation_jbh_join_button: "Host hasn't started the Meet, but you can join now.",
        notify_participant_joined: "{0} joined",
        notify_participant_left: "{0} left",
        save_meet_to: "Save Meet to",
        join_meet_but_has_ended: "Sorry, the Meet has ended!",
        meet_schedule_failed: "Unable to schedule Meet. Please try again.",
        meet_confirm_delete_meet: "Are you sure you want to delete this Meet?",
        meet_delete_meet_failed: "Unable to delete Meet. Please try again.",
        meet_schedule_success: "Meet scheduled",
        meet_update_success: "Meet updated",
        meet_delete_success: "Meet deleted",
        meet_update_failed: "Unable to update Meet. Please try again.",
        meet_start_video_failed: "Unable to start video. Please try again.",
        meet_join_video_failed: "Unable to join video. Please try again.",
        join_meet_but_ahead_of_scheduled: "The Meet is scheduled for {{date}}. Please try to join at the scheduled time.",
        join_meet_jbh_but_ahead_of_scheduled: "The Meet is scheduled for {{date}}. You can join this Meet {{minutes}} minutes ahead of the scheduled time.",
        join_meet_within_minutes_of_scheduled: "Your host has not started the Meet yet. Please wait.",
        plugin_install_confirm_tip: "Please make sure Moxtra Application Plugin installation is successful.",
        plugin_download_latest: "[url={{link}}]Click here[/url] to download the latest version.",
        plugin_refresh_tip: "Or you can refresh browser to try again.",
        plugin_error_block_group_policy: "Application is blocked by Windows Group Policy. Please change Group Policy and try again.",
        plugin_error_deny_execution: "You've denied the application to run.",
        screenshare_msg_attendee_loading: "Loading Presenter's screen...",
        screenshare_msg_status_started: "Screen Share started.",
        screenshare_msg_start_failed: "Unable to share screen. Please try again.",
        screenshare_msg_attendee_reconnect: "Network connection dropped. Reconnecting...",
        screenshare_msg_attendee_network_disconnected: "Network connection dropped. Please check your network connection.",
        screenshare_msg_status_stopped: "Screen Share stopped.",
        screenshare_msg_started: "You are sharing your screen now.",
        screenshare_msg_browser_supported_on_mac: "Screen Share requires Safari 6.0+, Chrome 19+, Firefox 12+ or Opera 12+.",
        screenshare_msg_browser_supported_on_win: "Screen Share requires IE 10+, Chrome 19+, Firefox 12+, or Opera 12+.",
        audio_msg_ie_supported: "Audio conference requires IE 10+, Chrome 19+, Firefox 12+, or Opera 12+.",
        microphone_alert: "Please allow Moxtra to access your microphone",
        permission_alert: "Moxtra plugin requires your permission to run",
        moxtra_plugin_is_downloading: "Moxtra plugin is downloading...",
        locate_the_installation_file: "Install the file once the download is complete.",
        activex_install_bar_disabled: "Don't see a message bar at the bottom? Use a different browser.",
        activex_filtering_enabled_alert: "This feature requires ActiveX Filtering to be disabled. Go to Tools - Safety to disable it.",
        activex_not_supported_on_metro_ie: "It seems like you are using Metro UI. Switch to Desktop mode and try again.",
        meet_empty_headline: "START A MEET",
        meet_empty_subtitle: "Talk and Share in Real-time",
        device_level_mic_tip: "To talk to others, turn on your system microphone.",
        device_level_speaker_tip: "To hear others speak, turn on the volume of your system speaker.",
        device_mic_muted_tip: "Your microphone is muted.",
        device_mic_status_tip: "You might be having problems with your microphone. Please check your system settings or [b]test audio[/b].",
        device_camera_error: "Sorry, unable to access your camera. Please make sure your camera is properly installed. Also close other applications and then try again.",
        device_microphone_error: "The system microphone was not found. Close other applications and try again.",
        audio_device_playback_error: "The system speaker was not found.",
        proxy_error_title: "Proxy Error",
        proxy_denied_error: "Please check your proxy settings.",
        audio_invalid_token_error: "A fatal error occurred due to which can't join audio. Please refresh your browser or rejoin the meet.",
        record_this_meet_tip: "Automatically record this Meet when it starts",
        click_to_record_this_meet: "Start Meet Recording",
        click_to_pause_record: "Pause Meet Recording",
        click_to_resume_record: "Resume Meet Recording",
        failed_to_start_record_meet: "Unable to start Meet recording. Please try again.",
        failed_to_pause_record_meet: "Unable to pause Meet recording. Please try again.",
        failed_to_resume_record_meet: "Unable to resume Meet recording. Please try again.",
        failed_to_stop_record_meet: "Unable to stop Meet recording. Please try again.",
        meet_recording_is_paused: "Meet recording is paused",
        recording_copied_success: "Recording copied",
        recording_copied_failed: "Unable to copy recording. Please try again later.",
        meet_in_progress_uppercase: "MEET IN PROGRESS",
        screen_share_uppercase: "SCREEN SHARE",
        we_are_preparing_your_meet: "Your Meet is about to start now",
        meet_finished_tip: "Thank you for experiencing Moxtra Meet.",
        moxtra_tagline: "Team Communication and Collaboration.",
        learn_more: "Learn more",
        add_to_calendar: "Add to calendar",
        import_icalendar: "Export iCalendar (.ics)",
        meet_join_audio_introduction: "Use your phone or internet to join the audio",
        meet_join_audio_voip_introduction: "Use internet to join the audio",
        install_chrome_extension: "Add Meet Extension to Chrome",
        install_chrome_extension_detail: "Please follow this one-time process to join Meet.",
        install_chrome_extension_button: "Add Meet Extension",
        install_chrome_extension_failed: "[color=darkorange]Unable to add Meet Extension.[/color]\n Please go to [url=https://chrome.google.com/webstore/detail/meet-extension-by-moxtra/gcihackglhkfinndffhemefinhlmagfe]Chrome Web Store[/url] to install the extension.",
        continue_to_download_chrome_extension: "Click [b]Continue[/b] to download extension.",
        drag_and_install_chrome_extension_tip: "Drag the [b]{{crx_name}}[/b] to Chrome Extensions tab after download completed.",
        install_addon: "Install Meet Add-On",
        install_addon_step1: "Click {{installer_zip_file_name}}",
        install_addon_step2: "Double click {{installer_app_file_name}} to join Meet",
        install_addon_failed: "If nothing prompts from browser, please [url={{addon_installer}}]try again[/url].",
        video_in_progress: "Video in Progress",
        update_meet_topic_success: "Meet topic updated",
        update_meet_topic_failed: "Unable to update meet topic. Please try again.",
        meet_application_os_supported: "Currently Meet is only supported on Windows and Mac OS X.",
        meet_reclaim_host_tip: "Do you want to reclaim host?",
        meet_reclaim_host_success: "Host reclaimed.",
        meet_reclaim_host_failed: "Unable to reclaim host. Please try again.",
        please_allow_moxtra_plugin_execute: "Please allow Moxtra plugin to run on your computer.",
        meet_reclaim_host_tip: "Do you want to reclaim host?",
        meet_reclaim_host_success: "Host reclaimed.",
        meet_reclaim_host_failed: "Unable to reclaim host. Please try again.",
        edge_browser_not_supported: "We’re sorry, Meet is not yet available for the Edge browser. Please join the Meet via Chrome or Firefox.",
        plugin_needed_to_join_audio: "A plugin is needed to join audio via internet.",
        join_via_app: "JOIN via APP",
        view_in_app: "VIEW in APP",
        open_the_app: "OPEN APP",
        get_the_app: "GET THE APP",
        proceed_to_mobile_site: "Proceed to Mobile Site",
        mobile_public_view_title: "You are invited to view the binder: [b]{0}[/b]",
        mobile_join_chat_title: "{0} invited you to chat",
        mobile_join_binder_title: "You are invited to join the binder: [b]{0}[/b]",
        mobile_welcome_to_moxtra: "Welcome to Moxtra",
        mobile_welcome_to_moxtra_invitations: "Welcome to Moxtra, there are pending invitations.",
        mobile_read_token_error: "Invalid or expired token.",
        note_renamed_to_clip: "Clip",
        note_topic: "{{name}}'s Clip",
        exit_without_saving: "Quit without saving",
        exit_without_saving_confirm: "Are you sure you want to end the Clip without saving?",
        note_duration: "Recording Duration: {0}",
        note_msg_in_progress: "You are recording a Clip.",
        note_name: "Clip Name",
        save_note_to: "Save Clip to",
        save_note_warning_hint: "Hint: It may take a few minutes to generate the Clip after you save.",
        github_tagline: "Code management and source control",
        github_summary: "[url=https://github.com]GitHub[/url] offers powerful collaboration, code review, issue tracking and online source code hosting for Git projects.",
        github_usage: "This integration will post commits, pull requests, and activity on GitHub Issues to a binder in Moxtra.",
        github_step1: "In your Github account, open the repo from which you want to receive notifications in Moxtra",
        github_step2: 'Click on "Settings" from the admin menu',
        github_step3: 'Click on "Webhooks & Services"',
        github_step4: 'Click on "Add webhook"',
        github_step5: "Enter the details in the webhook page",
        github_step5_1: 'Enter the url {{webhook_url}} which you copied from Moxtra into "Payload URL".',
        github_step5_2: 'Select "application/json" for content type.',
        github_step5_3: 'Select "Let me select individual events" for which events you would like to trigger.',
        github_step5_4: 'Keep "Active" checked.',
        github_step5_5: 'Click on "Add webhook"',
        hubspot_tagline: "All-in-one marketing software tool",
        hubspot_summary: "[url=http://www.hubspot.com]HubSpot[/url] is an inbound marketing software platform that helps companies attract visitors, convert leads, and close customers.",
        hubspot_usage: "This integration will post Hubspot leads, contacts etc to a binder in Moxtra when events are triggered in HubSpot.",
        hubspot_steps_title: "Setting up Webhooks includes the following two steps:",
        hubspot_steps_1: "Create a Workflow.",
        hubspot_steps_2: "Add an action.",
        hubspot_steps_1_title: "To create a Workflow",
        hubspot_steps_2_title: "To add an action",
        hubspot_steps_1_step1: 'Navigate to "Contacts > Workflows".',
        hubspot_steps_1_step2: 'Create a new workflow by clicking the button "Create new workflow".',
        hubspot_steps_1_step3: 'Name your workflow and select the type of workflow. Once named, and type is selected, click the "Create a new workflow" button.',
        hubspot_steps_1_step4: "Next you will see the Actions screen where you will set up the webhook.",
        hubspot_steps_2_step1: 'Add an action that includes "Trigger a Webhook".',
        hubspot_steps_2_step2: 'Select "POST" as the HTTP method from the dropdown.',
        hubspot_steps_2_step3: "Then enter the webhook URL.",
        hubspot_steps_2_step4: "Save the workflow",
        jira_tagline: "Project and issue tracking",
        jira_summary: "[url=https://www.atlassian.com/software/jira]JIRA[/url] is a powerful issue tracking service that allows teams to capture and organize issues, assign work, and follow their team’s activity.",
        jira_usage: "This integration will allow you to receive updates in a Moxtra binder when a JIRA issue is created, resolved or re-opened.",
        jira_step1: 'In your JIRA account, click on "System" in the Administration menu.',
        jira_step2: 'Click on "Webhooks", which is found in the sidebar under "Advanced".',
        jira_step3: 'Click the "Create a Webhook button" to display the webhook creation form. Choose a unique name and add Webhook URL as the URL. You can also configure which events will be posted to Moxtra. Click the "Create" button when you\'re done.',
        quickbooks_tagline: "Accounting software for small business",
        quickbooks_summary: "[url=http://quickbooks.intuit.com]QuickBooks[/url] is set of software solutions designed to manage payroll, inventory, sales and other needs of a small business. The software's features include marketing tools, merchant services, product and supplies, training solutions.",
        quickbooks_usage: "This integration will post notifications to a binder in Moxtra when new accounts, bills, invoices, payments etc are created.",
        salesforce_tagline: "Powerful customer relationship management software",
        salesforce_summary: "[url=http://www.salesforce.com]Salesforce[/url] offers CRM marketing and management that help automate sales management, sales forecasting and order management functions.",
        salesforce_usage: "This integration will post notifications to a binder in Moxtra when new accounts, contacts, leads, opportunities etc are created.",
        zendesk_tagline: "Beautifully simple customer service platform",
        zendesk_summary: "[url=http://www.zendesk.com]Zendesk[/url] is web-based software to manage your team's help desk ticketing, issue tracking, and customer service support.",
        zendesk_usage: "This integration allows your team to receive notifications when the status of a help ticket is changed.",
        zendesk_step1: 'Log in to Zendesk. Click the cogwheel-shaped "Admin" icon located at the bottom-left corner of the Dashboard page to take you to the Admin page.',
        zendesk_step2: 'In the "SETTINGS" menu, click on "Extensions".',
        zendesk_step3: 'Click "add target".',
        zendesk_step4: 'Choose "URL target" from the list of target types to add.',
        zendesk_step5: 'Name the new extension something like "Moxtra Target".',
        zendesk_step6: "In the URL field, enter {{webhook_url}}.",
        zendesk_step7: 'Select method as "POST".',
        zendesk_step8: 'Set the Attribute Name field to "payload".',
        zendesk_step9: 'Select "Create Target" from the drop-down menu and click the Submit button.',
        zendesk_example_title: "Setting up a trigger (example with Ticket creation)",
        zendesk_example_step1: 'From the Admin page, select "Triggers" from the "BUSINESS RULES" menu.',
        zendesk_example_step2: 'Click "add trigger".',
        zendesk_example_step3: 'Name the trigger something like "Ticket-Creation-Trigger".',
        zendesk_example_step4: 'From the drop-down menus in the "Meet all of the following conditions" section, select "Ticket: Is..." and "Created".',
        zendesk_example_step5: 'In the "Perform these actions" section, select "Notifications: Notify target" and "Moxtra Target".',
        zendesk_example_step6: "Use the available placeholders to create the message in the Message box.",
        zendesk_example_step7: "Submit the new trigger. It should look something like this.",
        zoho_tagline: "Flexible customer relationship management application",
        zoho_summary: "[url=http://www.zoho.com]Zoho[/url] CRM is a customer relationship management application with features like procurement, inventory, and some accounting functions from the realm of ERP.",
        zoho_usage: "This integration allows your team to receive notifications when a contact is created, a business deal is closed or a record is updated.",
        zoho_steps_title: "Setting up Webhooks includes the following three steps:",
        zoho_steps_1: "Create a webhook.",
        zoho_steps_2: "Associate webhook to a workflow rule.",
        zoho_steps_3: "Test webhook integration.",
        zoho_steps_1_title: "To create a webhook",
        zoho_steps_2_title: "To associate webhook to a workflow rule",
        zoho_steps_3_title: "To test the webhook integration",
        zoho_steps_1_step1: 'Click "Setup > Automation > Workflow > Webhooks".',
        zoho_steps_1_step2: 'In the Webhooks page, click the "Configure Webhook".',
        zoho_steps_1_step3: "In the Configure Webhook page, specify all necessary parameters.",
        zoho_steps_1_step4: 'Click "Save".',
        zoho_steps_2_step1: 'Click "Setup > Automation > Workflow Rules".',
        zoho_steps_2_step2: 'In the Workflow Rules page, click the "Create a Workflow Rule".',
        zoho_steps_2_step3: "In the Workflow Rule page, specify workflow rule parameters.",
        zoho_steps_2_step4: "Under Workflow Actions, select the webhooks to be triggered.",
        zoho_steps_2_step5: 'Click "Save".',
        zoho_steps_3_step1: "Add test data in CRM according to your workflow rule criteria.",
        zoho_steps_3_step2: "In the Moxtra binder, check for the data received from Zoho CRM via webhook notification.",
        zoho_steps_3_step3: "If there is an error or data mismatch, modify your webhook settings in Zoho CRM.",
        zoho_steps_3_step4: "Continue this test until you obtain the required data from Zoho CRM to Moxtra binder.",
        zapier_tagline: "Zapier makes it easy to automate tasks between web apps",
        zapier_summary: "Zapier lets users create integrations that automate tasks between hundreds of web applications.",
        zapier_usage: "Integrate Moxtra with dozens of your favorite productivity applications through Zapier.",
        email_service_tagline: "Send email to a Moxtra binder",
        email_service_summary: "You can do so much more with Moxtra by connecting it to the email apps you use like Gmail, Yahoo Mail, Outlook, Thunderbird etc.",
        email_service_usage: "You can email a message to a Moxtra binder.",
        email_service_follow_steps: "Follow these steps to add your email content to a Moxtra binder.",
        email_service_step1: "Click on Binder options.",
        email_service_step2: "Click on Settings.",
        email_service_step3: "Click on the binder email address to copy it.",
        email_service_step4: "Open your email client and send the email message to the binder email address.",
        email_service_step5: "Your email content will be posted as a page in the Moxtra binder. Any attachments in your email will also be posted as a page.",
        incoming_tagline: "Build your own integrations",
        incoming_summary: "Incoming Webhooks allow you to build or set up integrations which subscribe to certain events and make use of normal HTTP requests with a JSON payload. They are great for building your own, personal integration or sending real-time data into Moxtra from legacy and in house enterprise applications. They are simple ways to post messages from external sources into Moxtra.",
        incoming_sending_message: "Sending Messages",
        incoming_option1: "Option 1:",
        incoming_option1_desc: "Send a string as the [b]payload[/b] parameter in a POST request.",
        incoming_option2: "Option 2:",
        incoming_option2_desc: "Send a JSON string as the body of a POST request.",
        incoming_message_requirement: "For a simple message, your JSON string must contain a [b]text[/b] property. This is the text that will be posted to the binder.",
        incoming_message_sample: "A simple example:",
        crashlytics_tagline: "Powerful and lightweight crash analysis and reporting",
        crashlytics_summary: "Crashlytics provides powerful, yet light weight detailed crash reporting and real-time alerts for mobile devices. This integration will post a crash summary to a binder in Moxtra.",
        crashlytics_steps_to_add: "Here are the steps necessary to add the Crashlytics integration.",
        crashlytics_follow_the_url_instructions: "[url=http://support.crashlytics.com/knowledgebase/articles/102391-how-do-i-configure-a-custom-web-hook]Follow the instructions here[/url], and use {{webhook_url}} as the URL.",
        twitter_tagline: "Social networking and microblogging service",
        twitter_summary: 'Twitter is an online social networking service that enables users to send and read short 140-character messages called "tweets". This integration will allow you to post tweets to a binder that are sent to/from a Twitter account of your choice.',
        trello_tagline: "Project Management and To-do lists",
        trello_summary: "Trello is a collaborative task and project management service that uses Lists and Cards to organize your team's projects. Trello is the free, flexible, and visual way to organize anything with anyone. This integration will allow you to receive updates in a binder when activity occurs on Trello cards, lists and boards.",
        intercom_tagline: "User intelligence and customer communication",
        intercom_summary: "Intercom offers a central place for your business to see and talk to customers. You can have live conversations and send targeted messages to website visitors and users of your app. This integration will post activity about new user, new unsubscription, new tag on user and new conversation to a binder in Moxtra.",
        intercom_step1: "In Intercom, click on the gear icon in the top navigation and go to your [b]Integrations for My App[/b].",
        intercom_step2: "Click on [b]Webhooks[/b] in the left navigation, and then press the [b]Add Webhook Integration[/b] button to set it up.",
        intercom_step3_sub1: "Enter {{webhook_url}} and choose which notifications you want to see in Moxtra.  Currently, Moxtra supports the following notifications:",
        intercom_step3_sub2: "Press the [b]Add Integration[/b] button when you're done.",
        intercom_step3_sub3: "You can change your notification settings at any time by clicking [b]Edit[/b] in the Webhook Integration settings in Intercom.",
        intercom_step3_note1: "New Users",
        intercom_step3_note2: "New Unsubscription",
        intercom_step3_note3: "New Tag on User",
        intercom_step3_note4: "Reply to User",
        appsignal_tagline: "Monitoring Ruby on Rails apps",
        appsignal_summary: "AppSignal monitors apps built on Rails, Sinatra and Grape with support for Sidekiq, Delayed Job and Resque. This integration will post exception and performance notifications to a binder in Moxtra.",
        appsignal_step1: 'In your AppSignal account, go to the "[b]Integrations[/b]" tab on the sidebar.',
        appsignal_step2: "Fill out {{webhook_url}} in the  [b]Webhook url[/b] box. Press [b]Submit[/b] when you are done.",
        mailchimp_tagline: "Email marketing solution",
        mailchimp_summary: "Mailchimp allows you to manage contacts, send emails and track results. This integration will post notifications about new subscribers, new unsubscribers, profile updates, email address changes, subscriber list removal and campaign updates to a binder in Moxtra.",
        mailchimp_step1: "In your MailChimp account, navigate to your [b]Lists[/b] and choose the [b]Settings[/b] option.",
        mailchimp_step2: "On the Settings page, choose the [b]Webhooks[/b] option.",
        mailchimp_step3: "On the Webhooks page, click on [b]Create New Webhook[/b].",
        mailchimp_step4: "Enter {{webhook_url}} in the [b]Callback URL[/b] field, then select the events and event sources that you want sent to you. Remember to uncheck [b]via the API[/b] checkbox.",
        formstack_tagline: "Online form builder",
        formstack_summary: "Formstack is an online form building software packed with optimization features to help you capture and convert your marketing leads. This integration will post  your form data to a binder in Moxtra.",
        formstack_title: "In Formstack, webhooks are configured on a form-by-form basis.",
        formstack_step1: "From the Formstack dashboard, choose a Form that you want to integrate with Moxtra and click on the [b]Settings[/b] menu.",
        formstack_step2: "On the [b]Settings[/b] page, select the [b]Emails & Redirects[/b] tab on the left.",
        formstack_step3: "Scroll down to the [b]After the Form is Submitted[/b] section. Select the [b]Click here to change[/b] link. ",
        formstack_step4_sub1: "Once the dialog appears, select [b]Send data to an external URL (Webhook)[/b].",
        formstack_step4_sub2: "Enter {{webhook_url}} in the [b]Webhook URL[/b] field.",
        formstack_step4_sub3: "Click [b]Save[/b]",
        pivotaltracker_tagline: "Agile project management",
        pivotaltracker_summary: "Pivotal Tracker is a lightweight, agile project management tool for software teams. This integration will post notifications about added feature, added comment, edited feature, moved feature, started feature, finished feature, delivered feature, accepted feature and rejected feature to a binder in Moxtra.",
        pivotaltracker_step1: "In your Pivotal Tracker dashboard, choose the [b]Project[/b] and click on the [b]Settings[/b] icon  toward the top right of the sidebar.",
        pivotaltracker_step2: "On that page, under the [b]Integrations[/b] tab, find the [b]Activity Web Hook[/b] section.",
        pivotaltracker_step3: "Add {{webhook_url}} as your Web Hook URL. Ensure that the API Version is set to [b]v5[/b] and then click [b]Add[/b].",
        pivotaltracker_tips: "Tips: You can add multiple webhooks per project.",
        yo_tagline: "Zero character communication",
        yo_summary: "Yo is a single-tap, zero character communication tool for your mobile devices. This integration will post your Yo into a Moxtra binder.",
        yo_step1: "You will need a Yo API account for this integration. Go to [url=http://yoapi.justyo.co/]http://yoapi.justyo.co/[/url] and create your account.",
        yo_step2_sub1: "Select the account on the left bar and navigate to [b]Edit Profile[/b]. Scroll down to find the [b]Callback URL[/b] and fill in {{webhook_url}}. Hit [b]Update[/b] once you are done.",
        yo_step2_sub2: "When someone sends a Yo to your account, it will be posted to Moxtra.",
        paypal_tagline: "Send or receive money online",
        paypal_summary: "PayPal is an online payments system. This integration will post paypal transactions such as payments received, credit card authorizations, eCheck and recurring payments, chargebacks, disputes, reversals, and refunds to a binder in Moxtra.",
        paypal_note: "[b]Note: You will need a Paypal business account or a merchant account to set this up[/b].",
        paypal_step1: "In Paypal, click on [b]Profile & Settings[/b] on the [b]My Account[/b] tab.",
        paypal_step2: "On the [b]Profile & Settings[/b] page, click on [b]My selling tools[/b].",
        paypal_step3: "On this page, find [b]Instant payment notifications[/b] under [b]Getting paid and managing my risk[/b] tab  and click on [b]Update[/b].",
        paypal_step4: "On the [b]Instant Payment Notification (IPN)[/b] page, click on [b]Choose IPN Settings[/b].",
        paypal_step5_sub1: "On the [b]Edit IPN Settings[/b] page,",
        paypal_step5_sub2: "Fill in {{webhook_url}} in the [b]Notification URL[/b] box.",
        paypal_step5_sub3: "Click on [b]Receive IPN messages (Enabled)[/b].",
        paypal_step5_sub4: "Hit [b]Save[/b].",
        supportbee_tagline: "Manage customer support emails",
        supportbee_summary: "SupportBee is software that helps teams handle customer support emails.This integration will post notifications about new tickets created, new customer replies,  new agent replies amd new comments to a binder in Moxtra.",
        supportbee_step1: "In your SupportBee account, click on the [b]Admin[/b] tab on the top right corner of the main page. ",
        supportbee_step2: "In the [b]Admin[/b] page, choose [b]Web Hooks[/b] from the left hand side menu.",
        supportbee_step3: "Click on [b]Add New Web Hook[/b].",
        supportbee_step4_sub1: "Enter {{webhook_url}} in the [b]URL[/b] field.",
        supportbee_step4_sub2: "Press [b]Add Web Hook[/b] when you are done.",
        chargify_tagline: "Online billing software",
        chargify_summary: "Chargify is an online service and platform that automates billing for recurring revenue businesses. This integration will post chargify events such as subscription signups, renewals, payments, refunds, upgrades and billing changes to a binder in Moxtra.",
        chargify_step1: "In your Chargify dashboard, [b]Select a Site[/b] from the top menu. If you have already selected a site, skip to Step 2.",
        chargify_step2: "On the Site dashboard page, click on the [b]Settings[/b] tab.",
        chargify_step3: "Select [b]Webhooks[/b] from the left hand menu.",
        chargify_step4_sub1: "Check the [b]Send Webhooks to my Webhook URL(s)[/b] box.",
        chargify_step4_sub2: "Click on [b]Add URL[/b].",
        chargify_step4_sub3: "Fill out {{webhook_url}} in the box.",
        chargify_step4_sub4: "Press [b]Save[/b] when you are done.",
        olark_tagline: "Live help chat",
        olark_summary: "Olark is a tool for website hosts to chat with their website visitors using their existing instant messaging client. This integration will post an Olark chat transcript and offline messages to a binder in Moxtra.",
        olark_step1: "In your Olark Dashboard, navigate to the [b]Settings[/b] page.",
        olark_step2: "Click on [b]Integrations[/b] tab on the left.",
        olark_step3: "On the [b]Integrations[/b] page, click on [b]webhooks[/b].",
        olark_step4_sub1: "Enter {{webhook_url}} in the [b]Webhook url[/b] field.",
        olark_step4_sub2: "Choose which activities you want to see in Moxtra by selecting the checkboxes.",
        olark_step4_sub3: "Press the [b]Save[/b] button when you are done.",
        olark_step5: "Click the [b]Send Test[/b] button to check if the endpoint is configured properly.",
        olark_note: "[b]NOTE[/b]",
        olark_note1: "You can type [b]!lead[/b] after a conversation has ended to manually post your conversation into a Moxtra binder. ",
        olark_note2: "If a conversation continues after [b]!lead[/b] has been sent, Olark will do another POST to a Moxtra binder when the conversation finishes.",
        opbeat_tagline: "Extend your existing workflow",
        opbeat_summary: "Opbeat empowers developers to do great ops. Opbeat extends your existing workflow with an ops platform that works with your code and your team. This integration will post notifications about Opbeat events to a binder in Moxtra.",
        opbeat_step1: "In your Opbeat account, navigate to the [b]Settings[/b] for your company.",
        opbeat_step2_sub1: "In the [b]Settings[/b] page, scroll down to the HTTP Hook.",
        opbeat_step2_sub2: "Enter {{webhook_url}} in the [b]Hook Target[/b] box.",
        opbeat_step2_sub3: "Press [b]Save settings[/b] when you are done.",
        datadog_tagline: "Cloud monitoring",
        datadog_summary: "Datadog is a monitoring service that helps software developers and web operators understand and turn their IT data into actionable insight. This integration will post notifications to a binder in Moxtra when a metric alert is triggered in Datadog.",
        datadog_step1: "In your Datadog account, choose [b]Integrations[/b] from the [b]Integrations[/b] menu.",
        datadog_step2: "Find the Moxtra integration in the list and press the [b]Available[/b] button to configure it.",
        datadog_step3: "Switch to the [b]Configuration[/b] tab and add {{webhook_url}} as the [b]Moxtra Webhook URL[/b]. Press the [b]Install Integration[/b] button when you're done.",
        datadog_usage: "Usage",
        datadog_usage_desc: "To use the Datadog integration, simply add @moxtra when sharing a post or in the text of the metric alert you want to receive notifications from.",
        pagerduty_tagline: "On-call scheduling, alerting and incident tracking",
        pagerduty_summary: "PagerDuty is an operations performance platform delivering visibility and actionable intelligence across the entire incident lifecycle. This integration will post a message to a binder in Moxtra when an incident is triggered by your PagerDuty service.",
        pagerduty_step1_sub1: "In your PagerDuty account, if you already have an existing service that you want to integrate with Moxtra, navigate to the [b]Configuration[/b] tab and select [b]Services[/b] from the dropdown menu. You can choose to create a new service and then continue with integrating Moxtra.",
        pagerduty_step1_sub2: "Click on the service name to launch the service window.",
        pagerduty_step2: "In the service window, scroll down to [b]Webhooks[/b] and click on the [b]+ Add a webhook[/b] button.",
        pagerduty_step3_sub1: "Enter a name for your webhook (Moxtra) and add {{webhook_url}} in the [b]Endpoint URL[/b] box as follows:",
        pagerduty_step3_sub2: "Press [b]Save[/b] when you are done.",
        chargebee_tagline: "Online billing platform for subscription business",
        chargebee_summary: "ChargeBee is an online subscription and recurring billing management system for SaaS and web apps. This integration will post notifications to a binder in Moxtra about Chargebee payments, subscriptions and invoices.",
        chargebee_step1: "In your Chargebee site dashboard, navigate to the [b]Settings[/b] tab on the top.",
        chargebee_step2: "In the [b]Settings[/b] page, navigate to [b]API & WEBHOOKS[/b]. Click on [b]Webhook Settings[/b].",
        chargebee_step3: "Enter {{webhook_url}} in the [b]Webhook URL[/b] box.",
        raygun_tagline: "Automatic error reporting",
        raygun_summary: "Raygun is an error and crash reporting tool that helps developers discover and resolve software bugs. This integration will post error messages to a binder in Moxtra when an error is detected by Raygun.",
        raygun_step1: "In your Raygun application, click on [b]Application Settings[/b] in the left navigation and choose [b]Integrations[/b] from the sub-options.",
        raygun_step2: "On the [b]Integrations[/b] page, click on the [b]Webhook[/b] button.",
        raygun_step3_sub1: "In the [b]Setup[/b] tab, add {{webhook_url}} in the [b]Url[/b] box. Enable this integration.",
        raygun_step3_sub2: "Press [b]Save Changes[/b] when you are done.",
        postmark_tagline: "Transactional email delivery for web apps",
        postmark_summary: "Postmark removes the headaches of delivering and parsing transactional email for webapps with minimal setup time and zero maintenance. This integration will post notifications when an email bounces or a sent email is opened to a binder in Moxtra.",
        postmark_step1: "In your Postmark account, select the server and navigate to the [b]Settings[/b] tab.",
        postmark_step2_sub1: "In the [b]Settings[/b] page, click on the [b]Outbound[/b] tab.",
        postmark_step2_sub2: "Enter {{webhook_url}} in the [b]Bounce webhook[/b] and [b]Opens webhook[/b] box.",
        postmark_step2_sub3: "Press [b]Save changes[/b] when you are done.",
        stripe_tagline: "Web and mobile payments",
        stripe_summary: "Stripe provides a set of unified APIs and tools that instantly enable businesses and private individuals to accept and manage online payments. This integration will post notifications related to invoices, charges, transfers and customers to a binder in Moxtra.",
        stripe_step1: "In your Stripe dashboard, go to your [b]Account[/b] dropdown menu and choose [b]Account Settings[/b].",
        stripe_step2: "On the Settings page, select the [b]Webhooks[/b] tab. Click on the [b]Add endpoint[/b] button.",
        stripe_step3_sub1: "Paste {{webhook_url}} in the [b]URL[/b] field. Choose the [b]Live Mode[/b].	Choose [b]Select events[/b].",
        stripe_step3_sub2: "Currently, Moxtra supports the following events:",
        stripe_step3_event1: "Charge related",
        stripe_step3_event2: "Invoice related",
        stripe_step3_event3: "Transfer related",
        stripe_step3_event4: "Customer related",
        stripe_step3_sub3: "Press [b]Create endpoint[/b] once you’re done.",
        netlify_tagline: "Premium hosting services for modern static websites",
        netlify_summary: "Netlify builds, deploys and host static websites and apps. This integration will post notifications about deployment success or failure, builds and form submissions to a binder in Moxtra.",
        netlify_step1: "In your Netlify dashboard, navigate to an existing site or create a [b]New Site[/b]. On your site dashboard, navigate to the [b]Notifications[/b] tab.",
        netlify_step2: "On the [b]Notifications[/b] page, click [b]Edit[/b] for the event that you would like notifications.",
        netlify_step3: "Under [b]Configure a new deploy notification[/b] dropdown, click on [b]webhook[/b].",
        netlify_step4_sub1: "Enter {{webhook_url}} in the [b]URL to notify[/b] box.",
        netlify_step4_sub2: "Press [b]Save[/b] button when you’re done.",
        fulcrum_tagline: "Mobile data collection and visualization",
        fulcrum_summary: "Fulcrum is a mobile data collection platform that allows users to easily create and deploy mobile survey forms. This integration will post notifications about Fulcrum events to a binder in Moxtra.",
        fulcrum_step1_sub1: "From the Fulcrum dashboard, click on the gear icon in the upper right corner of the page. Click [b]Settings[/b].",
        fulcrum_step1_sub2: "If you want to change the organization, click the name of the organization from the left menu.",
        fulcrum_step2: "On the [b]Settings[/b] page, select the [b]API Webhooks[/b] from the left navigation.",
        fulcrum_step3: "Click on [b]Add Webhook[/b].",
        fulcrum_step4_sub1: "Fill out the [b]Name[/b] of the Webhook as [b]Moxtra[/b]. Add {{webhook_url}} in the [b]URL[/b] box. Ensure that the [b]Active?[/b] box is checked.",
        fulcrum_step4_sub2: "Press [b]Save Webhook[/b] when you are done.",
        opsgenie_tagline: "Mobile IT monitoring tool for alerts",
        opsgenie_summary: "OpsGenie is a cloud based service that enables operations teams to manage alerts via mobile apps, email and SMS. This integration will post a message to a binder in Moxtra when an alert is triggered by your OpsGenie service.",
        opsgenie_step1: "In your OpsGenie account, click the [b]Integrations[/b] tab on the left navigation. Search for [b]Moxtra[/b] and [b]Add[/b].",
        opsgenie_step2_sub1: "Copy {{webhook_url}} in the [b]URL[/b] box.",
        opsgenie_step2_sub2: "Press [b]Save Integration[/b] when you are done.",
        librato_tagline: "Real-time cloud monitoring",
        librato_summary: "Librato is a service for storage, visualization, alerting and real-time operations analytics for monitoring data. This integration will post a message to a binder in Moxtra when an alert is triggered by Librato.",
        librato_step1: "In your Librato account, click on [b]account settings[/b] from the menu in the top navigation.",
        librato_step2: "Press the [b]Services[/b] icon on the left bar, and then choose [b]Webhook[/b] from the list of services.",
        librato_step3: "In the middle column, press the [b]+[/b] button to configure a new service.",
        librato_step4: "On this page, give your service a title, Moxtra and add {{webhook_url}} as the [b]Url[/b]. Press the [b]create service[/b] button.",
        librato_step5: "Click on [b]Alerts[/b] in the top navigation, and then [b]create new alert[/b] or [b]edit[/b] an existing alert.",
        librato_step6_sub1: "In the [b]Alerts[/b] window, scroll down to the [b]Notification Services[/b] tab and choose [b]Webhook[/b]. Select the [b]Moxtra[/b] service that you configured in [b]Step 3[/b] above. ",
        librato_step6_sub2: "Press [b]create[/b] button at the top when you’re done.",
        bitbucket_tagline: "Web-based hosting for projects",
        bitbucket_summary: "Bitbucket is a Git and Mercurial based source code management and collaboration solution in the cloud. This integration will post notifications about commits, pull requests and activity on Bitbucket issues to a binder in Moxtra.",
        bitbucket_step1: "In your Bitbucket repository, navigate to Settings. Scroll down to [b]INTEGRATIONS[/b] in the left navigation and click on [b]Webhooks[/b].",
        bitbucket_step2: "On this page, click on [b]Add Webhook[/b].",
        bitbucket_step3_sub1: "Enter a [b]Title[/b] and add {{webhook_url}} in the [b]URL[/b] box.  Choose the triggers that you want to push into Moxtra. ",
        bitbucket_step3_sub2: "Press [b]Save[/b] when you are done.",
        integrations: "Integrations",
        action: "Action",
        configured: "Configured",
        description: "Description",
        step: "Step",
        check_available_zaps: "Check available Zaps",
        post_action_from_service: "{{postAction}} from {{serviceName}}",
        post_action_to_binder: "{{postAction}} to {{binderName}}",
        created_by_actor_on_date: "Created by {{actor}} on {{date}}",
        service_integrations_summary: "Make your team's collaboration and communication experience better by integrating with tools that you use outside of Moxtra. These integrations will let you automatically pull information in a timely, relevant and searchable way into Moxtra. You will be able to see everything that your team is doing, making you more productive!",
        setup_instructions: "Setup Instructions",
        webhook_url: "Webhook URL",
        post_to_binder: "Post to Binder",
        select_binder: "Select Binder",
        optional_description: "Optional description",
        create_integration: "Create Integration",
        create_service_integration_success: "Integration created",
        create_service_integration_failed: "Unable to create this integration. Please try again.",
        delete_service_integration_confirm: "Are you sure you want to delete this integration?",
        delete_service_integration_success: "Integration deleted",
        delete_service_integration_failed: "Unable to delete this integration. Please try again.",
        update_service_integration_success: "Integration updated",
        new_post_to_binder_note: "Select a binder where notifications will be posted.",
        new_post_as_action_note: "Select an event type where notifications will be posted.",
        new_integration_description_note: "Additional information regarding this integration.",
        view_post_to_binder_note: "Notifications that come in will be posted to this binder.",
        view_post_as_action_note: "Notifications that come in will be posted as this event type.",
        view_integration_description_note: "Notes to provide you additional context regarding this integration.",
        view_webhook_url_note: "When setting up this integration, this is the URL that you will paste into {{service}}.",
        post_as_chat: "Post as Chat",
        post_as_page: "Post as Page",
        post_as_todo: "Post as Todo",
        add_a_service_integrations: "Add an integration",
        add_a_new_service_integration: "Add a new {{service}} integration",
        follow_steps_to_add_integration: "Follow these steps to add the {{service}} integration.",
        service_integrations_feedback_note: "Don’t see a third-party service that you would like integrated with Moxtra?",
        service_integrations_feedback_action: "Just [b]let us know[/b] and we will add it to our integration list!",
        authed_integration: "This is an authed integration and we will manage the settings for you.",
        service_customize_name: "Customize Name",
        service_customize_name_note: "The name this integration will post as.",
        service_customize_icon: "Customize Icon",
        service_customize_icon_note: "Icon that is used for this integration.",
        service_customize_template: "Customize Template",
        service_customize_todo_name_template: "Customize Todo Name Template",
        service_customize_todo_desc_template: "Customize Todo Description Template",
        service_customize_chat_text_template: "Text Format",
        service_customize_chat_bbcode_template: "BBCode Format",
        service_customize_chat_bbcode_template_warning: "BBCode format requires Text format.",
        service_customize_template_chat_note: "For chat, we support BBCode and Text format.",
        service_customize_template_page_note: "For page, we support HTML format.",
        service_customize_template_todo_note: "For todo, we support Text format.",
        service_customize_template_sample: "Here is a sample template.",
        profile: "Profile",
        notification: "Notification",
        settings_change_photo: "Change Photo",
        settings_upload_photo: "Upload Photo",
        settings_remove_photo: "Remove Photo",
        settings_account_type: "Account Type",
        settings_send_feedback: "Send Feedback",
        settings_invalid_phone_number: "Invalid phone number",
        settings_free_edition: "Free Edition",
        settings_change_email: "Change Email",
        settings_new_email: "New Email",
        settings_verify_email: "Verify Email",
        settings_daily_digest_email: "Daily Digest Email",
        settings_please_enter_your_new_email: "Please enter your new email address",
        settings_buy_now: "Buy Now",
        settings_remove_photo_confirm: "Do you want to remove this photo?",
        settings_remove_photo_succeed: "Photo removed",
        settings_remove_photo_failed: "Unable to remove photo",
        settings_please_enter_correct_password: "Please enter correct password",
        read_faq: "Read the FAQ.",
        get_moxtra_desktop: "Get Moxtra Desktop",
        improve_productive: " - Powerful way to collaborate with your team from your desktop.",
        change_email_success: "Email changed",
        change_email_failed: "Unable to change email",
        change_email_conflict: "Unable to change email. The email address you have entered is already registered.",
        change_password_success: "Password changed",
        change_password_failed: "Unable to change password",
        send_feedback_success: "Feedback sent",
        send_feedback_failed: "Unable to send feedback, please try again.",
        send_feedback_hint: "Your feedback here...",
        update_profile_success: "Profile updated",
        update_profile_failed: "Unable to update profile",
        set_password_success: "Password set successfully",
        set_password_failed: "Unable to set password",
        common_label_setpass_title_part1: "Moxtra email address and password are",
        common_label_setpass_title_part2: "required to use Moxtra Mobile app",
        common_label_setpass_email_address: "Your Moxtra email address:",
        common_set_password: "Set Moxtra Password",
        set_moxtra_password: "1. Set a Moxtra password. You will need this to login from Moxtra Mobile App",
        download_moxtra_for_mobile: "2. Download Moxtra for your mobile device",
        open_and_login_mobile_app: "3. Open Moxtra app on your mobile device, and login with Moxtra email address and password, and Go Mobile!",
        admin_label_invitation_to_join: "Invitation to join",
        cap_storage_usage_used_up_alert: "You have used [b][color=red]{{percent}}[/color][/b] of {{maxSize}} storage.",
        cap_meet_duration_expried_alert: "This Meet will end in [b][color=red]{{remaining}}[/color][/b].",
        cap_meet_duration_max_alert: "Meet can last up to {{maxDuration}}. Upgrade to host longer Meets.",
        cap_meet_users_exceed_alert: "Exceeded maximum number of participants allowed in a Meet.",
        cap_chat_max_history_alert: "You can only view messages exchanged during the last {{maxHistory}}. Upgrade to view all messages.",
        share_pages_title: "Share Pages",
        share_a_page_title: "Share Page",
        share_a_resource_title: "Share File",
        share_email_link: "Email Link",
        share_copy_link: "Copy Link",
        share_binder_link: "Binder Link",
        share_page_link: "Page Link",
        pdf_with_annotation: "PDF with Annotation",
        share_flattened_pdf_tooltip: "Use this option to download a copy of the flattened document with annotation.",
        share_original_content: "Original Content",
        share_original_content_tooltip: "Use this option to download a copy of the content in original format, without annotations.",
        share_binder_has_no_pages: "This binder has no pages.",
        share_with_colon: "Share with:",
        message_colon: "Message:",
        send_view_only_link: "Send view only link of this binder page(s):",
        share_binder_pages_with_you: "I'd like to share Binder page(s) with you.",
        to_do: "To-Do",
        add_to_do_item: "Add a To-Do item...",
        delete_to_do_confirm: "Do you want to delete this to-do item?",
        delete_todo_success: "To-Do deleted",
        delete_todo_failed: "Unable to delete the to-do item. Please try again.",
        todo_created_date: "Created by {{name}}, {{date}}",
        add_attachments_success: "Attachments added",
        add_attachment_success: "Attachment added",
        add_attachments_failed: "Unable to add attachments. Please try again.",
        add_attachment_failed: "Unable to add attachment. Please try again.",
        assign_todo_failed: "Unable to assign a to-do item. Please try again.",
        set_due_date_failed: "Unable to set a due date. Please try again.",
        set_remind_date_failed: "Unable to set a reminder. Please try again.",
        update_todo_title_failed: "Unable to update this to-do item. Please try again.",
        confirm_remove_attachment: "Do you want to delete this attachment?",
        remove_attachment_failed: "Unable to remove attachment. Please try again.",
        todo_completed_title: "Completed ({{count}})",
        toggle_todo: "Toggle To-Do",
        due: "Due {{date}}",
        remove_comment_failed: "Unable to remove the comment. Please try again.",
        update_comment_failed: "Unable to update the comment. Please try again.",
        all_todos: "All To-Dos",
        my_todos: "My To-Dos",
        unassigned_todos: "Unassigned To-Dos",
        open_todos: "Open To-Dos",
        search_todo: "Search To-Do",
        assigned_to_me: "Assigned to me",
        binder_copy_a_todo_to: "Copy To-Do to",
        binder_copy_todos_to: "Copy To-Dos to",
        binder_move_a_todo_to: "Move To-Do to",
        binder_move_todos_to: "Move To-Dos to",
        binder_copy_todo_success: "To-Do copied",
        binder_copy_todos_success: "To-Dos copied",
        binder_copy_todo_fail: "Unable to copy to-do. Please try again.",
        binder_move_todo_success: "To-Do moved",
        binder_move_todos_success: "To-Dos moved",
        binder_move_todo_fail: "Unable to move to-do. Please try again.",
        create_todo: "Create To-Do",
        create_todo_success: "To-Do created",
        create_todo_fail: "Unable to create to-do. Please try again.",
        add_todo_description: "Add description...",
        todo_empty_headline: "Manage tasks",
        todo_empty_subtitle: "Create, organize and assign To-Dos to your team and keep them in a binder, so everything is actionable and transparent. Make it super easy to get tasks done with your team.",
        flag_important: "Mark important",
        flag_important_remove: "Remove important flag",
        sort_by_priority: "Sort by Priority",
        sort_by_assignee: "Sort by Assignee",
        sort_by_due_date: "Sort by Due Date",
        sort_by_alphabetically: "Sort Alphabetically",
        sort_todo: "Sort To-Do",
        one_activity: "1 activity",
        many_activities: "{{count}} activities",
        activities_capitalize: "Activities",
        email_is_required: "Please enter an email address",
        email_format_error: "Invalid email address",
        first_name_is_required: "Please enter your first name",
        password_is_required: "Please enter your password",
        password_min_characters_required: "Mininum 6 characters required",
        password_confirm: "Passwords do not match",
        comment_is_required: "Please enter your comment",
        name_is_required: "Please enter a name",
        zoom_in: "Zoom In",
        zoom_out: "Zoom Out",
        fullscreen: "Fullscreen",
        next_page: "Next Page",
        prev_page: "Prev Page",
        tool_select: "Select",
        tool_draw: "Draw",
        tool_highlighter: "Highlighter",
        tool_shape: "Shape",
        tool_arrow: "Arrow",
        tool_shape_rectangle: "Rectangle",
        tool_shape_circle: "Circle",
        tool_shape_ellipse: "Ellipse",
        tool_shape_line: "Line",
        tool_shape_triangle: "Triangle",
        tool_text: "Add Text",
        tool_image: "Add Image",
        tool_laserpointer: "Laser Pointer",
        tool_eraser: "Eraser",
        tool_redo: "Redo",
        tool_undo: "Undo",
        please_enter_page_title: "Please enter a title for this page",
        rename_page_title_success: "Title updated",
        rename_page_title_failed: "Unable to update the title. Please try again.",
        update_comment_success: "Comment updated",
        update_comment_failed: "Unable to update comment",
        delete_comment_success: "Comment deleted",
        delete_comment_failed: "Unable to delete comment",
        post_comment_failed: "Unable to post comment. Please try again later.",
        confirm_delete_comment: "Are you sure you want to delete this comment?",
        page_index_bracket: "Page {0}",
        webdoc_locked_by_self: "You were editing this note from another device. Any un-saved changes you have made to this note on your other device will be lost if you start editing this note here. Do you want to continue?",
        webdoc_locked: "This note is locked. {{username}} is editing the note.",
        press_esc_to_close: "Press Esc to close",
        preview_not_available: "Preview not available"
    },
    da: !1,
    de: !1,
    es: !0,
    fi: !1,
    fr: !0,
    id: !1,
    it: !1,
    ja: !0,
    ko: !1,
    nl: !1,
    pt: !0,
    ru: !1,
    sv: !1,
    th: !1,
    tr: !1,
    vi: !1,
    zh: !0,
    "zh-tw": !0
}), define("lang", [ "moxtra", "i18n!nls/lang" ], function() {
    var a = MX.lang || {}, b = Array.prototype.slice.call(arguments, 1);
    MX.each(b, function(b) {
        MX.extend(a, b);
    });
    var c = MX.storage("integration", "sessionStorage"), d = c.get("extension"), e = c.get("client_id");
    if (d) try {
        d = JSON.parse(0 === d.indexOf("{") ? d : decodeURIComponent(d));
    } catch (f) {
        logger.error(f);
    }
    if (d && d.i18n_file && d.i18n_file.use === !0 && e) try {
        var g = "i18n!customize/" + e + "/nls/lang";
        require([ g ], function(b) {
            MX.extend(a, b);
        });
    } catch (f) {}
    return a;
}), define("text", [ "module" ], function(a) {
    "use strict";
    var b, c, d, e, f, g = [ "Msxml2.XMLHTTP", "Microsoft.XMLHTTP", "Msxml2.XMLHTTP.4.0" ], h = /^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im, i = /<body[^>]*>\s*([\s\S]+)\s*<\/body>/im, j = "undefined" != typeof location && location.href, k = j && location.protocol && location.protocol.replace(/\:/, ""), l = j && location.hostname, m = j && (location.port || void 0), n = {}, o = a.config && a.config() || {};
    return b = {
        version: "2.0.12",
        strip: function(a) {
            if (a) {
                a = a.replace(h, "");
                var b = a.match(i);
                b && (a = b[1]);
            } else a = "";
            return a;
        },
        jsEscape: function(a) {
            return a.replace(/(['\\])/g, "\\$1").replace(/[\f]/g, "\\f").replace(/[\b]/g, "\\b").replace(/[\n]/g, "\\n").replace(/[\t]/g, "\\t").replace(/[\r]/g, "\\r").replace(/[\u2028]/g, "\\u2028").replace(/[\u2029]/g, "\\u2029");
        },
        createXhr: o.createXhr || function() {
            var a, b, c;
            if ("undefined" != typeof XMLHttpRequest) return new XMLHttpRequest();
            if ("undefined" != typeof ActiveXObject) for (b = 0; 3 > b; b += 1) {
                c = g[b];
                try {
                    a = new ActiveXObject(c);
                } catch (d) {}
                if (a) {
                    g = [ c ];
                    break;
                }
            }
            return a;
        },
        parseName: function(a) {
            var b, c, d, e = !1, f = a.indexOf("."), g = 0 === a.indexOf("./") || 0 === a.indexOf("../");
            return -1 !== f && (!g || f > 1) ? (b = a.substring(0, f), c = a.substring(f + 1, a.length)) : b = a, 
            d = c || b, f = d.indexOf("!"), -1 !== f && (e = "strip" === d.substring(f + 1), 
            d = d.substring(0, f), c ? c = d : b = d), {
                moduleName: b,
                ext: c,
                strip: e
            };
        },
        xdRegExp: /^((\w+)\:)?\/\/([^\/\\]+)/,
        useXhr: function(a, c, d, e) {
            var f, g, h, i = b.xdRegExp.exec(a);
            return i ? (f = i[2], g = i[3], g = g.split(":"), h = g[1], g = g[0], !(f && f !== c || g && g.toLowerCase() !== d.toLowerCase() || (h || g) && h !== e)) : !0;
        },
        finishLoad: function(a, c, d, e) {
            d = c ? b.strip(d) : d, o.isBuild && (n[a] = d), e(d);
        },
        load: function(a, c, d, e) {
            if (e && e.isBuild && !e.inlineText) return void d();
            o.isBuild = e && e.isBuild;
            var f = b.parseName(a), g = f.moduleName + (f.ext ? "." + f.ext : ""), h = c.toUrl(g), i = o.useXhr || b.useXhr;
            return 0 === h.indexOf("empty:") ? void d() : void (!j || i(h, k, l, m) ? b.get(h, function(c) {
                b.finishLoad(a, f.strip, c, d);
            }, function(a) {
                d.error && d.error(a);
            }) : c([ g ], function(a) {
                b.finishLoad(f.moduleName + "." + f.ext, f.strip, a, d);
            }));
        },
        write: function(a, c, d) {
            if (n.hasOwnProperty(c)) {
                var e = b.jsEscape(n[c]);
                d.asModule(a + "!" + c, "define(function () { return '" + e + "';});\n");
            }
        },
        writeFile: function(a, c, d, e, f) {
            var g = b.parseName(c), h = g.ext ? "." + g.ext : "", i = g.moduleName + h, j = d.toUrl(g.moduleName + h) + ".js";
            b.load(i, d, function() {
                var c = function(a) {
                    return e(j, a);
                };
                c.asModule = function(a, b) {
                    return e.asModule(a, j, b);
                }, b.write(a, i, c, f);
            }, f);
        }
    }, "node" === o.env || !o.env && "undefined" != typeof process && process.versions && process.versions.node && !process.versions["node-webkit"] ? (c = require.nodeRequire("fs"), 
    b.get = function(a, b, d) {
        try {
            var e = c.readFileSync(a, "utf8");
            0 === e.indexOf("﻿") && (e = e.substring(1)), b(e);
        } catch (f) {
            d && d(f);
        }
    }) : "xhr" === o.env || !o.env && b.createXhr() ? b.get = function(a, c, d, e) {
        var f, g = b.createXhr();
        if (g.open("GET", a, !0), e) for (f in e) e.hasOwnProperty(f) && g.setRequestHeader(f.toLowerCase(), e[f]);
        o.onXhr && o.onXhr(g, a), g.onreadystatechange = function() {
            var b, e;
            4 === g.readyState && (b = g.status || 0, b > 399 && 600 > b ? (e = new Error(a + " HTTP status: " + b), 
            e.xhr = g, d && d(e)) : c(g.responseText), o.onXhrComplete && o.onXhrComplete(g, a));
        }, g.send(null);
    } : "rhino" === o.env || !o.env && "undefined" != typeof Packages && "undefined" != typeof java ? b.get = function(a, b) {
        var c, d, e = "utf-8", f = new java.io.File(a), g = java.lang.System.getProperty("line.separator"), h = new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(f), e)), i = "";
        try {
            for (c = new java.lang.StringBuffer(), d = h.readLine(), d && d.length() && 65279 === d.charAt(0) && (d = d.substring(1)), 
            null !== d && c.append(d); null !== (d = h.readLine()); ) c.append(g), c.append(d);
            i = String(c.toString());
        } finally {
            h.close();
        }
        b(i);
    } : ("xpconnect" === o.env || !o.env && "undefined" != typeof Components && Components.classes && Components.interfaces) && (d = Components.classes, 
    e = Components.interfaces, Components.utils["import"]("resource://gre/modules/FileUtils.jsm"), 
    f = "@mozilla.org/windows-registry-key;1" in d, b.get = function(a, b) {
        var c, g, h, i = {};
        f && (a = a.replace(/\//g, "\\")), h = new FileUtils.File(a);
        try {
            c = d["@mozilla.org/network/file-input-stream;1"].createInstance(e.nsIFileInputStream), 
            c.init(h, 1, 0, !1), g = d["@mozilla.org/intl/converter-input-stream;1"].createInstance(e.nsIConverterInputStream), 
            g.init(c, "utf-8", c.available(), e.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER), 
            g.readString(c.available(), i), g.close(), c.close(), b(i.value);
        } catch (j) {
            throw new Error((h && h.path || "") + ": " + j);
        }
    }), b;
}), define("text!template/layout/guestLayout.html", [], function() {
    return '<div class="mx-scroll"><div class=" outer-container">\n    <header>\n        <!--a href="javascript:;" class="micon-moxtra"></a-->\n    </header>\n    <section class="">\n		<div id="fb-root"></div>\n        <div class="row">\n            <div class="" id="mxPageBody">\n\n            </div>\n        </div>\n\n    </section>\n</div>\n</div>\n';
}), define("layout/guestLayout", [ "moxtra", "lang", "text!template/layout/guestLayout.html" ], function(a, b, c) {
    "use strict";
    return a.Controller.extend({
        template: c,
        init: function(a) {
            this.$scope.lang = b;
            var c = this;
            this.opts = a, this.add(function() {
                c.currView && c.currView.destroy();
            }), $(a.renderTo).empty();
        },
        rendered: function() {
            this.container = this.$("#mxPageBody");
        },
        verify: function() {},
        setMainPage: function(a, b, c, d, e) {
            var f = this.req;
            this.currView && f && f.module === b ? this.opts.request.update(b, c, d, e) : (this.currView && this.currView.destroy(), 
            this.opts.request.update(b, c, d, e), this.currView = new a({
                name: c,
                renderTo: this.container
            })), this.req = this.opts.request.toJSON();
        }
    });
}), define("text!template/layout/loginLayout.html", [], function() {
    return '<header class="main-header mx-branding-header">\n\n    <a class="mx-branding-header-logo mx-logo pull-left" target="_blank"></a>\n    {{#if showBeta}}\n    <!-- this is for non-production env, so hardcode and inline styles -->\n    <div style="color: whitesmoke;margin-top: 14px;" class="header-beta pull-left">&nbsp;Beta</div>\n    {{/if}}\n    <div class="heard-search pull-right"></div>\n    <div class="header-social pull-right"></div>\n\n    <div class="header-wrap">\n        <div class="adminTitle"></div>\n    </div>\n</header>\n<section  class=" content">\n    <nav class="">\n        <ul>\n\n            <li>\n                <a href="#/timeline" class="active"> <i class="micon-list"></i>\n                    <span>{{modules.timeline}}</span>\n                    <span class="badge badge-timeline">0</span>\n                </a>\n            </li>\n            <li>\n                <a href="#/binder" > <i class="micon-binder"></i>\n                    <span>{{modules.binder}}</span>\n                </a>\n            </li>\n            {{!-- v2.9.0, remove Business Library\n            <li>\n                <a class=\'hide\' id="bizlib" href="#/library">\n                    <i class="micon-library"></i>\n                    <span>{{modules.bizlib}}</span>\n                    <span class="badge bgRed badge-bizlib">&nbsp;</span>\n                </a>\n            </li>\n            --}}\n            <!-- <li class="mx-branding-nav-todo" id="navTodo">\n            <a href="#/todo" >\n                <i class="micon-todo-empty"></i>\n                <span>{{modules.todo}}</span>\n            </a>\n        </li>\n        -->\n        <li>\n            <a href="#/meetintro" >\n                <i class="micon-calendar"></i>\n                <span>{{modules.meetintro}}</span>\n            </a>\n        </li>\n\n        <li>\n            <a href="#/contacts" >\n                <i class="micon-users-empty"></i>\n                <span>{{modules.contacts}}</span>\n            </a>\n        </li>\n        <li>\n            <a href="#/integrations" >\n                <i class="micon-integration"></i>\n                <span>{{modules.integrations}}</span>\n            </a>\n        </li>\n        <li>\n            <a href="#/settings" title="{{userName}}" data-placement="right">\n                <img class="nav-user-cover img-circle" src="{{avatar}}">\n                <span>{{modules.settings}}</span>\n            </a>\n        </li>\n        <li class=\'hide\' id="navAdmin">\n            <a href="#/admin">\n                <i class="micon-user-settings"></i>\n                <span>{{modules.admin}}</span>\n            </a>\n        </li>\n    </ul>\n\n</nav>\n<article  class="flexbox" id="mxPageBody"></article>\n\n</section>\n';
}), define("const", [], function() {
    "use strict";
    return {
        feed: {
            INVALID: "FEED_INVALID",
            RELATIONSHIP_JOIN: "FEED_RELATIONSHIP_JOIN",
            RELATIONSHIP_LEAVE: "FEED_RELATIONSHIP_LEAVE",
            RELATIONSHIP_INVITE: "FEED_RELATIONSHIP_INVITE",
            RELATIONSHIP_DECLINE: "FEED_RELATIONSHIP_DECLINE",
            RELATIONSHIP_CANCEL: "FEED_RELATIONSHIP_CANCEL",
            RELATIONSHIP_REMOVE: "FEED_RELATIONSHIP_REMOVE",
            RELATIONSHIP_CHANGE_ROLE: "FEED_RELATIONSHIP_CHANGE_ROLE",
            EMAIL_RECEIVE: "FEED_EMAIL_RECEIVE",
            TODO_CREATE: "FEED_TODO_CREATE",
            TODO_UPDATE: "FEED_TODO_UPDATE",
            TODO_DELETE: "FEED_TODO_DELETE",
            TODO_ASSIGN: "FEED_TODO_ASSIGN",
            TODO_COMMENT: "FEED_TODO_COMMENT",
            TODO_ATTACHMENT: "FEED_TODO_ATTACHMENT",
            TODO_DUE_DATE: "FEED_TODO_DUE_DATE",
            TODO_COMPLETE: "FEED_TODO_COMPLETE",
            TODO_REOPEN: "FEED_TODO_REOPEN",
            TODO_DUE_DATE_ARRIVE: "FEED_TODO_DUE_DATE_ARRIVE",
            BOARD_CREATE: "FEED_BOARD_CREATE",
            BOARD_NAME_CHANGE: "FEED_BOARD_NAME_CHANGE",
            BOARD_COMMENT: "FEED_BOARD_COMMENT",
            PAGES_CREATE: "FEED_PAGES_CREATE",
            PAGES_CREATE_WITH_ANNOTATION: "FEED_PAGES_CREATE_WITH_ANNOTATION",
            PAGES_ANNOTATION: "FEED_PAGES_ANNOTATION",
            PAGES_VIEW: "FEED_PAGES_VIEW",
            PAGES_DELETE: "FEED_PAGES_DELETE",
            PAGES_COMMENT: "FEED_PAGES_COMMENT",
            PAGES_UPLOAD: "PAGES_UPLOAD"
        },
        keys: {
            Enter: 13,
            Delete: 46,
            Shift: 16,
            Left: 37,
            Up: 38,
            Right: 39,
            Down: 40,
            Control: 17,
            BackSpace: 8,
            Escape: 27,
            Alt: 18,
            Space: 32,
            Comma: 188,
            Semicolon: 186
        },
        chat: {
            modelType: {
                Text: 1,
                Audio: 2,
                PageAudio: 3,
                PageVideo: 4,
                Picture: 5,
                File: 6,
                SysInfo: 7,
                Progress: 8,
                Resource: 9,
                PageComment: 10
            }
        },
        roleContext: {
            meet: "meet",
            note: "note",
            "public": "public",
            binder: "binder",
            annotate: "annotate"
        },
        binder: {
            role: {
                Editor: "BOARD_READ_WRITE",
                Viewer: "BOARD_READ",
                Owner: "BOARD_OWNER",
                Host: "LOCAL_HOST",
                Attendee: "LOCAL_ATTENDEE",
                Presenter: "LOCAL_PRESENTER",
                PublicViewer: "LOCAL_PUBLIC_VIEWER"
            },
            pageType: {
                whiteboard: "PAGE_TYPE_WHITEBOARD",
                video: "PAGE_TYPE_VIDEO",
                audio: "PAGE_TYPE_AUDIO",
                image: "PAGE_TYPE_IMAGE",
                web: "PAGE_TYPE_WEB",
                pdf: "PAGE_TYPE_PDF",
                url: "PAGE_TYPE_URL",
                note: "PAGE_TYPE_NOTE",
                ds: "PAGE_TYPE_DESKTOPSHARE",
                any: "PAGE_TYPE_ANY"
            },
            status: {
                invite: "BOARD_INVITED",
                member: "BOARD_MEMBER"
            },
            resourceStatus: {
                queued: "BOARD_RESOURCE_STATUS_QUEUED",
                converting: "BOARD_RESOURCE_STATUS_CONVERTING",
                converted: "BOARD_RESOURCE_STATUS_CONVERTED",
                failed: "BOARD_RESOURCE_STATUS_CONVERT_FAILED"
            },
            group: {
                colors: [ "004499", "425a00", "660000", "640064", "7b5200" ]
            }
        },
        defaults: {
            blankImg: "data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",
            binder: {
                thumbnail: "themes/images/binder/default_cover_web.1851fc29.png",
                thumbnail_small: "themes/images/default/default_binder_cover.1653bb1c.png",
                thumbnail_page: "themes/images/default/thumbnail_file.7459e474.jpg",
                thumbnail_whiteboard: "themes/images/default/thumbnail_whiteboard.b78843eb.jpg",
                thumbnail_file: "themes/images/file.8677dec6.png",
                thumbnail_note: "themes/images/watermark.a6aaa52d.png",
                thumbnail_empty_page: "themes/images/file-upload.f9ce704e.png",
                thumbnail_empty_todo: "themes/images/empty-icon-todos.42328c2c.png"
            },
            user: {
                avatar: "themes/images/default/avatar-single-360.ceef0e51.png"
            },
            source: {
                unknown: "themes/images/default/avatar_document-320.jpg"
            },
            group: {
                avatar: "themes/images/default/avatar-team-300.0cd712e5.png"
            },
            directory: {
                avatar: "themes/images/default/avatar-directory-100.3a4ee4da.png"
            },
            notification: {
                icon: "themes/images/binder/default_cover_small.348bb061.gif"
            }
        },
        group: {
            integrationType: {
                salesforce: "GROUP_INTEGRATION_SALESFORCE",
                saml: "GROUP_INTEGRATION_SAML"
            },
            status: {
                trial: "GROUP_TRIAL_SUBSCRIPTION",
                normal: "GROUP_NORMAL_SUBSCRIPTION",
                canceled: "GROUP_CANCELED_SUBSCRIPTION",
                expired: "GROUP_EXPIRED_SUBSCRIPTION"
            },
            userRole: {
                member: "GROUP_MEMBER_ACCESS",
                admin: "GROUP_ADMIN_ACCESS",
                owner: "GROUP_OWNER_ACCESS"
            },
            userStatus: {
                invited: "GROUP_INVITED",
                member: "GROUP_MEMBER"
            }
        },
        contact: {
            status: {
                normal: "CONTACT_NORMAL",
                pending: "CONTACT_PENDING",
                invited: "CONTACT_INVITED"
            }
        },
        agent: {
            entryType: {
                file: "ENTRY_FILE",
                folder: "ENTRY_FOLDER",
                drive: "ENTRY_DRIVE",
                board: "ENTRY_BOARD"
            }
        },
        meet: {
            recordingStatus: {
                stopped: "RECORDING_STOPPED",
                started: "RECORDING_STARTED",
                paused: "RECORDING_PAUSED",
                resumed: "RECORDING_RESUMED",
                saved: "RECORDING_SAVED",
                cancelled: "RECORDING_CANCELLED"
            },
            dsStatus: {
                stopped: "DS_STOPPED",
                started: "DS_STARTED",
                paused: "DS_PAUSED",
                resumed: "DS_RESUMED",
                remoteControl: "DS_REMOTECONTROL"
            },
            scheduleStatus: {
                ended: "SESSION_ENDED",
                scheduled: "SESSION_SCHEDULED",
                started: "SESSION_STARTED"
            },
            tags: {
                autoRecordMeet: "START_WITH_RECORDING",
                autoFullscreen: "SHOW_PAGE_AS_FULLSCREEN",
                hideAudio: "MEET_WITHOUT_AUDIO",
                autoJoinAudio: "MEET_AUTO_JOIN_AUDIO",
                hideAudioVoip: "MEET_WITHOUT_AUDIO_VOIP",
                hideAudioTelephony: "MEET_WITHOUT_AUDIO_DIALIN",
                hideInvite: "MEET_WITHOUT_INVITE",
                hideAttendeeInvite: "MEET_ATTENDEE_WITHOUT_INVITE",
                hideParticipant: "MEET_WITHOUT_PARTICIPANT",
                hideAttendeeParticipant: "MEET_ATTENDEE_WITHOUT_PARTICIPANT",
                disableAttendeeAnnotate: "MEET_ATTENDEE_WITHOUT_ANNOTATE",
                hideVideo: "MEET_WITHOUT_VIDEO",
                hideSharing: "MEET_WITHOUT_SHARING",
                hideShareFile: "MEET_WITHOUT_SHARE_FILE",
                videoToolbar: "MEET_VIDEO_TOOLBAR",
                videoQuality: "MEET_VIDEO_QUALITY",
                endPage: "MEET_END_PAGE"
            },
            network: {
                quality: {
                    good: "good",
                    bad: "bad"
                }
            },
            shareType: {
                file: "file",
                screen: "screen"
            }
        },
        branding: {
            webHeaderLogo: "Web_Header_Logo",
            webHeaderBgColor: "Web_Header_BgColor",
            webMeetHeaderBgColor: "Web_Meet_Header_BgColor",
            webMeetHeaderTextColor: "Web_Meet_Header_Text_Color",
            webNoteHeaderBgColor: "Web_Note_Header_BgColor",
            webNoteHeaderTextColor: "Web_Note_Header_Text_Color",
            mobileHeaderLogo: "Mobile_Header_Logo",
            emailHeaderLogo: "Email_Header_Logo",
            defaultBinderCover: "Default_Binder_Cover",
            defaultUserAvatar: "Default_User_Avatar",
            notificationIcon: "Notification_Icon",
            showNoteWatermark: "Show_Note_Watermark",
            noteWatermarkImage: "Note_Watermark_Image",
            showAppReview: "Show_App_Review",
            showSendFeedback: "Show_Send_Feedback",
            showTodo: "Show_Todo",
            startMeetFromBinder: "Start_Meet_From_Binder",
            showBinderOptions: "Show_Binder_Options",
            showBinderName: "Show_Binder_Name",
            showBinderEmailAddress: "Show_Binder_Email_Address",
            showNewBinder: "Show_New_Binder",
            showMeetNow: "Show_Meet_Now",
            showScheduleMeet: "Show_Schedule_Meet",
            webdavUrl: "WebDAV_URL",
            webdavDomain: "WebDAV_Domain",
            showAddFile: "Show_Add_File",
            showMeetShareScreen: "Show_Meet_Share_Screen",
            showMeetAudio: "Show_Meet_Audio",
            showMeetVideo: "Show_Meet_Video",
            enableMeetTelephony: "Enable_Meet_Telephony",
            disableAutoJoinAudio: "Disable_Auto_Join_Meet_Audio",
            webAddFileOptions: "JSON_Web_Add_File_Options",
            iosAddFileOptions: "JSON_IOS_Add_File_Options",
            androidAddFileOptions: "JSON_Android_Add_File_Options",
            plusNewPage: "plusNewPage",
            plusBinderPage: "plusBinderPage",
            plusDesktopLocal: "plusDesktopLocal",
            plusDesktopRemote: "plusDesktopRemote",
            plusWebDoc: "plusWebDoc",
            plusGallery: "plusGallery",
            plusCamera: "plusCamera",
            plusWebClip: "plusWebClip",
            plusBox: "plusBox",
            plusDropbox: "plusDropbox",
            plusEvernote: "plusEvernote",
            plusGoogleDrive: "plusGoogleDrive",
            plusICloudDrive: "plusICloudDrive",
            plusWebDAV: "plusWebDAV"
        },
        flags: {
            windowsAgent: "Moxtra Windows",
            macAgentAppstore: "(Moxtra OSX App store)",
            macAgentLocal: "(Moxtra OSX)"
        },
        style: {
            brandingId: "branding-style",
            meetBrandingId: "meet-branding-style"
        },
        video: {
            layout: {
                normal: 0,
                presenting: 1,
                vertical: 2
            },
            quality: {
                lower: 0,
                normal: 1,
                high: 2,
                HD: 3
            }
        }
    };
}), define("binder/binderModel", [ "moxtra", "lang", "const" ], function(a, b, c) {
    var d = MX.logger("binderModel");
    return a.Model.extend({
        idAttribute: "boardId",
        defaults: {
            boardId: "",
            category: 0,
            cover: "",
            name: "",
            ownerName: "",
            totalComments: -1,
            totalMembers: -1,
            totalPages: -1,
            totalIntegrations: 0,
            updateTime: "",
            thumbnail: "",
            thumbnail_small: "",
            ownerId: "",
            ownerEmail: "",
            orderNumber: 0,
            isMyBinder: !0,
            isOwner: !0,
            isEditor: !0,
            isViewer: !1,
            isInvite: !1,
            isMember: !1,
            isConversation: !1,
            isMeet: !1,
            isNotificationOff: !1,
            isSilentMessageOn: !1
        },
        validation: {
            name: [ {
                required: !0,
                msg: b.please_enter_binder_name
            } ]
        },
        parse: function(a) {
            if (a.board) {
                var e = MX.pick(a, [ "sequence", "board.name", "type", "status", "category", "boardId", "updated_time", "order_number", "board.view_tokens", "board.total_comments", "board.total_pages", "board.isconversation", "board.islive", "board.is_team", "board.total_members", "board.feeds.0.timestamp" ], {
                    format: function(a) {
                        return MX.camelize(a.split(".").pop());
                    }
                });
                e.boardId || (e.boardId = MX.get("board.id", a));
                var f = Moxtra.getMe(), g = f.id, h = f.email;
                if (e.isMeet = !!e.islive, e.isConversation = !!e.isconversation, e.isConversation) {
                    var i, j, k = [];
                    i = MX.filter(a.board.users, function(a) {
                        return !a.is_deleted && a.user && a.user.id != g && a.user && a.user.email != h;
                    });
                    for (var l = 0, m = Math.min(i && i.length || 0, 4); m > l; l++) j = i[l], k.push(j.user.first_name || j.user.name || j.user.email || "");
                    e.name = k.length ? k.join(", ") : b.group_chat;
                }
                var n = a.board.thumbnail;
                a.$name ? (e.thumbnail = n, e.thumbnail_small = n) : (e.thumbnail = n ? "/board/" + e.boardId + "/" + n : Moxtra.config.defaults.binder_cover, 
                e.thumbnail_small = n ? "/board/" + e.boardId + "/" + n : Moxtra.config.defaults.binder_cover), 
                n && (e.thumbnail = Moxtra.util.makeAccessTokenUrl(e.thumbnail), e.thumbnail_small = Moxtra.util.makeAccessTokenUrl(e.thumbnail_small));
                var o, p = MX.filter(a.board.users, {
                    is_deleted: void 0
                }), q = MX.filter(p, {
                    "user.id": g
                }), r = MX.filter(p, {
                    "group.id": f.groupId
                });
                e.isNotificationOff = q && q[0].is_notification_off ? q[0].is_notification_off : !1, 
                r && (d.debug(r), r = r[0]);
                if (p) if (a.type == c.binder.role.Owner) o = q && p.length > 1 ? b.binder_owner_me_shared : b.binder_owner_private, 
                e.isOwner = !0, e.ownerId = g, e.ownerEmail = h; else {
                    var s = MX.filter(p, {
                        type: c.binder.role.Owner
                    });
                    s = s && s[0].user || {}, o = b.binder_owner + ": " + s.first_name + " " + s.last_name, 
                    e.ownerId = s.id, e.isOwner = !1, e.isMyBinder = !1, e.ownerEmail = s.email;
                }
                if (e.ownerName = o, a.status == c.binder.status.invite ? (e.isInvite = !0, e.isEditor = !1) : (e.isEditor = a.type ? a.type === c.binder.role.Editor : r && r.type === c.binder.role.Editor, 
                e.isInvite = !1), e.isEditor || e.isOwner || (e.isViewer = !0), a.status === c.binder.status.member) e.isMember = !0; else if (p) {
                    var t = MX.filter(p, {
                        status: c.binder.status.member
                    });
                    MX.each(t, function(a) {
                        a.user && a.user.id === g && (e.isMember = !0);
                    });
                }
                if (e.viewTokens) {
                    var u = 0;
                    MX.each(e.viewTokens, function(a) {
                        a.actor_file_as && a.actor_file_as.type === Moxtra.const.USER_TYPE_SERVICE && u++;
                    }), e.totalIntegrations = u;
                }
                return e;
            }
        },
        save: function() {
            var a = this.toJSON();
            return new MX.ChainObject(function() {
                MX.api("/binders", "POST", {
                    data: {
                        name: a.name,
                        category: a.category,
                        isconversation: a.isConversation
                    }
                }, this.callback, this);
            });
        }
    });
}), define("binder/binderBiz", [ "moxtra", "binder/binderModel" ], function(a) {
    return {
        getBinder: function(b) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}", b), "GET", null, this.callback, this);
            });
        },
        searchOneBinder: function(b, c) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}", b), "GET", {
                    action: "search",
                    data: {
                        text: c
                    }
                }, this.callback, this);
            });
        },
        acceptBinder: function(b) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}", b), "PUT", {
                    action: "accept"
                }, this.callback, this);
            });
        },
        declineBinder: function(b) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}", b), "PUT", {
                    action: "decline"
                }, this.callback, this);
            });
        },
        leaveBinder: function(b) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}", b), "PUT", {
                    action: "leave"
                }, this.callback, this);
            });
        },
        assignCategoryToBinder: function(b, c) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}", b), "PUT", {
                    data: {
                        category: c
                    }
                }, this.callback, this);
            });
        },
        updateBinderOrderNumber: function(b, c) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}", b), "PUT", {
                    data: {
                        order_number: c
                    }
                }, this.callback, this);
            });
        },
        updateBindersOrderNumber: function(b) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}", "0"), "PUT", {
                    data: {
                        userBinders: b
                    },
                    action: "batchUpdateOrderNumber"
                }, this.callback, this);
            });
        },
        inviteMembers: function(b, c) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}/users", b), "POST", {
                    data: {
                        users: c
                    }
                }, this.callback, this);
            });
        },
        updatePageNumber: function(b, c, d) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}", b), "PUT", {
                    data: {
                        pages: c,
                        firstPageChanged: d
                    }
                }, this.callback, this);
            });
        },
        deleteBinderComment: function(b, c) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}/comments/{1}", b, c), "DELETE", null, this.callback, this);
            });
        },
        copyBinderResources: function(b, c, d, e) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}/resources", b), "POST", {
                    action: "copyFrom",
                    data: {
                        idFromBinder: c,
                        resources: d
                    },
                    view_token: e
                }, this.callback, this);
            });
        },
        deleteBinderResources: function(b, c) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}/resources", b), "DELETE", {
                    data: {
                        resources: c
                    }
                }, this.callback, this);
            });
        },
        getBoardPageData: function(b, c, d) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}/pages/{1}", b, c), "GET", {
                    view_token: d
                }, this.callback, this);
            });
        },
        addPageComment: function(b, c, d) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}/pages/{1}/comments", b, c), "POST", {
                    data: {
                        text: d
                    }
                }, this.callback, this);
            });
        },
        removePageComment: function(b, c, d) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}/pages/{1}/comments/{2}", b, c, d), "DELETE", null, this.callback, this);
            });
        },
        updatePageComment: function(b, c, d, e) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}/pages/{1}/comments/{2}", b, c, d), "PUT", {
                    data: {
                        text: e
                    }
                }, this.callback, this);
            });
        },
        deletePages: function(b, c) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}/pages", b), "DELETE", {
                    data: {
                        pages: c
                    }
                }, this.callback, this);
            });
        },
        rotatePages: function(b, c) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}/pages", b), "PUT", {
                    data: {
                        rotate: !0,
                        pages: c
                    }
                }, this.callback, this);
            });
        },
        renamePage: function(b, c, d) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}/pages/{1}", b, c), "PUT", {
                    data: {
                        name: d
                    }
                }, this.callback, this);
            });
        },
        copyPages: function(b, c, d, e, f) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}/pages", b), "POST", {
                    action: "copyFrom",
                    data: {
                        idFromBinder: c,
                        pages: d,
                        page_groups: e
                    },
                    view_token: f
                }, this.callback, this);
            });
        },
        removeMember: function(b, c, d) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}/users", b), "DELETE", {
                    data: {
                        users: [ {
                            email: c,
                            id: d
                        } ]
                    }
                }, this.callback, this);
            });
        },
        setMemberRole: function(b, c, d) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}/users/{1}", b, c), "PUT", {
                    data: {
                        type: d
                    }
                }, this.callback, this);
            });
        },
        renameGroup: function(b, c, d) {
            return d && d.length ? new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}/page_groups/{1}", b, c), "PUT", {
                    data: {
                        name: d
                    }
                }, this.callback, this);
            }) : void 0;
        },
        removePageFromGroup: function(b, c) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}/pages", b), "PUT", {
                    data: {
                        pages: c
                    }
                }, this.callback, this);
            });
        },
        createGroup: function(b, c) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}/page_groups", b), "POST", {
                    data: {
                        name: c
                    }
                }, this.callback, this);
            });
        },
        deleteGroup: function(b, c) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}/page_groups/{1}", b, c), "DELETE", null, this.callback, this);
            });
        },
        updatePageGroup: function(b, c, d) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}/page_groups/{1}", b, c), "PUT", {
                    data: {
                        pages: d
                    }
                }, this.callback, this);
            });
        },
        deleteAnnotation: function(b) {
            return new a.ChainObject(function() {
                MX.api(MX.format("/binders/{{boardid}}/pages/{{sequence}}/annotations/{{client_uuid}}", b), "DELETE", null, this.callback, this);
            });
        },
        updateAnnotation: function(b) {
            return new a.ChainObject(function() {
                MX.api(MX.format("/binders/{{boardid}}/pages/{{sequence}}/annotations/{{client_uuid}}", b), "PUT", {
                    data: {
                        svg: b.svg_tag
                    }
                }, this.callback, this);
            });
        },
        verifyInvitationToken: function(b) {
            return new a.ChainObject(function() {
                MX.api("/binders/invitation", "GET", {
                    view_token: b
                }, this.callback, this);
            });
        },
        isSilentMessageOn: function(a) {
            var b = !1, c = JSON.parse(localStorage.getItem("mx:SilentMessage"));
            return c && (b = c[a] === !0), b;
        }
    };
}), define("text!template/common/search.html", [], function() {
    return '<div class="form-with-icon input-with-search">\n    <i class="micon-search icon-control"></i>\n    <button type="button" class="close input-close hide" data-action="removeSearchKey" aria-hidden="true">\n        <span>×</span>\n    </button>\n    <input id="searchKey" disabled class="form-control input-sm" type="text" autocapitalize="off" autocorrect="off" autocomplete="off" placeholder="{{lang.search_all}}">\n\n    <div class="mx-search board-avatar-small">\n        <!--div class="search-header ">\n            <button type="button" class="close input-close" >\n                <span>×</span>\n            </button>\n        </div-->\n        <div class="mx-box mx-container" id="searchResult">\n            <div class="panel-default" id="searchContactsBox">\n                <div class="panel-heading">\n                    <h4 class="panel-title">\n                        <a data-toggle="collapse" data-parent="#searchResult" href="#contactsList"  class="collapsed">\n                            <i class="micon-arrow-right" />\n                            {{lang.contacts}} <span class="contacts count"></span>\n                        </a>\n                    </h4>\n                </div>\n                <div id="contactsList" class="panel-collapse collapse">\n                    <div class="panel-body" >\n                        <ul class="search-contacts box">\n\n                        </ul>\n                    </div>\n                </div>\n            </div>\n            <div class="panel-default" id="searchTeamsBox">\n                <div class="panel-heading">\n                    <h4 class="panel-title">\n                        <a data-toggle="collapse" data-parent="#searchResult" href="#teamsList"  class="collapsed">\n                            <i class="micon-arrow-right" />\n                            {{lang.teams}} <span class="teams count"></span>\n                        </a>\n                    </h4>\n                </div>\n                <div id="teamsList" class="panel-collapse collapse">\n                    <div class="panel-body" >\n                        <ul class="search-teams box">\n\n                        </ul>\n                    </div>\n                </div>\n            </div>\n            <div class="panel-default" id="searchBindersBox">\n                <div class="panel-heading">\n                    <h4 class="panel-title">\n                        <a data-toggle="collapse" data-parent="#searchResult" href="#binderResult" class="collapsed">\n                            <i class="micon-arrow-right" />\n                            {{lang.binders}} <span class="binders count"></span>\n                        </a>\n                    </h4>\n                </div>\n                <div id="binderResult" class="panel-collapse collapse">\n                    <div class="panel-body" >\n                        <ul id="binders" class="search-binders box bottom-line ">\n\n                        </ul>\n                    </div>\n                </div>\n            </div>\n            <div class="panel-default" id="bizContactsBox">\n                <div class="panel-heading">\n                    <h4 class="panel-title">\n                        <a data-toggle="collapse" data-parent="#searchResult" href="#bizContactsResult"  class="collapsed">\n                            <i class="micon-arrow-right" />\n                            {{lang.business_directory}} <span class="biz-contacts count"></span>\n                        </a>\n                    </h4>\n                </div>\n                <div id="bizContactsResult" class="panel-collapse collapse">\n                    <div class="panel-body" >\n                        <ul id=\'bizContacts\' class=" box">\n\n                        </ul>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n';
}), define("text!template/common/searchUserItem.html", [], function() {
    return '<li class="mx-item" ta-param="{{#if user.name}}{{user.name}}{{else}}{{user.displayName}}{{/if}}">\n    <div class="row" data-action="accessUser" data-param="{{user.primaryKey}}">\n        <div class="col-sm-2">{{avatarView this}}</div>\n\n        {{#if division}}\n        <div class="col-sm-7 ellipsis">\n            <div class="user-name">\n            	{{#if user.name}}\n            	{{user.name}}\n            	{{else}}\n                {{user.displayName}}\n                {{/if}}\n            </div>\n            <div class="gray size12" style="margin-top: -5px;">\n        		{{user.email}}\n        	</div>\n            <div class="org-name">{{division}}{{#if department}} - {{department}}{{/if}}</div>\n        </div>\n        {{else}}\n        <div class="col-sm-7 ellipsis">\n        	<div>\n        		{{#if user.name}}{{user.name}}{{else}}{{user.displayName}}{{/if}}\n        	</div>\n        	<div class="gray size12" style="margin-top: -5px;">\n        		{{user.email}}\n        	</div>\n        </div>\n        {{/if}}\n        <div class="pull-right marginTop5" style="margin-right: 5px">\n            <!-- <a  data-action="startMeet" data-param="{{user.userid}}" title="{{lang.start_meet}}"> <i class="micon-meet gray size16"/></a> -->\n            <a href="#mymeet?action=start_with_contact&email={{user.email}}&unique_id={{user.unique_id}}" target="{{meetTabName}}" oncontextmenu="return false;" title="{{lang.start_meet}}"> <i class="micon-meet gray size16"/></a>\n        </div>\n    </div>\n</li>\n';
}), define("text!template/common/searchBinderItem.html", [], function() {
    return '<div ta-param="{{board.name}}" >\n    <div class="mx-item "  >\n        <div class="row" data-action="gotoBinder" data-param="{{board.id}},{{boardType}}">\n            <div class="col-sm-2">{{boardAvatar this}}</div>\n            <div class="col-sm-9" >\n                <div class="marginTop8 ellipsis">{{board.name}}</div>\n            </div>\n            <div class="col-sm-1">\n                <a  data-action="searchBinderContent" data-param="{{board.id}},{{boardType}}" class="search-item-arrow marginTop5"> <i class="micon-arrow-right gray size14 "/></a>\n            </div>\n        </div>\n\n    </div>\n    <div class="row binder-content"></div>\n</div>';
}), define("text!template/common/searchBinderPageItem.html", [], function() {
    return '<div ta-param="{{name}}" class="mx-item row" data-action="gotoBinderPage" data-param="{{boardId}},{{sequence}},{{boardType}},{{type}}" >\n	<div class="col-dm-offset-1 col-sm-1"> <i class="{{icon}}"/></div>\n	<div class="col-sm-10">\n		<div class="name ellipsis" title="{{name}}">{{name}}</div>\n	</div>\n</div>\n';
}), define("text!template/common/searchTeamItem.html", [], function() {
    return '<li class="mx-item" ta-param="{{group.name}}">\n    <div class="row" data-action="gotoTeam" data-param="{{group.id}}">\n    	<div class="col-sm-2">\n    		<div class="contact-avatar">\n			    <img class="mx-noborder mx-noborder-radius" style="width: 32px; height: 32px;" src="{{group.avatar}}" />\n			</div>\n    	</div>\n    	<div class="col-sm-7 ellipsis">\n            <div class="user-name">\n                {{group.name}}\n            </div>\n            <div class="size12 gray" style="margin-top: -5px;">{{i18nCount group.members.length lang.member lang.members}}</div>\n        </div>\n    </div>\n</li>\n';
}), define("meet/meetUtil", [ "moxtra", "app", "lang", "const" ], function(a, b, c, d) {
    return {
        formatMeetId: function(a) {
            var b = a.length, c = [];
            return c.push(a.substr(0, 3)), c.push(a.substring(3, b - 3)), c.push(a.substr(-3)), 
            c.join(" ");
        },
        isOsSupported: function() {
            return MX.env.isMac || MX.env.isWin ? !0 : !1;
        },
        isBrowserSupported: function() {
            return MX.env.isMobile ? !1 : MX.env.isChrome && MX.env.browserVersion >= 19 || MX.env.isSafari && MX.env.browserVersion >= 6 || MX.env.isOpera && MX.env.browserVersion >= 12 || MX.env.isFF && MX.env.browserVersion >= 12 || MX.env.isIE && MX.env.browserVersion >= 9;
        },
        logFormat: function(a, b) {
            b = b || {};
            var c, d = "{{meetid}}.{{rosterid}}.web.{{datetime}} {{message}}";
            return c = MX.format(d, {
                meetid: b.meetId || "",
                rosterid: b.rosterId || Moxtra.getMe().sessionId || "",
                datetime: moment(Date.now()).format("MM/DD/YY HH:mm:ss.SSS"),
                message: a
            });
        },
        parseMeetInfo: function(a) {
            var b = {
                hasSession: !1,
                host: "",
                title: MX.escapeHTML(a.object && a.object.board && a.object.board.name || ""),
                boardId: a.object && a.object.board && a.object.board.id || "",
                meetId: "",
                isExpired: !0,
                isActive: !1,
                isScheduled: !1,
                scheduledDate: "",
                scheduledStartTime: 0,
                joinBeforeHost: 0
            }, e = a.object && a.object.board && a.object.board.users || [], f = MX.filter(e, {
                type: d.binder.role.Owner
            });
            f = f && f[0].user || {}, b.host = MX.format(c.meet_hosted_by, {
                name: Handlebars.Utils.escapeExpression(f.name || f.first_name || f.email)
            });
            var g = function(a) {
                var b = !1;
                return a.session_status === d.meet.scheduleStatus.started ? b = !1 : a.session_status === d.meet.scheduleStatus.scheduled ? a.scheduled_end_time < Date.now() && (b = !0) : a.session_status === d.meet.scheduleStatus.ended && (a.end_time > a.scheduled_end_time || a.scheduled_end_time < Date.now()) && (b = !0), 
                b;
            }, h = function(a) {
                return a.session_status === d.meet.scheduleStatus.started;
            };
            if (a.object && a.object.board && a.object.board.sessions && a.object.board.sessions[0]) {
                var i = a.object.board.sessions[0].session;
                i.start_time = i.start_time || 0, i.end_time = i.end_time || 0, i.scheduled_start_time = i.scheduled_start_time || 0, 
                i.scheduled_end_time = i.scheduled_end_time || 0, b.hasSession = !0, b.meetId = i.session_key, 
                b.isExpired = g(i), b.isActive = h(i), b.isScheduled = !b.isExpired && !b.isActive, 
                b.isScheduled && (b.scheduledDate = this.formatDate(i.scheduled_start_time), b.scheduledStartTime = i.scheduled_start_time), 
                b.joinBeforeHost = i.milliseconds_allowed_to_join_before_start || 0;
            }
            return b;
        },
        formatDate: function(a) {
            var b = Moxtra.getMe().timezone, c = "M/D/YY h:mm A";
            if (!b) return moment(a).format(c);
            try {
                return moment(a).tz(b).format(c);
            } catch (d) {
                return console.error(d), moment(a).format(c);
            }
        },
        isIntegrationAutoRecord: function() {
            var a = !1, c = b.integration.get("extension");
            if (c) {
                var d = JSON.parse(c);
                a = d.save_meet && d.save_meet.auto_record;
            }
            return a;
        },
        str2ab: function(a) {
            for (var b = new ArrayBuffer(2 * a.length), c = new Uint8Array(b), d = 0, e = a.length; e > d; d++) c[d] = a.charCodeAt(d);
            return b;
        },
        showMeetFeed: function(a, b) {
            b = b || [];
            var c = !1;
            if (a) {
                var d = Moxtra.getBoardMembers(a);
                if (d && d.length) {
                    var e = {}, c = !0;
                    MX.each(b, function(a) {
                        var b;
                        b = a.toJSON ? a.toJSON() : a, b.group ? e[b.group.id] = !0 : (b.id && (e[b.id] = !0), 
                        b.email && (e[b.email] = !0));
                    }), c = !0;
                    var f = Moxtra.getMe().id;
                    MX.each(d, function(a) {
                        var b = !1;
                        return a.group ? b = e[a.group.id] || !1 : a.user && (b = e[a.user.id] || e[a.user.email] || !1), 
                        a.user && a.user.id === f && (b = !0), b ? void 0 : (c = !1, !1);
                    });
                }
            }
            return c;
        }
    };
}), define("meet/meet", [ "moxtra", "lang", "app", "const", "meet/meetUtil" ], function(a, b, c, d, e) {
    var f = MX.logger("meet"), g = function() {}, h = (Moxtra.getMe().sessionId, {
        START: "start",
        END: "end",
        JOIN: "join",
        LEAVE: "leave"
    });
    return {
        start: function(a) {
            if (c.isIntegrationWebsdk() && !a.forceStart) return c.sendMessage(a.isNote ? {
                action: "request_note",
                binder_id: a.boardId || null,
                page_index: a.currPage || 0,
                session_id: Moxtra.getMe().sessionId
            } : {
                action: "request_meet",
                binder_id: a.boardId || null,
                session_id: Moxtra.getMe().sessionId
            }), void (a.success && a.success());
            this._setHref(a.backHref), a = this._processParams(a);
            var d, h = this, i = a.isNote ? b.note_renamed_to_clip : b.meet, j = Moxtra.getMe();
            (j.first_name || j.email) && (i = a.isNote ? MX.format(b.note_topic, {
                name: j.first_name || j.email
            }) : MX.format(b.meet_topic, {
                name: j.first_name || j.email
            })), a.topic && (i = a.topic), a.boardId && a.isNote && (d = {
                idFromBinder: a.boardId,
                pages: a.pages,
                resources: a.resources
            }), a.isNote && (d = d || {}, d.isnote = !0), f.logServer(e.logFormat("[meet:start] start meet")), 
            MX.api("/meets", "POST", {
                data: d
            }, function(b) {
                if (!b || !b.data) return a.error && a.error(b.xhr), null;
                var d = b.data, e = d.id;
                if (!e) {
                    var f = d.board || {};
                    e = f.id;
                }
                a.isNote && (c.status.remove("mxNote"), c.status.set("mxNote", {
                    srcId: a.boardId,
                    currPage: a.currPage
                })), h._start({
                    isNote: !!a.isNote,
                    originalId: a.boardId,
                    boardId: e,
                    topic: i,
                    users: a.users,
                    tags: a.tags,
                    silence: a.silence,
                    success: a.success || g,
                    error: a.error || g
                });
            });
        },
        startAssigned: function(a) {
            this._setHref(a.backHref), this._start({
                isNote: !1,
                autoRecord: a.autoRecord,
                boardId: a.boardId,
                sessionKey: a.sessionKey,
                topic: a.topic,
                tags: a.tags,
                success: a.success || g,
                error: a.error || g
            });
        },
        joinAssigned: function(a) {
            this._setHref(a.backHref), this._join(a);
        },
        join: function(a) {
            a = a || {}, this._setHref(a.backHref);
            var g = this, h = function(b) {
                a.error ? a.error(b) : c.navigate("/timeline", !0);
            }, i = function(a, d, e, f) {
                c.sendMessage({
                    action: "fail",
                    session_id: Moxtra.getMe().sessionId,
                    error_code: f,
                    error_message: a
                }), new MX.ui.Dialog({
                    title: a,
                    width: 300,
                    content: d,
                    buttons: [ {
                        text: b.ok,
                        className: "btn-primary",
                        click: function() {
                            this.close(), h(e);
                        }
                    } ]
                });
            };
            MX.api(MX.format("/meets/{0}", a.sessionKey), "GET", null, function(c) {
                if (c && "RESPONSE_SUCCESS" === c.code) if (f.logServer(e.logFormat("[meet:join] read meet ok, session_key = " + a.sessionKey, {
                    meetId: a.sessionKey
                })), c.object && c.object.board && (a.topic = c.object.board.name), c.object && c.object.board && c.object.board.sessions && c.object.board.sessions[0]) {
                    var h = c.object.board.sessions[0].session;
                    if (h.session_status === d.meet.scheduleStatus.started) g._join(a); else if (h.session_status === d.meet.scheduleStatus.scheduled) {
                        var j, k = h.scheduled_start_time - new Date().getTime();
                        h.milliseconds_allowed_to_join_before_start && k <= h.milliseconds_allowed_to_join_before_start ? g._join(a) : (j = 36e6 >= k ? b.join_meet_within_minutes_of_scheduled : MX.format(b.join_meet_but_ahead_of_scheduled, {
                            date: moment(h.scheduled_start_time).format("l LT")
                        }), i(b.meet_has_not_started, j, c, 412));
                    } else h.session_status === d.meet.scheduleStatus.ended ? i(b.meet_ended, b.join_meet_but_has_ended, c, 412) : i(b.meet_id_invalid, b.meet_id_invalid_check_tip, c, 404);
                } else g._join(a); else i(b.meet_id_invalid, b.meet_id_invalid_check_tip, c, 404);
            });
        },
        exit: function(a) {
            a = a || {}, a.isHost ? (a.action = h.END, f.logServer(e.logFormat("Host try to end meet.", {
                meetId: a.sessionKey
            }))) : (a.action = h.LEAVE, f.logServer(e.logFormat("Attendee try to leave meet.", {
                meetId: a.sessionKey
            }))), this._exit(a);
        },
        load: function(a) {
            if (a = a || {}, c.request.page()) {
                var b = this;
                MX.api("/binders/" + c.request.page(), "GET", null, function(c) {
                    c && "RESPONSE_SUCCESS" === c.code ? a.success && a.success(b._getProfile(c)) : a.error && a.error();
                });
            } else a.error && a.error();
        },
        readById: function(b) {
            return new a.ChainObject(function() {
                MX.api(MX.format("/meets/{0}", b), "GET", null, this.callback, this);
            });
        },
        _setHref: function(a) {
            a ? c.status.set("mxMeetAnchorHref", a) : c.status.set("mxMeetAnchorHref", location.href);
        },
        _processParams: function(a) {
            a = a || {};
            var b = [], c = [], d = [];
            return a.pages && (MX.each(a.pages, function(a) {
                MX.isNumber(1 * a) ? b.push(1 * a) : a.sequence && b.push(a.sequence);
            }), a.pages = b), a.resources && (MX.each(a.resources, function(a) {
                MX.isNumber(1 * a) ? c.push(1 * a) : a.sequence && c.push(a.sequence);
            }), a.resources = c), a.users && (MX.each(a.users, function(a) {
                d.push(MX.isString(a) ? {
                    email: a
                } : a);
            }), a.users = d), a;
        },
        _start: function(a) {
            var b, d = this;
            b = function() {
                var b = {
                    binder_id: a.boardId,
                    topic: a.topic
                };
                a.isNote || (b.original_board_id = a.originalId), d._request({
                    action: h.START,
                    autoRecord: a.autoRecord,
                    boardId: a.boardId,
                    isNote: a.isNote,
                    data: b,
                    success: function(b) {
                        a.isNote || c.sendMessage({
                            action: "start",
                            binder_id: b.board_id,
                            session_key: b.session_key,
                            session_id: Moxtra.getMe().sessionId
                        }), d._inviteUsers(b.board_id, b.session_key, a.users), a.success && a.success(b), 
                        a.originalId && MX.unsubscribe("/binders/" + a.originalId), a.silence || (a.isNote ? c.navigate("/note/" + b.board_id || a.boardId, !0) : c.navigate("/meet/" + b.board_id || a.boardId, !0));
                    },
                    error: function(b) {
                        b && 409 === b.status && a.sessionKey ? d._join({
                            sessionKey: a.sessionKey,
                            error: a.error || g
                        }) : a.error && a.error(b);
                    }
                });
            }, !a.isNote && a.tags ? Moxtra.loadBoard(a.boardId).success(function(c) {
                var d = [], e = c.tags;
                MX.each(a.tags, function(a) {
                    var b = e.get(a.name);
                    b || (b = new Moxtra.model.BoardTag(), b.set("name", a.name)), b.set("string_value", a.string_value), 
                    d.push(b);
                }), c.tags.push(d), c.update("tags").complete(function() {
                    b();
                });
            }).error(function() {
                b();
            }) : b();
        },
        _join: function(a) {
            f.logServer(e.logFormat("Try to join meet", {
                meetId: a.sessionKey
            }));
            var b = {};
            a.userName && (b.name = a.userName), a.topic && (b.topic = a.topic), this._request({
                action: h.JOIN,
                sessionKey: a.sessionKey,
                data: b,
                joinInvisible: a.invisible,
                success: function(b) {
                    c.sendMessage({
                        action: "join",
                        binder_id: b.board_id,
                        session_key: b.session_key,
                        session_id: Moxtra.getMe().sessionId
                    }), a.success && a.success(b), a.silence || c.navigate("/meet/" + b.board_id);
                },
                error: a.error || g
            });
        },
        _exit: function(a) {
            var b = this;
            f.logServer(e.logFormat("prepare to _exit Meet", {
                meetId: a.sessionKey
            })), this._request({
                action: a.action,
                sessionKey: a.sessionKey,
                async: a.async,
                data: {
                    binder_id: a.boardId,
                    session_key: a.sessionKey
                },
                success: function(c) {
                    !a.isNote && a.isSendMessage && f.logServer(a.isHost ? e.logFormat("Host ended meet SUCCESS.", {
                        meetId: a.sessionKey
                    }) : e.logFormat("Attendee left meet SUCCESS.", {
                        meetId: a.sessionKey
                    })), b._cleanup(), a.success && a.success(c);
                },
                error: function(b) {
                    f.logServer(a.isHost ? e.logFormat("Host ended meet ERROR.", {
                        meetId: a.sessionKey
                    }) : e.logFormat("Attendee left meet ERROR.", {
                        meetId: a.sessionKey
                    })), a.error && a.error(b);
                }
            });
        },
        _getProfile: function(a) {
            Moxtra.parseData(a), f.log("[_getProfile] source data: ", a);
            var b = {}, c = a.object && a.object.board, g = {}, h = Moxtra.getMe().sessionId;
            if (b.zone = a.zone || Moxtra.getMe().zone, c) {
                if (b.sessionId = h, b.isLive = !!c.islive, a.sessions && (g = a.sessions[0]), !g) return;
                b.boardId = g.board_id || c.id, b.sessionKey = g.session_key, b.topic = g.topic || "", 
                MX.each(g.user_roster, function(a) {
                    a.id === h && (b.isHost = !!a.is_host, b.isPresenter = !!a.is_presenter, b.isInvisible = !!a.is_invisible, 
                    b.selfName = MX.get("user.name", a) || MX.get("user.email", a) || ""), a.is_host && (b.host = a.user, 
                    a.user.groups && (b.host.bizAccount = !1));
                }), c.users && MX.each(c.users, function(a) {
                    return a.type === d.binder.role.Owner ? (b.boardOwner = a.user, !1) : void 0;
                }), b.boardTags = c.tags || [], f.logServer(e.logFormat("Read meet info SUCCESS: " + JSON.stringify(b), {
                    meetId: g.session_key
                }));
            }
            return b;
        },
        _request: function(a) {
            a = a || {};
            var d = a.sessionKey, g = !1;
            a.action === h.START && (d = a.boardId, g = !!a.autoRecord, c.isIntegrationEnabled() && (g = e.isIntegrationAutoRecord()), 
            a.isNote && (g = !1), f.log("[_request] START meet with auto record meet: " + g)), 
            MX.api("/meets/" + d, "PUT", {
                action: a.action,
                data: a.data,
                autoRecord: g,
                joinInvisible: a.joinInvisible,
                async: a.async
            }, function(e) {
                return e && "RESPONSE_ERROR_EXCEED_LIMIT" === e.code ? void ("EXCEED_SESSION_USERS_MAX" === e.detail_code && MX.ui.Alert(b.common_msg_reach_limit_participatns)) : void (e && e.data ? (f.log("_request success - " + a.action), 
                a.success && a.success(e.data)) : (f.error("_request error - " + a.action, e.xhr), 
                a.error && a.error(e.xhr), c.sendMessage({
                    action: "fail",
                    session_key: a.action === h.START ? null : d,
                    session_id: Moxtra.getMe().sessionId,
                    error_code: e.xhr && e.xhr.status || "404",
                    error_message: a.action + " failed"
                })));
            });
        },
        _inviteUsers: function(a, b, c) {
            if (c && c.length) {
                var d = new Moxtra.model.ActionObject();
                d.parse({
                    board_id: a,
                    session_key: b
                }), d.inviteUsers(c);
            }
        },
        _goBack: function() {
            c.navigate("/meetintro", !0);
        },
        _cleanup: function() {}
    };
}), define("text!template/common/searchUserOption.html", [], function() {
    return '<div class="search-user-option">\n    <p class="row" >\n        {{lang.what_do_you_want_to_do}}\n    </p>\n    <div class="row" >\n        <div class="col-sm-6 col-sm-offset-1 ">\n            <button type="button"  class="btn btn-default" data-action="startChat">{{lang.start_a_new_conversation}}</button>\n        </div>\n\n        <div class="col-sm-4 ">\n\n            <button type="button"  class="btn btn-default" data-action="viewProfile">{{lang.view_profile}}</button>\n        </div>\n    </div>\n</div>\n\n\n';
}), define("common/searchUserOption", [ "moxtra", "lang", "text!template/common/searchUserOption.html" ], function(a, b, c) {
    return a.Controller.extend({
        template: c,
        handleAction: !0,
        init: function(a) {
            this.$scope.lang = b, this.onStartChat = a.onStartChat, this.onViewProfile = a.onViewProfile;
        },
        rendered: function() {},
        startChat: function() {
            this.onStartChat && this.onStartChat();
        },
        viewProfile: function() {
            this.onViewProfile && this.onViewProfile();
        }
    });
}), define("text!template/user/avatarView.html", [], function() {
    return '<div class="mx-user contact-avatar" {{#if openBizCard}}{{#if isWebsdk}}data-messager="bizCardMessager" data-userid="{{user.id}}" data-uniqueid="{{user.unique_id}}"{{/if}}{{/if}} {{#if openBizCard}}{{#if enableBizCard}}data-view="bizCardView" data-param="{{user.id}}"{{/if}}{{/if}}>\n    <img class="img-circle {{#if openBizCard}}{{#if isWebsdk}}clickable{{/if}}{{/if}} {{#if openBizCard}}{{#if enableBizCard}}clickable{{/if}}{{/if}} {{#if isServiceIntegration}}mx-noborder mx-noborder-radius mx-nobox-shadow mx-inherit-bgcolor{{/if}}{{#if group}}mx-noborder mx-noborder-radius mx-nobox-shadow{{/if}}"  src="{{#if isVirtualUser}}{{directory}}{{else}}{{avatar}}{{/if}}">\n    <i class="icon {{#if online}}online{{/if}}" data-online="{{#if user.id}}{{user.id}}{{else}}{{id}}{{/if}}"></i>\n</div>\n';
}), define("text!template/viewer/audioView.html", [], function() {
    return '{{#if isMobile}}\n<div class="mejs-container">\n	<img src="{{thumbnail}}" style="width: {{width}}px; height: {{height}}px;" />\n	<div class="mejs-overlay-button" data-action="playOnMobile" data-param="{{source}}"></div>\n</div>\n{{else}}\n<audio controls="controls" width="400">\n    <source src="{{source}}" type="audio/x-m4a">\n    <source src="{{source}}" type="audio/mpeg">\n    {{lang.browser_not_support_audio_tag}}\n</audio>\n{{/if}}\n';
}), define("text!template/viewer/videoView.html", [], function() {
    return '{{#if isMobile}}\n<div class="mejs-container">\n	<img src="{{thumbnail}}" style="width: {{width}}px; height: {{height}}px;" />\n	<div class="mejs-overlay-button" data-action="playOnMobile" data-param="{{source}}"></div>\n</div>\n{{else}}\n<video poster="{{thumbnail}}" width="100%" height="100%"  style="width:100%;height:100%"\n        controls  preload="none">\n    <source src="{{source}}" type="video/mp4"/>\n    {{lang.browser_not_support_video_tag}}\n</video>\n{{/if}}\n';
}), define("text!template/component/addPageMenu.html", [], function() {
    return '<ul class="dropdown-menu add-page-menu {{className}}">\n\n	{{#if session_key}}\n	<!-- handle plugin window covered web case -->\n	<iframe class="mx-iframe-shim" src="javascript:;" frameborder="0" allowtransparency="true" scrolling="no"></iframe>\n	{{/if}}\n\n	{{#each top_menus}}\n		<li class="add-page-item"><a class="mouse-hand"  data-action="binderActions.addCustomPages" data-param="{{menu_name}},{{../session_key}},{{action}}"><i class="micon-page size16 blue marginRight5"></i>{{menu_name}}</a></li>\n	{{/each}}\n\n	{{#when addOptions.plusDesktopLocal \'==\' \'1\'}}\n	<li class="mx-branding-addfile-desktop addpage-desktop add-page-item {{#if hide_menus.desktop}}hide{{/if}} {{#if session_key}}mx-ie-relative{{/if}}"><a id="addpage_flashuploader" data-param="desktop" class="upload-handler mouse-hand"><i class="micon-desktop size16 blue marginRight5"></i>{{lang.desktop}}</a></li>\n    {{/when}}\n    {{#when addOptions.plusDesktopRemote \'==\' \'1\'}}\n    <li class="mx-branding-addfile-remote addpage-remote add-page-item {{#if hide_menus.remote}}hide{{/if}} {{#if session_key}}mx-ie-relative{{/if}}"><a class="mouse-hand" data-action="binderActions.addPage" data-param="remoteDesktop"><i class="micon-desktop-remote size16 blue marginRight5"></i>{{lang.remote_desktop}}</a></li>\n    {{/when}}\n    {{#when addOptions.plusBinderPage \'==\' \'1\'}}\n    <li class="mx-branding-addfile-binder addpage-binder add-page-item {{#if hide_menus.binder}}hide{{/if}} {{#if session_key}}mx-ie-relative{{/if}}"><a class="mouse-hand" data-action="binderActions.addPage" data-param="binderPage,{{session_key}}"><i class="micon-binder size16 blue marginRight5"></i>{{lang.binder}}</a></li>\n	{{/when}}\n	{{#when addOptions.plusNewPage \'==\' \'1\'}}\n	<li class="mx-branding-addfile-whiteboard addpage-whiteboard add-page-item {{#if hide_menus.whiteboard}}hide{{/if}} {{#if session_key}}mx-ie-relative{{/if}}"><a class="mouse-hand" data-action="binderActions.addPage" data-param="whiteboard,{{session_key}}"><i class="micon-file-with-pen size16 blue marginRight5"></i>{{lang.whiteboard}}</a></li>\n    {{/when}}\n    {{#when addOptions.plusWebDoc \'==\' \'1\'}}\n    <li class="mx-branding-addfile-webdoc addpage-webdoc add-page-item {{#if hide_menus.webdoc}}hide{{/if}} {{#if session_key}}mx-ie-relative{{/if}}"><a class="mouse-hand" data-action="binderActions.addPage" data-param="webdoc"><i class="micon-file-with-text size16 blue"></i>{{lang.note}}</a></li>\n    {{/when}}\n   	{{#when addOptions.plusDropbox \'==\' \'1\'}}\n    <li class="mx-branding-addfile-dropbox addpage-dropbox add-page-item {{#if hide_menus.dropbox}}hide{{/if}} {{#if session_key}}mx-ie-relative{{/if}}"><a class="mouse-hand" data-action="binderActions.addPage" data-param="dropbox"><i class="micon-logo-dropbox size16 blue marginRight5"></i>{{lang.dropbox}}</a></li>\n    {{/when}}\n\n	{{#each bottom_menus}}\n		<li class="add-page-item"><a class="mouse-hand" data-action="binderActions.addCustomPages" data-param="{{menu_name}},{{../session_key}}"><i class="micon-page size16 blue marginRight5"></i>{{menu_name}}</a></li>\n	{{/each}}\n</ul>\n';
}), define("text!template/common/binderCover.html", [], function() {
    return '<div class="mx-cover-wrap mx-cover-sm pull-left">\n                    <span class="mx-cover-img ">\n                    <img src="{{thumbnail}}" />\n                   </span>\n</div>\n';
}), define("text!template/common/boardAvatar.html", [], function() {
    return '{{#if board.isconversation}}\n<div class="board-avatars board-avatar-{{boardAvatarClass board.members.length}}" >\n    {{#when board.members.length \'>=\' 2}}\n    {{#each board.members}}\n    {{#when ../../myself \'!=\' user.primaryKey}}\n    {{#when @index \'<\' 5 }}\n                            <span class="mx-presence">\n                                <span class="mx-presence-wrap">\n                                    <img src="{{avatar}}" class=" img-circle"/>\n                                </span>\n                                <i class="icon {{#if online}}online{{/if}}" data-online="{{user.id}}"></i>\n                            </span>\n    {{/when}}\n    {{/when}}\n    {{/each}}\n    {{/when}}\n\n    {{#when board.members.length \'<=\' 1}}\n    {{#each board.members}}\n                    <span class="mx-presence">\n                                <span class="mx-presence-wrap">\n                                    <img src="{{avatar}}"   class=" img-circle {{#if group}}mx-noborder mx-noborder-radius{{/if}}"/>\n                                </span>\n                                <i class="icon {{#if online}}online{{/if}}" data-online="{{user.id}}"></i>\n                            </span>\n    {{/each}}\n    {{/when}}\n</div>\n{{else}}\n<div class="board-avatars " {{#if tipName}}title="{{board.name}}"{{/if}}>\n    <div class="board-wrap">\n	        	<span class="board-wrap-outer">\n	        		<span class="board-wrap-inner">\n	        			<img src="{{board.thumbnail_small}}"\n                             />\n	        		</span>\n	        	</span>\n    </div>\n</div>\n{{/if}}\n';
}), define("text!template/mx/mxThumbnail.html", [], function() {
    return '<div class="mx-thumbnail {{className}}">\n    {{#if hasCount}}\n    <span class="badge">{{count}}</span>\n    {{/if}}\n	<span class="mx-thumbnail-outer">\n		<span class="mx-thumbnail-inner">\n			<img src="{{{info}}}">\n		</span>\n		{{#if online}}\n		<i class="mx-online"></i>\n		{{/if}}\n	</span>\n</div>\n';
}), define("text!template/mx/mxUserAvatarGroup.html", [], function() {
    return '<div class="mx-avatar-group {{className}}">\n    {{#if hasCount}}\n        <span class="badge">{{count}}</span>\n    {{/if}}\n	{{#each users}}\n  		{{mxUserAvatar this}}\n	{{/each}}\n</div>\n';
}), define("text!template/mx/mxButton.html", [], function() {
    return '<button class="btn {{type}}" type="button" {{#if hasAction}}data-action="{{action}}"{{/if}}>\n	{{label}}\n	{{#if hasIcon}}\n	<i class="{{icon}}"></i>\n	{{/if}}\n</button>';
}), define("text!template/mx/mxLinkButton.html", [], function() {
    return '<a class="btn {{type}}" type="button" href="javascript:void(0)" {{#if hasAction}}data-action="{{action}}"{{/if}}>\r\n	{{label}}\r\n	{{#if hasIcon}}\r\n	<i class="{{icon}}"></i>\r\n	{{/if}}\r\n</a>';
}), define("text!template/mx/mxCheckbox.html", [], function() {
    return '<label class="mx-checkbox" for="{{id}}">\n    {{#if checked}}\n    <input type="checkbox" name="{{name}}" id="{{id}}" value="true" checked="checked">\n    {{else}}\n    <input type="checkbox" name="{{name}}" id="{{id}}">\n    {{/if}}\n    <span class="mx-icon">{{text}}</span>\n</label>\n';
}), define("text!template/mx/mxRadio.html", [], function() {
    return '<label class="mx-radio" for="{{id}}">\n    {{#if checked}}\n    <input type="radio" name="{{name}}" id="{{id}}" value="true" checked="checked" >\n    {{else}}\n        <input type="radio" name="{{name}}" id="{{id}}">\n    {{/}}\n    <span>{{text}}</span>\n</label>\n';
}), define("config", [], function() {
    "use strict";
    return {
        google_api: {
            endpoint: "https://apis.google.com/js/client.js",
            scopes: "https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile",
            clientId: "413083443718-gq6cr0pvm1plfcibm4gpk6issncjkihn.apps.googleusercontent.com"
        },
        global: {
            homeSite: "http://www.moxtra.com/?web",
            fb_sdk_endpoint: "https://connect.facebook.net/en_US/sdk.js",
            fb_app_id: 400731083336840,
            dropbox_dropin_app_key: "hgdf297qdgsxwuj",
            appstore_url: navigator.userAgent.match(/(iPad|iPhone|iPod)/i) ? "https://itunes.apple.com/app/id590571587?mt=8" : "market://details?id=com.moxtra.binder",
            plan_code: {
                monthly: "moxtrabusiness-monthly",
                year: "moxtrabusiness-annual"
            },
            meetTabName: function() {
                return navigator.userAgent.indexOf("Moxtra Windows") > 0 ? "_blank" : location.host + ".meet.tab";
            }(),
            mx_production: function() {
                return location.host.indexOf("moxtra.com") > -1 && -1 === location.host.indexOf("beta.moxtra.com");
            }()
        },
        settings: {
            chatViewCount: 20,
            joinBeforeHost: 18e5,
            meetListTimer: 3e5,
            favicon: "favicon.png",
            faviconMeet: "favicon_orange.png"
        },
        branding: {
            webHeaderLogoSize: {
                width: 114,
                height: 38
            },
            webMeetHeaderLogoSize: {
                width: 114,
                height: 38
            },
            webNoteHeaderLogoSize: {
                width: 114,
                height: 38
            },
            mobileHeaderLogoSize: {
                width: 154,
                height: 32
            },
            emailHeaderLogoSize: {
                width: 277,
                height: 82
            },
            defaultBinderCoverSize: {
                width: 360,
                height: 360
            },
            defaultUserAvatarSize: {
                width: 300,
                height: 300
            },
            notificationIconSize: {
                width: 80,
                height: 80
            },
            noteWatermarkImageSize: {
                width: 1024,
                height: 1024
            }
        },
        thresholds: {
            storageAlert: 70,
            meetDurationLimitation: 10
        },
        services: {
            name: {
                github: "Github",
                hubspot: "HubSpot",
                jira: "JIRA",
                quickbooks: "QuickBooks",
                salesforce: "Salesforce",
                zendesk: "Zendesk",
                zoho: "Zoho"
            },
            site: {
                github: "https://github.com",
                hubspot: "http://www.hubspot.com",
                jira: "https://www.atlassian.com/software/jira",
                quickbooks: "http://quickbooks.intuit.com",
                salesforce: "http://www.salesforce.com",
                zendesk: "http://www.zendesk.com",
                zoho: "http://www.zoho.com"
            }
        },
        ADMIN_USER_PAGE_SIZE: 20
    };
}), define("common/groupCap", [ "moxtra" ], function() {
    "use strict";
    return {
        hasSaml: function() {
            var a = this._caps();
            return a.is_enterprise && a.has_saml;
        },
        hasSF: function() {
            return !1;
        },
        hasBranding: function() {
            var a = this._caps();
            return a.has_branding;
        },
        hasConfiguration: function() {
            var a = this._caps();
            return a.has_configuration;
        },
        _caps: function() {
            return Moxtra.getMyGroup() && Moxtra.getMyGroup().group_caps || {
                is_enterprise: !1,
                has_saml: !0,
                has_salesforce: !1,
                has_branding: !0,
                has_configuration: !0
            };
        }
    };
}), define("admin/branding/helper", [ "moxtra", "config", "lang", "const", "common/groupCap" ], function(a, b, c, d, e) {
    var f = {
        web: {},
        ios: {},
        android: {}
    };
    f.web[d.branding.plusNewPage] = "1", f.web[d.branding.plusBinderPage] = "1", f.web[d.branding.plusDesktopLocal] = "1", 
    f.web[d.branding.plusDesktopRemote] = "1", f.web[d.branding.plusWebDoc] = "1", f.web[d.branding.plusDropbox] = "1", 
    f.ios[d.branding.plusNewPage] = "1", f.ios[d.branding.plusBinderPage] = "1", f.ios[d.branding.plusDesktopRemote] = "1", 
    f.ios[d.branding.plusGallery] = "1", f.ios[d.branding.plusCamera] = "1", f.ios[d.branding.plusWebClip] = "1", 
    f.ios[d.branding.plusBox] = "1", f.ios[d.branding.plusWebDoc] = "1", f.ios[d.branding.plusDropbox] = "1", 
    f.ios[d.branding.plusEvernote] = "1", f.ios[d.branding.plusGoogleDrive] = "1", f.ios[d.branding.plusICloudDrive] = "1", 
    f.ios[d.branding.plusWebDAV] = "1", f.android[d.branding.plusNewPage] = "1", f.android[d.branding.plusBinderPage] = "1", 
    f.android[d.branding.plusDesktopRemote] = "1", f.android[d.branding.plusGallery] = "1", 
    f.android[d.branding.plusCamera] = "1", f.android[d.branding.plusDropbox] = "1", 
    f.android[d.branding.plusGoogleDrive] = "1";
    var g = {
        webLogo: {
            url: "themes/images/logo.96259535.png",
            previewSize: b.branding.webHeaderLogoSize
        },
        mobileLogo: {
            url: "themes/images/moxtra_top_gray@2x.f0b9ad97.png",
            previewSize: b.branding.mobileHeaderLogoSize
        },
        emailLogo: {
            url: "images/email/logo_large.png",
            previewSize: {
                width: 139,
                height: 41
            }
        },
        binderCover: {
            url: "themes/images/default/default_binder_cover.1653bb1c.png",
            previewSize: {
                width: 80,
                height: 80
            }
        },
        userAvatar: {
            url: d.defaults.user.avatar,
            previewSize: {
                width: 60,
                height: 60
            }
        },
        notification: {
            url: "themes/images/binder/default_cover_small.348bb061.gif",
            previewSize: b.branding.notificationIconSize
        },
        noteWatermarkImage: {
            url: "themes/images/default/clip-watermark.b9378e82.png",
            previewSize: {
                width: 80,
                height: 80
            }
        }
    }, h = {
        webHeaderBg: "#0082D5",
        webMeetHeaderBg: "#FF8400",
        webMeetHeaderText: "#FFFFFF",
        webNoteHeaderBg: "#61BF05",
        webNoteHeaderText: "#FFFFFF"
    }, i = {
        web: {
            keys: {
                webHeaderLogo: d.branding.webHeaderLogo,
                webHeaderBgColor: d.branding.webHeaderBgColor,
                webMeetHeaderBgColor: d.branding.webMeetHeaderBgColor,
                webMeetHeaderTextColor: d.branding.webMeetHeaderTextColor,
                webNoteHeaderBgColor: d.branding.webNoteHeaderBgColor,
                webNoteHeaderTextColor: d.branding.webNoteHeaderTextColor
            },
            defaults: {
                webHeaderLogo: g.webLogo.url,
                webHeaderBgColor: h.webHeaderBg,
                webMeetHeaderBgColor: h.webMeetHeaderBg,
                webMeetHeaderTextColor: h.webMeetHeaderText,
                webNoteHeaderBgColor: h.webNoteHeaderBg,
                webNoteHeaderTextColor: h.webNoteHeaderText
            },
            extra: {
                webHeaderLogoSize: b.branding.webHeaderLogoSize
            }
        },
        mobile: {
            keys: {
                mobileHeaderLogo: d.branding.mobileHeaderLogo
            },
            defaults: {
                mobileHeaderLogo: g.mobileLogo.url
            },
            extra: {
                mobileHeaderLogoSize: b.branding.mobileHeaderLogoSize
            }
        },
        email: {
            keys: {
                emailHeaderLogo: d.branding.emailHeaderLogo
            },
            defaults: {
                emailHeaderLogo: g.emailLogo.url
            },
            extra: {
                emailHeaderLogoSize: b.branding.emailHeaderLogoSize
            }
        },
        misc: {
            keys: {
                defaultBinderCover: d.branding.defaultBinderCover,
                defaultUserAvatar: d.branding.defaultUserAvatar,
                notificationIcon: d.branding.notificationIcon,
                showNoteWatermark: d.branding.showNoteWatermark,
                noteWatermarkImage: d.branding.noteWatermarkImage
            },
            defaults: {
                defaultBinderCover: g.binderCover.url,
                defaultUserAvatar: g.userAvatar.url,
                notificationIcon: g.notification.url,
                showNoteWatermark: "1",
                noteWatermarkImage: g.noteWatermarkImage.url
            },
            extra: {
                defaultBinderCoverSize: b.branding.defaultBinderCoverSize,
                defaultUserAvatarSize: b.branding.defaultUserAvatarSize,
                notificationIconSize: b.branding.notificationIconSize,
                noteWatermarkImageSize: b.branding.noteWatermarkImageSize
            }
        },
        configuration: {
            keys: {
                showAddFile: d.branding.showAddFile,
                webAddFileOptions: d.branding.webAddFileOptions,
                iosAddFileOptions: d.branding.iosAddFileOptions,
                androidAddFileOptions: d.branding.androidAddFileOptions,
                showAppReview: d.branding.showAppReview,
                showSendFeedback: d.branding.showSendFeedback,
                showTodo: d.branding.showTodo,
                startMeetFromBinder: d.branding.startMeetFromBinder,
                showBinderOptions: d.branding.showBinderOptions,
                showBinderName: d.branding.showBinderName,
                showBinderEmailAddress: d.branding.showBinderEmailAddress,
                showNewBinder: d.branding.showNewBinder,
                showMeetNow: d.branding.showMeetNow,
                showScheduleMeet: d.branding.showScheduleMeet,
                showMeetShareScreen: d.branding.showMeetShareScreen,
                showMeetAudio: d.branding.showMeetAudio,
                showMeetVideo: d.branding.showMeetVideo,
                enableMeetTelephony: d.branding.enableMeetTelephony,
                disableAutoJoinAudio: d.branding.disableAutoJoinAudio,
                webdavUrl: d.branding.webdavUrl,
                webdavDomain: d.branding.webdavDomain
            },
            defaults: {
                showAddFile: "1",
                webAddFileOptions: f.web,
                iosAddFileOptions: f.ios,
                androidAddFileOptions: f.android,
                showAppReview: "1",
                showSendFeedback: "1",
                showTodo: "1",
                startMeetFromBinder: "1",
                showBinderOptions: "1",
                showBinderName: "1",
                showBinderEmailAddress: "1",
                showNewBinder: "1",
                showMeetNow: "1",
                showScheduleMeet: "1",
                showMeetShareScreen: "1",
                showMeetAudio: "1",
                showMeetVideo: "1",
                enableMeetTelephony: "1",
                disableAutoJoinAudio: "1",
                webdavUrl: "",
                webdavDomain: ""
            }
        }
    }, j = {}, k = function(a) {
        try {
            a = JSON.parse(a);
        } catch (b) {
            console.error(b), a = !0;
        }
        return a;
    };
    return j[d.branding.webHeaderLogo] = function(a, c) {
        if (!a || a == g.webLogo.url || !c.hasBranding) {
            var d = $(".mx-branding-header-logo"), e = d.attr("target"), f = b.global.homeSite;
            return "_blank" == e && d.attr("href", f), "";
        }
        if (c.ignoreStyle) return "";
        var h = '.mx-branding-header-logo, .mx-branding-meet-logo, .mx-branding-note-logo {background: url("{0}") no-repeat 0 0 !important;}';
        return a != g.webLogo.url && (h += "\r\n", h += ".mx-branding-viewer-poweredby.active {display: inline-block !important; bottom: 55px !important;}"), 
        MX.format(h, a);
    }, j[d.branding.webHeaderBgColor] = function(a, b) {
        if (!a || a == h.webHeaderBg || !b.hasBranding || b.ignoreStyle) return "";
        var c = ".mx-branding-header {background-color: {0} !important;}";
        return MX.format(c, a);
    }, j[d.branding.webMeetHeaderBgColor] = function(a, b) {
        if (!a || a == h.webMeetHeaderBg || !b.hasBranding || b.ignoreStyle) return "";
        var c = ".mx-branding-meet-header {background-color: {0} !important;}";
        return c += "\r\n", c += ".mx-branding-meet-dialog-btn {background-color: {0} !important; border-color: {0} !important; opacity: 0.85;}", 
        c += ".mx-branding-meet-dialog-btn:hover {opacity: 1;}", MX.format(c, a);
    }, j[d.branding.webMeetHeaderTextColor] = function(a, b) {
        if (!a || a == h.webMeetHeaderText || !b.hasBranding || b.ignoreStyle) return "";
        var c = ".mx-branding-meet-header .mx-branding {color: {0} !important;}";
        return c += "\r\n", c += ".mx-branding-meet-header .mx-branding.caret {border-top-color: {0} !important;}", 
        c += "\r\n", c += ".mx-branding-meet-header .meet-btn-toggle.mx-branding.active {border-color: {0} !important;}", 
        MX.format(c, a);
    }, j[d.branding.webNoteHeaderBgColor] = function(a, b) {
        if (!a || a == h.webNoteHeaderBg || !b.hasBranding || b.ignoreStyle) return "";
        var c = ".mx-branding-note-header {background-color: {0} !important;}";
        return c += "\r\n", c += ".mx-branding-note-dialog-btn {background-color: {0} !important; border-color: {0} !important; opacity: 0.85;}", 
        c += ".mx-branding-note-dialog-btn:hover {opacity: 1;}", MX.format(c, a);
    }, j[d.branding.webNoteHeaderTextColor] = function(a, b) {
        if (!a || a == h.webNoteHeaderText || !b.hasBranding || b.ignoreStyle) return "";
        var c = ".mx-branding-note-header .mx-branding {color: {0} !important;}";
        return c += "\r\n", c += ".mx-branding-note-header .mx-branding.caret {border-top-color: {0} !important;}", 
        c += "\r\n", c += ".mx-branding-note-header .meet-btn-toggle.mx-branding.active {border-color: {0} !important;}", 
        MX.format(c, a);
    }, j[d.branding.webAddFileOptions] = function(a, b) {
        if (!b.hasConfiguration) return !1;
        var c = _.clone(f.web);
        try {
            a = JSON.parse(a);
        } catch (e) {
            console.error(e), a = {};
        }
        _.extend(c, a);
        var g = function(a) {
            $("li.mx-branding-addfile-" + a).remove();
        };
        return MX.each(c, function(a, b) {
            switch (b) {
              case d.branding.plusNewPage:
                "0" == a && g("whiteboard");
                break;

              case d.branding.plusBinderPage:
                "0" == a && g("binder");
                break;

              case d.branding.plusDesktopLocal:
                "0" == a && g("desktop");
                break;

              case d.branding.plusDesktopRemote:
                "0" == a && g("remote");
                break;

              case d.branding.plusWebDoc:
                "0" == a && g("webdoc");
                break;

              case d.branding.plusDropbox:
                "0" == a && g("dropbox");
            }
        }), !1;
    }, j[d.branding.showTodo] = function(a, b) {
        return b.hasConfiguration ? !1 : !1;
    }, j[d.branding.showSendFeedback] = function(a, b) {
        return b.hasConfiguration ? (k(a) ? $(".mx-branding-send-feedback").removeClass("hide") : $(".mx-branding-send-feedback").addClass("hide"), 
        !1) : !1;
    }, {
        getDefaults: function(a) {
            var b = i[a], c = {};
            return c.DefaultLogo = g, b && _.extend(c, b.defaults, b.extra), c;
        },
        genModel: function(b, c) {
            var d, e = i[b], f = {};
            f.DefaultLogo = g, e ? (MX.each(e.keys, function(a, b) {
                var d = c.get(a) || {};
                if (a && 0 === a.indexOf("JSON_")) {
                    try {
                        f[b] = JSON.parse(d.string_value);
                    } catch (g) {
                        console.error(g), f[b] = {};
                    }
                    f[b] = _.extend(e.defaults[b], f[b]);
                } else f[b] = d.string_value || e.defaults[b];
            }), e.extra && _.extend(f, e.extra), d = a.Model.extend(e.defaults)) : d = a.Model.extend({});
            var h = new d();
            return h.set(f);
        },
        genCollection: function(b) {
            var c, d = a.Collection.extend({});
            return c = new d(), c.reset(b), c;
        },
        loadStyle: function() {
            var a = MX.get("tags", Moxtra.getMyGroup());
            if (a) {
                var b = {
                    hasBranding: e.hasBranding(),
                    hasConfiguration: e.hasConfiguration()
                }, c = d.style.brandingId, f = [];
                $("#" + c).length && $("#" + c).remove(), f.push('<style id="' + c + '">'), MX.each(j, function(c, d) {
                    var e, g = a.get(d);
                    g && (e = c(g.string_value, b), e && MX.isString(e) && f.push(e));
                }), f.push("</style>"), 2 != f.length && $("html head").append(f.join("\r\n"));
            }
        },
        loadMeetStyle: function(a) {
            var b, c = {}, e = d.style.meetBrandingId, f = [], g = [ d.branding.webHeaderLogo, d.branding.webMeetHeaderBgColor, d.branding.webMeetHeaderTextColor ];
            if ($("#" + e).length && $("#" + e).remove(), a) {
                if (b = a.get("tags"), c.hasBranding = a.get("group_caps.has_branding"), c.hasConfiguration = a.get("group_caps.has_configuration"), 
                f.push('<style id="' + e + '">'), MX.each(j, function(a, d) {
                    if (g.indexOf(d) > -1) {
                        var e, h = b.get(d);
                        h && (e = a(h.string_value, c), e && MX.isString(e) && f.push(e));
                    }
                }), f.push("</style>"), 2 == f.length) return;
                $("html head").append(f.join("\r\n"));
            }
        },
        getAddFileOptions: function(a) {
            if (a = a || "web", [ "web", "ios", "android" ].indexOf(a) < 0 && (a = "web"), !e.hasConfiguration()) return _.extend({}, f[a]);
            var b = MX.get("tags", Moxtra.getMyGroup()), c = _.clone(f[a]), g = {};
            if (b) {
                var h = b.get(d.branding.webAddFileOptions);
                try {
                    h && (g = JSON.parse(h.string_value));
                } catch (i) {
                    console.error(i), g = {};
                }
                _.extend(c, g);
            }
            return c;
        },
        isShowAddFile: function(a) {
            return this._getTagBoolValue(d.branding.showAddFile, a);
        },
        isShowTodo: function() {
            return this._getTagBoolValue(d.branding.showTodo);
        },
        isShowMeetInBinder: function() {
            return this._getTagBoolValue(d.branding.startMeetFromBinder);
        },
        isShowFeedback: function() {
            return this._getTagBoolValue(d.branding.showSendFeedback);
        },
        isShowBinderOptions: function() {
            return this._getTagBoolValue(d.branding.showBinderOptions);
        },
        isShowBinderName: function() {
            return this._getTagBoolValue(d.branding.showBinderName);
        },
        isShowBinderEmailAddress: function() {
            return this._getTagBoolValue(d.branding.showBinderEmailAddress);
        },
        isShowNewBinder: function() {
            return this._getTagBoolValue(d.branding.showNewBinder);
        },
        isShowMeetNow: function() {
            return this._getTagBoolValue(d.branding.showMeetNow);
        },
        isShowScheduleMeet: function() {
            return this._getTagBoolValue(d.branding.showScheduleMeet);
        },
        isShowMeetShareScreen: function(a) {
            return this._getTagBoolValue(d.branding.showMeetShareScreen, a);
        },
        isShowMeetAudio: function(a) {
            return this._getTagBoolValue(d.branding.showMeetAudio, a);
        },
        isShowMeetVideo: function(a) {
            return this._getTagBoolValue(d.branding.showMeetVideo, a);
        },
        _getTagBoolValue: function(a, b) {
            var c, d, f = !0;
            if (b) {
                if (!b.get("group_caps.has_configuration")) return !0;
                c = b.get("tags");
            } else {
                if (!e.hasConfiguration()) return !0;
                c = MX.get("tags", Moxtra.getMyGroup());
            }
            return c && (d = c.get(a) || {}, "0" == d.string_value && (f = !1)), f;
        },
        getNotificationIcon: function() {
            var a = MX.get("tags", Moxtra.getMyGroup()), b = g.notification.url;
            if (e.hasBranding() && a) {
                var c = a.get(d.branding.notificationIcon) || {};
                c.string_value && (b = c.string_value);
            }
            return b;
        },
        genUploader: function(a) {
            if (MX.ui.brandingUploader) {
                a = a || {};
                var b = a.name, d = a.button || a.name + "_flash", e = a.size, f = MX.get("id", Moxtra.getMyGroup()) || Moxtra.getMe().groupId;
                MX.ui.brandingUploader.register(b, {
                    browse_button: d,
                    filters: {
                        mime_types: [ {
                            title: c.image_files,
                            extensions: "jpeg,jpg,gif,png"
                        } ]
                    },
                    showNotification: !0,
                    multi_selection: !1,
                    url: function() {
                        var a = "/group/" + f + "/upload?width={{width}}&height={{height}}";
                        return MX.format(a, e);
                    },
                    success: function(b, c) {
                        var d = {};
                        try {
                            d = JSON.parse(c.response);
                        } catch (e) {
                            console.error(e);
                        }
                        if (a.success) {
                            var f = MX.get("object.group.resources.0.sequence", d), g = MX.get("object.group.id", d), h = "";
                            f && (h = g ? MX.format("/group/{0}/resource/{1}", g, f) : MX.format("/group/resource/{0}", f)), 
                            a.success(h);
                        }
                    },
                    error: function() {
                        a.error && a.error();
                    }
                });
            }
        },
        refreshUploader: function(a, b) {
            MX.ui.brandingUploader && MX.ui.brandingUploader.refresh(a, b);
        },
        destroyUploader: function(a) {
            if (MX.ui.brandingUploader) {
                var b = MX.get("modules." + a + ".element", MX.ui.brandingUploader);
                MX.ui.brandingUploader.unregister(a), b && b.remove();
            }
        },
        checkColor: function(a) {
            var b = {
                RGBA: function(a) {
                    var b = /^rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(a);
                    return b ? b[0] : void 0;
                },
                "RGBA%": function(a) {
                    var b = /^rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(a);
                    return b ? b[0] : void 0;
                },
                "#HEX": function(a) {
                    var b = /^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/.exec(a);
                    return b ? b[0] : void 0;
                },
                "#HEX3": function(a) {
                    var b = /^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/.exec(a);
                    return b ? b[0] : void 0;
                },
                HEX: function(a) {
                    var b = /^([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/.exec(a);
                    return b ? "#" + b[0] : void 0;
                },
                HEX3: function(a) {
                    var b = /^([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/.exec(a);
                    return b ? "#" + b[0] : void 0;
                }
            }, c = "";
            return MX.each(b, function(b) {
                return c = b(a), c ? !1 : void 0;
            }), c;
        },
        buildTags: function(a, b, c, e) {
            var f = [];
            if (!a) return f;
            var g = i[b], h = a.tags, j = [ d.branding.showAddFile, d.branding.showAppReview, d.branding.showSendFeedback, d.branding.showTodo, d.branding.startMeetFromBinder, d.branding.showBinderOptions, d.branding.showBinderName, d.branding.showBinderEmailAddress, d.branding.showNewBinder, d.branding.showMeetNow, d.branding.showScheduleMeet, d.branding.showMeetShareScreen, d.branding.showMeetAudio, d.branding.showMeetVideo, d.branding.enableMeetTelephony, d.branding.disableAutoJoinAudio, d.branding.showNoteWatermark ];
            return g && h && MX.each(g.keys, function(a, b) {
                var d = c[b];
                if (!MX.isUndefined(d)) {
                    var i = h.get(a);
                    if (e) i && (i.set("string_value", ""), f.push(i)); else {
                        var k = g.defaults[b], l = !1;
                        a && 0 == a.indexOf("JSON_") && (d = JSON.stringify(d), l = !0), (d != k || j.indexOf(a) > -1) && (l = !0), 
                        l ? (i || (i = new Moxtra.model.BoardTag(), i.set("name", a)), i.set("string_value", d), 
                        f.push(i)) : i && (i.set("string_value", ""), f.push(i));
                    }
                }
            }), f;
        }
    };
}), define("component/templateHelper", [ "text!template/user/avatarView.html", "text!template/viewer/audioView.html", "text!template/viewer/videoView.html", "text!template/component/addPageMenu.html", "text!template/common/binderCover.html", "text!template/common/boardAvatar.html", "text!template/mx/mxThumbnail.html", "text!template/mx/mxUserAvatarGroup.html", "text!template/mx/mxButton.html", "text!template/mx/mxLinkButton.html", "text!template/mx/mxCheckbox.html", "text!template/mx/mxRadio.html", "../lang", "app", "admin/branding/helper", "const" ], function(avatarView, audioView, videoView, addPageMenu, binderCover, boardAvatar, mxThumbnailView, mxUserAvatarGroup, mxButton, mxLinkButton, mxCheckbox, mxRadio, lang, app, brandingHelper, consts) {
    function addTemplateToHandlebars(a, b) {
        var c = Handlebars.compile(b);
        Handlebars.registerHelper(a, function() {
            for (var a = arguments, b = {
                lang: lang
            }, d = 0; d < a.length - 1; d++) b = MX.extend(b, a[d]);
            var e = c(MX.extend({
                lang: lang,
                "const": consts
            }, b));
            return new Handlebars.SafeString(e);
        });
    }
    addTemplateToHandlebars("avatarView", avatarView), addTemplateToHandlebars("videoView", videoView), 
    addTemplateToHandlebars("audioView", audioView), addTemplateToHandlebars("binderCover", binderCover), 
    addTemplateToHandlebars("boardAvatar", boardAvatar);
    var tplAddPageMenu = Handlebars.compile(addPageMenu);
    Handlebars.registerHelper("addPageMenu", function(a, b) {
        var c = [], d = [], e = {};
        if (app.isIntegrationEnabled()) {
            var f, g = app.integration.get("extension");
            if (g) {
                try {
                    f = JSON.parse(0 === g.indexOf("{") ? g : decodeURIComponent(g));
                } catch (h) {
                    console.error(h);
                }
                var i = f && f.menus && f.menus[0].add_page || [];
                MX.each(i, function(a) {
                    "top" === a.position && c.push(a), "bottom" === a.position && d.push(a), a.display === !1 && (e[a.menu_name] = !0);
                });
            }
            "sf" === app.integration.get("type") && c.push({
                action: "addpage",
                menu_name: lang.salesforce_document,
                position: "top"
            });
        }
        var j = brandingHelper.getAddFileOptions();
        (app.isIntegrationEnabled() || app.accessFromChina()) && (j[consts.branding.plusDropbox] = "0"), 
        app.isIntegrationEnabled() && (j[consts.branding.plusDesktopRemote] = "0");
        var k = tplAddPageMenu({
            lang: lang,
            className: a,
            session_key: b,
            top_menus: c,
            bottom_menus: d,
            hide_menus: e,
            addOptions: j
        });
        return new Handlebars.SafeString(k);
    }), Handlebars.registerHelper("groupEach", function(a, b) {
        var c, d = b.fn, e = b.inverse, f = 0, g = "", h = toString.call(a);
        if (h === functionType && (a = a.call(this)), b.data && (c = Handlebars.createFrame(b.data)), 
        a && "object" == typeof a) if (a instanceof Array) for (var i = a.length; i > f; f++) c && (c.index = f), 
        g += d(a[f], {
            data: c
        }); else for (var j in a) a.hasOwnProperty(j) && (c && (c.key = j), g += d(a[j], {
            data: c
        }), f++);
        return 0 === f && (g = e(this)), g;
    }), Handlebars.registerHelper("when", function(v1, operator, v2, options) {
        return MX.isFunction(v2) && (v2 = v2()), MX.isFunction(v1) && (v1 = v1()), eval("v1 " + operator + " v2") ? options.fn(this) : void 0;
    }), Handlebars.registerHelper("ifCond", function(a, b, c, d) {
        switch (b) {
          case "==":
            return a == c ? d.fn(this) : d.inverse(this);

          case "!=":
            return a != c ? d.fn(this) : d.inverse(this);

          case "===":
            return a === c ? d.fn(this) : d.inverse(this);

          case "!==":
            return a !== c ? d.fn(this) : d.inverse(this);

          case "&&":
            return a && c ? d.fn(this) : d.inverse(this);

          case "||":
            return a || c ? d.fn(this) : d.inverse(this);

          case "<":
            return c > a ? d.fn(this) : d.inverse(this);

          case "<=":
            return c >= a ? d.fn(this) : d.inverse(this);

          case ">":
            return a > c ? d.fn(this) : d.inverse(this);

          case ">=":
            return a >= c ? d.fn(this) : d.inverse(this);

          default:
            return a == c ? d.fn(this) : d.inverse(this);
        }
    }), Handlebars.registerHelper("lowercase", function(a) {
        return a.toLowerCase();
    }), Handlebars.registerHelper("uppercase", function(a) {
        return a.toUpperCase();
    }), Handlebars.registerHelper("capitalizeFirst", function(a) {
        return a.charAt(0).toUpperCase() + a.substring(1).toLowerCase();
    }), Handlebars.registerHelper("linkMode", function(a) {
        var b = /\b(?:mailto:)?([\w.]+@[-a-z\d]+(?:\.[-a-z\d]+){1,2})\b|\b((?:((?:ftp|file|https?):\/\/)|(www\.))([-a-z\d]+(?:\.[-a-z\d]+)*(?:\:\d+)?(\?[^\/\(\)\{\}\s\[\]]+)?(?:\/[^\/\(\)\{\}\s\[\]]+)*\/?))(?=(?:$|[\s\n\)\]]))(?![^\[](.+?)\[\/url\])/gi;
        return new Handlebars.SafeString(Handlebars.Utils.escapeExpression(a || "").replace(b, function(a, b, c, d, e, f) {
            return b ? '<a href="mailto:' + b + '">' + a + "</a>" : c ? (d || (d = "http://" + e), 
            '<a href="' + d + f + '" target="_blank" >' + c + "</a>") : void 0;
        }).replace(/\n/g, "<br/>").replace(/\t/g, "&nbsp;&nbsp;&nbsp;&nbsp;"));
    }), Handlebars.registerHelper("chatFormat", function(a, b) {
        return b ? (a = Handlebars.helpers.linkMode(a), a = a.string) : (a = Handlebars.Utils.escapeExpression(a || ""), 
        a = a.replace(/\n/g, "<br/>").replace(/\t/g, "&nbsp;&nbsp;&nbsp;&nbsp;")), Handlebars.helpers.bbcode(a);
    }), Handlebars.registerHelper("formatter", function(a, b) {
        var c = "";
        return MX.lang[a] && MX.lang[a].constructor === Function && (c = MX.lang[a](b)), 
        c;
    }), Handlebars.registerHelper("formatShortTime", function(a) {
        var b = Moxtra.getMe().timezone || "";
        if (!a) return "";
        try {
            return moment(a).tz(b).format("h:mm A");
        } catch (c) {
            return console.error(c), moment(a).format("h:mm A");
        }
    }), Handlebars.registerHelper("formatFullDateTime", function(a) {
        var b = Moxtra.getMe().timezone || "";
        if (!a) return "";
        try {
            return moment(a).tz(b).format("LLL");
        } catch (c) {
            return console.error(c), moment(a).format("LLL");
        }
    }), Handlebars.registerHelper("formatDuration", function(a) {
        var b, c, d, e = moment.duration(a), f = [];
        return b = e.hours(), c = e.minutes(), d = e.seconds(), d && (c += 1), c >= 60 && (b += 1, 
        c -= 60), b && (f.push(b), f.push(lang.hr)), c && (f.push(c), f.push(lang.min)), 
        f.join(" ");
    }), Handlebars.registerHelper("brandDemoHighlightBorder", function(a) {
        var a = a.toUpperCase();
        return "#FFF" == a || "#FFFFFF" == a ? "highlight-border" : "";
    }), Handlebars.registerHelper("brandDemoHighlightBg", function(a) {
        var a = a.toUpperCase();
        return "#FFF" == a || "#FFFFFF" == a ? "highlight-bg" : "";
    }), Handlebars.registerHelper("boardAvatarClass", function(a) {
        return 1 === a ? 1 : a > 5 ? 5 : a;
    }), Handlebars.registerHelper("formatServiceCustomizeTemplate", function(a) {
        var b, c = {
            chat: lang.service_customize_template_chat_note,
            page: lang.service_customize_template_page_note,
            todo: lang.service_customize_template_todo_note
        };
        return a = a || "", b = a.split(",") || [], c[b[0]] || c.chat;
    }), Handlebars.registerHelper("formatPostAs", function(a) {
        var b, c = {
            chat: lang.post_as_chat,
            page: lang.post_as_page,
            todo: lang.post_as_todo
        }, d = [];
        return a = a || "", b = a.split(",") || [], b.forEach(function(a) {
            try {
                a = a.trim();
            } catch (b) {
                console.error(b);
            }
            c[a] && d.push(c[a]);
        }), d.join(", ");
    }), Handlebars.registerHelper("formatPostAsFrom", function(a, b, c) {
        var d, e = Handlebars.helpers.formatPostAs(a);
        return d = c ? c : Handlebars.helpers.formatServiceName(b), MX.format(lang.post_action_from_service, {
            postAction: e,
            serviceName: d
        });
    }), Handlebars.registerHelper("formatPostAsTo", function(a, b) {
        var c = Handlebars.helpers.formatPostAs(a), b = b || "";
        return MX.format(lang.post_action_to_binder, {
            postAction: c,
            binderName: b
        });
    }), Handlebars.registerHelper("formatServiceName", function(a, b) {
        var c, d = MX.get("services.name", app.config) || {};
        return c = d[a] || a || "", MX.isString(b) ? MX.format(b, {
            service: c
        }) : c;
    }), Handlebars.registerHelper("formatCreatedByOnDate", function(a, b) {
        var a = a || "", c = Handlebars.helpers.formatDatetime(b);
        return MX.format(lang.created_by_actor_on_date, {
            actor: a,
            date: c
        });
    }), Handlebars.registerHelper("formatServiceSite", function(a) {
        var b, c, d = MX.get("services.name", app.config) || {}, e = MX.get("services.site", app.config) || {};
        return b = d[a] || "", c = e[a] || "", b && c ? MX.format('<a href="{0}" target="_blank">{1}</a>', c, b) : "<a>" + a + "</a>";
    }), Handlebars.registerHelper("formatServiceSummary", function(a) {
        var b = lang[a + "_summary"] || "";
        return b ? Handlebars.helpers.bbcode(b) : Handlebars.helpers.formatServiceSite(a);
    }), Handlebars.registerHelper("imgSrcL10n", function(a) {
        a = a || "";
        var b = Moxtra.getMe().language, c = a.split("/") || [], d = [];
        return "themes" === c[0] && "images" === c[1] && b && "en" !== b ? (c.forEach(function(a, c) {
            d.push(a), 1 === c && d.push(b);
        }), new Handlebars.SafeString(MX.format(' src="{0}" onerror="this.src=\'{1}\'" ', d.join("/"), a))) : new Handlebars.SafeString(MX.format(' src="{0}" ', a));
    }), Handlebars.registerHelper("qualityIndicator", function(a) {
        var b = '<i class="micon-network-{0} lossrate-indicator {1}"></i>', c = "";
        return a === consts.meet.network.quality.bad && (c = MX.format(b, "disabled", "red")), 
        new Handlebars.SafeString(c);
    }), Handlebars.registerHelper("i18nCount", function(a, b, c) {
        var d = "";
        return 1 === a || 0 === a ? d = a + " " + (b || "") : a > 1 && (d = a + " " + (c || "")), 
        d;
    }), Handlebars.registerHelper("thumbByBoardId", function(a) {
        var b = Moxtra.getBoard(a);
        return b ? Handlebars.helpers.boardAvatar({
            board: b,
            tipName: !0,
            defaultBoardAvatar: Moxtra.config.defaults.binder_cover_project
        }, a) : "";
    }), Handlebars.registerHelper("formatWebhookUrl", function(a, b) {
        var c = MX.format('<code class="mx-inline-code">{0}</code>', b), d = MX.format(a, {
            webhook_url: c
        });
        return Handlebars.helpers.bbcode(d);
    }), Handlebars.registerHelper("mxButton", function(a, b, c, d) {
        var e = Handlebars.compile(mxButton), f = {
            type: a || "btn-default",
            label: b,
            hasAction: !1,
            hasIcon: !1
        };
        return "string" == typeof c && (f.action = c, f.hasAction = !0), "string" == typeof d && (f.hasIcon = !0, 
        f.icon = d), new Handlebars.SafeString(e(f));
    }), Handlebars.registerHelper("mxLinkButton", function(a, b, c, d) {
        var e = Handlebars.compile(mxLinkButton), f = {
            type: a || "btn-default",
            label: b,
            hasAction: !1,
            hasIcon: !1
        };
        return "string" == typeof c && (f.action = c, f.hasAction = !0), "string" == typeof d && (f.hasIcon = !0, 
        f.icon = d), new Handlebars.SafeString(e(f));
    }), Handlebars.registerHelper("mxThumbnail", function(a, b, c, d) {
        b !== !0 && (b = !1);
        var e = Handlebars.compile(mxThumbnailView), f = {
            info: a,
            online: b,
            className: c,
            hasCount: !1
        };
        return 0 !== d && (f.count = d, f.hasCount = !0), new Handlebars.SafeString(e(f));
    }), Handlebars.registerHelper("mxUserAvatar", function(a) {
        return Handlebars.helpers.mxThumbnail(a.avatar, a.user.online, "mx-user-avatar", a.feed_unread_count);
    }), Handlebars.registerHelper("mxUserAvatarGroup", function(a) {
        var b = a.feed_unread_count, c = a.board.members, d = Moxtra.getMe().id, e = [];
        c.forEach(function(a, b) {
            a.user.id == d && c.splice(b, 1);
        }), c.forEach(function(a, b) {
            3 > b && (e.push(a), a.feed_unread_count = 0);
        });
        var f = {
            users: e
        }, g = e.length;
        1 == g && (f.className = "mx-count-2"), 2 == g && (f.className = "mx-count-3"), 
        3 == g && (f.className = "mx-count-4"), 0 !== b && (f.count = b, f.hasCount = !0);
        var h = Handlebars.compile(mxUserAvatarGroup);
        return h(f);
    }), Handlebars.registerHelper("mxBoardThumbnail", function(a) {
        return Handlebars.helpers.mxThumbnail(a.thumbnail, !1, "mx-binder-thumbnail", a.feed_unread_count);
    }), Handlebars.registerHelper("mxUserBoardThumbnail", function(a) {
        return Handlebars.helpers.mxThumbnail(a.board.thumbnail, !1, "mx-binder-thumbnail", a.feed_unread_count);
    }), Handlebars.registerHelper("mxPageThumbnail", function(a) {
        return Handlebars.helpers.mxThumbnail(a.thumbnail, !1, "mx-page-thumbnail", 0);
    }), Handlebars.registerHelper("mxGroupThumbnail", function(a) {
        return Handlebars.helpers.mxThumbnail(a.thumbnail, !1, "mx-group-thumbnail", 0);
    }), Handlebars.registerHelper("mxCheckbox", function(a, b, c, d) {
        var e = {
            text: a,
            name: b,
            id: c,
            checked: d
        }, f = Handlebars.compile(mxCheckbox);
        return new Handlebars.SafeString(f(e));
    }), Handlebars.registerHelper("mxRadio", function(a, b, c, d) {
        var e = {
            text: a,
            name: b,
            id: c,
            checked: d
        }, f = Handlebars.compile(mxRadio);
        return new Handlebars.SafeString(f(e));
    });
}), define("common/search", [ "moxtra", "lang", "app", "text!template/common/search.html", "text!template/common/searchUserItem.html", "text!template/common/searchBinderItem.html", "text!template/common/searchBinderPageItem.html", "text!template/common/searchTeamItem.html", "const", "binder/binderBiz", "meet/meet", "common/searchUserOption", "component/templateHelper" ], function(a, b, c, d, e, f, g, h, i, j, k, l) {
    "use strict";
    var m = a.Model.extend({
        defaults: {
            sequence: void 0,
            avatar: "",
            type: "",
            name: "",
            url: ""
        }
    }), n = /[^\x00-\xff]/;
    return a.Controller.extend({
        template: d,
        handleAction: !0,
        events: {
            "keyup #searchKey": "onKeyUp"
        },
        init: function(a) {
            this.$scope.lang = b, this.binders = new Moxtra.Collection({
                model: "Moxtra.model.UserBoard",
                attributeId: "board.id",
                reverseOrder: !0,
                unique: !0
            }), this.teams = new Moxtra.Collection({
                model: "Moxtra.model.UserGroup",
                attributeId: "group.id",
                index: "sequence"
            }), this.searchSeed = null;
            this.listenTo(a.request, "change:params.search", this.search), this.opts = a;
        },
        updateTitleCount: function(a) {
            var b, c = this;
            "binders" === a && (b = this.binders && this.binders.length || 0, c.$(".binders.count").text("(" + b + ")"), 
            c.handlePanel("#binderResult", "#searchBindersBox", b)), "teams" === a && (b = this.teams && this.teams.length || 0, 
            c.$(".teams.count").text("(" + b + ")"), c.handlePanel("#teamsList", "#searchTeamsBox", b)), 
            "contacts" === a && (b = this.contacts && this.contacts.length || 0, c.$(".contacts.count").text("(" + b + ")"), 
            c.handlePanel("#contactsList", "#searchContactsBox", b)), "bizcontacts" === a && (b = this.bizContacts && this.bizContacts.length || 0, 
            c.$(".biz-contacts.count").text("(" + b + ")"), c.handlePanel("#bizContactsResult", "#bizContactsBox", b));
        },
        rendered: function() {
            var d = Moxtra.getMe(), g = this;
            this.listenTo(d, "firstSubscribe", function() {
                g.$("#searchKey").prop("disabled", !1), this.$(".search-contacts").empty(), this.$(".search-teams").empty(), 
                this.$("#binders").empty(), this.$("#bizContacts").empty(), this.contactList = new a.List({
                    renderTo: this.$(".search-contacts"),
                    emptyTemplate: "<p class='empty'>" + b.search_no_contact_found + "</p>",
                    template: e,
                    lazyload: !1,
                    $scope: {
                        lang: b,
                        blankImg: i.defaults.blankImg,
                        meetTabName: c.config.global.meetTabName
                    }
                }), this.recovery(this.contactList);
                var j = Moxtra.getMe().primaryKey, k = Moxtra.config.defaults;
                this.recovery(new a.List({
                    tagName: "div",
                    renderTo: this.$("#binders"),
                    collection: this.binders,
                    emptyTemplate: "<p class='empty'>" + b.search_no_binder_found + "</p>",
                    template: f,
                    lazyload: !1,
                    $scope: {
                        lang: b,
                        boardType: "binder",
                        blankImg: i.defaults.blankImg,
                        defaultUserAvatar: i.defaults.user.avatar,
                        defaultBoardAvatar: k.binder_cover,
                        myself: j
                    }
                })), this.recovery(new a.List({
                    tagName: "div",
                    renderTo: this.$(".search-teams"),
                    collection: this.teams,
                    emptyTemplate: "<p class='empty'></p>",
                    template: h,
                    lazyload: !1,
                    hideLoading: !0,
                    $scope: {
                        lang: b
                    }
                })), d.groupId ? (this.bizContactsList = new a.List({
                    tagName: "div",
                    renderTo: this.$("#bizContacts"),
                    emptyTemplate: "<p class='empty'>" + b.search_no_contact_found + "</p>",
                    lazyload: !1,
                    template: e,
                    $scope: {
                        lang: b,
                        blankImg: i.defaults.blankImg
                    }
                }), this.recovery(this.bizContactsList)) : this.$("#bizContactsBox").hide();
            }), $(document.body).click("click", function(a) {
                g.isShow && ($(a.target).closest(".mx-search").size() || g.removeSearchKey(!0));
            });
        },
        handlePanel: function(a, b, c) {
            var d, e = $(a), f = $(b), g = [ "#searchTeamsBox" ].indexOf(b) > -1;
            e.height(c > 0 ? "auto" : "0"), d = e.parent().find('[href="' + a + '"]'), 1 > c ? (g && f.addClass("hide"), 
            d.addClass("collapsed"), e.removeClass("in").addClass("collapse")) : (g && f.removeClass("hide"), 
            d.removeClass("collapsed"), e.removeClass("collapse").addClass("in"));
        },
        startMeet: function(a) {
            var c = this.handleEvent;
            c.stopPropagation();
            var d = this.getUserInfo(a);
            this.removeSearchKey(), k.start({
                users: [ d ],
                success: function() {},
                error: function() {
                    MX.ui.notifyError(b.contact_start_meet_failed);
                }
            });
        },
        getUserInfo: function(a) {
            var b = this.contacts.get(a);
            if (b || (b = this.bizContacts.get(a)), !b) return null;
            var c, d = {};
            return (c = b.get("user.email")) && (d.email = c), (c = b.get("user.id")) && (d.id = c), 
            d;
        },
        accessUser: function(a) {
            function c() {
                Moxtra.startChat(g).success(function(a) {
                    h.opts.request.navigate("timeline/" + a.id);
                }).error(function() {
                    MX.ui.notifyError(b.contact_start_chat_failed);
                });
            }
            function d() {
                var a = g.id || g.email;
                h.opts.request.navigate("contacts/" + a + "/1");
            }
            function e() {
                new MX.ui.Dialog({
                    width: 440,
                    content: new l({
                        onStartChat: function() {
                            this.dialog.close(), c();
                        },
                        onViewProfile: function() {
                            this.dialog.close(), d();
                        }
                    })
                });
            }
            var f = this.handleEvent;
            f.stopPropagation();
            var g = this.getUserInfo(a), h = this;
            h.removeSearchKey(), Moxtra.loadChatWithUser([ g ]).success(function(a) {
                a ? c() : e();
            }).error(function() {
                e();
            });
        },
        onKeyUp: function(a) {
            var b = $(a.target), c = $.trim(b.val()), d = this, e = c.length;
            c.length > 0 ? this.$(".input-close").removeClass("hide") : this.$(".input-close").addClass("hide"), 
            clearTimeout(this.searchSeed), n.test(c) && (e = 2 * e), e >= 2 || a.keyCode === i.keys.Enter ? this.searchSeed = setTimeout(function() {
                d.search(c, a.keyCode === i.keys.Enter);
            }, 500) : this.hideResult();
        },
        gotoUserDetail: function(a) {
            "contacts" === this.opts.request.module() ? (this.opts.request.router.navigate("no-url", {
                trigger: !0
            }), this.opts.request.router.navigate("contacts/" + a + "/1", {
                trigger: !0
            })) : this.opts.request.navigate("contacts", a, 1), this.removeSearchKey();
        },
        gotoBinder: function(a, b) {
            var c = this.opts.request;
            "group" === b ? c.navigate("library", a) : c.navigate("timeline", a), this.removeSearchKey();
        },
        gotoBinderPage: function(a, b, c, d) {
            "group" === c ? "todo" === d ? this.opts.request.navigate("library", a, null, {
                seq: b
            }) : this.opts.request.navigate("library", a, b) : "todo" === d ? this.opts.request.navigate("timeline", a, null, {
                tab: "tab_todo",
                seq: b
            }) : "chat" === d ? this.opts.request.navigate("timeline", a, null, {
                tab: "tab_chat",
                seq: b
            }) : this.opts.request.navigate("timeline", a, b), this.removeSearchKey();
        },
        gotoTeam: function(a) {
            this.opts.request.navigate("contacts", a, 4), this.removeSearchKey();
        },
        search: function(a, b) {
            if (b || a && !(a.length < 1) && this.key !== a) {
                a = $.trim(a.toLowerCase()), this.contacts = Moxtra.getUserContacts(function(b) {
                    var c = (MX.get("user.first_name", b) || "").toLowerCase(), d = (MX.get("user.last_name", b) || "").toLowerCase(), e = (MX.get("user.name", b) || c + " " + d).toLowerCase(), f = (MX.get("user.email", b) || "").toLowerCase(), g = MX.get("user.phone_number", b) || "";
                    return Moxtra.api.filter.filterUser(a, [ c, d, e, f, g ]);
                }), this.contactList.binding(this.contacts), this.updateTitleCount("contacts"), 
                this.$(".mx-search").show(), this.isShow || (this.isShow = !0), this.searchTeam(a), 
                this.binders.clear();
                var c, d, e = Moxtra.model.Root.user.boards, f = [], g = Moxtra.api.util.getBoardName;
                e.each(function(b) {
                    Moxtra.api.filter.isTimelineData(b) && (d = b.board || {}, c = g(b).toLowerCase(), 
                    c.indexOf(a) > -1 && "BOARD_MEMBER" === b.status && f.push(b));
                }), this.binders.push(f, !0), this.updateTitleCount("binders"), this.searchBizContact(a), 
                (a.length >= 2 || b) && this.searchBinderFromServer(a), this.key = a;
            }
        },
        searchTeam: function(a) {
            var b = [];
            this.teams.clear(), Moxtra.getMe().groups.each(function(c) {
                if (MX.get("type", c.group) === Moxtra.const.GROUP_TYPE_TEAM) {
                    var d = MX.get("name", c.group) || "";
                    d.toLowerCase().indexOf(a) > -1 && b.push(c);
                }
            }), this.teams.push(b), this.updateTitleCount("teams");
        },
        searchBizContact: function(a) {
            var b, c, d = Moxtra.getMyGroup();
            d && (this.bizContacts = d.members.clone({
                filterFn: function(d) {
                    return c = d.user, b = [], b.push(c.name), b.push(c.email), b.push(c.phone_number), 
                    b.push(d.division), b.push(d.department), b = b.join("|").toLowerCase(), b.indexOf(a) > -1 ? !0 : void 0;
                }
            }), this.bizContactsList.binding(this.bizContacts), this.updateTitleCount("bizcontacts"));
        },
        searchBinderFromServer: function(a) {
            var b = Moxtra.getMe(), c = Moxtra.cache("UserBoard"), d = this;
            b.search(a).success(function(a) {
                if (a = MX.get("object.user.boards", a)) {
                    for (var b, e, f = a.length - 1, g = (Moxtra.model.Root.user.boards, []); f > -1; f--) b = a[f], 
                    e = b.board, "BOARD_MEMBER" === b.status && (b = c.push(b)) && g.push(b);
                    d.binders.push(g), d.updateTitleCount("binders");
                }
            });
        },
        searchBinderContent: function(c, d) {
            this.handleEvent.stopPropagation();
            var e = $(this.handleEvent.currentTarget), f = e.closest(".mx-item").parent();
            if (f.hasClass("open")) f.removeClass("open"), e.find("i").addClass("micon-arrow-right").removeClass("micon-arrow-down"); else {
                e.find("i").removeClass("micon-arrow-right").addClass("micon-arrow-down");
                var h = e.closest(".search-binders").find(".open").removeClass("open").find(".micon-arrow-down");
                h.length && h.removeClass("micon-arrow-down").addClass("micon-arrow-right");
                var k = f.addClass("open").find(".binder-content");
                if (k.data("loaded")) return;
                var l = $("#searchKey").val();
                k.loading("smallBlank");
                var n = new (a.Collection.extend({
                    idAttribute: "sequence",
                    model: m
                }))();
                this.pagesList = new a.List({
                    tagName: "div",
                    renderTo: k,
                    collection: n,
                    emptyTemplate: "<p class='empty'>" + b.search_no_result + "</p>",
                    template: g,
                    lazyload: !1,
                    syncModel: !0,
                    $scope: {
                        lang: b,
                        boardType: d,
                        boardId: c,
                        blankImg: i.defaults.blankImg
                    }
                }), k.data("loaded", !0), j.searchOneBinder(c, l).success(function(a) {
                    Moxtra.loadBoard(c, {
                        withOutCache: !0
                    }).success(function(b) {
                        k.loading(!1);
                        var c = MX.get("object.board.pages", a), d = MX.get("object.board.comments", a), e = MX.get("object.board.feeds", a), f = MX.get("object.board.todos", a), g = MX.get("object.board.page_groups", a), h = [], i = {};
                        MX.each(d, function(a) {
                            i[a.sequence] = a;
                        }), MX.each(e, function(a) {
                            var b = i[MX.get("board.comments.0.sequence", a)];
                            b && h.push({
                                sequence: a.sequence,
                                type: "chat",
                                icon: "micon-chat",
                                name: b.text
                            });
                        });
                        var j, l, m, o;
                        MX.each(c, function(a) {
                            j = b.pages.get(a.sequence), m = b.resources.get(j.original_resource_sequence), 
                            j && h.push({
                                sequence: a.sequence,
                                name: j.name || m && m.name || "Page",
                                type: "page",
                                icon: "micon-page"
                            });
                        }), MX.each(g, function(a) {
                            o = b.page_groups.get(a.sequence), o && h.push({
                                sequence: a.client_uuid,
                                name: o.name || m && m.name || "Page",
                                type: "page",
                                icon: "micon-page"
                            });
                        }), MX.each(f, function(a) {
                            l = b.todos.get(a.sequence), l && h.push({
                                sequence: a.sequence,
                                name: l.name,
                                type: "todo",
                                icon: "micon-todo-empty"
                            });
                        }), n.reset(h, {
                            parse: !0
                        });
                    });
                }).error(function() {
                    k.data("loaded", !1);
                });
            }
        },
        hideResult: function() {
            this.isShow && (this.isShow = !1, this.$(".mx-search").hide(), this.key = null, 
            this.binders && this.binders.clear(), this.teams && this.teams.clear(), this.contacts && this.contacts.reset([]), 
            this.bizContacts && this.bizContacts.reset([]), this._destroy([ "contacts", "bizContacts" ]));
        },
        _destroy: function(a) {
            var b = this;
            MX.each(a, function(a) {
                b[a] && b[a].destroy && (b[a].destroy(), b[a] = null);
            });
        },
        removeSearchKey: function(a) {
            this.hideResult(), this.$(".input-close").addClass("hide"), this.$("#searchKey").val(""), 
            a !== !0 && this.$("#searchKey").focus();
        }
    });
}), define("text!template/common/favorite.html", [], function() {
    return '<div class="ta-favorite-list">\n	{{!-- js-show-favorite in app.js --}}\n    <span class="mx-header-favorite micon-star-empty size16 js-show-favorite" data-action="show_feeds"></span>\n    <div class="mx-brief hide">\n        <div class="mx-brief-header">\n            <button type="button" class="close" data-action="hideFavorite" aria-hidden="true">×</button>\n            <div>\n                <ul class="nav mx-tab favorite-tab">\n                    <li class="active" data-action="show_feeds" data-param="true"><a>{{lang.favorite_header}}</a></li>\n                    <li data-action="show_binders"><a>{{lang.binders}}</a></li>\n                </ul>\n            </div>\n        </div>\n        <div class="mx-brief-container mx-timeline-thumb">\n\n        </div>\n    </div>\n</div>\n';
}), define("text!template/common/favoriteItem.html", [], function() {
    return '<li>\n    {{#each board.feeds}}\n    <div class="brief-item-header size12">\n        {{actor.user.displayName}} · {{formatter \'formatDate\' created_time}}\n        <span class="pull-right micon-star brief-item-action-remove clickable size16" data-action="removeFavoriteFeed" data-param="{{../sequence}}"></span>\n    </div>\n    <div class="brief-item-content" data-action="gotoPage" ta-param="{{sequence}}" data-param="{{boardId}},{{sequence}}">\n        {{#if message.mentionsComment}}\n            {{chatFormat message.mentionsComment}}\n        {{else}}\n            {{chatFormat message.chatMsg}}\n        {{/if}}\n    </div>\n    {{/each}}\n    <div class="brief-item-footer size12">\n        <span>{{board.name}}</span>\n    </div>\n</li>\n';
}), define("text!template/common/favoriteBinderItem.html", [], function() {
    return '<li data-action="gotoBinder" data-param="{{board.id}}">\n    <div class="mx-item row">\n        <div class="item-thumb" >\n            {{#if board.isconversation}}\n            <div class="timeline-avatars timeline-avatar-{{avatarCount board.members.length}}">\n            {{else}}\n            <div class="timeline-avatars">\n            {{/if}}\n                {{#if board.isconversation}}\n                {{!--  conversation, meet and binder UI display are different --}}\n                    {{#when board.members.length \'>=\' 2}}\n                        {{#each board.members}}\n                            {{#when ../../myself \'!=\' user.primaryKey}}\n                                {{#if ../../showCount}}\n                                    <span class="mx-presence">\n                                <span class="avatar-wrap img-polaroid img-circle {{#if group}}mx-noborder mx-noborder-radius{{/if}}">\n                                    <img src="{{avatar}}" class="lazy"/>\n                                </span>\n                                <i class="icon {{#if online}}online{{/if}}" data-online="{{user.id}}"></i>\n                            </span>\n                                {{/if}}\n                            {{/when}}\n                        {{/each}}\n                        {{showCount 0}}\n                    {{/when}}\n\n                    {{#when board.members.length \'<=\' 1}}\n                        {{#each board.members}}\n                            <span class="mx-presence">\n                                <span class="avatar-wrap img-polaroid img-circle">\n                                    <img src="{{avatar}}" class="lazy"/>\n                                </span>\n                            </span>\n                        {{/each}}\n                    {{/when}}\n                {{else}}\n                        <div class="cover-wrap">\n                            <span class="wrap-outer">\n                                <span class="wrap-inner">\n                                    <img src="{{board.thumbnail_small}}" />\n                                </span>\n                            </span>\n                        </div>\n                {{/if}}\n            </div>\n        </div>\n        <div class="item-content">\n            <span class="pull-right" data-action="removeFavoriteBinder" data-param="{{board.id}}" data-stopPropagation="true"><i class="brief-item-action-remove micon-star size16"></i></span>\n            <div class="wrap-info">\n                <div class="item-main">\n                    <span class="ellipsis" title="{{board.name}}"><strong>{{board.name}}</strong></span>\n                    <span class="item-feed ellipsis-2line size14 color-secondary" title="{{lastFeed.message}}">{{chatFormat lastFeed.message false}}</span>\n                </div>\n            </div>\n            <div class="sub-wrap-info">\n                    <span class="pull-right update-time" data-widget="updateTime" data-param="{{#if lastFeed}}{{lastFeed.timestamp}}{{else}}{{board.created_time}}{{/if}}">\n                        {{#if lastFeed}}\n                            {{formatter \'formatDate\' lastFeed.timestamp}}\n                        {{else}}\n                            {{formatter \'formatDate\' board.created_time}}\n                        {{/if}}\n                    </span>\n                    <span>\n                        {{#if is_notification_off}}<i class="micon-notification-off size16 gray marginRight5" title="{{lang.notification_off}}"></i>{{/if}}\n                        {{#if isSilentMessageOn}}<i class="micon-bell-disabled size16 gray marginRight5" title="{{lang.silent_message_on}}"></i>{{/if}}\n                        {{#if board.total_open_todos}}<i class="micon-todo-empty-fine size16 gray" title="{{lang.open_todos}}"></i> <span class="ta-open-todos gray size12">{{board.total_open_todos}}</span>{{/if}}\n                    </span>\n            </div>\n    </div>\n</li>\n';
}), define("common/favorite", [ "moxtra", "lang", "app", "text!template/common/favorite.html", "text!template/common/favoriteItem.html", "text!template/common/favoriteBinderItem.html", "const", "component/templateHelper" ], function(a, b, c, d, e, f) {
    "use strict";
    return a.Controller.extend({
        template: d,
        handleAction: !0,
        init: function(a) {
            this.$scope.lang = b, this.opts = a;
        },
        rendered: function() {
            Moxtra.getMe();
        },
        show_feeds: function(a) {
            var d = this;
            a || (this.$(".mx-brief").mxModal({
                closeCb: $.proxy(d._closeCb, d)
            }), this.$(".mx-header-favorite").removeClass("micon-star-empty").addClass("micon-star")), 
            this.$(".favorite-tab").children().removeClass("active"), this.$("[data-action=show_feeds]").addClass("active"), 
            this.$(".mx-brief-container").empty(), d.favorites = Moxtra.getFavorites(), this.list = new Moxtra.SimpleList({
                tagName: "ul",
                renderTo: this.$(".mx-brief-container"),
                collection: d.favorites,
                template: e,
                scrollElement: this.$(".mx-brief-container"),
                emptyTemplate: b.empty_favorite_list,
                $scope: {
                    lang: b
                }
            }), c.sendMessage({
                action: "favorite_list_shown",
                session_id: Moxtra.getMe().sessionId
            });
        },
        show_binders: function() {
            this.$(".favorite-tab").children().removeClass("active"), this.$("[data-action=show_binders]").addClass("active"), 
            this.$(".mx-brief-container").empty();
            var c = Moxtra.getTimelineList(function(a) {
                return a.is_favorite;
            }), d = this, e = Moxtra.getMe().primaryKey;
            this.list = new a.List({
                tagName: "ul",
                renderTo: this.$(".mx-brief-container"),
                collection: c,
                template: f,
                scrollElement: this.$(".mx-brief-container"),
                emptyTemplate: '<div class="mx-list-empty-wrap">' + b.empty_favorite_binder_list + "</div>",
                $scope: {
                    lang: b,
                    myself: e,
                    avatarCount: function(a) {
                        return 1 === a ? 1 : a > 5 ? 5 : a;
                    },
                    showCount: function(a) {
                        return 0 === a ? (d._showCountForAvatar = 0, !1) : (d._showCountForAvatar ? d._showCountForAvatar++ : d._showCountForAvatar = 1, 
                        d._showCountForAvatar <= 4);
                    }
                }
            }), d.recovery(d.list);
        },
        _closeCb: function() {
            this.$(".mx-header-favorite").removeClass("micon-star").addClass("micon-star-empty"), 
            c.sendMessage({
                action: "favorite_list_hidden",
                session_id: Moxtra.getMe().sessionId
            }), this.list.destroy(), this.list = null;
        },
        hideFavorite: function() {
            this.$(".mx-brief").mxModal({
                close: !0
            }), this._closeCb();
        },
        gotoPage: function(a, c) {
            var d = Moxtra.getUserBoard(a);
            return d ? (MX.ui.notifySuccess(b.loading), this.opts.request.navigate("timeline", a, null, {
                tab: "tab_chat",
                seq: c
            }), void this.hideFavorite()) : void MX.ui.notifyError(b.binder_not_found);
        },
        gotoBinder: function(a) {
            this.opts.request.navigate("timeline", a), MX.ui.notifySuccess(b.loading), this.hideFavorite();
        },
        removeFavoriteFeed: function(a) {
            var c = this.favorites.get(a), d = c.board.feeds[0], e = this;
            d.favorite(!1).success(function() {
                MX.ui.notifySuccess(b.remove_favorite_success), e.list.removeItem(c);
            }).error(function() {
                MX.ui.notifyError(b.remove_favorite_failed);
            });
        },
        removeFavoriteBinder: function(a) {
            var b = Moxtra.getUserBoard(a);
            b.set("is_favorite", !1), b.update(), this.handleEvent.stopPropagation();
        },
        _destroy: function(a) {
            var b = this;
            MX.each(a, function(a) {
                b[a] && b[a].destroy && (b[a].destroy(), b[a] = null);
            });
        }
    });
}), define("text!template/common/mention.html", [], function() {
    return '<div class="ta-mention-list">\n	{{!-- js-show-mention in app.js --}}\n    <span class="mx-header-mention micon-mention size16 js-show-mention" data-action="showMention"></span>\n    <div class="mx-brief hide mx-mentions-container">\n        <div class="mx-brief-header">\n            <button type="button" class="close" data-action="hideMention" aria-hidden="true">×</button>\n            <h4 class="mx-mention-header">{{lang.mention_header}}</h4>\n        </div>\n        <div class="mx-brief-container">\n\n        </div>\n    </div>\n</div>\n';
}), define("text!template/common/mentionItem.html", [], function() {
    return '<li>\n    {{#each board.feeds}}\n        <div class="brief-item-header size12">\n            {{actor.user.displayName}} · {{formatter \'formatDate\' created_time}}\n                <span class="pull-right brief-item-action-remove clickable size14" data-action="removeMention" data-param="{{../sequence}}">{{../lang.dismiss}}</span>\n        </div>\n        <div class="brief-item-content" data-action="gotoPage" ta-param="{{sequence}}" data-param="{{boardId}},{{sequence}},{{../sequence}}">\n            {{#if message.mentionsComment}}\n                {{chatFormat message.mentionsComment}}\n            {{else}}\n                {{chatFormat message.chatMsg}}\n            {{/if}}\n        </div>\n    {{/each}}\n    <div class="brief-item-footer size12">\n        <span>{{board.name}}</span>\n    </div>\n</li>\n';
}), define("common/mention", [ "moxtra", "lang", "app", "text!template/common/mention.html", "text!template/common/mentionItem.html", "const", "component/templateHelper" ], function(a, b, c, d, e) {
    "use strict";
    return a.Controller.extend({
        template: d,
        handleAction: !0,
        init: function(a) {
            this.$scope.lang = b, this.opts = a;
        },
        rendered: function() {
            Moxtra.getMe();
        },
        showMention: function() {
            var a = this;
            this.$(".mx-brief").mxModal({
                closeCb: $.proxy(a._closeCb, a)
            }), this.$(".mx-header-mention").addClass("font-blue"), a.mentions = Moxtra.getMentionMes(), 
            this.list = new Moxtra.SimpleList({
                tagName: "ul",
                renderTo: this.$(".mx-brief-container"),
                collection: a.mentions,
                scrollElement: this.$(".mx-brief-container"),
                template: e,
                emptyTemplate: b.empty_mention_list,
                $scope: {
                    lang: b
                }
            }), c.sendMessage({
                action: "mention_list_shown",
                session_id: Moxtra.getMe().sessionId
            });
        },
        hideMention: function() {
            this.$(".mx-brief").mxModal({
                close: !0
            }), this._closeCb();
        },
        _closeCb: function() {
            this.$(".mx-header-mention").removeClass("font-blue"), c.sendMessage({
                action: "mention_list_hidden",
                session_id: Moxtra.getMe().sessionId
            }), this.list.destroy(), this.list = null;
        },
        gotoPage: function(a, c) {
            var d = Moxtra.getUserBoard(a);
            return d ? (MX.ui.notifySuccess(b.loading), this.opts.request.navigate("timeline", a, null, {
                tab: "tab_chat",
                seq: c
            }), void this.hideMention()) : void MX.ui.notifyError(b.binder_not_found);
        },
        removeMention: function(a) {
            var c = this;
            Moxtra.removeMentionMes(a).success(function() {
                MX.ui.notifySuccess(b.mentioned_me_dismissed);
                var d = c.mentions.get(a);
                c.list.removeItem(d);
            }).error(function() {
                MX.ui.notifyError(b.mentioned_me_not_dismissed);
            });
        },
        _destroy: function(a) {
            var b = this;
            MX.each(a, function(a) {
                b[a] && b[a].destroy && (b[a].destroy(), b[a] = null);
            });
        }
    });
}), define("text!template/common/browserAlert.html", [], function() {
    return "<div id='browserWarning'>\n    <div class=\"alert alert-warning \">\n        <button type=\"button\" class=\"close\" data-action=\"closeAlert\" data-dismiss=\"alert\" aria-hidden=\"true\">&times;</button>\n        {{lang.common_msg_browser_info_suggestion}}\n        <a href='http://www.google.com/chrome' target='_blank'>Chrome 19+</a>,\n        <a href='http://getfirefox.com' target='_blank'>FireFox 12+</a>,\n        <a href='http://www.opera.com/download/' target='_blank'>Opera 12+</a>,\n        <a href='http://www.apple.com/safari/' target='_blank'>Safari 5.1+</a> or\n        <a href='http://www.microsoft.com/windows/downloads/ie/getitnow.mspx' target='_blank'>Internet Explorer 9+</a>.\n    </div>\n\n</div>\n";
}), define("common/browserAlert", [ "moxtra", "lang", "text!template/common/browserAlert.html" ], function(a, b, c) {
    return a.Controller.extend({
        template: c,
        handleAction: !0,
        init: function(a) {
            this.$scope.lang = b, this.opts = a;
        },
        closeAlert: function() {
            this.opts.status.set("closeBrowserAlert", !0);
        }
    });
}), function() {
    var a = {}, b = null, c = null, d = null, e = null, f = {}, g = window.devicePixelRatio || 1, h = 16 * g, i = {
        width: 7,
        height: 9,
        font: 10 * g + "px arial",
        colour: "#ffffff",
        background: "#F03D25",
        fallback: !0,
        crossOrigin: !0,
        abbreviate: !0
    }, j = function() {
        var a = navigator.userAgent.toLowerCase();
        return function(b) {
            return -1 !== a.indexOf(b);
        };
    }(), k = {
        ie: j("msie"),
        chrome: j("chrome"),
        webkit: j("chrome") || j("safari"),
        safari: j("safari") && !j("chrome"),
        mozilla: j("mozilla") && !j("chrome") && !j("safari")
    }, l = function() {
        for (var a = document.getElementsByTagName("link"), b = 0, c = a.length; c > b; b++) if ((a[b].getAttribute("rel") || "").match(/\bicon\b/)) return a[b];
        return !1;
    }, m = function() {
        for (var a = document.getElementsByTagName("link"), b = document.getElementsByTagName("head")[0], c = 0, d = a.length; d > c; c++) {
            var e = "undefined" != typeof a[c];
            e && (a[c].getAttribute("rel") || "").match(/\bicon\b/) && b.removeChild(a[c]);
        }
    }, n = function() {
        if (!c || !b) {
            var a = l();
            c = b = a ? a.getAttribute("href") : "/favicon.ico";
        }
        return b;
    }, o = function() {
        return e || (e = document.createElement("canvas"), e.width = h, e.height = h), e;
    }, p = function(a) {
        m();
        var b = document.createElement("link");
        b.type = "image/x-icon", b.rel = "icon", b.href = a, document.getElementsByTagName("head")[0].appendChild(b);
    }, q = function(a, b) {
        if (!o().getContext || k.ie || k.safari || "force" === f.fallback) return r(a);
        var c = o().getContext("2d"), b = b || "#000000", e = n();
        d = document.createElement("img"), d.onload = function() {
            c.clearRect(0, 0, h, h), c.drawImage(d, 0, 0, d.width, d.height, 0, 0, h, h), (a + "").length > 0 && s(c, a, b), 
            t();
        }, !e.match(/^data/) && f.crossOrigin && (d.crossOrigin = "anonymous"), d.src = e;
    }, r = function(a) {
        if (f.fallback) {
            var b = document.title;
            "(" === b[0] && (b = b.slice(b.indexOf(" "))), document.title = (a + "").length > 0 ? "(" + a + ") " + b : b;
        }
    }, s = function(a, b) {
        "number" == typeof b && b > 99 && f.abbreviate && (b = u(b));
        var c = (b + "").length - 1, d = f.width * g + 6 * g * c, e = f.height * g, i = h - e, j = h - d - g, l = 16 * g, m = 16 * g, n = 2 * g;
        a.font = (k.webkit ? "bold " : "") + f.font, a.fillStyle = f.background, a.strokeStyle = f.background, 
        a.lineWidth = g, a.beginPath(), a.moveTo(j + n, i), a.quadraticCurveTo(j, i, j, i + n), 
        a.lineTo(j, l - n), a.quadraticCurveTo(j, l, j + n, l), a.lineTo(m - n, l), a.quadraticCurveTo(m, l, m, l - n), 
        a.lineTo(m, i + n), a.quadraticCurveTo(m, i, m - n, i), a.closePath(), a.fill(), 
        a.beginPath(), a.strokeStyle = "rgba(0,0,0,0.3)", a.moveTo(j + n / 2, l), a.lineTo(m - n / 2, l), 
        a.stroke(), a.fillStyle = f.colour, a.textAlign = "right", a.textBaseline = "top", 
        a.fillText(b, 2 === g ? 29 : 15, k.mozilla ? 7 * g : 6 * g);
    }, t = function() {
        o().getContext && p(o().toDataURL());
    }, u = function(a) {
        for (var b = [ [ "G", 1e9 ], [ "M", 1e6 ], [ "k", 1e3 ] ], c = 0; c < b.length; ++c) if (a >= b[c][1]) {
            a = v(a / b[c][1]) + b[c][0];
            break;
        }
        return a;
    }, v = function(a, b) {
        var c = new Number(a);
        return c.toFixed(b);
    };
    a.setOptions = function(a) {
        f = {};
        for (var b in i) f[b] = a.hasOwnProperty(b) ? a[b] : i[b];
        return this;
    }, a.setImage = function(a) {
        return b = a, t(), this;
    }, a.setBubble = function(a, b) {
        return a = a || "", q(a, b), this;
    }, a.reset = function() {
        p(c);
    }, a.setOptions(i), window.Tinycon = a, "function" == typeof define && define.amd && define("tinycon", a);
}(), define("layout/loginLayout", [ "moxtra", "lang", "app", "text!template/layout/loginLayout.html", "layout/guestLayout", "binder/binderBiz", "common/search", "common/favorite", "common/mention", "common/browserAlert", "const", "config", "tinycon" ], function(a, b, c, d, e, f, g, h, i, j, k, l) {
    MX.logger("loginLayout");
    return e.extend({
        template: d,
        handleAction: !0,
        init: function(a) {
            var c = Moxtra.getMe();
            this.$scope.showBeta = !l.global.mx_production, this.$scope.modules = {
                timeline: b.timeline,
                binder: b.binder_shelf,
                bizlib: b.business_library,
                meetintro: b.calendar,
                contacts: b.contacts,
                integrations: b.integrations,
                settings: b.account_settings,
                admin: b.admin_console
            }, this.$scope.avatar = c.avatar, this.$scope.userMeName = c.name, this.listenTo(a.request, "change:module", this.focusToModule), 
            e.prototype.init.call(this, a), this.opts = a;
        },
        verify: function() {
            var a = Moxtra.getMe(), b = this.opts.request;
            if (!a.id) return b.navigate("login", null, null, {
                backUrl: location.href
            }), !1;
            var d = location.href.toString(), e = c.routingToUserDataCenter(d);
            return d !== e ? (location.replace(e), !1) : a.needVerifyEmail ? (b.navigate("verify", null, null, {
                backUrl: location.href
            }), !1) : !0;
        },
        rendered: function() {
            var a = this.opts.router.integration, b = this.opts.router.status;
            "0" === a.get("header") && this.$el.addClass("hideNav"), "admin" === a.get("type") && this.$el.addClass("adminHeader"), 
            MX.env.isBrowserNotSupport && 1 != b.get("closeBrowserAlert") && new j({
                renderTo: document.body,
                parent: this,
                status: b
            }), (c.isMacAgentAppstore() || c.isMacAgentLocal()) && ($("#mxPage").addClass("mac-agent-inline"), 
            $("#mxPage header.main-header").addClass("mx-agent-headerless"), $("#mxPage article#mxPageBody").css({
                "padding-top": 0
            }), $("#mxPage section > nav > ul").css({
                "margin-top": 0
            })), this.badge = this.$(".badge-timeline"), this.libraryBadge = this.$(".badge-bizlib"), 
            this.avatar = this.$(".nav-user-cover"), this.container = this.$("#mxPageBody"), 
            this.add(new g({
                request: this.opts.request,
                renderTo: ".heard-search"
            })), c.isIntegrationEnabled() || (this.add(new i({
                request: this.opts.request,
                renderTo: ".header-social"
            })), this.add(new h({
                request: this.opts.request,
                renderTo: ".header-social"
            }))), MX.env.isIE && $("#searchKey").placeholder();
            var d = this, e = Moxtra.getMe(), f = location.href.toString().indexOf("timeline") > 0 ? !0 : !1, l = a.get("group_id");
            f ? e.loadFirstPageBoards() : l || e.subscribe(), this.listenTo(e, "firstSubscribe", function() {
                var a = Moxtra.getMe(), b = a.groupId;
                !b || a.groupAccessType !== k.group.userRole.admin && a.groupAccessType !== k.group.userRole.owner || d.$("#navAdmin").removeClass("hide"), 
                d._updateAvatar(), d._updateBadge();
            }), this.listenTo(e, "change:feed_unread_count", this._updateBadge), this.listenTo(e, "change:picture", this._updateAvatar);
        },
        _updateAvatar: function() {
            var a = Moxtra.getMe().avatar;
            if (a && this.$scope.avatar !== a) {
                var b = this, c = new Image();
                c.onload = function() {
                    b.avatar.attr("src", a), b.$scope.avatar = a;
                }, c.onerror = function() {
                    b.avatar.attr("src", Moxtra.getMe().branding.getDefaultUserAvatar());
                }, c.src = a;
            }
        },
        _updateBadge: function() {
            var a = this.opts.router.integration;
            if (!("0" === a.get("header") || location.href.indexOf("meet/") > 0 || location.href.indexOf("note/") > 0)) {
                var b = Moxtra.getMe(), c = b.feed_unread_count;
                c && c > 0 ? (this.badge.text(c).show(), Tinycon.setBubble(c)) : (this.badge.hide(), 
                Tinycon.setBubble(0), Tinycon.reset());
            }
        },
        focusToModule: function() {
            var a, b = this.opts.request.module();
            $("nav li>a").each(function(c, d) {
                a = $(d), a.attr("href").indexOf(b) > 0 ? a.addClass("active") : a.removeClass("active");
            });
        }
    });
}), define("text!template/layout/mobileLayout.html", [], function() {
    return '<div class="body">\r\n    <header>\r\n        <a href="javascript:;" class="mx-logo"></a>\r\n    </header>\r\n    <section class="">\r\n        <div class="row">\r\n            <div class="flexbox" id="mxPageBody">\r\n\r\n            </div>\r\n        </div>\r\n\r\n    </section>\r\n</div>\r\n';
}), define("layout/mobileLayout", [ "moxtra", "lang", "text!template/layout/mobileLayout.html", "layout/guestLayout" ], function(a, b, c, d) {
    return d.extend({
        template: c
    });
}), define("text!template/layout/loadingLayout.html", [], function() {
    return '<div class="body outer-container">\r\n	<header>\r\n        <a href="javascript:;" class="mx-logo"></a>\r\n    </header>\r\n    <section class="" style="border: none;">\r\n        <div class="row">\r\n			<div class="" id="mxPageBody">\r\n				\r\n				<div class="progress progress-striped active" style="height:8px;">\r\n				  <div class="progress-bar"  role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 45%">\r\n				    <span class="sr-only">45%</span>\r\n				  </div>\r\n				</div>\r\n				\r\n            </div>\r\n        </div>\r\n    </section>\r\n</div>';
}), define("layout/loadingLayout", [ "moxtra", "lang", "text!template/layout/loadingLayout.html", "layout/guestLayout" ], function(a, b, c, d) {
    return d.extend({
        template: c
    });
}), define("text!template/layout/pendingLayout.html", [], function() {
    return '<header id="publicHeader" class="main-header">\r\n    <a href="javascript:;" class="mx-logo pull-left"></a>\r\n    <div class="btn-group pull-right" style="padding-right:16px;padding-top:4px;">\r\n      <button type="button" class="btn btn-default btn-sm" data-action="gotoWebsite">{{lang.explore_moxtra}}</button>\r\n	  <button type="button" class="btn btn-default btn-sm" data-action="gotoSignup">{{lang.sign_up}}</button>\r\n	  <button type="button" class="btn btn-default btn-sm" data-action="gotoSignin">{{lang.log_in}}</button>\r\n	</div>\r\n</header>\r\n<section  class="non-login content">\r\n    <article  class="flexbox" id="mxPageBody">\r\n\r\n    </article>\r\n\r\n</section>\r\n\r\n<footer>\r\n\r\n</footer>\r\n';
}), define("layout/pendingLayout", [ "moxtra", "lang", "app", "text!template/layout/pendingLayout.html", "layout/guestLayout" ], function(a, b, c, d, e) {
    return e.extend({
        template: d,
        handleAction: !0,
        rendered: function() {
            this.container = this.$("#mxPageBody");
            var a = this.opts.router.integration;
            "0" === a.get("header") && "sf" === a.get("type") && ($("#publicHeader").hide(), 
            $("#mxPageBody").css({
                "padding-top": 0
            }));
        },
        gotoSignup: function() {
            this.request.navigate("signup", null, null, {
                backUrl: location.href
            });
        },
        gotoSignin: function() {
            this.request.navigate("login", null, null, {
                backUrl: location.href
            });
        },
        gotoWebsite: function() {
            location.href = "http://www.moxtra.com?web";
        }
    });
}), define("text!template/layout/emptyLayout.html", [], function() {
    return '<div class="body">\r\n    <section class="">\r\n        <div class="flexbox" id="mxPageBody">\r\n\r\n        </div>\r\n    </section>\r\n</div>\r\n';
}), define("layout/emptyLayout", [ "moxtra", "lang", "text!template/layout/emptyLayout.html", "layout/guestLayout" ], function(a, b, c, d) {
    return d.extend({
        template: c
    });
}), define("text!template/layout/selectorLayout.html", [], function() {
    return '<div class="selectorLayout">\n<!--header>\n    <a href="javascript:;" class="mx-logo pull-left"></a>\n</header-->\n<section class="content">\n    <div id="mxPageBody">\n    </div>\n</section>\n</div>';
}), define("layout/selectorLayout", [ "moxtra", "lang", "text!template/layout/selectorLayout.html", "layout/guestLayout" ], function(a, b, c, d) {
    return d.extend({
        template: c
    });
}), define("text!template/layout/singleModuleLayout.html", [], function() {
    return '<section class="content apiView">\n    <article class="flexable mx-layout-three" style="padding:0; margin:0" id="mxPageBody">\n\n    </article>\n</section>';
}), define("layout/singleModuleLayout", [ "moxtra", "lang", "text!template/layout/singleModuleLayout.html", "layout/guestLayout" ], function(a, b, c, d) {
    return d.extend({
        template: c
    });
}), define("text!template/common/error404.html", [], function() {
    return '<div id="container">\n    <h1 id="title" class="logo_words">404 Not Found</h1>\n</div>\n\n<div id="content">\n    Oops, the page you tried to access could not be found.<br />\n</div>';
}), define("router", [ "moxtra", "layout/guestLayout", "layout/loginLayout", "layout/mobileLayout", "layout/loadingLayout", "layout/pendingLayout", "layout/emptyLayout", "layout/selectorLayout", "layout/singleModuleLayout", "text!template/common/error404.html", "lang", "common/search", "backbone", "handlebars" ], function(a, b, c, d, e, f, g, h, i, j) {
    var k = new MX.Logger("Router");
    MX.Request = a.Model.extend({
        defaults: {
            module: "",
            page: "",
            sequence: ""
        },
        update: function(a, b, c, d) {
            var e = {
                module: a,
                page: b,
                sequence: c
            };
            MX.each(d, function(a, b) {
                e["params." + b] = a;
            }), this._clearParams(e), this.set(e);
        },
        module: function(a, b) {
            if (MX.isUndefined(a)) return this.get("module");
            this._clearParams();
            var c = this.get("module");
            this.set("page", ""), this.set("module", a), a != c && this.router.navigate(this.toURL(), {
                trigger: !!b
            });
        },
        page: function(a, b) {
            if (MX.isUndefined(a)) return this.get("page");
            var c = this.get("page");
            this._clearParams(), this.set({
                page: a,
                sequence: ""
            }), a != c && this.router.navigate(this.toURL(), {
                trigger: !!b
            });
        },
        sequence: function(a, b) {
            return MX.isUndefined(a) ? this.get("sequence") : (k.debug("set sequence [{0}] {1}", a, this.get("sequence")), 
            void (this.get("sequence") != a && (k.debug("navigate sequence [{0}]", a), this.set("sequence", a, {
                silent: b === !1
            }), this.router.navigate(this.toURL(), {
                trigger: !!b
            }))));
        },
        _clearParams: function(a) {
            var b = this.toJSON(), c = this;
            MX.each(b, function(b, d) {
                0 === d.indexOf("params.") && (a ? void 0 === a[d] && c.unset(d) : c.unset(d));
            });
        },
        params: function(a, b) {
            if (MX.isUndefined(a)) {
                var c = this.toJSON(), d = {};
                return MX.each(c, function(a, b) {
                    0 == b.indexOf("params.") && (d[b.substr(7)] = a);
                }), d;
            }
            if (MX.isObject(a)) {
                var e = this;
                return void MX.each(a, function(a, b) {
                    e.params(b, a);
                });
            }
            var f = this.get("params." + a);
            f != b && (this.set("params." + a, b), this.router.navigate(this.toURL(), {
                trigger: !1
            }));
        },
        navigate: function(a, b, c, d) {
            var e = new MX.Request();
            e.update(a, b, c, d), k.debug(e.toURL());
            var f = location.href.toString().split("#").shift();
            location.href = f + "#" + e.toURL();
        },
        toURL: function() {
            var a = this.toJSON(), b = [], c = [ a.module ];
            for (var d in a) 0 == d.indexOf("params.") && b.push(d.substr(7) + "=" + encodeURIComponent(a[d]));
            a.page && c.push(a.page), a.sequence && c.push(a.sequence);
            var e = "/" + c.join("/");
            return b.length && (e += "?" + b.join("&")), e;
        }
    });
    var l = new MX.Request(), m = MX.storage("appstatus", "sessionStorage", [ "lastBinder", "mxNote", "mxPublicView", "mxDSAnchorPage", "mxMeetId", "mxMeetAnchorHref", "mxMeetEnableVoice", "mxMeetEnableVideo", "mxMeetRecorder", "mxMeetShareType", "mxMeetSharingPage", "mxMeetTimer", "mxMeetInvitees", "mxMeetOriginalId", "mxMeetJoinId", "mxSessionTimeline", "mxMeetMsgTimestamp", "backURL", "closeBrowserAlert", "closeEmailVerifyAlert", "closeGroupInviteAlert", "closeStorageUsageAlert" ]), n = MX.storage("integration", "sessionStorage"), o = MX.storage("applocalstatus", "localStorage", [ "mxMeetInvitees", "mxMeetTopic", "mxMeetOriginalId" ]), p = {
        selector: h,
        guest: b,
        login: c,
        mobile: d,
        loading: e,
        noNavBar: f,
        mobileEmpty: g,
        single: i
    };
    return Backbone.Router.extend({
        modules: {
            forgetpass: {
                layout: "guest",
                alias: "identity/forgetpass"
            },
            resetpass: {
                layout: "guest",
                alias: "identity/forgetpass"
            },
            setpass: {
                layout: "login",
                alias: "settings/setpass"
            },
            changepass: {
                layout: "guest",
                alias: "identity/changepass"
            },
            signup: {
                layout: "guest",
                alias: "identity/signup"
            },
            joinbinder: MX.env.isMobile ? {
                layout: "mobileEmpty",
                alias: "mobile/mobile"
            } : {
                layout: "guest",
                alias: "binder/joinBinder"
            },
            groupjoin: {
                layout: "guest",
                alias: "group/joinGroup"
            },
            leave: {
                layout: "guest",
                alias: "binder/leaveBinder"
            },
            sfjoin: {
                layout: "guest",
                alias: "group/joinSalesforceGroup"
            },
            contactjoin: MX.env.isMobile ? {
                layout: "mobileEmpty",
                alias: "mobile/mobile"
            } : {
                layout: "guest",
                alias: "contacts/joinContact"
            },
            joinmeet: MX.env.isMobile ? {
                layout: "mobileEmpty",
                alias: "mobile/mobile"
            } : {
                layout: "guest",
                alias: "meet/joinMeet"
            },
            meetintro: {
                layout: "login",
                alias: "meet/meetIntro"
            },
            meet: {
                layout: "loading",
                alias: "meet/viewer"
            },
            mymeet: {
                layout: "mobileEmpty",
                alias: "meet/mymeet"
            },
            note: {
                layout: "loading",
                alias: "note/viewer"
            },
            view: {
                layout: "mobileEmpty",
                alias: "binder/publicView"
            },
            viewmobile: {
                layout: "mobile",
                alias: "binder/publicView"
            },
            detail: MX.env.isMobile ? {
                layout: "mobileEmpty",
                alias: "mobile/mobile"
            } : {
                layout: "login",
                alias: "timeline/timeline"
            },
            viewinvite: MX.env.isMobile ? {
                layout: "mobileEmpty",
                alias: "mobile/mobile"
            } : {
                layout: "login",
                alias: "timeline/timeline"
            },
            verify: {
                layout: "guest",
                alias: "identity/verifyWelcome"
            },
            timeline: {
                layout: "login"
            },
            binder: {
                layout: "login"
            },
            admin: {
                layout: "login"
            },
            settings: {
                layout: "login"
            },
            contacts: {
                layout: "login"
            },
            integrations: {
                layout: "login",
                alias: "services/services"
            },
            upgrade: {
                layout: "guest",
                alias: "buy/upgrade"
            },
            list: {
                layout: "login",
                alias: "binder/binder"
            },
            session: {
                layout: "login",
                alias: "meet/meetIntro"
            },
            feed: {
                layout: "login",
                alias: "timeline/timeline"
            },
            myprofile: {
                layout: "login",
                alias: "settings/profile"
            },
            unsubscribe: {
                layout: "login",
                alias: "settings/profile"
            },
            sflink: {
                layout: "mobileEmpty",
                alias: "identity/sflink"
            },
            todo: {
                layout: "login",
                alias: "todo/binderList"
            },
            login: {
                layout: "guest",
                alias: "identity/login"
            },
            ssologin: {
                layout: "guest",
                alias: "identity/ssologin"
            },
            logout: {
                layout: "guest",
                alias: "identity/logout"
            },
            start: {
                layout: "loading",
                alias: "api/startUrl"
            },
            join: {
                layout: "loading",
                alias: "api/joinUrl"
            },
            record: {
                layout: "loading",
                alias: "api/startNoteUrl"
            },
            chat: {
                layout: "loading",
                alias: "api/startChatUrl"
            },
            "api.startNote": {
                layout: "loading",
                alias: "api/startNoteUrl"
            },
            "api.note": {
                layout: "loading",
                alias: "note/viewer"
            },
            chooser: {
                layout: "selector",
                alias: "api/selectorUrl"
            },
            "api.startAnnotate": {
                layout: "single",
                alias: "api/annotate"
            },
            "api.annotate": {
                layout: "single",
                alias: "api/annotate"
            },
            "api.team": {
                layout: "single",
                alias: "api/team"
            },
            "api.timeline": {
                layout: "single",
                alias: "api/timeline"
            },
            "api.startChat": {
                layout: "single",
                alias: "api/startChat"
            },
            "api.chat": {
                layout: "single",
                alias: "api/chat"
            },
            "api.startMeet": {
                layout: "single",
                alias: "api/startMeet"
            },
            "api.joinMeet": {
                layout: "single",
                alias: "api/joinMeet"
            },
            "api.meet": {
                layout: "loading",
                alias: "meet/viewer"
            },
            "api.newBinder": MX.env.isMobile ? {
                layout: "mobileEmpty",
                alias: "mobile/mobile"
            } : {
                layout: "single",
                alias: "api/newBinder"
            },
            "api.endMeet": {
                layout: "single",
                alias: "api/endMeet"
            },
            "api.leaveMeet": {
                layout: "single",
                alias: "api/leaveMeet"
            },
            "api.video": {
                layout: "single",
                alias: "api/video"
            },
            "api.todo": {
                layout: "single",
                alias: "api/todo"
            },
            "api.calendar": {
                layout: "single",
                alias: "api/calendar"
            },
            "api.data.timeline": {
                layout: "single",
                alias: "api/data/timeline"
            },
            "api.ui.binder": {
                layout: "single",
                alias: "api/ui/binder"
            },
            "api.ui.timeline": {
                layout: "single",
                alias: "api/ui/timeline"
            }
        },
        alias: {},
        routes: {
            ":module?*querystring": "viewFromQueryString",
            ":module/?*querystring": "viewFromQueryString",
            ":module": "viewFactory",
            ":module/:page?*querystring": "viewFromPageQueryString",
            ":module/:page/?*querystring": "viewFromPageQueryString",
            ":module/:page": "viewFactory",
            ":module/:page/:id?*querystring": "viewFactory",
            ":module/:page/:id/?*querystring": "viewFactory",
            ":module/:page/:id": "viewFactory",
            "*filter": "viewFactory"
        },
        initialize: function() {
            l.router = this, this.request = l, this.status = m, this.localStatus = o, this.integration = n;
        },
        getRealPage: function(a) {
            var b = this.modules[a];
            return b && b.alias ? b.alias : a + "/" + a;
        },
        setCurrentView: function(a, b, c, d) {
            var e, f = this.modules[a];
            return f ? (e = f.layout, MX.isFunction(e) && (e = e.call(this)), void (this.setLayout(e) !== !1 && this.loadPage(a, b, c, d))) : (k.error("Not find the layout [{0}]", name), 
            !1);
        },
        loadPage: function(a, b, c, d, e) {
            var f = this;
            e || (e = this.getRealPage(a, b)), require([ e ], function(e) {
                f.currLayout.setMainPage(e, a, b, c, d);
            }, function(a) {
                a.requireModules && "define" !== a.requireType ? a.requireType && (k.error("cannot find module [{0}]", a.requireModules), 
                f.errorPage()) : (k.error("js error:[{0}] in file [{1}]", a.message, a.requireModules), 
                k.error(a.stack));
            });
        },
        setLayout: function(a) {
            return this.currLayoutName != a ? (this.currLayout && this.currLayout.destroy(), 
            this.currLayout = new p[a]({
                renderTo: "#mxPage",
                request: l,
                router: this
            }), this.currLayoutName = a, this.currLayout.verify()) : !0;
        },
        viewFactory: function(a, b, c, d) {
            var e, f;
            return d && (e = this.parseQueryString(d), this.saveParamsToStorage(e)), this._processParams(e), 
            a = a || "login", (f = this.modules[a]) ? f.rewrite ? f.rewrite.call(this, a, b, c, e || {}) : void this.setCurrentView(a, b, c, e) : void this.errorPage();
        },
        viewFromQueryString: function(a, b) {
            this.viewFactory(a, null, null, b);
        },
        viewFromPageQueryString: function(a, b, c) {
            this.viewFactory(a, b, null, c);
        },
        parseQueryString: function(a) {
            var b, c, d = {};
            if (!a) return d;
            var e = a, f = a.indexOf("backUrl=");
            if (a.indexOf("type=sf") > -1 && a.indexOf("chooser") > -1) {
                var g = a.indexOf("type=sf");
                d.backUrl = a.substr(f + 8, g - 1), e = a.substr(g);
            } else f > -1 && (d.backUrl = a.substr(f + 8), e = a.substr(0, f - 1));
            return e && (b = e.split("&"), MX.each(b, function(a) {
                c = a.split(/=(.+)?/), d[c[0]] = c[1];
            })), d;
        },
        saveParamsToStorage: function(a) {
            if (a.type || a.header || a.client_id || a.access_token) {
                var b = !!n.get("type");
                MX.each(a, function(a, c) {
                    b && "type" === c || n.set(c, a);
                });
            }
        },
        _processParams: function(a) {
            a = a || {};
            var b = a.extension || n.get("extension"), c = a.client_id || n.get("client_id");
            if (b) try {
                b = JSON.parse(0 === b.indexOf("{") ? b : decodeURIComponent(b));
            } catch (d) {
                k.error(d);
            }
            b && b.css_file && b.css_file.use === !0 && c ? this._injectCSS("themes/skins/" + c + "/style.css?" + Math.random()) : this._removeCSS();
        },
        _removeCSS: function() {
            var a = document.getElementById("moxtra-external-css");
            a && a.remove();
        },
        _injectCSS: function(a) {
            var b = "moxtra-external-css", c = document.getElementById(b);
            if (c) c.href = a; else {
                var d = document.createElement("link");
                d.id = b, d.href = a, d.rel = "stylesheet", document.getElementsByTagName("head")[0].appendChild(d);
            }
        },
        errorPage: function() {
            this.currLayout && (this.currLayout.destroy(), this.currLayoutName = null), $("#mxPage").html(j);
        }
    });
}), function(a, b) {
    "use strict";
    "function" == typeof define && define.amd ? define("notify", [], function() {
        return b(a, document);
    }) : "object" == typeof exports ? module.exports = b(a, document) : a.Notify = b(a, document);
}(window, function(a) {
    "use strict";
    function b(a, c) {
        if ("string" != typeof a) throw new Error("Notify(): first arg (title) must be a string.");
        if (this.title = a, this.options = {
            icon: "",
            body: "",
            tag: "",
            notifyShow: null,
            notifyClose: null,
            notifyClick: null,
            notifyError: null,
            permissionGranted: null,
            permissionDenied: null,
            timeout: null
        }, this.permission = null, b.isSupported() && "object" == typeof c) {
            for (var d in c) c.hasOwnProperty(d) && (this.options[d] = c[d]);
            "function" == typeof this.options.notifyShow && (this.onShowCallback = this.options.notifyShow), 
            "function" == typeof this.options.notifyClose && (this.onCloseCallback = this.options.notifyClose), 
            "function" == typeof this.options.notifyClick && (this.onClickCallback = this.options.notifyClick), 
            "function" == typeof this.options.notifyError && (this.onErrorCallback = this.options.notifyError);
        }
    }
    return b.isSupported = function() {
        return "Notification" in a ? !0 : !1;
    }, b.needsPermission = function() {
        return b.isSupported() && "granted" === Notification.permission ? !1 : !0;
    }, b.requestPermission = function(c, d) {
        b.isSupported() && a.Notification.requestPermission(function(a) {
            switch (a) {
              case "granted":
                "function" == typeof c && c();
                break;

              case "denied":
                "function" == typeof d && d();
            }
        });
    }, b.prototype.show = function() {
        b.isSupported() && (this.myNotify = new Notification(this.title, {
            body: this.options.body,
            tag: this.options.tag,
            icon: this.options.icon
        }), this.options.timeout && !isNaN(this.options.timeout) && setTimeout(this.close.bind(this), 1e3 * this.options.timeout), 
        this.myNotify.addEventListener("show", this, !1), this.myNotify.addEventListener("error", this, !1), 
        this.myNotify.addEventListener("close", this, !1), this.myNotify.addEventListener("click", this, !1));
    }, b.prototype.onShowNotification = function(a) {
        this.onShowCallback && this.onShowCallback(a);
    }, b.prototype.onCloseNotification = function() {
        this.onCloseCallback && this.onCloseCallback(), this.destroy();
    }, b.prototype.onClickNotification = function() {
        this.onClickCallback && this.onClickCallback();
    }, b.prototype.onErrorNotification = function() {
        this.onErrorCallback && this.onErrorCallback(), this.destroy();
    }, b.prototype.destroy = function() {
        this.myNotify.removeEventListener("show", this, !1), this.myNotify.removeEventListener("error", this, !1), 
        this.myNotify.removeEventListener("close", this, !1), this.myNotify.removeEventListener("click", this, !1);
    }, b.prototype.close = function() {
        this.myNotify.close();
    }, b.prototype.handleEvent = function(a) {
        switch (a.type) {
          case "show":
            this.onShowNotification(a);
            break;

          case "close":
            this.onCloseNotification(a);
            break;

          case "click":
            this.onClickNotification(a);
            break;

          case "error":
            this.onErrorNotification(a);
        }
    }, b;
}), define("component/notify/notify", [ "moxtra", "lang", "notify", "const" ], function(a, b, c, d) {
    var e, f = {
        closable: !0,
        text: "",
        type: "success",
        autoClose: !0,
        delay: 3
    }, g = {
        success: "alert-success mx-notify-success",
        error: "alert-danger",
        warning: "alert-warning",
        info: "alert-info"
    };
    MX.ui.Notify = MX.Controller.extend({
        tagName: "div",
        className: "mx-notify alert",
        initialize: function(a) {
            a || (a = {}), _.extend(this, f, _.pick(a, [ "content", "type", "closeable", "onClose", "autoClose", "delay", "iframeShim" ])), 
            this.render();
        },
        render: function() {
            e || (e = $(document.createElement("div")), e.addClass("notify-container"), e.appendTo(document.body));
            var a = this.type;
            if (this.$el.addClass(g[a]), this.closable) {
                var b = $('<button type="button" class="close" aria-hidden="true">&times;</button>');
                b.on("click", $.proxy(this.close, this)), this.$el.append(b);
            }
            var c = this.content;
            MX.isString(c) ? this.$el.append(c) : c instanceof MX.Controller && (c.prototype ? new c({
                renderTo: this.$el,
                parent: this
            }) : (c.parent = this, c.renderTo(this.el))), this.$el.appendTo(e), this.iframeShim && this.$el.append('<iframe class="mx-iframe-shim" src="javascript:;" frameborder="0" allowtransparency="true" scrolling="no"></iframe>'), 
            this.autoClose && setTimeout($.proxy(this.close, this), 1e3 * this.delay);
        },
        close: function() {
            this.closed || (this.closed = !0, this.trigger("close"), this.onClose && this.onClose(), 
            this.$el.fadeOut("slow", $.proxy(this.destroy, this)));
        }
    }), MX.ui.notifySuccess = function(a) {
        return new MX.ui.Notify({
            content: a,
            iframeShim: !0,
            type: "success"
        });
    }, MX.ui.notifyError = function(a) {
        return new MX.ui.Notify({
            content: a,
            iframeShim: !0,
            type: "error"
        });
    }, MX.ui.notifyInfo = function(a) {
        return new MX.ui.Notify({
            content: a,
            iframeShim: !0,
            type: "info"
        });
    }, MX.ui.notifyWarning = function(a) {
        return new MX.ui.Notify({
            content: a,
            iframeShim: !0,
            type: "warning"
        });
    }, MX.ui.notifyDesktop = function(a) {
        if (c.isSupported()) {
            var e = {
                title: b.notification,
                message: b.notification,
                icon: d.defaults.notification.icon,
                click: null,
                timeout: 3
            };
            _.extend(e, a), e.notifyClick = function() {
                window.focus(), "function" == typeof e.click && e.click();
            }, e.body = e.message;
            var f = new c(e.title, e);
            c.needsPermission() ? c.requestPermission(function() {
                f.show();
            }, function() {}) : f.show();
        }
    };
}), define("text!template/component/dialogBox.html", [], function() {
    return '<div class="modal fade" id="modal{{id}}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel{{id}}" aria-hidden="true">\n	<div class="modal-dialog">\n		<div class="modal-content">\n			{{#if iframeShim}}\n			<!-- handle plugin window covered web case -->\n			<iframe class="mx-iframe-shim" src="javascript:;" frameborder="0" allowtransparency="true" scrolling="no"></iframe>\n			{{/if}}\n\n		</div>\n	</div>\n</div>\n';
}), define("text!template/component/dialogContent.html", [], function() {
    return '<div class="modal-sub-content modal-sub-content-{{cid}}">\n    <div class="modal-header {{#if hideHeader}}hide{{/if}}" >\n    	{{#unless hideClose}}\n        <button type="button" class="close" data-action="close" aria-hidden="true">&times;</button>\n        {{/unless}}\n        <h4 class="modal-title ellipsis">{{title}}</h4>\n    </div>\n    <div class="modal-body"></div>\n    <div class="modal-footer" ></div>\n</div>';
}), define("component/dialog/dialog", [ "moxtra", "text!template/component/dialogBox.html", "text!template/component/dialogContent.html", "lang" ], function(a, b, c, d) {
    var e = Handlebars.compile(c), f = Handlebars.compile('<button type="button" id="{{id}}" class="btn btn-default {{className}}" {{#if loadingText}}data-loading-text="{{loadingText}}"{{/if}} {{#if caret}}data-toggle="dropdown"{{/if}} data-action="{{click}}" data-param="{{param}}" {{#if enableOpacity}}style="opacity:0.99;"{{/if}}>{{text}}{{#if caret}}<span class="caret"></span>{{/if}}</button>'), g = Handlebars.compile('<a href="{{href}}" target="{{hrefTarget}}" {{#if disableContextMenu}}oncontextmenu="return false;"{{/if}} id="{{id}}" class="btn btn-default {{className}}" {{#if loadingText}}data-loading-text="{{loadingText}}"{{/if}} {{#if caret}}data-toggle="dropdown"{{/if}} data-action="{{click}}" data-param="{{param}}">{{text}}{{#if caret}}<span class="caret"></span>{{/if}}</a>'), h = MX.logger("Dialog");
    MX.ui.Dialog = MX.Controller.extend({
        template: b,
        handleAction: !0,
        init: function(a) {
            this.dialogs = [], this.iframeShim = !(!a || !a.iframeShim), this.$scope.iframeShim = this.iframeShim, 
            this.$scope.id = this.cid, this.renderTo(document.body), a && this.push(a), this.open(MX.get("disableKeyboard", a));
        },
        createContentView: function(a) {
            if (!a) return void h.error("need a content");
            a.content || (a = {
                content: a,
                title: a.title,
                buttons: a.buttons
            });
            var b, c = a.content, d = {
                title: a.title,
                buttons: a.buttons,
                hideHeader: a.hideHeader,
                hideClose: a.hideClose
            };
            if (MX.isString(c)) {
                b = d.view = $(e(d));
                var f = b.find(".modal-body");
                MX.isString(c) && f.html(c);
            } else MX.isFunction(c) && c.prototype && (c = new c()), d.buttons = c.buttons, 
            d.title = c.title || d.title, b = d.view = $(e(d)), c.dialog = this, c.renderTo(b.find(".modal-body")), 
            d.content = c, d.hideHeader = c.hideHeader || d.hideHeader || !1, d.hideClose = c.hideClose || d.hideClose || !1;
            return a.width && this.$(".modal-dialog").width(a.width), a.className && this.$(".modal-dialog").addClass(a.className), 
            d;
        },
        getButton: function(a) {
            if (this.currChild) {
                var b = this.currChild.view, c = b.find(".modal-footer .btn");
                return MX.isNumber(a) ? c.eq(a) : c;
            }
        },
        createButtons: function(a) {
            var b, c, d = "";
            return a.disabled && (a.className += " disabled"), a.position && (d = " pull-" + a.position), 
            a.menu ? (a.caret = !0, a.className += " dropdown-toggle", c = Handlebars.compile(' <ul class="dropdown-menu" role="menu">{{#each menu}}<li><a href="javascript:;" data-action="{{click}}">{{text}}</a></li>{{/each}}</ul>'), 
            b = '<div class="btn-group ' + d + '">' + f(a) + c(a) + "</div>") : (a.className += d, 
            a.href ? (a.hrefTarget || (a.hrefTarget = "_blank"), a.disableContextMenu = "_blank" === a.hrefTarget ? !1 : !0, 
            b = g(a)) : (this.iframeShim && MX.env.isIE && (9 === MX.env.browserVersion || 10 === MX.env.browserVersion) && (a.enableOpacity = !0), 
            b = f(a))), b;
        },
        _handleAction: function(a) {
            var b = $(a.currentTarget);
            if (b.hasClass("disabled")) return !1;
            var c = b.data("action"), d = b.data("param"), d = d ? String(d) : "";
            d = "" === d ? [] : d.split(",");
            var e = this.currChild.content || this, f = MX.get(c, e);
            f || (f = MX.get(c, this), e = this), _.isFunction(f) && (e.handleEvent = a, f.apply(e, d), 
            e.handleEvent = null);
        },
        push: function(a) {
            var b = this, a = b.createContentView(a);
            a.buttons && (html = [], MX.each(a.buttons, function(a) {
                if (MX.isFunction(a.click)) {
                    var c = "action" + Math.floor(1e3 * Math.random(1e3));
                    b[c] = a.click, a.click = c, a.id = a.id || c;
                } else a.id = a.id || a.click;
                html.push(b.createButtons(a));
            }), a.view.find(".modal-footer").html(html.join(""))), this.dialogs.push(a), a.view.appendTo(b.$(".modal-content")), 
            this.currChild && this.currChild.view.hide(), this.currChild = a;
        },
        pop: function() {
            var a = this.dialogs.pop();
            a && (a.content && a.content.destroy(), a.view && a.view.remove(), this.dialogs.length > 0 ? (a = this.dialogs[this.dialogs.length - 1], 
            a.view.show(), this.currChild = a) : this.close());
        },
        close: function() {
            this.trigger("close");
            var a = 0, b = this.dialogs.length;
            for (a = 0; b > a; a++) this.dialogs[a].content && this.dialogs[a].content.destroy(), 
            this.dialogs[a].view && this.dialogs[a].view.remove();
            this.dialogs.length = 0, this.$el.modal("hide");
            var c = this;
            setTimeout(function() {
                c.destroy(), $(".modal-backdrop").remove();
            }, 1e3);
        },
        open: function(a) {
            var b = {
                backdrop: "static"
            }, c = this;
            a && (b.keyboard = !1), this.$el.modal(b), this.$el.on("keydown keyup", function(a) {
                a.stopPropagation();
            }), this.$el.on("shown.bs.modal", function() {
                MX.env.isFF && c.iframeShim && c.$el.removeClass("fade").removeClass("in");
            });
        },
        progress: function(a) {
            this.$(".modal-body").loading(a);
        },
        getButton: function(a) {
            var b = this.currChild && MX.filter(this.currChild.buttons, {
                id: a
            });
            return b && b.length ? (b = b[0], this.$("#" + b.id)) : $({});
        }
    }), MX.ui.Confirm = function(a, b, c, e) {
        var f = "btn-primary ta-confirm-ok";
        e && e.className && (f += " " + e.className), new MX.ui.Dialog({
            width: 300,
            title: d.confirm,
            buttons: [ {
                text: d.cancel,
                className: "ta-confirm-cancel",
                click: function() {
                    c && c(), this.close();
                }
            }, {
                text: d.ok,
                className: f,
                click: function() {
                    b && b(), this.close();
                }
            } ],
            iframeShim: !0,
            content: a
        });
    }, MX.ui.Alert = function(a, b) {
        var c = "btn-primary", e = d.information;
        return b && b.className && (c += " " + b.className), b && b.title && (e = b.title), 
        new MX.ui.Dialog({
            title: e,
            width: 300,
            content: a,
            iframeShim: !0,
            buttons: [ {
                text: d.ok,
                className: c,
                click: function() {
                    this.close();
                }
            } ]
        });
    }, $.fn.modal.Constructor.prototype.show = function(a) {
        var b = this, c = $.Event("show.bs.modal", {
            relatedTarget: a
        });
        this.$element.trigger(c), this.isShown || c.isDefaultPrevented() || (this.isShown = !0, 
        this.escape(), this.$element.on("click.dismiss.modal", '[data-dismiss="modal"]', $.proxy(this.hide, this)), 
        this.backdrop(function() {
            var c = $.support.transition && b.$element.hasClass("fade");
            b.$element.parent().length || b.$element.appendTo(document.body), b.$element.show(), 
            c && b.$element[0].offsetWidth, b.$element.addClass("in").attr("aria-hidden", !1), 
            b.enforceFocus();
            var d = $.Event("shown.bs.modal", {
                relatedTarget: a
            });
            c ? b.$element.find(".modal-dialog").one($.support.transition.end, function() {
                b.$element.trigger(d);
            }).emulateTransitionEnd(300) : b.$element.trigger(d);
        }));
    };
}), define("text!template/component/inputDialog.html", [], function() {
    return '<form role="form">\n    <div class="form-group">\n        <label for="inputContent">{{label}}</label>\n        <input autocomplete="off" type="{{type}}" name="{{name}}" value="{{value}}" autofocus="autofocus" class="form-control" data-error-style="inline" id="inputContent" placeholder="{{placeholder}}">\n    </div>\n</form>';
}), define("component/dialog/inputDialog", [ "moxtra", "lang", "text!template/component/inputDialog.html", "const", "component/dialog/dialog" ], function(a, b, c, d) {
    var c = (MX.logger("InputDialog"), Handlebars.compile(c));
    return a.ui.InputDialog = a.Controller.extend({
        tagName: "div",
        className: "input-dialog",
        title: b.select_category,
        events: {},
        handleAction: !0,
        init: function(a) {
            this.$scope.lang = b, _.extend(this, a);
        },
        render: function() {
            this.$el.html(c(_.extend({
                type: "text",
                placeholder: "",
                name: "",
                value: ""
            }, this.input))), this.form = new a.Form({
                form: this.$("form"),
                model: this.model,
                submit: this.onSubmit,
                scope: this
            });
        },
        onSubmit: function() {},
        onKeyUp: function(a) {
            a.stopPropagation(), a.keyCode == d.keys.Enter && (this.onSubmit(), a.preventDefault(), 
            a.stopPropagation());
        }
    }), a.ui.InputDialog;
}), define("component/loading", [ "moxtra", "spin" ], function(a, b) {
    "use strict";
    var c = {
        lines: 12,
        length: 7,
        width: 5,
        radius: 10,
        rotate: 0,
        corners: 1,
        color: "rgba(0,0,0,0.3)",
        direction: 1,
        speed: 1,
        trail: 100,
        opacity: .25,
        className: "spinner",
        top: "auto",
        left: "auto",
        position: "relative"
    }, d = {
        smallBlank: {
            color: "#000000",
            length: 5,
            radius: 5,
            lines: 8,
            width: 3
        }
    };
    $.fn.loading = function(a, e) {
        return this.each(function() {
            var f = this, g = $(f), h = g.data("spinner");
            if (h && a === !1) {
                if (g.data("spinner", null), "number" == typeof h) return void clearTimeout(h);
                h.stop(), h = null;
            }
            MX.isString(a) && (a = d[a] || {}), h || a === !1 || (a = $.extend({}, c, a), e === !1 ? (h = new b(a).spin(f), 
            g.data("spinner", h)) : (h = setTimeout(function() {
                h = new b(a).spin(f), g.data("spinner", h);
            }, 300), g.data("spinner", h)));
        });
    };
    var e = $('<div class="global-loading"></div>');
    MX.loading = function(a) {
        e.inited || (e.appendTo(document.body), e.inited = !0), a ? (e.show(), e.loading({
            color: "#ffffff",
            length: 15,
            lines: 10
        }, !1)) : (e.hide(), e.loading(!1));
    };
}), define("app", [ "router", "config", "const", "lang", "uuid", "admin/branding/helper", "component/notify/notify", "component/dialog/dialog", "component/dialog/inputDialog", "component/loading" ], function(a, b, c, d, e, f) {
    "use strict";
    var g = MX.logger("app"), h = $({});
    window.uuid = e;
    var i = {
        router: null,
        integration: null,
        request: null,
        status: null,
        localStatus: null,
        config: b,
        "const": c,
        navigate: function(a, b) {
            b = b || !0, this.router.navigate.call(this.router, "#" + a, {
                trigger: b
            });
        },
        sendMessage: function(a) {
            var b, c;
            b = JSON.parse(sessionStorage.getItem("integration")), c = b && b.origin || "*", 
            a.session_key && (a.meet_id = a.session_key);
            var d = JSON.stringify(a);
            g.log("sendmessage to window = " + c, d);
            var e = opener || parent || window, f = b && "1" === b.popup;
            if (MX.env.isIE && MX.env.browserVersion < 10 && f) e.mxPostMessagePassthrough(d); else if ("postMessage" in e) try {
                e.postMessage(d, c), (i.isMacAgentAppstore() || i.isMacAgentLocal()) && e.MXNAtive && e.MXNAtive.jsPostMessage_ && e.MXNAtive.jsPostMessage_(d);
            } catch (h) {
                g.error(h);
            }
        },
        isIntegrationEnabled: function() {
            var a = JSON.parse(sessionStorage.getItem("integration"));
            return a && ("websdk" === a.type || "sf" === a.type);
        },
        isIntegrationWebsdk: function() {
            var a = JSON.parse(sessionStorage.getItem("integration"));
            return a && "websdk" === a.type;
        },
        isIntegrationSalesforce: function() {
            var a = JSON.parse(sessionStorage.getItem("integration"));
            return a && "sf" === a.type;
        },
        isIntegrationVideo: function() {
            var a = JSON.parse(sessionStorage.getItem("integration"));
            return !a || "websdk" !== a.type || a.video && "false" !== a.video ? !0 : !1;
        },
        isIntegrationAgent: function() {
            var a = JSON.parse(sessionStorage.getItem("integration"));
            return a && "agent" === a.type;
        },
        isForceViewSharingInNative: function() {
            var a = JSON.parse(sessionStorage.getItem("integration"));
            return a && "native" === a.view_sharing;
        },
        isAutoJoinMeet: function() {
            var a = !0;
            if (i.isIntegrationEnabled()) {
                var b = i.integration.get("extension");
                if (b) try {
                    var c = JSON.parse(b);
                    c.auto_join_meet === !1 && (a = !1);
                } catch (d) {}
            }
            return a;
        },
        isWindowsAgent: function() {
            return navigator.userAgent.indexOf(c.flags.windowsAgent) > 0;
        },
        isMacAgentAppstore: function() {
            return navigator.userAgent.indexOf(c.flags.macAgentAppstore) > 0;
        },
        isMacAgentLocal: function() {
            return navigator.userAgent.indexOf(c.flags.macAgentLocal) > 0;
        },
        trigger: function(a, b) {
            return h.trigger(a, b);
        },
        on: function(a, b, c) {
            return h.on(a, b, c);
        },
        off: function(a, b) {
            return h.off(a, b);
        },
        accessFromChina: function() {
            return /cn/.test(Moxtra.getMe().server);
        },
        routingToUserDataCenter: function(a) {
            var b, c = Moxtra.getMe(), d = location.host, e = d.split("."), f = e[0];
            return "www" === f && c.preferred_zone && c.preferred_zone !== c.zone && f !== c.preferred_zone && (e[0] = c.preferred_zone, 
            b = e.join("."), a = a.replace(d, b)), a;
        }
    };
    return $(function() {
        function a() {
            d = setTimeout(function() {
                console.log("[timer] start build check Timer");
                var b = location.href.indexOf("meet/") > 0 || location.href.indexOf("note/") > 0;
                $.get("build.txt?v=" + Math.random(), function(a) {
                    try {
                        var c = sessionStorage.getItem("buildTime");
                        c ? c === a || b ? console.log("[timer] No new build detected, do nothing") : (console.log("[timer] new build detected, need reload page"), 
                        sessionStorage.setItem("buildTime", a), location.reload()) : (console.log("[timer] set buildTime to sessionStorage"), 
                        sessionStorage.setItem("buildTime", a), location.reload());
                    } catch (d) {
                        console.error(d);
                    }
                }), a();
            }, 9e5);
        }
        function b() {
            console.log("subscribe active"), Moxtra.Subscribe.active(), d && (console.log("remove buildCheckTimer"), 
            clearTimeout(d), d = null);
        }
        function c() {
            console.log("subscribe inactive"), Moxtra.Subscribe.inactive();
            var b = location.href.indexOf("meet/") > 0 || location.href.indexOf("note/") > 0;
            b || a();
        }
        MX.env.isIE9 && $(document.body).addClass("bw-ie9"), Moxtra.on("invalidToken", function() {
            i.sendMessage({
                action: "invalidToken",
                session_id: Moxtra.getMe().sessionId
            });
        }), Moxtra.on("sessionTimeout", function() {
            if (Moxtra.Subscribe.stop(), sessionStorage.removeItem("mx:cache"), sessionStorage.removeItem("mxsdk:auth"), 
            !location.href.match(/#[\/]?view\/([^\/]+)/)) {
                var a = i.router.parseQueryString(location.href), b = a.backUrl;
                b = b ? decodeURIComponent(b) : location.href, i.request.navigate("login", null, null, {
                    backUrl: b
                });
            }
            location.reload();
        });
        var d;
        i.isMacAgentAppstore() || i.isMacAgentLocal() ? (document.addEventListener("AgentWindowVisibility", function(a) {
            switch (a = a || {}, a.detail) {
              case "show":
                b();
                break;

              case "hide":
                c();
            }
        }), document.addEventListener("AgentNativeAction", function(a) {
            switch (a = a || {}, a.detail) {
              case "showFavorite":
                $(".mx-modal-backdrop").click(), $(".js-show-favorite").click();
                break;

              case "showMention":
                $(".mx-modal-backdrop").click(), $(".js-show-mention").click();
                break;

              case "hideMention":
              case "hideFavorite":
                $(".mx-modal-backdrop").click();
            }
        })) : $(document).on({
            "show.visibility": function() {
                b();
            },
            "hide.visibility": function() {
                c();
            }
        });
    }), Moxtra.api.util.setMomentLanguage(Moxtra.getMe().language), Moxtra.getMe().on("firstSubscribe", function() {
        function a(a) {
            if (a) {
                var c = a.lastFeed, g = c && c.message, h = c.isMe, j = {}, k = window.moxAgentSender;
                if (!(a.board && (a.board.islive || a.board.isnote) || c.type && c.type.indexOf(b) > -1)) return h ? void (e && (j = {
                    action: "feed_update_self",
                    message: g,
                    binder_id: a.board.id,
                    session_id: d
                }, i.sendMessage(j))) : void (a.is_notification_off || location.href.indexOf("meet/") > 0 || location.href.indexOf("note/") > 0 || a.isInvited || !a.feed_unread_count || "admin.moxtra.com" === location.hostname || h || (e ? (j = {
                    action: "feed_update",
                    title: a.board.name,
                    message: g,
                    binder_id: a.board.id,
                    session_id: d,
                    feed_unread_count: a.feed_unread_count
                }, i.sendMessage(j), k && k.moxNotification && k.moxNotification(JSON.stringify(j))) : MX.ui.notifyDesktop({
                    title: MX.cutStr(a.board.name, 30),
                    icon: f.getNotificationIcon(),
                    message: MX.cutStr(g, 70).split("\n")[0],
                    timeout: 10,
                    click: function() {
                        i.navigate("/timeline/" + a.board.id, !0);
                    }
                })));
            }
        }
        f.loadStyle(), Moxtra.getOnlineStatus().success(function() {
            var a = Moxtra.getUserContacts();
            MX.each(a, function(a) {
                a.online && $("[data-online=" + a.user.id + "]").addClass("online");
            });
        }), Moxtra.api.util.setMomentLanguage(Moxtra.getMe().language), Date.parseDate = function(a, b) {
            return moment(a, b).toDate();
        }, Date.prototype.dateFormat = function(a) {
            return "d.m.Y" === a && (a = "YYYY-MM-DD"), moment(this).format(a);
        }, !i.isIntegrationEnabled() && MX.env.isChrome && "Notification" in window && window.addEventListener("click", function g() {
            Notification.requestPermission(function() {}), window.removeEventListener("click", g);
        });
        var b = [ "FEED_RELATIONSHIP_LEAVE", "FEED_RELATIONSHIP_JOIN", "FEED_RELATIONSHIP_DECLINE", "FEED_RELATIONSHIP_CANCEL", "FEED_RELATIONSHIP_REMOVE", "FEED_RELATIONSHIP_CHANGE_ROLE", "FEED_FOLDER_CREATE" ], c = Moxtra.getMe(), d = c.sessionId, e = i.isIntegrationEnabled();
        c.on(Moxtra.const.EVENT_FEED_CHANGE, function(b) {
            if (!(c.revision < 1)) {
                var d;
                d = Moxtra.getUserBoard(b.sequence), d && d.lastFeed && a(d);
            }
        });
    }), i;
}), define("text!template/meet/joinMeet.html", [], function() {
    return '<div class="container2">\r\n    <h1 class="page-title">{{lang.meet_invitation}}</h1>\r\n    \r\n    <div id="mxMeetAction">\r\n    	\r\n    </div>\r\n</div>';
}), define("text!template/meet/joinMeetForm.html", [], function() {
    return '<form id="joinMeetForm" class="form-signin">\r\n	<div class="form-group" >\r\n		<input type="text" name="meetId" class="form-control meet-id" data-error-style="inline" placeholder="{{lang.meet_id}}" autofocus>\r\n	</div>\r\n	<div class="form-group" >\r\n		{{#if guest}}\r\n		<input type="text" name="name" class="form-control join-as-name" data-error-style="inline" placeholder="{{lang.meet_attendee_name_optional}}" autofocus>\r\n		{{else}}\r\n		{{lang.join_as_colon}} {{name}}\r\n		{{/if}}\r\n	</div>\r\n	<button class="btn btn-lg btn-primary btn-block"  type="submit">{{lang.join_meet}}</button>\r\n</form>\r\n';
}), define("meet/joinMeetModel", [ "moxtra", "app", "lang", "const", "meet/meetUtil" ], function(a, b, c, d, e) {
    return a.Model.extend({
        idAttribute: "boardId",
        defaults: {
            boardId: "",
            meetId: "",
            displayMeetId: "",
            name: "",
            status: "",
            meetDate: "",
            hostId: "",
            hostName: "",
            hostEmail: "",
            hostMsg: "",
            hasStarted: !1,
            hasError: !1,
            errorMsg: "",
            backHref: ""
        },
        setData: function(a) {
            a || (a = {}), this.set({
                boardId: a.id,
                name: Handlebars.Utils.escapeExpression(a.name)
            }), a.sessions && a.sessions[0] && a.sessions[0].session && this.set({
                status: a.sessions[0].session.session_status,
                meetId: a.sessions[0].session.session_key,
                displayMeetId: e.formatMeetId(a.sessions[0].session.session_key),
                meetDate: moment(a.sessions[0].session.scheduled_start_time).format("M/D/YY h:mm A"),
                hasStarted: a.sessions[0].session.session_status === d.meet.scheduleStatus.started
            });
            var b = MX.filter(a.users, {
                type: d.binder.role.Owner
            });
            b = b && b[0].user || {}, this.set({
                hostId: b.id,
                hostName: Handlebars.Utils.escapeExpression(b.name || b.first_name || b.email),
                hostEmail: Handlebars.Utils.escapeExpression(b.email),
                hostMsg: MX.format(c.meet_hosted_by, {
                    name: Handlebars.Utils.escapeExpression(b.name || b.first_name || b.email)
                })
            });
        },
        setError: function(a) {
            var b = MX.format(c.meet_invitation_invalid_id, a);
            a || (b = c.meet_invitation_id_required), this.set({
                hasError: !0,
                errorMsg: b
            });
        },
        setBackHref: function(a) {
            this.set({
                backHref: a
            });
        }
    });
}), define("text!template/meet/joinMeetView.html", [], function() {
    return '{{#if hasError}}\r\n<div class="alert alert-warning">\r\n	<span>{{bbcode errorMsg}}</span>\r\n	<br/>\r\n	<div class="container2 row">\r\n		<br/>\r\n		<div class="col-md-12">\r\n			<button class="btn btn-primary pull-right" data-action="goHome">{{lang.ok}}</button>\r\n		</div>\r\n	</div>\r\n</div>\r\n{{else}}\r\n<div class="join-meet-wrap">\r\n	<div class="row">\r\n		<div class="col-xs-5">\r\n			<div class="meet-info">\r\n				<div class="meet-item ellipsis-3line">{{bbcode name}}</div>\r\n				<div class="meet-item">{{displayMeetId}}</div>\r\n				<div class="meet-item">{{bbcode hostMsg}}</div>\r\n			</div>\r\n		</div>\r\n		<div class="col-xs-7">\r\n			<div class="mx-meet-invitation-form">\r\n				\r\n			</div>\r\n		</div>\r\n	</div>\r\n</div>\r\n{{/if}}\r\n';
}), define("text!template/meet/joinMeetOption.html", [], function() {
    return '<div>\r\n	<div class="meet-ask-host size16">{{scheduledDate}}</div>\r\n	<div class="meet-ask-host">{{lang.meet_invitation_if_host}}</div>\r\n	<div><a class="mouse-hand" data-action="showLogin">{{lang.meet_invitation_click_to_start}}</a></div>\r\n</div>';
}), define("text!template/meet/joinMeetAction.html", [], function() {
    return '<div class="meet-actions">\r\n	{{#if showMessage}}\r\n	<div class="alert {{alertClass}}">\r\n		<div>{{message}}</div>\r\n		<br/>\r\n		<button class="btn btn-primary" data-action="goHome">{{lang.ok}}</button>\r\n	</div>\r\n	{{else}}\r\n		{{#if isHost}}\r\n			{{#if scheduledDate}}\r\n			<div class="meet-msg">{{scheduledDate}}</div>\r\n			{{/if}}\r\n		<div class="meet-msg">{{lang.meet_invitation_click_start_button}}</div>\r\n		<button class="btn btn-primary" data-action="start">{{lang.start_meet}}</button>\r\n		{{else}}\r\n		<div class="meet-msg">\r\n			{{#if jbh}}\r\n			{{lang.meet_invitation_jbh_join_button}}\r\n			{{else}}\r\n			{{lang.meet_invitation_click_join_button}}\r\n			{{/if}}\r\n		</div>\r\n		{{#if showInput}}\r\n		<input type="text" name="name" class="form-control join-meet-name" data-error-style="inline" placeholder="{{lang.meet_attendee_name_optional}}" autofocus> <br/>\r\n		{{else}}\r\n		<div class="meet-msg">{{lang.join_as_colon}} {{attendee}}</div>\r\n		{{/if}}\r\n		<button class="btn btn-primary" data-action="join" data-param="{{attendee}}">{{lang.join_meet}}</button>\r\n		{{/if}}\r\n	{{/if}}\r\n</div>\r\n';
}), define("meet/joinMeetAction", [ "moxtra", "app", "lang", "text!template/meet/joinMeetAction.html" ], function(a, b, c, d) {
    return a.Controller.extend({
        template: d,
        handleAction: !0,
        init: function(a) {
            this.$scope.attendee = a.attendee || "", this.$scope.jbh = a.jbh || !1, this.$scope.lang = c, 
            "join" === a.action ? (this.$scope.showMessage = !1, this.$scope.isHost = !1, a.attendee ? (this.$scope.showInput = !1, 
            this.$scope.attendee = a.attendee) : this.$scope.showInput = !0) : "start" === a.action ? (this.$scope.showMessage = !1, 
            this.$scope.isHost = !0, this.$scope.scheduledDate = a.message || "") : "warning" === a.action ? (this.$scope.showMessage = !0, 
            this.$scope.alertClass = "alert-warning", this.$scope.message = a.message || "") : "error" === a.action && (this.$scope.showMessage = !0, 
            this.$scope.alertClass = "alert-danger", this.$scope.message = a.message || "");
        },
        rendered: function() {
            MX.env.isIE && $("textarea, :text").placeholder();
        }
    });
}), define("text!template/common/loginForm.html", [], function() {
    return '<form id="loginForm" class="form-signin">\r\n	<div class="form-group">\r\n		<span class="invitee-email">{{email}}</span>\r\n	</div>\r\n	<div class="form-group">\r\n		<input type="password" name="password" class="form-control" data-error-style="inline" placeholder="{{lang.password}}">\r\n	</div>\r\n	<label class="checkbox">\r\n        <input type="checkbox" name="remember_me" value="1"> {{lang.login_remember_me}}\r\n    </label>\r\n    <button class="btn btn-lg btn-primary btn-block"  type="submit">{{btnText}}</button>\r\n    <div class="form-group marginTop15">\r\n        <a href="/forgotpassword" target="_blank">{{lang.forgot_password}}</a>\r\n    </div>\r\n</form>';
}), define("identity/userModel", [ "moxtra", "lang" ], function(a) {
    return a.Model.extend({
        defaults: {
            email: "",
            password: "",
            first_name: "",
            last_name: "",
            remember_me: !1
        }
    });
}), define("identity/identityBiz", [ "moxtra" ], function(a) {
    return a.ns("MX.identify").extend({
        login: function(b) {
            var c = b.toJSON();
            return new a.ChainObject(function() {
                MX.login({
                    email: c.email,
                    password: c.password,
                    remember: "1" === c.remember_me
                }, this.callback, this);
            });
        },
        googleLogin: function(b) {
            return new a.ChainObject(function() {
                MX.login({
                    loginFrom: "google",
                    accessToken: b
                }, this.callback, this);
            });
        },
        sfLogin: function(b, c) {
            return new a.ChainObject(function() {
                MX.api("/users/me", "GET", {
                    action: "salesforce_login",
                    data: {
                        token: b,
                        login_url: c
                    }
                }, this.callback, this);
            });
        },
        resetPass: function(b) {
            var c = b.toJSON();
            return new a.ChainObject(function() {
                MX.api("/users/me", "PUT", {
                    action: "reset_password",
                    data: {
                        email: c.email
                    }
                }, this.callback, this);
            });
        },
        changePass: function(b) {
            var c = b.toJSON();
            return new a.ChainObject(function() {
                MX.api("/users/me", "PUT", {
                    action: "reset_password",
                    data: {
                        verify_token: c.token,
                        pass: c.pass
                    }
                }, this.callback, this);
            });
        },
        signup: function(b, c) {
            var d = b.toJSON();
            return c && (d = _.extend(d, c)), new a.ChainObject(function() {
                MX.api("/users", "POST", {
                    data: d
                }, this.callback, this);
            });
        },
        logout: function(a) {
            MX.logout(a), Moxtra.logout();
        },
        update: function() {},
        verifyEmailToken: function(b) {
            return new a.ChainObject(function() {
                MX.api("/users/me", "GET", {
                    action: "verify_email_token",
                    data: {
                        token: b
                    }
                }, this.callback, this);
            });
        },
        resendVerifyEmail: function() {
            return new a.ChainObject(function() {
                MX.api("/users/me", "PUT", {
                    action: "resend_verify_email"
                }, this.callback, this);
            });
        }
    });
}), define("common/loginForm", [ "moxtra", "lang", "app", "text!template/common/loginForm.html", "identity/userModel", "identity/identityBiz" ], function(a, b, c, d, e) {
    return a.Controller.extend({
        template: d,
        handleAction: !0,
        init: function(a) {
            this.$scope.email = a.email, this.callback = a.callback || function() {}, this.$scope.lang = b, 
            this.$scope.btnText = b.sign_in_and_accept, a.btnText && (this.$scope.btnText = a.btnText);
            var c = e.extend({
                validation: {
                    password: [ {
                        required: !0,
                        msg: b.password_is_required
                    } ]
                }
            });
            this.model = new c(), this.model.set({
                email: a.email
            });
        },
        rendered: function() {
            this.form = new a.Form({
                parent: this,
                form: this.$el,
                model: this.model,
                submit: this.submit,
                scope: this
            });
        },
        _success: function() {
            this.callback();
        },
        _error: function(c) {
            this.form.showError(c && 400 === c.status ? b.login_failed_user_pass : a.format(b.login_failed_unexpected, {
                code: err.xhr.status
            }));
        },
        submit: function() {
            var a = this.form, b = this, c = this.model.toJSON();
            a.disable(!0), Moxtra.login({
                email: c.email,
                pass: c.password,
                remember: c.remember_me
            }).setScope(b).success(b._success).error(b._error).complete(function() {
                a.disable(!1);
            });
        }
    });
}), define("meet/joinMeetView", [ "moxtra", "lang", "app", "const", "text!template/meet/joinMeetView.html", "text!template/meet/joinMeetOption.html", "meet/joinMeetAction", "common/loginForm", "meet/meet" ], function(a, b, c, d, e, f, g, h, i) {
    var j = Handlebars.compile(f);
    return a.Controller.extend({
        template: e,
        handleAction: !0,
        events: {
            "keydown input": "onInputName"
        },
        init: function(a) {
            this.profile = a.profile, this.$scope.lang = b;
        },
        rendered: function() {
            var a = this.profile, d = this.model.toJSON(), e = this, f = "";
            d.hasError || Moxtra.verifyToken().complete(function() {
                var h = Moxtra.getMe();
                if (a.hasSession) if (a.isActive) {
                    var k = "";
                    h.id ? e.join(h.name) : e.recovery(new g({
                        action: "join",
                        attendee: k,
                        renderTo: ".mx-meet-invitation-form"
                    }));
                } else a.isExpired ? e.recovery(new g({
                    action: "error",
                    message: b.join_meet_but_has_ended,
                    renderTo: ".mx-meet-invitation-form"
                })) : a.isScheduled && (f = a.joinBeforeHost ? MX.format(b.join_meet_jbh_but_ahead_of_scheduled, {
                    date: a.scheduledDate,
                    minutes: a.joinBeforeHost / 6e4
                }) : MX.format(b.join_meet_but_ahead_of_scheduled, {
                    date: a.scheduledDate
                }), Date.now() > a.scheduledStartTime && (f = b.join_meet_within_minutes_of_scheduled), 
                h.id ? h.id === d.hostId ? e.recovery(new g({
                    action: "start",
                    message: "",
                    renderTo: ".mx-meet-invitation-form"
                })) : a.joinBeforeHost && a.joinBeforeHost >= a.scheduledStartTime - Date.now() ? i.join({
                    sessionKey: d.meetId,
                    userName: h.name,
                    backHref: d.backHref,
                    error: function() {
                        MX.ui.notifyError(b.join_meet_but_has_ended), setTimeout(function() {
                            c.navigate("/login", !0);
                        }, 1e3);
                    }
                }) : e.recovery(new g({
                    action: "warning",
                    message: f,
                    renderTo: ".mx-meet-invitation-form"
                })) : a.joinBeforeHost && a.joinBeforeHost >= a.scheduledStartTime - Date.now() ? e.recovery(new g({
                    action: "join",
                    jbh: !0,
                    attendee: k,
                    renderTo: ".mx-meet-invitation-form"
                })) : e.$(".mx-meet-invitation-form").append($(j({
                    lang: b,
                    scheduledDate: f
                }))));
            });
        },
        join: function(a) {
            a || (a = this.$(".join-meet-name").val());
            var d = this.model.toJSON();
            i.joinAssigned({
                sessionKey: d.meetId,
                userName: a,
                backHref: d.backHref,
                error: function() {
                    MX.ui.notifyError(b.join_meet_but_has_ended), setTimeout(function() {
                        c.navigate("/login", !0);
                    }, 1e3);
                }
            });
        },
        start: function() {
            var a = this.model.toJSON();
            i.startAssigned({
                boardId: a.boardId,
                sessionKey: a.meetId,
                topic: a.topic,
                backHref: a.backHref
            });
        },
        onInputName: function(a) {
            if (a.keyCode === c.const.keys.Enter && !a.shiftKey) {
                var b = this.$(".join-meet-name").val();
                b && this.join(b);
            }
        },
        showLogin: function() {
            this.$(".mx-meet-invitation-form").empty();
            var a = this.model.toJSON(), c = this;
            this.recovery(new h({
                email: a.hostEmail,
                btnText: b.sign_in_and_start,
                callback: function() {
                    c.start();
                },
                renderTo: ".mx-meet-invitation-form"
            }));
        },
        goHome: function() {
            Moxtra.getMe().id ? c.navigate("/meetintro", !0) : c.navigate("/login", !0);
        }
    });
}), define("meet/joinMeet", [ "moxtra", "lang", "app", "text!template/meet/joinMeet.html", "text!template/meet/joinMeetForm.html", "meet/joinMeetModel", "meet/joinMeetView", "meet/meetUtil", "meet/meet" ], function(a, b, c, d, e, f, g, h, i) {
    var j = Handlebars.compile(e), k = MX.logger("joinMeet");
    return a.Controller.extend({
        template: d,
        init: function() {
            this.$scope.lang = b, this.meetId = c.request.page(), this.model = new f();
        },
        rendered: function() {
            this.$("#mxMeetAction").loading({
                length: 7
            }), window.name = c.config.global.meetTabName;
            var a = this;
            this.meetId ? i.readById(this.meetId).success(function(b) {
                a._success(b);
            }).error(function(b) {
                a._error(b);
            }) : this._renderJoinForm();
        },
        _success: function(a) {
            this.model.setData(a.object.board), this.model.setBackHref(this._getBackHref()), 
            this._show(h.parseMeetInfo(a));
        },
        _error: function(a) {
            window.name = "", this.model.setError(this.meetId), this.model.setBackHref(this._getBackHref()), 
            this._show(h.parseMeetInfo(a));
        },
        _show: function(a) {
            this.$("#mxMeetAction").loading(!1), this.recovery(new g({
                model: this.model,
                profile: a,
                renderTo: "#mxMeetAction"
            }));
        },
        _getBackHref: function() {
            return "#mymeet?action=default";
        },
        _renderJoinForm: function() {
            this.$("#mxMeetAction").loading(!1);
            var c = a.Model.extend({
                defaults: {
                    meetId: "",
                    name: ""
                },
                validation: {
                    meetId: [ {
                        required: !0,
                        msg: b.meet_id_required
                    }, {
                        pattern: /(\d+|\s*)/,
                        msg: b.meet_id_format_error
                    } ]
                }
            }), d = this;
            this.formModel = new c(), Moxtra.verifyToken().complete(function() {
                var c = Moxtra.getMe(), e = !0, f = "";
                c.id && (e = !1, f = c.name, d.formModel.set({
                    name: f
                })), d.$("h1.page-title").html(b.join_meet), d.$("#mxMeetAction").html($(j({
                    lang: b,
                    guest: e,
                    name: f
                }))), MX.env.isIE && d.$("#joinMeetForm input").placeholder(), this.form = new a.Form({
                    parent: d,
                    id: "#joinMeetForm",
                    model: d.formModel,
                    submit: d._joinMeet,
                    scope: d
                });
            });
        },
        _joinMeet: function() {
            this.$("#mxMeetAction").loading({
                length: 7
            });
            var a = this.formModel.get("meetId"), c = this.formModel.get("name") || b.meet_guest, d = this;
            a = a.replace(/(-|\s*)/gi, ""), i.join({
                backHref: d._getBackHref(),
                sessionKey: a,
                userName: c,
                success: function() {
                    k.log("joined meet !!!"), d.$("#mxMeetAction").loading(!1);
                },
                error: function(a) {
                    k.error("Join meet error", a), d.$("#mxMeetAction").loading(!1);
                }
            });
        }
    });
}), define("text!template/meet/main.html", [], function() {
    return '<div class="mx-meet default">\n    <header class="mx-branding-meet-header mxbrand-meet-header">\n    	<div class="mx-meet-header row">\n    		<div class="col-xs-12">\n    			<a class="pull-left"><i class="mx-branding-meet-logo mx-logo-white mxbrand-logo"></i></a>\n                <div class="pull-left"><i class="mxbrand-powered-by-moxtra"></i></div>\n    			<div class="meet-topbar-topic pull-left">\n\n    			</div>\n    			<div class="meet-topbar-speaker pull-left">\n\n    			</div>\n\n    			<div class="pull-right">\n    				<div class="meet-btn-exit topbar-action" data-action="exitMeet"><i class="mx-branding micon-close size20" title="{{exitTooltip}}" data-placement="bottom"></i></div>\n    			</div>\n    			<div class="mx-meet-toggleside pull-right {{#if disableToggleSide}}hide{{/if}}">\n    				<div class="mx-branding meet-btn-toggle topbar-action active" data-action="toggleSide"><i class="mx-branding micon-users size20 on" title="{{lang.meet_tooltip_hide_panel}}" data-placement="bottom"></i><i class="micon-users-empty size20 off" title="{{lang.meet_tooltip_show_panel}}" data-placement="bottom"></i></div>\n    			</div>\n    			<div class="mx-meet-video pull-right">\n\n    			</div>\n    			<div class="mx-meet-telephony pull-right">\n\n    			</div>\n    			<div class="meet-topbar-mic pull-right">\n\n    			</div>\n    			<div class="meet-topbar-ds pull-right">\n\n    			</div>\n    			<div class="meet-topbar-add pull-right mxbrand-hide">\n\n    			</div>\n    		</div>\n    	</div>\n    </header>\n    <footer></footer>\n    <!-- <div id="mxMeetPlugin"></div> -->\n    <div class="mx-meet-webrtc">\n    	<div id="localvideo"><video id="sourcevid" muted="true" autoplay style="width:100px;height:100px;" class="hide"></video></div>\n		<div id="remotevideovid1"><video id="remotevid1" autoplay class="hide"></video></div>\n		<div id="remotevideovid2"><video id="remotevid2" autoplay class="hide"></video></div>\n		<div id="remotevideovid3"><video id="remotevid3" autoplay class="hide"></video></div>\n		<div id="remotevideovid4"><video id="remotevid4" autoplay class="hide"></video></div>\n    </div>\n    <a id="uploadDragDropInMeetHidden" class="hide"></a>\n    <!-- <div class="mx-meet-video"></div> -->\n</div>\n';
}), define("text!template/meet/participant.html", [], function() {
    return '<div class="participant-list">\r\n\r\n</div>';
}), define("common/messageListener", [ "moxtra" ], function() {
    "use strict";
    var a, b = function(b) {
        if (a && a.binder_id && b.source !== window && (b.source === window.parent || b.source === window.opener)) {
            var c = {};
            try {
                c = JSON.parse(b.data);
            } catch (b) {
                return void console.error(b);
            }
            "message" === c.action && (c.sender = a.session_id, c.delivery_mode = c.delivery_mode || "broadcast", 
            Moxtra.createBoardTag(a.binder_id, "MessageID_" + c.message_id, JSON.stringify(c)));
        }
    };
    return {
        on: function(c) {
            a = c || a, MX.messageListener || ("undefined" != typeof window.addEventListener ? window.addEventListener("message", b, !1) : "undefined" != typeof window.attachEvent && window.attachEvent("onmessage", b), 
            MX.messageListener = !0);
        },
        off: function() {
            "undefined" != typeof window.addEventListener ? window.removeEventListener("message", b, !1) : "undefined" != typeof window.attachEvent && window.detachEvent("onmessage", b), 
            a = null, MX.messageListener = !1;
        }
    };
}), define("meet/meetModel", [ "moxtra", "lang", "app" ], function(a) {
    var b = MX.logger("meet:model");
    return a.Model.extend({
        idAttribute: "boardId",
        defaults: {
            boardId: "",
            sessionKey: "",
            topic: "",
            zone: "",
            meetHost: {},
            hostId: "",
            meetPresenter: {},
            boardOwner: {},
            changedRoster: [],
            userRoster: {},
            userId: Moxtra.getMe().id,
            sessionId: Moxtra.getMe().sessionId,
            firstSubscribe: !1,
            participantNumber: 0,
            isExpired: !1,
            isEnded: !1,
            isMeetHost: !1,
            isMeetPresenter: !1,
            isInvisible: !1,
            noPermission: !1,
            selfLeft: !1,
            currentPage: 0,
            syncPage: 0,
            shareType: "off",
            videoState: [],
            latestRecordingState: "",
            laserPointer: {},
            notifyStatus: {},
            appConfig: {}
        },
        setData: function(a) {
            if (a.is_deleted) return void this.set("isEnded", !0);
            if (a.is_expired) return void this.set({
                isExpired: !0
            });
            var c = Moxtra.getMe();
            if (this.set("sessionId", c.sessionId), this.set("userId", c.id), a.board_id && this.set({
                boardId: a.board_id
            }), a.session_key && this.set({
                sessionKey: a.session_key
            }), a.topic && this.set({
                topic: Handlebars.Utils.escapeExpression(a.topic)
            }), a.user_roster) {
                this.set("changedRoster", a.user_roster);
                var d = this.get("userRoster"), e = !1, f = this;
                MX.each(a.user_roster, function(a) {
                    d[a.id] = a, a.is_host && (f.set({
                        meetHost: a
                    }, {
                        silent: !0
                    }), a.user && f.set({
                        hostId: a.user.id
                    }, {
                        silent: !0
                    })), a.is_presenter && f.set({
                        meetPresenter: a
                    }, {
                        silent: !0
                    }), a.id === f.get("sessionId") && (f.set("isMeetHost", !!a.is_host), f.set("isMeetPresenter", !!a.is_presenter), 
                    f.set("isInvisible", !!a.is_invisible), a.participant_number && f.set("participantNumber", a.participant_number), 
                    e = !!a.is_deleted);
                }), this.set({
                    selfLeft: e
                }), this.set({
                    userRoster: d
                }, {
                    silent: !0
                });
            }
            a.page_switch && (a.page_switch.id === this.get("sessionId") ? this.set({
                syncPage: a.page_switch.page_sequence
            }, {
                silent: !0
            }) : this.set({
                syncPage: a.page_switch.page_sequence
            })), a.video_state && (a.video_state[0] && a.video_state[0].id === this.get("sessionId") ? (b.log("set video_state silent"), 
            this.set({
                videoState: a.video_state
            }, {
                silent: !0
            })) : (b.log("set video_state"), this.set({
                videoState: a.video_state
            }))), a.recording_state && this.set({
                latestRecordingState: a.recording_state[a.recording_state.length - 1].status
            }), a.laser_pointer && (a.laser_pointer.id === this.get("sessionId") ? (b.log("set laser_pointer silent"), 
            this.set({
                laserPointer: a.laser_pointer
            }, {
                silent: !0
            })) : (b.log("set laser_pointer silent"), this.set({
                laserPointer: a.laser_pointer
            })));
        },
        setCurrentPage: function(a) {
            this.set({
                currentPage: a
            });
        },
        setNotifyStatus: function(a) {
            a && this.set({
                notifyStatus: {
                    hasData: !0
                }
            });
            var b = this.get("notifyStatus");
            b.hasData && !a && (b.notify = !0, this.set({
                notifyStatus: b
            }));
        },
        setNoPermission: function(a) {
            a && this.set({
                noPermission: !!a
            });
        },
        setAppConfig: function(a) {
            var b = this.get("appConfig");
            this.set({
                appConfig: _.extend(b, a)
            }, {
                silent: !0
            });
        },
        setShareType: function(a, b) {
            this.set({
                shareType: a
            }, {
                silent: !!b
            });
        },
        reset: function() {
            var a = this.defaults;
            a.userRoster = {}, a.appConfig = {}, this.set(a, {
                silent: !0
            });
        }
    });
}), define("meet/audio/audioModel", [ "moxtra", "lang" ], function(a) {
    return a.Model.extend({
        idAttribute: "id",
        defaults: {
            id: Moxtra.getMe().sessionId,
            audioConf: {},
            serverAddr: "",
            port: 5e3,
            token: "",
            isWebrtc: !1,
            isEnabled: !1,
            isMuted: !1,
            uiEnabled: !1,
            uiMuted: !1,
            ssrc: 0,
            deviceLevel: {},
            deviceWarning: 0,
            audiences: {},
            ssrcMapping: {},
            speakers: {},
            speaking: 0,
            networks: [],
            networking: 0,
            nativeConnecting: 0,
            nativeConnected: 0,
            reconnecting: 0,
            reconnected: 0,
            reconnectTimeout: 0,
            notify: !1,
            actionDone: 0,
            mutedDone: 0,
            left: 0,
            cmdMute: 0,
            telephonyJoined: !1,
            telephonyMuted: !1,
            micStatus: 1,
            micStatusUpdated: 0
        },
        setData: function(a) {
            if (this.set("id", Moxtra.getMe().sessionId), a.user_roster) {
                var b, c = this, d = this.get("id"), e = this.get("audiences") || {}, f = this.get("ssrcMapping") || {};
                MX.each(a.user_roster, function(a) {
                    a.id === d && (a.audio_status && a.audio_status.is_mute && a.requestor_id !== d && c.set({
                        cmdMute: Math.random()
                    }), a.telephone_status && c.set({
                        telephonyJoined: a.telephone_status.is_in_session,
                        telephonyMuted: a.telephone_status.is_mute
                    })), a.audio_status && a.audio_status.ssrc && (a.id !== d && !e[a.audio_status.ssrc] && a.user && (e[a.audio_status.ssrc] = a.user.name || a.user.first_name || a.user.last_name || a.user.email || ""), 
                    f[a.audio_status.ssrc] || (b || (b = _.invert(f)), b[a.id] && MX.each(f, function(b, c) {
                        b === a.id && (delete f[c], delete e[c]);
                    }), f[a.audio_status.ssrc] = a.id));
                }), this.set({
                    audiences: e,
                    ssrcMapping: f
                }, {
                    silent: !0
                });
            }
            a.audio_conf && (this.set({
                audioConf: a.audio_conf
            }), this.set({
                serverAddr: a.audio_conf.server_addr,
                port: a.audio_conf.port || 5e3,
                token: a.audio_conf.token
            }));
        },
        getAudioConf: function() {
            return this.get("audioConf");
        },
        setWebrtc: function(a) {
            this.set({
                isWebrtc: !!a
            }, {
                silent: !0
            });
        },
        setSSRC: function(a) {
            this.set({
                ssrc: a
            }, {
                silent: !0
            });
        },
        setEnabled: function(a) {
            this.set({
                isEnabled: !!a,
                uiEnabled: !!a
            });
        },
        setMuted: function(a) {
            this.set({
                isMuted: !!a,
                uiMuted: !!a
            }), !!a !== this.previous("isMuted") && this.set({
                notify: Math.random()
            });
        },
        setLeft: function() {
            this.set({
                left: Math.random()
            });
        },
        setReconnecting: function() {
            this.set({
                reconnecting: Math.random()
            });
        },
        setReconnected: function() {
            this.set({
                reconnected: Math.random()
            });
        },
        setReconnectTimeout: function() {
            this.set({
                reconnectTimeout: Math.random()
            });
        },
        setSpeakers: function(a) {
            this.set({
                speakers: a,
                speaking: Math.random()
            });
        },
        setDeviceLevel: function(a) {
            this.set({
                deviceLevel: a,
                deviceWarning: Math.random()
            });
        },
        setNetworks: function(a) {
            this.set({
                networks: a,
                networking: Math.random()
            });
        },
        setNativeConnecting: function() {
            this.set({
                nativeConnecting: Math.random()
            });
        },
        setNativeConnected: function() {
            this.set({
                nativeConnected: Math.random()
            });
        },
        setActionDone: function() {
            this.set({
                actionDone: Math.random()
            });
        },
        setMutedDone: function() {
            this.set({
                mutedDone: Math.random()
            });
        },
        setMicStatus: function(a) {
            this.set({
                micStatus: a,
                micStatusUpdated: Math.random()
            });
        },
        reset: function() {
            var a = this.defaults;
            this.set(a, {
                silent: !0
            });
        }
    });
}), define("meet/video/videoModel", [ "moxtra" ], function(a) {
    return a.Model.extend({
        idAttribute: "id",
        defaults: {
            id: Moxtra.getMe().sessionId,
            videoConf: {},
            confId: "",
            serverAddr: "",
            port: 443,
            token: "",
            layout: 0,
            quality: 1,
            audiobutton: !1,
            isJoined: !1,
            isBroadcast: 0,
            cmdJoin: 0,
            cmdCheck: 0,
            cameras: {}
        },
        setData: function(a) {
            if (a.audio_conf && (this.set("id", Moxtra.getMe().sessionId), this.set({
                videoConf: a.audio_conf
            }), this.set({
                confId: a.audio_conf.conf_id || "",
                serverAddr: a.audio_conf.server_addr || "",
                port: a.audio_conf.port || 5e3,
                token: a.audio_conf.token || ""
            })), a.user_roster) {
                var b = this.get("id"), c = this.get("cameras"), d = this.get("isJoined"), e = !1;
                MX.each(a.user_roster, function(a) {
                    d || !a.is_deleted && a.id !== b && a.video_status && a.video_status.is_in_session && a.video_status.is_broadcast && (e = !0), 
                    a.is_deleted ? delete c[a.id] : a.video_status && (c[a.id] = a.video_status.is_in_session && a.video_status.is_broadcast ? 1 : 0);
                }), this.set({
                    cameras: c,
                    cmdCheck: Math.random()
                }), e && this.set({
                    cmdJoin: Math.random()
                });
            }
        },
        setJoined: function(a) {
            this.set({
                isJoined: !!a
            });
        },
        setBroadcast: function(a) {
            this.set({
                isBroadcast: !!a
            });
        },
        setLayout: function(a) {
            this.set({
                layout: a
            }, {
                silent: !0
            });
        },
        setQuality: function(a) {
            this.set({
                quality: a
            }, {
                silent: !0
            });
        },
        setAudiobutton: function(a) {
            this.set({
                audiobutton: a
            }, {
                silent: !0
            });
        },
        reset: function() {
            var a = this.defaults;
            this.set(a, {
                silent: !0
            });
        }
    });
}), define("meet/telephony/telephonyModel", [ "moxtra", "lang" ], function(a) {
    "use strict";
    return a.Model.extend({
        idAttribute: "id",
        defaults: {
            id: Moxtra.getMe().sessionId,
            numbers: []
        },
        setData: function(a) {
            a.telephony_conf && a.telephony_conf.numbers && this.set({
                numbers: a.telephony_conf.numbers
            });
        },
        reset: function() {
            var a = this.defaults;
            this.set(a, {
                silent: !0
            });
        }
    });
}), define("meet/ds/dsModel", [ "moxtra", "lang", "app", "meet/meetUtil" ], function(a, b, c, d) {
    var e = MX.logger("meet:dsmodel");
    return a.Model.extend({
        idAttribute: "sequence",
        defaults: {
            sequence: 0,
            sessionKey: "",
            sessionId: Moxtra.getMe().sessionId,
            dsConf: {},
            serverAddr: "",
            port: 443,
            token: "",
            dsState: {},
            aLoad: !1,
            aConnected: 0,
            aStarted: !1,
            aReconnect: !1,
            aTimeout: 0,
            aStopped: !1,
            aNotSupported: !1,
            aResize: {},
            pStarted: !1,
            pStopped: !1,
            pNotSupported: !1,
            destoryAction: !1
        },
        setData: function(a) {
            if (this.set("sessionId", Moxtra.getMe().sessionId), a.session_key && this.set({
                sessionKey: a.session_key
            }, {
                silent: !0
            }), a.ds_conf && (this.set({
                dsConf: a.ds_conf
            }), this.set({
                serverAddr: a.ds_conf.server_addr,
                port: a.ds_conf.port || 443,
                token: a.ds_conf.token
            })), a.ds_state) {
                var b = this.get("dsState");
                MX.each(a.ds_state, function(a) {
                    b[a.page_sequence] = a;
                }), e.logServer(d.logFormat("[dsModel setData] state updated to: " + JSON.stringify(b), {
                    meetId: this.get("sessionKey"),
                    rosterId: this.get("sessionId")
                })), this.set({
                    dsState: b
                });
            }
        },
        getSessionKey: function() {
            return this.get("sessionKey");
        },
        getSessionId: function() {
            return this.get("sessionId");
        },
        getDSConf: function() {
            return this.get("dsConf");
        },
        getDSState: function() {
            return this.get("dsState")[this.get("sequence")];
        },
        getSequence: function() {
            return this.get("sequence");
        },
        getAttendeeResize: function() {
            return this.get("aResize");
        },
        setSequence: function(a) {
            this.set({
                sequence: a
            }, {
                silent: !0
            });
        },
        setAttendeeLoad: function(a) {
            this.set({
                aLoad: !!a
            });
        },
        setAttendeeConnected: function() {
            this.set({
                aConnected: Math.random()
            });
        },
        setAttendeeStarted: function(a) {
            this.set({
                aStarted: !!a
            });
        },
        setAttendeeReconnect: function(a) {
            a ? this.set({
                aReconnect: !!a
            }) : this.set({
                aReconnect: !!a
            }, {
                silent: !0
            });
        },
        setAttendeeTimeout: function(a) {
            this.set({
                aTimeout: a
            });
        },
        setAttendeeStopped: function(a) {
            this.set({
                aStopped: !!a
            });
        },
        setAttendeeNotSupported: function(a) {
            a ? this.set({
                aNotSupported: !!a
            }) : this.set({
                aNotSupported: !!a
            }, {
                silent: !0
            });
        },
        setAttendeeResize: function(a) {
            this.set({
                aResize: a
            });
        },
        setPresenterStarted: function(a) {
            this.set({
                pStarted: !!a
            });
        },
        setPresenterStopped: function(a) {
            this.set({
                pStopped: !!a
            });
        },
        setPresenterNotSupported: function(a) {
            a ? this.set({
                pNotSupported: !!a
            }) : this.set({
                pNotSupported: !!falg
            }, {
                silent: !0
            });
        },
        triggerDestoryAction: function() {
            this.set({
                destoryAction: Math.random()
            });
        },
        reset: function() {
            var a = this.defaults;
            delete a.dsConf, a.dsState = {}, a.aResize = {}, this.set(a, {
                silent: !0
            });
        }
    });
}), define("binder/binderPageModel", [ "moxtra", "lang", "const" ], function(a, b, c) {
    {
        var d = c.binder.pageType, e = c.defaults.binder, f = _.invert(d);
        MX.logger("pageModel");
    }
    return a.Model.extend({
        idAttribute: "sequence",
        defaults: {
            name: "",
            sequence: "",
            background: "",
            thumbnail: "",
            url: "",
            width: 1024,
            height: 768,
            boardid: "",
            source: "",
            totalComments: 0,
            rotate: 0,
            pageIndex: 0,
            isMedia: !1,
            token: ""
        },
        parse: function(b, d) {
            b.boardid = d.boardid;
            var g = MX.pick(b, [ "sequence", "name", "vector", "boardid", "background", "width", "page_type", "page_group", "total_comments", "type", "height", "rotate", "pageIndex", "page_number", "url" ], {
                format: function(a) {
                    return MX.camelize(a);
                }
            });
            g.pageNumber || (g.pageNumber = 1 * g.sequence), g.type = f[b.page_type];
            var h = c.binder.pageType;
            g.isMedia = [ h.video, h.audio, h.note ].indexOf(b.page_type) > -1, g.isWeb = b.page_type === h.web, 
            g.isUrl = b.page_type === h.url;
            var i, j;
            if (b.thumbnail) i = a.format("/board/${boardid}/${sequence}/${thumbnail}", b); else switch (g.pageType) {
              case h.whiteboard:
              case h.web:
                i = e.thumbnail_whiteboard;
                break;

              case h.note:
                i = c.defaults.blankImg;
                break;

              case h.unknown:
                i = e.thumbnail_file;
                break;

              default:
                i = c.defaults.blankImg;
            }
            g.thumbnail = i, g.pageType == h.whiteboard ? j = c.defaults.source.unknown : g.pageType == h.unknown ? j = c.defaults.source.unknown : /web|url|video|audio|note/.test(g.type) ? j = a.format("/board/${boardid}/${sequence}/${vector}", g) : (b.background || (b.background = "background"), 
            j = a.format("/board/${boardid}/${sequence}/${background}", b)), g.source = j, d.token ? (g.thumbnail !== c.defaults.blankImg && (g.thumbnail += "?t=" + d.token), 
            g.source += "?t=" + d.token, g.token = d.token) : (g.thumbnail !== c.defaults.blankImg && (g.thumbnail = Moxtra.util.makeAccessTokenUrl(g.thumbnail)), 
            g.source = Moxtra.util.makeAccessTokenUrl(g.source));
            var k = b.height;
            return (!k || 0 >= k) && (g.height = 768), k = b.width, (!k || 0 >= k) && (g.width = 1024), 
            g;
        }
    });
}), define("meet/pagesCollection", [ "moxtra", "binder/binderPageModel" ], function(a, b) {
    return a.Collection.extend({
        model: b,
        updatePageIndex: function() {
            var a = 1;
            this.each(function(b) {
                b.set("pageIndex", a), a++;
            });
        }
    });
}), define("meet/brandingCache", [ "moxtra", "const" ], function(a, b) {
    "use strict";
    var c = null, d = "", e = null, f = {}, g = {}, h = function(a, b) {
        var c, d = !0;
        return c = b.get(a) || {}, "0" === c.string_value && (d = !1), d;
    }, i = function(a, b) {
        var c = b.get(a) || {};
        return c.string_value || "";
    }, j = "configuration", k = "branding", l = function(a, b) {
        var d, e = !0;
        return d = MX.get("tags", c), d && (b === j ? MX.get("has_configuration", c.group_caps) && (e = h(a, d)) : b === k && MX.get("has_branding", c.group_caps) && (e = h(a, d))), 
        e;
    }, m = function(a, b) {
        var d = "", e = MX.get("tags", c);
        return e && (b === j ? MX.get("has_configuration", c.group_caps) && (d = i(a, e)) : b === k && MX.get("has_branding", c.group_caps) && (d = i(a, e))), 
        d;
    }, n = function() {
        var a = {};
        return l(b.branding.showMeetAudio, j) || (a[b.meet.tags.hideAudio] = !0), l(b.branding.showMeetVideo, j) || (a[b.meet.tags.hideVideo] = !0), 
        l(b.branding.showMeetShareScreen, j) || (a[b.meet.tags.hideSharing] = !0), l(b.branding.showAddFile, j) || (a[b.meet.tags.hideShareFile] = !0), 
        a[b.branding.defaultUserAvatar] = m(b.branding.defaultUserAvatar, k), a[b.branding.webMeetHeaderBgColor] = m(b.branding.webMeetHeaderBgColor, k), 
        a[b.branding.webMeetHeaderTextColor] = m(b.branding.webMeetHeaderTextColor, k), 
        l(b.branding.disableAutoJoinAudio, j) || (a[b.meet.tags.autoJoinAudio] = !0), l(b.branding.enableMeetTelephony, j) || (a[b.meet.tags.hideAudioTelephony] = !0), 
        a;
    }, o = function() {
        f = {};
        var a = {}, c = n();
        e && MX.each(e, function(c) {
            c.name && (a[c.name] = [ b.meet.tags.endPage, b.meet.tags.videoQuality ].indexOf(c.name) > -1 ? c.string_value : "1" === c.string_value);
        }), MX.each(c, function(b, c) {
            b && (a[c] = b);
        }), f = a;
    }, p = {
        getBoolTag: function(a) {
            return f[a] ? !0 : !1;
        },
        getStringTag: function(a) {
            return f[a] || "";
        },
        getAppConfig: function(a) {
            var c, d = {};
            d[b.meet.tags.hideAudio] = this.getBoolTag(b.meet.tags.hideAudio), d[b.meet.tags.hideVideo] = this.getBoolTag(b.meet.tags.hideVideo), 
            "api.video" === a ? (d[b.meet.tags.hideSharing] = !0, d[b.meet.tags.videoToolbar] = !0, 
            c = b.video.quality.normal) : (d[b.meet.tags.hideSharing] = this.getBoolTag(b.meet.tags.hideSharing), 
            d[b.meet.tags.videoToolbar] = !1, c = b.video.quality.high);
            var e = this.getStringTag(b.meet.tags.videoQuality) || c;
            d[b.meet.tags.videoQuality] = 1 * e;
            var f = this.getStringTag(b.branding.webMeetHeaderBgColor);
            return f && (d[b.branding.webMeetHeaderBgColor] = f), f = this.getStringTag(b.branding.webMeetHeaderTextColor), 
            f && (d[b.branding.webMeetHeaderTextColor] = f), d;
        },
        clear: function() {
            c = null, d = "", e = null, f = {}, g = {};
        }
    };
    return Object.defineProperties(p, {
        org: {
            set: function(a) {
                a && (c = a, o());
            }
        },
        orgId: {
            set: function(a) {
                d = a || "";
            },
            get: function() {
                return d;
            }
        },
        boardTags: {
            set: function(a) {
                a && (e = a, o());
            }
        },
        data: {
            get: function() {
                return f;
            }
        },
        userCap: {
            set: function(a) {
                g = a || {};
            },
            get: function() {
                return g;
            }
        }
    }), p;
}), define("meet/participant/participantModel", [ "moxtra", "lang", "app", "const", "meet/brandingCache" ], function(a, b, c, d, e) {
    "use strict";
    return a.Model.extend({
        idAttribute: "id",
        defaults: {
            id: "",
            name: b.meet_guest,
            email: "",
            avatar: d.defaults.user.avatar,
            isMe: !1,
            isHost: !1,
            isPresenter: !1,
            isAudioEnabled: !1,
            isAudioMuted: !1,
            isTelephoneEnabled: !1,
            isTelephoneMuted: !1,
            enableMuteAction: !1,
            enableOptions: !1,
            pureCallIn: !1,
            isCallIn: !1,
            telephoneOnly: !1,
            uid: "u" + parseInt(100 * Math.random(), 10),
            inSession: !1,
            attendeeSequence: 0,
            attendeeStatus: "",
            networkLossrate: 0,
            networkLetency: 0,
            networkJitter: 0,
            networkQuality: "",
            isTeam: !1,
            rawData: {}
        },
        parse: function(a, b) {
            var c, f, g = {}, h = MX.get("id", Moxtra.getMyGroup()) || "";
            return g.rawData = a, g.id = a.id, g.isMe = a.id === b.meet.sessionId, g.isHost = !!a.is_host, 
            g.isPresenter = !!a.is_presenter, a.user && (g.name = Handlebars.Utils.escapeExpression(a.user.name || a.user.first_name || a.user.email), 
            g.email = Handlebars.Utils.escapeExpression(a.user.email || ""), g.unique_id = a.user.unique_id, 
            g.userId = a.user.id || "", a.user.picture ? (g.avatar = [ "/board", b.boardId, a.user.id, a.user.picture ].join("/"), 
            g.avatar += "?sessionid=" + a.id) : (f = a.user.id || a.user.email || a.user.unique_id, 
            c = Moxtra.getUserContact(f) || Moxtra.getGroupContact(f), c && c.avatar && (g.avatar = c.avatar), 
            g.avatar && 0 === g.avatar.indexOf("/group/") && h !== e.orgId && (g.avatar = ""), 
            g.avatar || (g.avatar = e.getStringTag(d.branding.defaultUserAvatar) || Moxtra.config.user.avatar), 
            g.avatar += "?sessionid=" + a.id)), a.group && a.group.id && (g.name = Handlebars.Utils.escapeExpression(a.group.name), 
            g.avatar = Moxtra.config.group.avatar, g.isTeam = !0), a.audio_status && (g.isAudioEnabled = !!a.audio_status.is_in_session, 
            g.isAudioMuted = !!a.audio_status.is_mute), a.telephone_status && (g.isTelephoneEnabled = !!a.telephone_status.is_in_session, 
            g.isTelephoneMuted = !!a.telephone_status.is_mute, g.isCallIn = !0, g.pureCallIn = !!a.telephone_status.is_pure_telephone_user), 
            g.telephoneOnly = g.isTelephoneEnabled && !g.isAudioEnabled ? !0 : !1, g.enableMuteAction = (b.meet.isMeetHost || b.meet.isMeetPresenter) && g.isAudioEnabled && !g.isAudioMuted, 
            g.enableOptions = b.meet.isMeetHost || b.meet.isMeetPresenter, g.uid = this.cid, 
            g.inSession = !!b.inSession, !g.inSession && a.status && (g.attendeeSequence = a.sequence, 
            a.is_deleted ? g.attendeeStatus = "DECLINED" : a.status === d.binder.status.member ? g.attendeeStatus = "ACCEPTED" : a.status === d.binder.status.invite && (g.attendeeStatus = "INVITED")), 
            g.enableReclaim = !1, !g.isHost && g.isMe && g.userId && g.userId === b.meet.hostId && (g.enableReclaim = !0), 
            g;
        }
    });
}), define("meet/participant/participantCollection", [ "moxtra", "lang", "meet/participant/participantModel" ], function(a, b, c) {
    return a.Collection.extend({
        model: c,
        sortField: [ "isHost", "isPresenter", "isMe", "inSession", "name" ],
        comparator: function(a, b) {
            var c = a.toJSON(), d = b.toJSON();
            return c.isHost ? -1 : d.isHost ? 1 : c.isPresenter ? -1 : d.isPresenter ? 1 : c.isMe ? -1 : d.isMe ? 1 : c.inSession && d.inSession || !c.inSession && !d.inSession ? c.name.toLowerCase() < d.name.toLowerCase() ? -1 : c.name.toLowerCase() > d.name.toLowerCase() ? 1 : 0 : c.inSession ? -1 : d.inSession ? 1 : 0;
        }
    });
}), define("meet/chat/chatModel", [ "moxtra", "lang", "app", "const" ], function(a, b, c, d) {
    return a.Model.extend({
        idAttribute: "sequence",
        defaults: {
            sequence: 0,
            avatar: d.defaults.user.avatar,
            isMe: !1,
            msg: ""
        },
        parse: function(b, c) {
            var d, e, f, g = {}, h = "";
            if (c && c.meet && (d = c.meet.boardId || b.board && b.board.id, e = c.meet.sessionId || Moxtra.getMe().sessionId, 
            f = c.meet.userRoster || {}), b.sequence && (g.sequence = b.sequence), b.roster) {
                var i = f[b.roster.id];
                b.roster.id === e && (g.isMe = !0), i && i.user && (h = i.user.name || i.user.email || "", 
                i.user.picture && (g.avatar = [ "/board", d, i.user.id, i.user.picture ].join("/"), 
                g.avatar += "?sessionid=" + b.roster.id)), g.msg = g.isMe ? b.text || "" : h ? a.format("{0}: {1}", h, b.text || "") : b.text || "";
            }
            return g;
        }
    });
}), define("meet/chat/chatCollection", [ "moxtra", "meet/chat/chatModel" ], function(a, b) {
    return a.Collection.extend({
        model: b
    });
}), define("meet/connector/type", [ "moxtra" ], function() {
    return {
        request: {
            ds: {
                START: "DS_SESSION_REQUEST_START",
                JOIN: "DS_SESSION_REQUEST_JOIN",
                STOP: "DS_SESSION_REQUEST_STOP",
                UPDATE: "DS_SESSION_REQUEST_UPDATE"
            },
            ac: {
                JOIN: "AC_SESSION_REQUEST_JOIN",
                LEAVE: "AC_SESSION_REQUEST_LEAVE",
                MUTE: "AC_SESSION_REQUEST_MUTE",
                UNMUTE: "AC_SESSION_REQUEST_UNMUTE",
                CONFIG: "AC_SESSION_REQUEST_CONFIG",
                UPDATE: "AC_SESSION_REQUEST_UPDATE"
            },
            av: {
                JOIN: "AV_SESSION_REQUEST_JOIN",
                LEAVE: "AV_SESSION_REQUEST_LEAVE",
                UPDATE: "AV_SESSION_REQUEST_UPDATE",
                LAYOUT: "AV_SESSION_REQUEST_LAYOUT",
                CAMERA_OFF: "AV_SESSION_REQUEST_CAMERAOFF",
                CAMERA_ON: "AV_SESSION_REQUEST_CAMERAON",
                CONFIG: "AV_SESSION_REQUEST_CONFIG"
            },
            cmd: {
                ROSTERS_JOINED: "APP_ROSTERS_CMD_JOINED",
                ROSTERS_LEFT: "APP_ROSTERS_CMD_LEFT",
                MEET_CONFIG: "APP_MEET_CONFIG"
            },
            webrtc_ac: {
                JOINED: "AC_SESSION_STATUS_JOINED",
                MUTED: "AC_SESSION_STATUS_MUTED",
                UNMUTED: "AC_SESSION_STATUS_UNMUTED",
                LEFT: "AC_SESSION_STATUS_LEFT"
            },
            ds_status: {
                STARTED: "DS_SESSION_STATUS_STARTED",
                STOPPED: "DS_SESSION_STATUS_STOPPED"
            }
        },
        response: {
            ds: {
                STARTED: "DS_SESSION_RESPONSE_STARTED",
                STOPPED: "DS_SESSION_RESPONSE_STOPPED",
                PAUSED: "DS_SESSION_RESPONSE_PAUSED",
                RESUMED: "DS_SESSION_RESPONSE_RESUMED",
                CONNECTING: "DS_SESSION_RESPONSE_CONNECTING",
                ERROR: "DS_SESSION_RESPONSE_ERROR"
            },
            ac: {
                JOINED: "AC_SESSION_RESPONSE_JOINED",
                LEFT: "AC_SESSION_RESPONSE_LEFT",
                MUTED: "AC_SESSION_RESPONSE_MUTED",
                UNMUTED: "AC_SESSION_RESPONSE_UNMUTED",
                SPEAKER: "AC_SESSION_RESPONSE_SPEAKERS",
                NETWORK: "AC_SESSION_RESPONSE_NETWORKS",
                DEVICELEVEL: "AC_SESSION_RESPONSE_DEVICELEVEL",
                CONNECTING: "AC_SESSION_RESPONSE_CONNECTING",
                ERROR: "AC_SESSION_RESPONSE_ERROR",
                MIC_STATUS: "AC_SESSION_RESPONSE_MIC_STATUS"
            },
            av: {
                JOINED: "AV_SESSION_RESPONSE_JOINED",
                LEFT: "AV_SESSION_RESPONSE_LEFT",
                BROADCASTED: "AV_SESSION_RESPONSE_BROADCASTED",
                UNBROADCASTED: "AV_SESSION_RESPONSE_UNBROADCASTED",
                CONNECTING: "AV_SESSION_RESPONSE_CONNECTING",
                ERROR: "AV_SESSION_RESPONSE_ERROR"
            },
            peer: {
                CONNECTED: "APP_PEER_RESPONSE_CONNECTED"
            },
            sys_error: "PLUGIN_RESPONSE_SYSTEMERROR"
        },
        status: {
            ds: {
                STARTED: "DS_STARTED",
                PAUSED: "DS_PAUSED",
                STOPPED: "DS_STOPPED",
                RESUMED: "DS_RESUMED"
            },
            ac: {
                JOINED: "AC_JOINED",
                MUTED: "AC_MUTED",
                UNMUTED: "AC_UNMUTED",
                LEFT: "AC_LEFT"
            }
        },
        notify_web: {
            ac: {
                JOIN: "AC_SESSION_NOTIFY_JOIN",
                MUTE: "AC_SESSION_NOTIFY_MUTE",
                UNMUTE: "AC_SESSION_NOTIFY_UNMUTE",
                LEAVE: "AC_SESSION_NOTIFY_LEAVE"
            },
            av: {
                JOIN: "AV_SESSION_NOTIFY_JOIN"
            }
        },
        action: {
            roster: {
                ADD: "add",
                REMOVE: "remove"
            },
            peer: {
                RECONNECT: "peer_reconnect",
                REFRESH: "peer_refresh"
            },
            plugin: {
                RECONNECT: "plugin_reconnect"
            },
            extension: {
                RECONNECT: "extension_reconnect"
            },
            activex: {
                RECONNECT: "activex_reconnect"
            },
            attendee: {
                NATIVE: "attendee_on_native_base64",
                SEND: "attendee_send_data"
            },
            audio: {
                CHECK: "check_webrtc_audio"
            }
        },
        base64: {
            ds: {
                ATTENDEE: 1
            }
        },
        codeTypes: {
            application: 10,
            network: 20,
            proxy: 30,
            system: 40,
            protocol_buffer: 50
        },
        defines: {
            ERROR_INVALID_TOKEN: 2,
            ERR_DEVICE_NOTFOUND: 31,
            ERR_AUDIO_NOPLAYBACK: 32,
            BLOCKED_GROUP_POLICY: 1260,
            DENY_EXECUTION: 1223
        }
    };
}), define("meet/connector/helper", [ "moxtra", "uuid", "meet/connector/type", "meet/meetUtil" ], function(a, b, c, d) {
    var e = MX.logger("meet:connector:helper");
    return {
        appConfigReq: function(a) {
            return {
                type: c.request.cmd.MEET_CONFIG,
                conf: a,
                action: a
            };
        },
        rosterReq: function(a, d) {
            if (0 === d.length) return {};
            var e;
            switch (a) {
              case c.action.roster.ADD:
                e = c.request.cmd.ROSTERS_JOINED;
                break;

              case c.action.roster.REMOVE:
                e = c.request.cmd.ROSTERS_LEFT;
            }
            var f = {
                type: e,
                sequence: b.v1(),
                action: {
                    rosters: d
                }
            };
            return f;
        },
        dsReq: function(a, c, d, e) {
            e = e || d.sequence;
            var f = {
                type: a,
                sequence: b.v1(),
                action: {
                    board_id: c.boardId,
                    session_key: c.sessionKey,
                    ds_conf: {
                        conf_id: d.dsConf.conf_id,
                        server_addr: [ "wss://", d.dsConf.server_addr, "/ds" ].join(""),
                        server_ip: [ "wss://", d.dsConf.server_ip, "/ds" ].join(""),
                        port: d.dsConf.port,
                        token: d.dsConf.token
                    },
                    ds_state: {
                        id: c.sessionId,
                        page_sequence: e,
                        is_presenter: c.isMeetPresenter ? 1 : 0,
                        ds_id: e + ""
                    }
                }
            };
            return f;
        },
        acReq: function(a, d, e, f) {
            var g = {
                type: a,
                sequence: b.v1(),
                action: {
                    board_id: d.boardId,
                    session_key: d.sessionKey,
                    ac_conf: {
                        conf_id: e.audioConf.conf_id,
                        server_addr: e.audioConf.server_addr,
                        token: e.audioConf.token
                    },
                    ac_state: {
                        id: d.sessionId
                    },
                    zone: d.zone,
                    audio_conf: e.audioConf
                }
            };
            return f && (g.action.type = "tcp"), (a === c.request.ac.UPDATE || a === c.request.ac.JOIN) && (g.action.ac_conf.muted = e.isMuted ? 1 : 0, 
            g.action.ac_state.muted = e.isMuted ? 1 : 0), g;
        },
        avReq: function(a, c, d, e) {
            var f = {
                type: a,
                sequence: b.v1(),
                action: {
                    board_id: c.boardId,
                    session_key: c.sessionKey,
                    av_conf: {
                        conf_id: d.videoConf.conf_id,
                        server_addr: d.videoConf.server_addr,
                        port: d.videoConf.port,
                        tcp_port: d.videoConf.tcp_port,
                        token: d.videoConf.token,
                        broadcast: e ? 1 : 0,
                        layout: d.layout,
                        quality: d.quality,
                        audiobutton: d.audiobutton
                    },
                    av_state: {
                        id: c.sessionId,
                        av_id: c.sessionKey + ""
                    }
                }
            };
            return f;
        },
        avReqSimple: function(a, b, c) {
            var d = {
                type: a,
                action: {
                    av_conf: {
                        conf_id: c.videoConf.conf_id
                    },
                    av_state: {
                        id: b.sessionId
                    }
                }
            };
            return d;
        },
        avLayoutReq: function(a, c, d, e) {
            var f = {
                type: a,
                sequence: b.v1(),
                action: {
                    board_id: c.boardId,
                    session_key: c.sessionKey,
                    av_conf: {
                        conf_id: d.videoConf.conf_id,
                        layout: e
                    }
                }
            };
            return f;
        },
        dsTryReq: function(a, b) {
            var d = b.sequence, e = a.isMeetPresenter ? c.request.ds.START : c.request.ds.JOIN;
            return this.dsReq(e, a, b, d);
        },
        acTryReq: function(a, d) {
            var e = {
                type: c.request.ac.JOIN,
                sequence: b.v1(),
                action: {
                    board_id: a.boardId,
                    session_key: a.sessionKey,
                    ac_conf: {
                        muted: d.isMuted ? 1 : 0,
                        conf_id: d.audioConf.conf_id,
                        server_addr: d.audioConf.server_addr,
                        token: d.audioConf.token
                    },
                    ac_state: {
                        id: a.sessionId,
                        muted: d.isMuted ? 1 : 0
                    },
                    zone: a.zone,
                    audio_conf: d.audioConf
                }
            };
            return e;
        },
        avTryReq: function(a, d) {
            var e = {
                type: c.request.av.JOIN,
                sequence: b.v1(),
                action: {
                    board_id: a.boardId,
                    session_key: a.sessionKey,
                    av_conf: {
                        conf_id: d.videoConf.conf_id,
                        server_addr: d.videoConf.server_addr,
                        port: d.videoConf.port,
                        tcp_port: d.videoConf.tcp_port,
                        token: d.videoConf.token,
                        broadcast: d.isBroadcast ? 1 : 0,
                        layout: d.layout,
                        quality: d.quality,
                        audiobutton: d.audiobutton
                    },
                    av_state: {
                        id: a.sessionId,
                        av_id: a.sessionKey + ""
                    }
                }
            };
            return e;
        },
        publishDS: function(a, b, c) {
            var f = {
                ds_state: [ {
                    page_sequence: c,
                    status: a
                } ]
            };
            this._publish(f, b.sessionKey, b.boardId).success(function() {
                e.logServer(d.logFormat("[publishDS] publish SUCCESS, request : " + JSON.stringify(f), {
                    meetId: b.sessionKey
                }));
            }).error(function() {
                e.logServer(d.logFormat("[publishDS] publish ERROR, request : " + JSON.stringify(f), {
                    meetId: b.sessionKey
                }));
            });
        },
        publishAC: function(a, b, f, g) {
            g = g || b.sessionId;
            var h, i = {
                is_in_session: !1,
                is_mute: !0,
                ssrc: f.ssrc
            };
            switch (a) {
              case c.status.ac.JOINED:
                i.is_in_session = !0, i.is_mute = f.isMuted;
                break;

              case c.status.ac.MUTED:
                i.is_in_session = !0, i.is_mute = !0;
                break;

              case c.status.ac.UNMUTED:
                i.is_in_session = !0, i.is_mute = !1;
                break;

              case c.status.ac.LEFT:
                i.is_in_session = !1, i.is_mute = !0;
            }
            h = {
                user_roster: [ {
                    id: g,
                    audio_status: i
                } ]
            }, this._publish(h, b.sessionKey, b.boardId).success(function() {
                e.logServer(d.logFormat("[publishAC] publish SUCCESS, request : " + JSON.stringify(h), {
                    meetId: b.sessionKey
                }));
            }).error(function() {
                e.logServer(d.logFormat("[publishAC] publish ERROR, request : " + JSON.stringify(h), {
                    meetId: b.sessionKey
                }));
            });
        },
        publishTelephone: function(a, b, d) {
            var e, f = {
                is_in_session: !0,
                is_mute: !1
            };
            switch (a) {
              case c.status.ac.JOINED:
                f.is_in_session = !0, f.is_mute = !1;
                break;

              case c.status.ac.MUTED:
                f.is_in_session = !0, f.is_mute = !0;
                break;

              case c.status.ac.UNMUTED:
                f.is_in_session = !0, f.is_mute = !1;
                break;

              case c.status.ac.LEFT:
                f.is_in_session = !1, f.is_mute = !0;
            }
            e = {
                user_roster: [ {
                    id: d,
                    telephone_status: f
                } ]
            }, this._publish(e, b.sessionKey, b.boardId).success(function() {}).error(function() {});
        },
        publishMuteAll: function(a) {
            var b, c, d, e = [];
            b = a.userRoster, delete b[a.sessionId], c = _.values(b), MX.each(c, function(a) {
                if (!a.is_deleted) {
                    var b = {
                        id: a.id
                    };
                    a.audio_status && (b.audio_status = {
                        is_mute: !0
                    }), e.push(b);
                }
            }), d = {
                user_roster: e
            }, this._publish(d, a.sessionKey, a.boardId);
        },
        publishAV: function(a, b) {
            var c = {
                user_roster: [ {
                    id: b.id,
                    video_status: {
                        is_in_session: !!b.isJoined,
                        is_broadcast: b.isJoined ? !!b.isBroadcast : !1
                    }
                } ]
            };
            this._publish(c, a.sessionKey, a.boardId);
        },
        _publish: function(b, c, f) {
            return f && (b.board_id = f), e.logServer(d.logFormat("[_publish] try to publish: " + JSON.stringify(b), {
                meetId: c
            })), new a.ChainObject(function() {
                MX.api("/meets/" + c, "PUT", {
                    action: "publish",
                    data: b
                }, this.callback, this);
            });
        }
    };
}), define("meet/connector/cache", [ "moxtra", "meet/connector/type", "meet/connector/helper" ], function(a, b, c) {
    var d = !1, e = !1, f = [], g = {}, h = {}, i = {}, j = {}, k = {}, l = {}, m = "", n = "", o = !1, p = !1, q = !1, r = !1, s = [], t = null, u = null, v = !1, w = !1, x = !1, y = "", z = {}, A = !1, B = !1, C = function(a) {
        if ("string" != typeof a) return a;
        try {
            return JSON.parse(a);
        } catch (b) {
            return console.error(b), {};
        }
    }, D = {
        clear: function() {
            d = !1, e = !1, f = [], g = {}, h = {}, i = {}, j = {}, k = {}, l = {}, m = "", 
            n = "", o = !1, p = !1, q = !1, r = !1, s = [], t = null, u = null, v = !1, w = !1, 
            x = !1, y = "", z = {}, A = !1, B = !1;
        }
    };
    return Object.defineProperties(D, {
        connecting: {
            get: function() {
                return d;
            },
            set: function(a) {
                d = !!a;
            }
        },
        downloading: {
            get: function() {
                return e;
            },
            set: function(a) {
                e = !!a;
            }
        },
        request: {
            get: function() {
                var a = {};
                if (!k.isWebrtc && k.isEnabled && (a[b.request.ac.JOIN] = c.acReq(b.request.ac.JOIN, i, k), 
                k.isMuted ? a[b.request.ac.MUTE] = c.acReq(b.request.ac.MUTE, i, k) : a[b.request.ac.UNMUTE] = c.acReq(b.request.ac.UNMUTE, i, k)), 
                i.isMeetPresenter ? j.pStarted && (a[b.request.ds.START] = c.dsReq(b.request.ds.START, i, j)) : j.aStarted && !x && "base64" === y && (a[b.request.ds.JOIN] = c.dsReq(b.request.ds.JOIN, i, j)), 
                l.isJoined && (a[b.request.av.JOIN] = c.avReq(b.request.av.JOIN, i, l, l.isBroadcast)), 
                f.length) {
                    for (var d in f) {
                        var e = a[f[d].type];
                        e && (f[d] = e, delete a[f[d].type]);
                    }
                    return _.union(f, _.values(a));
                }
                return _.values(a);
            },
            set: function(a) {
                if (a = C(a), 0 == a.length) return void (f = []);
                if (a.type) {
                    var b = !1;
                    for (var c in f) if (f[c].type === a.type) {
                        b = !0, f[c] = a;
                        break;
                    }
                    b || f.push(a);
                }
            }
        },
        cfg: {
            get: function() {
                return g;
            },
            set: function(a) {
                g = a;
            }
        },
        peer: {
            get: function() {
                return h;
            },
            set: function(a) {
                h = a;
            }
        },
        meet: {
            get: function() {
                return i;
            },
            set: function(a) {
                i = a, m = a.sessionKey, n = a.sessionId;
            }
        },
        meetId: {
            get: function() {
                return m;
            }
        },
        rosterId: {
            get: function() {
                return n;
            }
        },
        ds: {
            get: function() {
                return j;
            },
            set: function(a) {
                j = a, o = a.pStarted || a.aStarted;
            }
        },
        audio: {
            get: function() {
                return k;
            },
            set: function(a) {
                k = a, p = a.isEnabled;
            }
        },
        video: {
            get: function() {
                return l;
            },
            set: function(a) {
                l = a, q = a.isJoined;
            }
        },
        dsActive: {
            get: function() {
                return o;
            }
        },
        audioActive: {
            get: function() {
                return p;
            }
        },
        videoActive: {
            get: function() {
                return q;
            }
        },
        tryAgainShown: {
            get: function() {
                return r;
            },
            set: function(a) {
                r = !!a;
            }
        },
        errorModules: {
            get: function() {
                return s;
            },
            set: function(a) {
                if (MX.isArray(a) && 0 == a.length) return void (s = []);
                var b = !1;
                for (var c in s) if (s[c] === a) {
                    b = !0;
                    break;
                }
                b || s.push(a);
            }
        },
        downloadDialog: {
            get: function() {
                return t ? t : {
                    close: function() {}
                };
            },
            set: function(a) {
                t = a;
            }
        },
        permissionDialog: {
            get: function() {
                return u ? u : {
                    close: function() {}
                };
            },
            set: function(a) {
                u = a;
            }
        },
        permissionTipWebrtc: {
            get: function() {
                return v;
            },
            set: function(a) {
                v = !!a;
            }
        },
        permissionTipPlugin: {
            get: function() {
                return w;
            },
            set: function(a) {
                w = !!a;
            }
        },
        attendeeWebsocket: {
            get: function() {
                return x;
            },
            set: function(a) {
                x = !!a;
            }
        },
        attendeeConnection: {
            get: function() {
                return y;
            },
            set: function(a) {
                y = a;
            }
        },
        base64: {
            get: function() {
                return z;
            }
        },
        inSession: {
            get: function() {
                return A;
            },
            set: function(a) {
                A = !!a;
            }
        },
        denyExecutionOnIEShown: {
            get: function() {
                return B;
            },
            set: function(a) {
                B = a;
            }
        }
    }), D;
}), define("meet/connector/listener", [ "moxtra" ], function() {
    return Moxtra.define({
        singleton: !0,
        methods: {
            on: function(a, b, c) {
                MX.isUndefined(a) || (this.off(a), this.on._super.call(this, a, b, c));
            }
        }
    });
}), define("text!template/meet/downloadTip.html", [], function() {
    return '<div class="mx-app-download-tip">\r\n	<ul>\r\n		<li class="center">\r\n			<span class="size20">{{lang.moxtra_plugin_is_downloading}}</span>\r\n		</li>\r\n		<li class="center">\r\n			<span class="msg size12">{{lang.locate_the_installation_file}}</span>\r\n			<br/> <br/>\r\n		</li>\r\n        <li class="center">\r\n          {{#if isMac}}\r\n			{{#if isChrome}}<img class="mx-width-full" src="themes/images/download_tip_mac_chrome.3ec72536.jpg" style="max-width: 552px;"/>{{/if}}\r\n			{{#if isFF}} <img class="mx-width-full" src="themes/images/download_tip_mac_ff.a8e406ce.jpg" style="max-width: 552px;"/>{{/if}}\r\n			{{#if isSafari}}<img class="mx-width-full" src="themes/images/download_tip_mac_safari.6d89cbbd.jpg" style="max-width: 552px;"/>{{/if}}\r\n		  {{/if}}\r\n		  {{#if isWin}} \r\n		  	{{#if isChrome}}<img class="mx-width-full" src="themes/images/download_tip_win_chrome.f54e8851.jpg" style="max-width: 552px;"/>{{/if}}\r\n			{{#if isFF}}<img class="mx-width-full" src="themes/images/download_tip_win_ff.1ea04bfc.jpg" style="max-width: 552px;"/>{{/if}}\r\n			{{#if isIE}}<img class="mx-width-full" src="themes/images/download_tip_win_ie.ab15ab2c.jpg" style="max-width: 552px;"/>{{/if}}\r\n		  {{/if}}\r\n        </li>\r\n        {{#if isWin}}\r\n        {{#if isIE}}\r\n        <li class="center">\r\n        	<br /> <br />\r\n        	<span class="size16">{{lang.activex_install_bar_disabled}}</span>\r\n        </li>\r\n        {{/if}}\r\n        {{/if}}\r\n	</ul>\r\n</div>';
}), define("text!template/meet/connector/downloadAddOn.html", [], function() {
    return '<div class="mx-app-download-tip">\n	<ul>\n		<li class="center">\n			<span class="size20">{{lang.install_addon}}</span>\n		</li>\n		<li class="marginTop15"></li>\n		{{#if isMac}}\n		<li>\n			<div class="marginLeft10">1. {{addon_step1}}</div>\n			<div class="marginLeft10">2. {{addon_step2}}</div>\n			<br />\n			<div class="center">\n			{{#if isChrome}}<img class="mx-width-full" src="themes/images/meet_addon_mac.fd449615.png" style="max-width: 230px;"/>{{/if}}\n			</div>\n		</li>\n		{{/if}}\n		{{#if isWin}}\n		<li class="center">\n			<span>{{addon_step2}}</span>\n			<br />\n			{{#if isChrome}}<img class="mx-width-full" src="themes/images/meet_addon_win.18194d35.png" style="max-width: 230px;"/>{{/if}}\n		</li>\n		{{/if}}\n		<li class="center">\n			<br />\n			<span class="msg">{{bbcode addon_installer}}</span>\n		</li>\n	</ul>\n</div>';
}), define("text!template/meet/connector/downloadPartnerExtension.html", [], function() {
    return '<div class="mx-app-download-tip">\n	<ul>\n		<li class="center">\n			<span class="msg">{{lang.install_chrome_extension_detail}}</span>\n		</li>\n		<li>\n			<br />\n			<span>1. {{bbcode lang.continue_to_download_chrome_extension}}</span>\n		</li>\n		<li>\n			<img class="mx-width-full" src="themes/images/download_continue_chrome_extension.1c5b8b54.png" style="max-width: 300px;"/>\n		</li>\n		<li>\n			<br />\n			<span>2. {{bbcode install_crx_tip}}</span>\n		</li>\n		<li>\n			<img class="mx-width-full" src="themes/images/download_tip_chrome_extension.fb7766f8.png" style="max-width: 552px;"/>\n		</li>\n	</ul>\n</div>';
}), define("text!template/meet/activexTip.html", [], function() {
    return '<div class="mx-app-activex-tip">\n	<ul>\n		<li class="center">\n			<div class="activex-notes">\n				<div class="activex-step-1">{{bbcode lang.activex_download_alert_tip}}</div>\n				<div class="activex-step-2">{{bbcode lang.activex_permission_alert_tip}}</div>\n			</div>\n			<img class="mx-width-full" src="themes/images/download_tip_win_ie.ab15ab2c.jpg" style="max-width: 552px;"/>\n		</li>\n	</ul>\n</div>';
}), define("text!template/meet/activexDenyTip.html", [], function() {
    return '<div class="mx-app-activex-tip">\n	<ul>\n		<li class="center">\n			<img class="mx-width-full" src="themes/images/permission_deny_execution_ie.f3880ff2.jpg" style="max-width: 552px;"/>\n			<div class="activex-notes">\n				<div class="size18">{{lang.please_allow_moxtra_plugin_execute}}</div>\n			</div>\n		</li>\n	</ul>\n</div>';
}), define("text!template/meet/downloadRefresh.html", [], function() {
    return '<div class="mx-app-download-tip">\r\n	<ul>\r\n		<li class="center">\r\n			<span class="icon"><i class="glyphicon glyphicon-refresh"></i></span>\r\n		</li>\r\n		<li class="center">\r\n			<span class="msg">{{lang.installation_error}}</span>\r\n		</li>\r\n		<li>\r\n			<div>{{lang.plugin_install_confirm_tip}}</div>\r\n			<div>{{bbcode download}}</div>\r\n			<div>{{lang.plugin_refresh_tip}}</div>\r\n		</li>\r\n	</ul>\r\n</div>';
}), define("text!template/meet/permissionTip.html", [], function() {
    return '<div class="mx-app-download-tip">\n    <ul>\n        <li class="center">\n            <span class="size20">\n            	{{#if webrtc}}{{lang.microphone_alert}}{{/if}}\n            	{{#if plugin}}{{lang.permission_alert}}{{/if}}\n            	{{#if ff}}{{lang.permission_alert}}{{/if}}\n            </span>\n            <br/> <br/>\n        </li>\n        <li class="center">\n        	{{#if webrtc}}<img class="mx-width-full" src="themes/images/microphone_alert.52724dde.jpg" style="max-width: 313px;"/>{{/if}}\n        	{{#if plugin}}\n        		{{#if chrome.higherVersion}}\n        		<img src="themes/images/permission_alert_chrome.f3738c5c.png" class="marginLeftNegative15 mx-width-full" style="max-width: 434px;"/>\n        		{{/if}}\n        		{{#if chrome.lowerVersion}}\n        		<img src="themes/images/mac_permission_alert.178461bc.jpg" class="marginLeftNegative15 mx-width-full" style="max-width: 317px;"/>\n        		{{/if}}\n        	{{/if}}\n        	{{#if ff.normal}}<img class="mx-width-full" src="themes/images/permission_alert_ff_multi.81cf2467.jpg" style="max-width: 552px;"/>{{/if}}\n        	{{#if ff.special}}<img class="mx-width-full" src="themes/images/permission_alert_ff.339d5488.jpg" style="max-width: 552px;"/>{{/if}}\n        </li>\n\n    </ul>\n</div>';
}), define("text!template/component/fileProgress.html", [], function() {
    return '<div class="file-progress">\n	<iframe class="mx-iframe-shim" src="javascript:;" frameborder="0" allowtransparency="true" scrolling="no"></iframe>\n	\n    <div class="ellipsis progress-name">{{name}}</div>\n    <div class="progress">\n        <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width: {{percent}}%">\n            <span class="sr-only">{{percent}}</span>\n        </div>\n    </div>\n</div>';
}), define("component/uploader/fileProgress", [ "moxtra", "lang", "text!template/component/fileProgress.html" ], function(a, b, c) {
    return a.Controller.extend({
        template: c,
        className: "file-progress",
        init: function(a) {
            this.$scope.lang = b, _.extend(this, a), this.listenTo(a.model, "change", this.update);
        },
        update: function(a) {
            var b = a.get("percent"), c = a.get("name");
            if (this.$(".progress-bar").width(b + "%"), c && this.$(".progress-name").text(c), 
            this.$(".sr-only").text(b + "%"), 100 == b) {
                var d = this.parent;
                setTimeout(function() {
                    d.close();
                }, 2e3);
            }
        }
    });
}), define("meet/connector/config", [ "moxtra" ], function() {
    var a = "mxEmbededPlugin" + Math.floor(1e4 * Math.random()), b = (navigator.language || navigator.browserLanguage || "en-US").toLowerCase();
    return b = "zh-tw" === b ? "zh-tw" : b.substr(0, 2), {
        lang: b,
        target: "#mxMeetPlugin",
        pluginId: a,
        pluginBgColor: 4539717,
        element: '<embed id="' + a + '" type="{{plugin_type}}" style="background:transparent;width:100%;height:100%;"></embed>',
        activeX: '<object id="' + a + '" classid="CLSID:{{activex_clsid}}" width="100%" height="100%"></object>',
        sessionId: Moxtra.getMe().sessionId,
        platform: MX.env.isMac ? "os_mac" : "os_win",
        domain: MX.format("{0}/client/", MX.getOrigin()),
        appcfg: MX.format("{0}/client/MoxtraApp_config.json", MX.getOrigin()),
        plugin: "plugin_name",
        installer: "installer_file",
        name: "application_name",
        version: "application_ver",
        pkg: "application_pkg",
        ie: "win_ie",
        plugin_type: "plugin_type",
        addon_version: "add_on_version",
        addon_installer: "add_on_name",
        addon_name: "",
        extensionId: "gcihackglhkfinndffhemefinhlmagfe",
        partnerExtensionId: "ncopmpddfokfcmmnhhbekaecjbokeeck",
        moxtraCrxName: "MoxtraMeetExtension.crx",
        moxtraExtensionCrx: MX.format("{0}/client/MoxtraMeetExtension.crx", MX.getOrigin()),
        partnerCrxName: "MeetingExtension.crx",
        partnerExtensionCrx: MX.format("{0}/client/MeetingExtension.crx", MX.getOrigin())
    };
}), define("text!template/component/binderSelector.html", [], function() {
    return '<div>\n    <form role="form" onsubmit="return false" class="form-with-icon" >\n		<i class="micon-search icon-control"></i>\n        <button type="button" class="close input-close hide" data-action="removeSearchKey" aria-hidden="true">\n            <span>×</span>\n        </button>\n        <input type="text" class="form-control" autofocus="autofocus" autocomplete="off" name="key" placeholder="{{lang.search}}">\n    </form>\n    <div class="mx-container mx-box">\n    	<div class="moxtra-list mx-binder-selector">\n\n    	</div>\n    </div>\n</div>\n';
}), define("text!template/component/binderSelectorItem.html", [], function() {
    return '<li class="mx-item" id="BS_{{board.id}}">\n    <div class="mx-hover-effect row mouse-hand" data-action="selectBinder">\n        {{#if board.conversation}}\n        <div class="col-md-2 col-xs-2 chat-avatar-{{board.conversation}}" >\n        	{{#each board.avatars}}\n        	<span class="mx-presence">\n                <span class="avatar-wrap img-polaroid img-circle">\n                    <img src="{{this}}"/>\n                </span>\n            </span>\n        	{{/each}}\n        </div>\n        {{else}}\n        <div class="binder-thumb col-md-2 col-xs-2">\n	        <div class="cover-wrap">\n	        	<span class="wrap-outer">\n	        		<span class="wrap-inner">\n	        			<img src="{{board.thumbnail}}" />\n	        		</span>\n	        	</span>\n	        </div>\n        </div>\n        {{/if}}\n        <div class="col-md-8 col-xs-8">\n            <span class="board-name">\n                <span class="ellipsis">{{board.name}}</span>\n            </span>\n        </div>\n        <div class="col-md-2 col-xs-2">\n            <span class="board-action">\n                {{#if multiple}}\n                <input type="checkbox" value="{{board.id}}" class="mx-hide" name="binderSelector">\n                {{else}}\n                <input type="radio" value="{{board.id}}" class="mx-hide" name="binderSelector">\n                {{/if}}\n                \n                {{#unless showCheckbox}}\n	                {{#if board.total_pages}}\n	                <a class="btn btn-link"><i class="micon-arrow-right open-board"></i></a>\n	                {{/if}}\n                {{/unless}}\n            </span>\n        </div>\n    </div>\n</li>\n';
}), define("component/selector/binderSelector", [ "moxtra", "lang", "app", "text!template/component/binderSelector.html", "text!template/component/binderSelectorItem.html", "admin/branding/helper", "component/dialog/dialog" ], function(a, b, c, d, e, f) {
    var g = (MX.logger("BinderSelector"), Handlebars.compile(e));
    return a.ui.BinderSelector = a.Controller.extend({
        template: d,
        handleAction: !0,
        init: function(a) {
            a = a || {}, this.$scope.lang = b, this.filter = a.filter, _.extend(this, {
                style: "form",
                showCheckbox: !0,
                multiple: !1
            }, a), f.isShowNewBinder() && this.newBinder && this.buttons && this.buttons.unshift({
                text: b.start_a_new_conversation,
                position: "left",
                className: "btn-default",
                click: "newBinder"
            });
        },
        rendered: function() {
            var a, c = Moxtra.getMe(), d = this;
            console.log("start timer..."), console.time("test_raw_binderselector"), a = function() {
                d.binders = Moxtra.getUserBoardsSummaryFromJSON({
                    filter: d.filter
                });
                var a = [], c = d.multiple, e = d.showCheckbox;
                MX.each(d.binders, function(d) {
                    a.push(g({
                        lang: b,
                        board: d,
                        multiple: c,
                        showCheckbox: e
                    }));
                }), d.$(".mx-binder-selector").html(a.join("")), e && d.$('input[type="' + (c ? "checkbox" : "radio") + '"]').mxCheckbox(), 
                console.timeEnd("test_raw_binderselector");
            }, d.$el.loading(), c.revision ? (a(), d.$el.loading(!1)) : (c.subscribe(), Moxtra.onReady(function() {
                a(), d.$el.loading(!1);
            })), d.$("form input").on("keyup", $.proxy(d.filterBinder, d)), MX.env.isIE && d.$("form input").placeholder(), 
            d.$el.addClass("mx-" + d.style), d.recovery(function() {
                d.binders = null;
            });
        },
        removeSearchKey: function() {
            this.$("form input").val("").trigger("keyup").focus();
        },
        filterBinder: function(a) {
            var b = $(a.target).val().trim(), c = this;
            return b = b.toLowerCase(), b.length ? (c.$(".input-close").removeClass("hide"), 
            void (c.binders && (c.$("li.mx-item").addClass("hide"), MX.each(c.binders, function(a) {
                var d = (a.name || "").toLowerCase();
                d.indexOf(b) > -1 && c.$("#BS_" + a.id).removeClass("hide");
            })))) : (c.$("li.mx-item").removeClass("hide"), void c.$(".input-close").addClass("hide"));
        },
        getFormElements: function(a) {
            return a = a || this.$el, a.find(this.multiple ? 'input[type="checkbox"]' : 'input[type="radio"]');
        },
        selectBinder: function() {
            var a = this.handleEvent, b = $(a.currentTarget), c = this.getFormElements(b), d = c.prop("checked");
            "INPUT" != a.target.tagName && (d = !d, c.prop("checked", d).trigger("change")), 
            this.currSelected && this.currSelected.removeClass("selected"), b.addClass("selected"), 
            this.currSelected = b;
            var e = this.value();
            this.trigger("select", e), this.onSelect(e), a.stopPropagation();
        },
        onSelect: function() {},
        value: function() {
            var a = [];
            return this.getFormElements().each(function(b, c) {
                var d = $(c);
                d.prop("checked") && a.push(d.val());
            }), a.length ? a : null;
        }
    }), MX.ui.BinderSelector;
}), define("text!template/component/userSelector.html", [], function() {
    return '<div class="mx-user-selector">\n	{{#if inputPanel}}\n    <form role="form" onsubmit="return false" style="position:relative;">\n    	<div id="userSelectorFormGroup" class="form-group">\n	        <button type="button" class="close input-close hide" data-action="removeSearchKey" aria-hidden="true">\n	            <span>×</span>\n	        </button>\n	        <input type="text" class="form-control" {{#if autoFocus}}autofocus="autofocus"{{/if}}  autocomplete="off" name="key" placeholder="{{#if onlyInputModel}}{{lang.enter_email}}{{else}}{{lang.search_or_enter_email}}{{/if}}">\n            <div class="mx-email-tip">{{lang.enter_email_tip}}</div>\n        </div>\n    </form>\n    {{/if}}\n    {{#if selectedPanel}}\n        <div class="panel-default selected-user-panel mx-box hide">\n            <div class="panel-heading">\n                <h4 class="panel-title">\n                    <a data-toggle="collapse" data-parent="#accordion" href="#selectedUserList{{viewid}}" class="collapsed selected-panel" style="position: relative;">\n                        {{#if notifySelected}}\n                        <div class="selected-panel-notification">\n                            <span class="selected-notification linear-blue-bg pull-right ellipsis"></span>\n                        </div>\n                        {{/if}}\n                        <div class="selected-panel-title">\n                            <i class="micon-arrow-right" /> {{lang.selected_users}} <span class="selected-count-info hide">(<span class="selected-count">0</span>)</span>\n                        </div>\n                    </a>\n                </h4>\n            </div>\n            <div id="selectedUserList{{viewid}}" class="panel-collapse collapse">\n                <div class="panel-body" >\n\n                </div>\n            </div>\n        </div>\n    {{/if}}\n    {{#if showFrame}}\n    <div class="mx-container  mx-box">\n	    	{{#if teamsPanel}}\n	    	<div class="panel-default team-panel">\n	    		<div class="panel-heading">\n		    		<h4 class="panel-title">\n		    			<a data-toggle="collapse" data-parent="#accordion" href="#moxtraTeamList" class="collapsed">\n	                        <i class="micon-arrow-right"></i>\n	                       {{lang.teams}} (<span class="teams-count">0</span>)\n	                    </a>\n		    		</4>\n	    		</div>\n	    		<div id="moxtraTeamList" class="panel-collapse collapse">\n                    <div class="panel-body">\n\n                    </div>\n                </div>\n	    	</div>\n	    	{{/if}}\n            {{#if groupsPanel}}\n            <div class=" panel-default group-panel">\n                <div class="panel-heading">\n                    <h4 class="panel-title">\n                        <a data-toggle="collapse" data-parent="#accordion" href="#groupUserList" class="collapsed">\n                            <i class="micon-arrow-right"></i>\n                            <span class="biz-title">{{lang.business_directory}}</span> (<span class="groups-count">0</span>)\n                        </a>\n                        <div class="biz-back hide"><button class="btn btn-xs btn-primary" data-action="returnBizLibrary">{{lang.back}}</button></div>\n                    </h4>\n                </div>\n                <div id="groupUserList" class="panel-collapse collapse">\n                    <div class="panel-body" >\n\n                    </div>\n                </div>\n            </div>\n            {{/if}}\n            {{#if contactsPanel}}\n            <div class=" panel-default">\n                <div class="panel-heading">\n                    <h4 class="panel-title">\n                        <a data-toggle="collapse" data-parent="#accordion" href="#moxtraUserList">\n                            <i class="micon-arrow-right"></i>\n                           {{lang.contacts}} (<span class="users-count">0</span>)\n                        </a>\n                    </h4>\n                </div>\n                <div  id="moxtraUserList" class="panel-collapse collapse in">\n                    <div class="panel-body">\n\n                    </div>\n                </div>\n            </div>\n            {{/if}}\n    </div>\n    {{/if}}\n    {{#if needMessage}}\n    <div class="dropup invite-message-container">\n        <input type="checkbox" name="includeMessage" id="includeMessage"/>\n        <label for="includeMessage" class="invite-message-action">{{lang.include_invitation_message}}</label>\n    </div>\n    <div class="invite-message-content hide">\n        <textarea id="invite" class="invite-message-textbox noResize noOutline" placeholder="{{lang.enter_invitation_message}}"></textarea>\n        <span data-action="zoomInviteMessage"><i class="micon-full-screen"></i></span>\n    </div>\n    {{/if}}\n</div>\n';
}), define("text!template/component/userSelectorItem.html", [], function() {
    return '<li id="{{cid}}" class="mx-item">\n	{{#if group}}\n    <div class="mx-contacts-item row" data-action="selectUser" data-param="{{group.id}}">\n        <div class="col-md-2 col-xs-2">\n        	<div class="mx-user contact-avatar">\n			    <img class="img-circle mx-noborder mx-noborder-radius mx-nobox-shadow" src="{{group.avatar}}"/>\n			</div>\n        </div>\n        <div class="mx-user-info col-md-8 col-xs-8" >\n            <div class="user-name paddingTop15"> {{group.name}}</div>\n        </div>\n        <div class="col-md-2 col-xs-2">\n            <span class="user-action">\n                {{#if multiple}}\n                <input type="checkbox" value="{{group.id}}" data-team="true" data-type="{{dataType}}" class="mx-hide" name="selectedUser" >\n                {{else}}\n                <input type="radio" value="{{group.id}}" data-team="true" data-type="{{dataType}}" class="mx-hide" name="selectedUser">\n                {{/if}}\n            </span>\n        </div>\n    </div>\n    {{else}}\n    <div class="mx-contacts-item row" data-action="selectUser" data-param="{{user.id}}">\n        <div class="col-md-2 col-xs-2">\n        {{avatarView this}}\n        </div>\n        <div class="mx-user-info col-md-8 col-xs-8" >\n            <div class="user-name"> {{user.name}}</div>\n            <span class="user-email">{{user.email}}</span>\n        </div>\n        <div class="col-md-2 col-xs-2">\n            <span class="user-action">\n                {{#if multiple}}\n                <input type="checkbox" value="{{user.primaryKey}}" {{#if user.email}}data-email="{{user.email}}"{{/if}} data-type="{{dataType}}" class="mx-hide" name="selectedUser" >\n                {{else}}\n                <input type="radio" value="{{user.primaryKey}}" {{#if user.email}}data-email="{{user.email}}"{{/if}} data-type="{{dataType}}" class="mx-hide" name="selectedUser">\n                {{/if}}\n            </span>\n        </div>\n    </div>\n    {{/if}}\n</li>\n';
}), define("text!template/component/groupUserSelectorItem.html", [], function() {
    return '<li id="{{cid}}" class="mx-item">\n    <div class="mx-contacts-item row" {{#if isVirtualUser}} data-action="showSubList" data-param="{{division}},{{sequence}}"{{else}} data-action="selectUser" data-param="{{user.primaryKey}}"{{/if}}>\n        <div class="col-md-2 col-xs-2">\n            {{avatarView this}}\n        </div>\n        <div class="mx-user-info col-md-8 col-xs-8" >\n            {{#if isVirtualUser}}\n                <div class="org-name">{{user.name}}</div>\n            {{else}}\n            <div class="user-name">{{user.name}}</div>\n            <span class="user-email">{{user.email}}</span>\n            <div class="user-phone">\n                {{#if division}}\n                    {{division}}{{#if department}} - {{department}}{{/if}}\n                {{else}}\n                    {{#if department}}\n                        {{department}}\n                    {{else}}\n                        {{user.phone}}\n                    {{/if}}\n                {{/if}}\n            </div>\n            {{/if}}\n        </div>\n        <div class="col-md-2 col-xs-2">\n            <span class="user-action">\n                {{#if isVirtualUser}}\n                    <a class="btn btn-link"><i class="micon-arrow-right"/></a>\n                {{else}}\n                    {{#if multiple}}\n                        <input type="checkbox" value="{{user.primaryKey}}" data-type="{{dataType}}" class="mx-hide" name="selectedUser" >\n                    {{else}}\n                        <input type="radio" value="{{user.primaryKey}}" data-type="{{dataType}}" class="mx-hide" name="selectedUser">\n                    {{/if}}\n                 {{/if}}\n            </span>\n\n        </div>\n    </div>\n</li>\n';
}), define("text!template/component/expandTextarea.html", [], function() {
    return '<div>\n    <div>\n        <button type="button" class="close" data-action="exitZoom">&times;</button>\n        <h4 class="ellipsis">{{title}}</h4>\n    </div>\n    <textarea class="form-control expand-textarea vertResize" value="{{message}}" placeholder="{{placeholder}}" autofocus="autofocus">{{message}}</textarea>\n</div>\n';
}), define("component/textarea", [ "moxtra", "lang", "text!template/component/expandTextarea.html" ], function(a, b, c) {
    return a.Controller.extend({
        template: c,
        handleAction: !0,
        init: function(a) {
            this.$scope.lang = b, this.$scope.message = a.message || "", this.$scope.title = a.title || "", 
            this.$scope.readonly = a.readonly || !1, this.$scope.placeholder = a.placeholder || !1, 
            _.extend(this, a);
        },
        rendered: function() {},
        exitZoom: function() {
            this.handleEvent.preventDefault(), this.handleEvent.stopPropagation(), this.onClose(this.$("textarea").val());
        },
        onClose: function() {}
    });
}), define("user/userModel", [ "moxtra", "lang", "const" ], function(a, b, c) {
    MX.logger("UserModel");
    return a.Model.extend({
        idAttribute: "userid",
        defaults: {
            userid: "",
            email: "",
            displayName: "",
            firstName: "",
            lastName: "",
            avatar: "",
            avatar2x: "",
            avatar4x: "",
            phoneNumber: "",
            status: "",
            type: ""
        },
        parse: function(a, b) {
            var c;
            return c = a && a.user ? this.parseUsersItem(a, b) : this.parseActor(a, b);
        },
        parseActor: function(a) {
            var b = MX.pick(a, [ "id", "email", "first_name", "last_name", "name", "phone_number", "picture", "picture2x", "picture4x", "picture_url", "picture2x_url", "picture4x_url" ], {
                format: function(a) {
                    return MX.camelize(a.split(".").pop());
                }
            });
            b.userid = b.id;
            var d, e, f;
            return d = e = f = c.defaults.user.avatar, b.avatar = b.pictureUrl || d, b.avatar2x = b.picture2xUrl || e, 
            b.avatar4x = b.picture4xUrl || f, b.avatar = Moxtra.util.makeAccessTokenUrl(b.avatar), 
            b.firstName || (b.firstName = b.email), b.lastName || (b.lastName = ""), b.displayName = b.firstName || b.name || b.email, 
            b;
        },
        parseUsersItem: function(a, b) {
            var d = MX.pick(a, [ "user.id", "user.email", "user.unique_id", "user.first_name", "user.last_name", "user.name", "user.phone_number", "user.picture", "user.picture2x", "user.picture4x", "user.picture_url", "user.picture2x_url", "user.picture4x_url", "status", "sequence", "type", "division", "department" ], {
                format: function(a) {
                    return MX.camelize(a.split(".").pop());
                }
            });
            d.userid = d.id || d.email || d.unique_id;
            var e, f, g;
            if (e = f = g = c.defaults.user.avatar, d.picture2x = d.picture2x || d.picture, 
            d.picture4x = d.picture4x || d.picture, d.picture && !d.pictureUrl) {
                if (a.status && a.status.indexOf("CONTACT_") > -1 && (e = MX.format("/user/contact/${sequence}/${picture}", d), 
                f = MX.format("/user/contact/${sequence}/${picture2x}", d), g = MX.format("/user/contact/${sequence}/${picture4x}", d)), 
                a.status && a.status.indexOf("GROUP_") > -1) {
                    var h = MX.storage("integration", "sessionStorage");
                    d.groupid = h.get("group_id") || Moxtra.getMe().groupId, e = MX.format("/group/${groupid}/member/${sequence}/${picture}", d), 
                    f = MX.format("/group/${groupid}/member/${sequence}/${picture2x}", d), g = MX.format("/group/${groupid}/member/${sequence}/${picture4x}", d);
                }
                var i = b && b.boardid || null;
                i && a.status && a.status.indexOf("BOARD_") > -1 && (d.boardid = i, e = MX.format("/board/${boardid}/user/${sequence}/${picture}", d), 
                f = MX.format("/board/${boardid}/user/${sequence}/${picture2x}", d), g = MX.format("/board/${boardid}/user/${sequence}/${picture4x}", d));
            }
            d.avatar = d.pictureUrl || e, d.avatar2x = d.picture2xUrl || f, d.avatar4x = d.picture4xUrl || g;
            var j = Moxtra.storage("integration").get("access_token");
            return j && (d.avatar = d.avatar + "?access_token=" + j), d.firstName || (d.firstName = d.email), 
            d.lastName || (d.lastName = ""), d.displayName = d.firstName + " " + d.lastName, 
            d;
        }
    });
}), define("contacts/contactBiz", [ "moxtra", "app" ], function(a) {
    return {
        resend: function(b) {
            return new a.ChainObject(function() {
                MX.api("/users/" + b, "CHAT", null, this.callback, this);
            });
        },
        accept: function(b) {
            return new a.ChainObject(function() {
                MX.api("/contacts", "POST", {
                    data: {
                        type: "accept",
                        users: [ {
                            email: b
                        } ]
                    }
                }, this.callback, this);
            });
        },
        decline: function(b) {
            return new a.ChainObject(function() {
                MX.api("/contacts", "DELETE", {
                    data: {
                        type: "deny",
                        users: [ {
                            email: b
                        } ]
                    }
                }, this.callback, this);
            });
        },
        filterUser: function(a, b) {
            var c = !1;
            if (a && a.length > 0) if (a = a.toLowerCase(), MX.isArray(b)) {
                for (var d = 0; d < b.length; d++) if (b[d] && b[d].indexOf(a) >= 0) return !0;
            } else c = b.indexOf(a) >= 0; else c = !0;
            return c;
        }
    };
}), define("component/selector/userSelector", [ "moxtra", "lang", "app", "const", "text!template/component/userSelector.html", "text!template/component/userSelectorItem.html", "text!template/component/groupUserSelectorItem.html", "../textarea", "user/userModel", "uuid", "contacts/contactBiz" ], function(a, b, c, d, e, f, g, h, i, j, k) {
    "use strict";
    i.extend({
        validation: {
            email: [ {
                required: !0,
                msg: b.email_is_required
            }, {
                pattern: "email",
                msg: b.email_format_error
            } ]
        }
    });
    return a.ui.UserSelector = a.Controller.extend({
        template: e,
        title: b.select_user,
        inputPanel: !0,
        selectedPanel: !0,
        teamsPanel: !0,
        contactsPanel: !0,
        groupsPanel: !0,
        supportInputEmail: !0,
        autoFocus: !0,
        expandSelected: !1,
        notifySelected: !0,
        handleAction: !0,
        invitationMessage: function() {
            return this.includeMessage ? $(".invite-message-textbox").val().replace(/^\s*|\s*$/g, "") || null : null;
        },
        init: function(a) {
            _.extend(this, {
                style: "form",
                multiple: !0
            }, a), this.needMessage && (this.$scope.needMessage = !0), this.viewid = this.cid, 
            this.$scope.viewid = this.viewid;
            var e = Moxtra.getMe(), f = !1, g = this;
            c.isIntegrationEnabled() ? (this.teamsPanel = !1, this.groupsPanel = !1, this.contactsPanel = !1, 
            this.expandSelected = !0, f = !0) : (this.teams = e.groups.clone({
                filterFn: function(a) {
                    return a.status === d.group.userStatus.member;
                }
            }), (!this.teams.length || e.unique_id) && (this.teamsPanel = !1), this.recovery(this.teams), 
            (!e.id || e.unique_id) && (this.contactsPanel = !1), e.id && e.groupId && !e.unique_id || (this.groupsPanel = !1, 
            a.groupsPanel === !0 && (this.groupsPanel = !0)), this.listenTo(e, "firstSubscribe", function() {
                e.contacts.length || (g.contactsPanel = !1);
            }), this.contactsPanel || this.groupsPanel || (this.expandSelected = !0, f = !0)), 
            this.selected = new Moxtra.Collection({
                model: "Moxtra.model.BoardUser",
                attributeId: "sequence",
                index: [ "user.id", "user.email", "user.unique_id", "group.id" ]
            }), this.listenTo(this.selected, "all", this.updateInfo("selected")), this.listenTo(this.selected, "all", this.onChange), 
            this.listenTo(this.selected, "add", function(a) {
                if (g.expandSelected) {
                    var c = $('[href="#selectedUserList' + this.viewid + '"]');
                    1 === g.selected.length && c.hasClass("collapsed") && c.click();
                }
                g.notifySelected && (clearTimeout(g.clearNotificationTimeout), setTimeout(function() {
                    var c = "";
                    c = a.group ? a.group.name : a.user.displayName, g.$(".selected-count-info").addClass("highlight-count"), 
                    g.$(".selected-notification").text(MX.format(b.added_somebody, c)), g.clearNotificationTimeout = setTimeout(function() {
                        g.$(".selected-count-info").removeClass("highlight-count"), g.$(".selected-notification").empty();
                    }, 2500);
                }, 500));
            }), this.listenTo(this.selected, "remove", function() {
                g.notifySelected && g.$(".selected-notification").empty();
            }), this.recovery(this.selected), _.extend(this.$scope, {
                lang: b,
                inputPanel: this.inputPanel,
                selectedPanel: this.selectedPanel,
                teamsPanel: this.teamsPanel,
                contactsPanel: this.contactsPanel,
                groupsPanel: this.groupsPanel,
                autoFocus: this.autoFocus,
                notifySelected: this.notifySelected,
                onlyInputModel: f,
                showFrame: this.teamsPanel || this.groupsPanel || this.contactsPanel
            });
        },
        onChange: function() {},
        showSubList: function(a, b) {
            var c = this.groups.get(b);
            this.groups = Moxtra.getBizDirectory(c.isDivision ? {
                division: c.user.name,
                filterFn: this.filterFn
            } : {
                division: a,
                department: c.user.name,
                filterFn: this.filterFn
            }), this.listenTo(this.groups, "all", this.updateInfo("groups")), this.groups.length && this._updateBizTitle(c.user.name);
        },
        _updateBizTitle: function(a) {
            this.$(".biz-title").text(a), this.$(".groups-count").html(this.groups.length), 
            this.grouplist.binding(this.groups), this.$(".biz-back").removeClass("hide");
        },
        returnBizLibrary: function(a) {
            var c = this.handleEvent;
            c && c.stopPropagation();
            var d = this.groups[0];
            return !a && d && d.department && d.division ? (this.groups = Moxtra.getBizDirectory({
                division: d.division,
                filterFn: this.filterFn
            }), void this._updateBizTitle(d.division)) : (this.groups = Moxtra.getBizDirectory({
                filterFn: this.filterFn
            }), this.listenTo(this.groups, "all", this.updateInfo("groups")), this.grouplist.binding(this.groups), 
            this.$(".biz-title").text(b.business_directory), this.$(".groups-count").html(this.groups.length), 
            this.$(".biz-back").addClass("hide"), void 0);
        },
        rendered: function() {
            var c = this;
            Moxtra.onReady(function() {
                if (c.teamsPanel && (c.listenTo(c.teams, "all", c.updateInfo("teams")), c.listenTo(c.teams, "inited", c.updateInfo("teams"))), 
                c.groupsPanel) {
                    var a, b = Moxtra.getMe();
                    b && b.groupId && (a = b.groupId);
                    var d = Moxtra.storage("integration");
                    d.get("group_id") && (a = d.get("group_id")), a ? (c.groups = Moxtra.getBizDirectory({
                        filterFn: c.filterFn
                    }), c.listenTo(c.groups, "inited", function() {
                        c.groups.length ? c.$(".group-panel").show() : c.$(".group-panel").hide(), c.$(".groups-count").html(c.groups.length);
                    }, c), c.listenTo(c.groups, "all", c.updateInfo("groups")), c.recovery(c.groups)) : c.groupsPanel = !1;
                }
                c.contactsPanel && (c.users = Moxtra.getUserContacts(), c.listenTo(c.users, "all", c.updateInfo("users")), 
                c.listenTo(c.users, "inited", c.updateInfo("users")), c.recovery(c.users)), c.filterFn || (c.filterFn = c._selectedFilter());
            }), this.teams && (this.teamlist = new a.List({
                renderTo: this.$("#moxtraTeamList .panel-body"),
                collection: this.teams,
                template: f,
                syncModel: !0,
                $scope: {
                    lang: b,
                    blankImg: d.defaults.blankImg,
                    multiple: this.multiple,
                    dataType: "teams"
                },
                onAddItem: function(a) {
                    var b = a.find('input[type="' + (c.multiple ? "checkbox" : "radio") + '"]');
                    b.mxCheckbox();
                }
            })), this.users && (this.userlist = new a.List({
                renderTo: this.$("#moxtraUserList .panel-body"),
                collection: this.users,
                template: f,
                syncModel: !0,
                $scope: {
                    lang: b,
                    blankImg: d.defaults.blankImg,
                    multiple: this.multiple,
                    dataType: "users"
                },
                onAddItem: function(a) {
                    var b = a.find('input[type="' + (c.multiple ? "checkbox" : "radio") + '"]');
                    b.mxCheckbox();
                }
            })), this.groups && (this.grouplist = new a.List({
                renderTo: this.$("#groupUserList .panel-body"),
                collection: this.groups,
                template: g,
                syncModel: !0,
                $scope: {
                    lang: b,
                    blankImg: d.defaults.blankImg,
                    directory: d.defaults.directory.avatar,
                    multiple: this.multiple,
                    dataType: "groups"
                },
                onAddItem: function(a) {
                    var b = a.find('input[type="' + (c.multiple ? "checkbox" : "radio") + '"]');
                    b.mxCheckbox();
                }
            })), this.selectedPanel && (this.emaillist = new a.List({
                renderTo: this.$("#selectedUserList" + this.viewid + " .panel-body"),
                collection: this.selected,
                template: f,
                syncModel: !0,
                $scope: {
                    lang: b,
                    blankImg: d.defaults.blankImg,
                    multiple: this.multiple,
                    dataType: "selected"
                },
                onAddItem: function(a) {
                    a.find('input[type="' + (c.multiple ? "checkbox" : "radio") + '"]').prop("checked", !0).mxCheckbox();
                }
            })), this.defaultSelected ? (this.defaultSelected = MX.filter(this.defaultSelected, function(a) {
                return a.isGroup ? !0 : a.id !== Moxtra.getMe().id;
            }), this.selected.push(this.defaultSelected), this.$("#selectedUserList" + this.viewid).closest(".panel-collapse").collapse("show")) : this.selected.push([]), 
            this.$("form input").on("keyup", $.proxy(this.filterUser, this)), this.$("#includeMessage").on("click", function() {
                $(this).is(":checked") ? ($(".invite-message-content").removeClass("hide"), $(".invite-message-textbox").focus(), 
                c.includeMessage = !0) : (c.includeMessage = !1, $(".invite-message-content").addClass("hide"));
            }), MX.env.isIE && this.$("form input").placeholder(), this.$el.addClass("mx-" + this.style), 
            this.$(".collapse").collapse({
                toggle: !1
            }), this.contactsPanel || setTimeout(function() {
                $('[href="#groupUserList"]').click();
            }, 500);
        },
        closeMessageBox: function() {
            $(".invite-message-box").addClass("hide");
        },
        updateInfo: function(a) {
            var b = this, c = b[a];
            return function() {
                "selected" === a && (c.length ? (b.$(".selected-user-panel").removeClass("hide"), 
                b.$(".selected-count-info").removeClass("hide")) : (b.$(".selected-user-panel").addClass("hide"), 
                b.$(".selected-count-info").addClass("hide"))), b.$("." + a + "-count").text(c.length);
            };
        },
        removeSearchKey: function() {
            this._clearInput(), this._updateAlternatives();
        },
        filterUser: function(a) {
            var b = $.trim($(a.target).val()).toLowerCase(), c = [], e = [], f = this._selectedFilter(), g = function(a) {
                var c = a.user, d = (c.displayName || "").toLowerCase(), e = c.email.toLowerCase(), g = c.phone_number;
                return k.filterUser(b, [ d, e, g ]) && f(a);
            }, h = this;
            if (this.$("#userSelectorFormGroup").removeClass("has-error"), b.length ? this.$(".input-close").removeClass("hide") : this.$(".input-close").addClass("hide"), 
            a.keyCode === d.keys.Enter || a.keyCode === d.keys.Space || a.keyCode === d.keys.Comma || a.keyCode === d.keys.Semicolon) {
                if (b.length) {
                    if (c = h._split(b), e = h._pickEmails(c), c.length > 0 && 0 === e.length) return void this.$("#userSelectorFormGroup").addClass("has-error");
                    e.forEach(function(a) {
                        var b = h.selected.originalFilter(function(b) {
                            return b.user && b.user.email === a;
                        });
                        if (0 === b.length) {
                            var c;
                            h.userlist && (c = h.users.originalFilter(function(b) {
                                return b.user && b.user.email === a;
                            })), h.grouplist && (c && c.length || (c = h.groups.originalFilter(function(b) {
                                return b.user && b.user.email === a;
                            }))), c && c.length || (c = new Moxtra.model.BoardUser(), c.user = new Moxtra.model.Contact({
                                email: a
                            })), h.selected.push(c);
                        }
                    }), this._clearInput(), this._updateAlternatives();
                }
            } else this.teamlist && (this.teamlist.filter(function(a) {
                var c = (a.group.name || "").toLowerCase();
                return c.indexOf(b) > -1;
            }), this.$(".teams-count").text(this.teamlist.collection.length)), this.userlist && (this.userlist.filter(g), 
            this.$(".users-count").text(this.userlist.collection.length)), this.grouplist && (this.returnBizLibrary(!0), 
            b && (this.groups = Moxtra.searchBizContact(b, this.filterFn)), this.listenTo(this.groups, "all", this.updateInfo("groups")), 
            this.grouplist.binding(this.groups));
        },
        zoomInviteMessage: function() {
            if (this.dialog) {
                var a = this.$(".invite-message-textbox").val(), b = this, c = new h({
                    message: a,
                    onClose: function(c) {
                        c !== a && b.$(".invite-message-textbox").val(c), b.dialog.$(".modal-dialog").removeClass("message-container"), 
                        b.dialog.pop();
                    }
                });
                this.dialog.push({
                    content: c,
                    className: "message-container",
                    hideHeader: !0
                });
            }
        },
        getFormElements: function(a) {
            return a = a || this.$el, a.find(this.multiple ? 'input[type="checkbox"]' : 'input[type="radio"]');
        },
        selectUser: function() {
            var a, b = this.handleEvent, c = $(b.currentTarget), d = this.getFormElements(c), e = d.val(), f = d.data("type");
            if (b.stopPropagation(), "selected" === f) a = this.selected.get(e), this.selected.remove(a); else {
                if (a = this[f].get(e), !this.multiple && this.selected.length) {
                    var g = this.selected.at(0);
                    this.selected.remove(g);
                }
                this.selected.push(a);
            }
            this._clearInput(), this._updateAlternatives(), this.trigger("select", this.selected.clone()), 
            this.onSelect();
        },
        _selectedFilter: function() {
            var a = this.selected;
            return function(b) {
                var c;
                return b.group ? (c = b.group, Array.prototype.filter.call(a, function(a) {
                    return a.group && a.group.id === c.id;
                }).length <= 0) : (c = b.user, a && c.get("email") ? Array.prototype.filter.call(a, function(a) {
                    return a.user && a.user.email === c.email;
                }).length <= 0 : Array.prototype.filter.call(a, function(a) {
                    return a.user && a.user.primaryKey === c.primaryKey;
                }).length <= 0);
            };
        },
        _updateAlternatives: function() {
            this.teamlist && (this.teamlist.filter(this._selectedFilter()), this.$(".teams-count").text(this.teamlist.collection.length)), 
            this.userlist && (this.userlist.filter(this._selectedFilter()), this.$(".users-count").text(this.userlist.collection.length)), 
            this.grouplist && (this.grouplist.filter(this._selectedFilter()), this.$(".groups-count").text(this.grouplist.collection.length));
        },
        _clearInput: function() {
            var a = this.$("form input"), b = a.val();
            b && this.groupsPanel && this.returnBizLibrary(!0), a.val("").focus(), this.$(".input-close").addClass("hide");
        },
        _split: function(a) {
            return a.split(/,|;|\s/g);
        },
        _pickEmails: function(a) {
            var b = [];
            return a.forEach(function(a) {
                /^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(a) && b.push(a.toLowerCase());
            }), b;
        },
        onSelect: function() {},
        completeValues: function() {
            var a = this.$("form input").val(), b = [], c = this;
            return a.length > 0 && (b = this._pickEmails(this._split(a)), b.length && b.forEach(function(a) {
                var b;
                c.selected.originalFilter(function(b) {
                    return b.user && b.user.email === a;
                }).length || (b = new Moxtra.model.BoardUser(), b.user = new Moxtra.model.Contact(), 
                b.user.email = a, b.displayName = a, c.selected.push(b));
            })), this.selected;
        },
        value: function() {
            var a = this.completeValues(), b = new Moxtra.util.Array();
            return a.length && a.each(function(a) {
                a.group ? b.push(a.group) : (a.user.picture_url = a.avatar, b.push(a.user));
            }), b;
        }
    }), MX.ui.UserSelector;
}), define("ui", [], function() {}), define("meet/connector/util", [ "moxtra", "lang", "app", "text!template/meet/downloadTip.html", "text!template/meet/connector/downloadAddOn.html", "text!template/meet/connector/downloadPartnerExtension.html", "text!template/meet/activexTip.html", "text!template/meet/activexDenyTip.html", "text!template/meet/downloadRefresh.html", "text!template/meet/permissionTip.html", "component/uploader/fileProgress", "meet/connector/config", "meet/connector/type", "meet/connector/cache", "meet/connector/listener", "component/dialog/dialog", "ui" ], function(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o) {
    var p, q = MX.logger("meet:connector:util"), r = Handlebars.compile(d), s = Handlebars.compile(e), t = Handlebars.compile(f), u = (Handlebars.compile(g), 
    Handlebars.compile(h)), v = Handlebars.compile(i), w = Handlebars.compile(j), x = function() {
        var c = a.Model.extend({
            percent: 0,
            name: ""
        });
        p = new c({
            percent: 0,
            name: b.upgrading
        }), new MX.ui.Notify({
            autoClose: !1,
            iframeShim: !0,
            content: new k({
                model: p
            })
        });
    };
    return {
        parse: function(a) {
            a = this.json(a);
            var b = {}, c = a[l.platform] || {}, d = [ "plugin", "installer", "name", "version", "pkg", "ie", "plugin_type", "addon_version", "addon_installer" ];
            return MX.each(d, function(a) {
                "installer" === a || "addon_installer" === a ? (b[a] = l.domain + c[l[a]], "addon_installer" === a && (b.addon_name = c[l[a]])) : b[a] = c[l[a]];
            }), b.ie || (b.ie = {}), b;
        },
        activeXFeature: function() {
            if (!("ActiveXObject" in window)) return !1;
            try {
                if (window.external && external.msActiveXFilteringEnabled && external.msActiveXFilteringEnabled()) return !1;
            } catch (a) {}
            return !0;
        },
        isNewPlugin: function(a) {
            var b = a.split(" ");
            if (b.length) {
                b = b[b.length - 1];
                var c = b.split(".");
                return parseInt(c[0]) >= 2 ? !0 : !1;
            }
            return !1;
        },
        hasPlugin: function(a) {
            var b = !1;
            try {
                navigator.plugins.refresh(!1), navigator.plugins[a] && (q.log("[util:hasPlugin] got plugin in browser plugins list."), 
                b = !0);
            } catch (c) {
                q.error("[util:hasPlugin] error when check plugin existence: ", c);
            }
            return b;
        },
        hasActiveX: function(a) {
            if (a) {
                var b;
                try {
                    b = new ActiveXObject(a);
                } catch (c) {}
                return !!b;
            }
            return !1;
        },
        isActiveXSupported: function() {
            var a, c = !1;
            return "undefined" != typeof window.external.msActiveXFilteringEnabled && (c = window.external.msActiveXFilteringEnabled()), 
            c ? (MX.ui.Alert(b.activex_filtering_enabled_alert, {
                className: "mx-branding-meet-dialog-btn"
            }), q.logServer(this.logFormat("[isActiveXSupported] Not supported, as ActiveX Filtering enabled")), 
            !1) : MX.env.browserVersion > 9 && (a = function() {
                var a = null, b = null;
                try {
                    new ActiveXObject("");
                } catch (c) {
                    b = c.name;
                }
                try {
                    a = !!new ActiveXObject("htmlfile");
                } catch (c) {
                    a = !1;
                }
                return a = "ReferenceError" != b && 0 == a ? !1 : !0, !a;
            })() ? (MX.ui.Alert(b.activex_not_supported_on_metro_ie, {
                className: "mx-branding-meet-dialog-btn"
            }), q.logServer(this.logFormat("[isActiveXSupported] Not supported, as IE in metro style")), 
            !1) : !0;
        },
        download: function(a, b) {
            if (!n.inSession) return void q.log("[util:download] meet is ended, do not continue to download.");
            var c, d = "hiddenMXApplicationDownloader";
            c = document.getElementById(d), null === c && (c = document.createElement("iframe"), 
            c.id = d, c.style.display = "none", document.body.appendChild(c)), q.log("[util:download] ", a), 
            c.src = MX.env.isIE ? a + "?v=" + Math.round(1e6 * Math.random()) + ".exe" : a + "?v=" + Math.round(1e6 * Math.random()), 
            this.showDownloadTip(a, b);
        },
        showPermissionTip: function(a) {
            if (MX.env.isChrome || MX.env.isFF && MX.env.browserVersion >= 30) {
                var c = {}, d = {
                    normal: !1,
                    special: !1
                }, e = {
                    higherVersion: !1,
                    lowerVersion: !1
                };
                c.lang = b, MX.env.isChrome ? (_.extend(c, {
                    webrtc: "webrtc" === a,
                    plugin: "plugin" === a
                }), MX.env.browserVersion >= 37 ? e.higherVersion = !0 : e.lowerVersion = !0, c.chrome = e) : (1 == navigator.plugins.length ? d.special = !0 : d.normal = !0, 
                c.ff = d), n.permissionDialog = new MX.ui.Dialog({
                    title: "",
                    width: this._getDialogWidth(615),
                    content: w(c),
                    iframeShim: !0
                }), n.permissionDialog.on("close", function() {
                    n.permissionDialog = null;
                });
            }
        },
        hidePermissionTip: function() {
            n.permissionDialog.close(), n.permissionDialog = null;
        },
        showDownloadTip: function(a, c) {
            c = c || {};
            var d = {
                lang: b
            }, e = r;
            _.extend(d, MX.env);
            var f = 615;
            if ("add-on" === c.type) {
                e = s;
                var g = n.cfg.addon_name || "", h = g.replace(".zip", ".app"), i = n.cfg.addon_installer;
                d.addon_step1 = MX.format(b.install_addon_step1, {
                    installer_zip_file_name: g
                }), d.addon_step2 = MX.format(b.install_addon_step2, {
                    installer_app_file_name: h
                }), d.addon_installer = MX.format(b.install_addon_failed, {
                    addon_installer: i
                }), f = 450;
            }
            "extension" === c.type && (e = t, d.install_crx_tip = MX.format(b.drag_and_install_chrome_extension_tip, {
                crx_name: c.crx_name
            })), n.downloadDialog = new MX.ui.Dialog({
                title: "",
                width: this._getDialogWidth(f),
                content: e(d),
                iframeShim: !0
            }), n.downloadDialog.on("close", function() {
                c.onClose && c.onClose(), n.downloadDialog = null;
            });
        },
        hideDownloadTip: function() {
            n.downloadDialog && (n.downloadDialog.close(), n.downloadDialog = null);
        },
        showActiveXTip: function() {
            this.showDownloadTip();
        },
        hideActiveXTip: function() {
            this.hideDownloadTip();
        },
        showConnectingTip: function() {
            $(".mx-viewer-tips .tips-header.self-connecting").removeClass("hide").html('<span style="display:inline-block;padding:3px 15px;margin-bottom:-3px;background:#FEFBB9;color:#333;">' + b.connecting_ellipsis + "</span>");
        },
        hideConnectingTip: function() {
            $(".mx-viewer-tips .tips-header.self-connecting").addClass("hide").empty();
        },
        showUpgradeProgress: function(a) {
            p || x(), p.set({
                percent: a
            });
        },
        needConnection: function(a) {
            return [ m.request.ds.START, m.request.ds.JOIN, m.request.ac.JOIN, m.request.av.JOIN ].indexOf(a) > -1;
        },
        hasFunction: function(a, b) {
            var c = !1;
            return b && (b.prototype ? b.prototype.hasOwnProperty(a) && MX.isFunction(b[a]) && (c = !0) : b.hasOwnProperty(a) && MX.isFunction(b[a]) && (c = !0)), 
            c;
        },
        dialog: function(a, c, d) {
            var e = function() {
                c && (q.log("[util:dialog] trigger: ", c), o.trigger(c));
            }, f = function() {
                q.log("[util:dialog] cancel reconnect, so reset ds/ac/av status"), o.trigger(m.response.ds.STOPPED, {
                    code: 0
                }), o.trigger(m.response.ac.LEFT, {
                    code: 0
                }), o.trigger(m.response.av.LEFT, {
                    code: 0
                }), d && d.cancelCallback && d.cancelCallback();
            }, g = {}, h = this;
            g.lang = b, g.download = MX.format(b.plugin_download_latest, {
                link: n.cfg.installer
            });
            var i = {
                peerUpdated: {
                    title: "",
                    width: this._getDialogWidth(400),
                    content: b.peer_server_updated_tip,
                    iframeShim: !0,
                    buttons: [ {
                        text: b.ok,
                        className: "btn-warning mx-branding-meet-dialog-btn",
                        click: function() {
                            this.close(), e();
                        }
                    } ]
                },
                refresh: {
                    title: "",
                    width: this._getDialogWidth(400),
                    content: v(g),
                    iframeShim: !0,
                    buttons: [ {
                        text: b.cancel,
                        className: "btn-default",
                        click: function() {
                            this.close(), f();
                        }
                    }, {
                        text: b.refresh,
                        className: "btn-warning mx-branding-meet-dialog-btn",
                        click: function() {
                            this.close(), e();
                        }
                    } ]
                },
                reconnect: {
                    title: "",
                    width: this._getDialogWidth(400),
                    content: b.system_unknown_error,
                    iframeShim: !0,
                    buttons: [ {
                        text: b.cancel,
                        className: "btn-default",
                        click: function() {
                            q.logServer(h.logFormat('[User Action] click "Cancel" ')), this.close(), f();
                        }
                    }, {
                        text: b.try_again,
                        className: "btn-warning mx-branding-meet-dialog-btn",
                        click: function() {
                            q.logServer(h.logFormat('[User Action] click "Try Again" ')), this.close(), e();
                        }
                    } ]
                }
            };
            MX.env.isIE && "reconnect" === a && n.denyExecutionOnIEShown && (n.denyExecutionOnIEShown = !1, 
            i.reconnect.content = u({
                lang: b
            }), i.reconnect.width = this._getDialogWidth(550), i.reconnect.buttons = []), i[a] && new MX.ui.Dialog(i[a]);
        },
        getExtensionId: function() {
            return this.installFromChromeStore() ? l.extensionId : this.isPartnerExtension() ? l.partnerExtensionId : l.extensionId;
        },
        isPartnerExtension: function() {
            return c.isIntegrationWebsdk();
        },
        installFromChromeStore: function() {
            var a = !0;
            return "cn" === Moxtra.getMe().zone && (a = !1), a;
        },
        logFormat: function(a, b) {
            b = b || {};
            var c, d = "{{meetid}}.{{rosterid}}.web.{{datetime}} {{message}}";
            return c = MX.format(d, {
                meetid: n.meetId || b.meetId || "",
                rosterid: n.rosterId || b.rosterId || Moxtra.getMe().sessionId || "",
                datetime: moment(Date.now()).format("MM/DD/YY HH:mm:ss.SSS"),
                message: a
            });
        },
        json: function(a) {
            if ("string" != typeof a) return "object" == typeof a ? a : {};
            try {
                return JSON.parse(a);
            } catch (b) {
                return {};
            }
        },
        string: function(a) {
            if ("string" == typeof a) return a;
            try {
                return JSON.stringify(a);
            } catch (b) {
                return "";
            }
        },
        parentWinWidth: function() {
            var a = $(window).width();
            try {
                window.frameElement && (a = window.frameElement.offsetWidth);
            } catch (b) {}
            return a;
        },
        _getDialogWidth: function(a) {
            var b = this.parentWinWidth(), c = 40;
            return b > a + c ? a : b - c;
        }
    };
}), define("meet/connector/appPlugin", [ "moxtra", "lang", "app", "meet/connector/config", "meet/connector/type", "meet/connector/util", "meet/connector/cache", "meet/connector/listener" ], function(a, b, c, d, e, f, g, h) {
    var i = MX.logger("meet:connector:plugin"), j = function() {
        this.ActiveX = MX.env.isIE, this.TIMEOUT = {}, this.connected = !1, this.connecting = !1, 
        this.TRY_DIALOG = !1;
    };
    return _.extend(j.prototype, {
        init: function() {
            h.on(e.action.plugin.RECONNECT, this._start, this), i.logServer(f.logFormat("[Show] connecting tip of appPlugin init")), 
            f.showConnectingTip(), i.logServer(f.logFormat("[int] set connecting status: true")), 
            this.connecting = !0, this.ActiveX ? this._launch() : this._check();
        },
        send: function(a) {
            if (this.connected) i.log("[send] try to send: ", a), this._send(a); else {
                if (i.log("[send] has not connected!"), g.request = a, this.connecting && this.ActiveX) return void i.logServer(f.logFormat("[send] plugin is connecting, only cache request: " + JSON.stringify(a)));
                f.needConnection(a.type) && (this.connecting || (i.log("[send] has not connected, try to start..."), 
                i.logServer(f.logFormat("[send] connected:false and connecting:false, set connecting status: true, then goto startApplication flow")), 
                this.connecting = !0, this.ActiveX ? this._launch() : this._check()));
            }
        },
        close: function() {
            i.logServer(f.logFormat("[close] closed...")), this._clearTimeout(), this.connected = !1, 
            this.connecting = !1, i.logServer(f.logFormat("[Hide] connecting tip of appPlugin")), 
            f.hideDownloadTip(), f.hidePermissionTip(), f.hideConnectingTip(), this.stopApplication(), 
            i.logServer(f.logFormat("[close] remove plugin dom"), !0), this._clearPlugin();
        },
        stopApplication: function() {
            var a = this._plugin();
            if (a) try {
                i.logServer(f.logFormat("[close] stopApplication")), a.stopApplication();
            } catch (b) {
                i.warnServer(f.logFormat("[close] stopApplication error: " + b));
            }
        },
        _check: function() {
            this._clearTimeout(), g.downloading = !1, this._clearPlugin();
            var a = this, b = function() {
                f.hasPlugin(g.cfg.plugin) ? (i.logServer(f.logFormat("[_check] found plugin, try to launch it")), 
                g.downloading = !1, clearTimeout(a.TIMEOUT.check), f.hidePermissionTip(), f.hideDownloadTip(), 
                a._launch()) : (i.logServer(f.logFormat("[_check] Not found plugin, waiting until Moxtra Application Plugin installed")), 
                g.downloading || (i.logServer(f.logFormat("[_check] trigger download installer_file")), 
                g.downloading = !0, f.download(g.cfg.installer), a.TIMEOUT.download = setTimeout(function() {
                    f.hideDownloadTip();
                }, 6e5)), a.TIMEOUT.check = setTimeout(function() {
                    i.warn("[_check] No plugin found, so loop to load plugin every 1.5 seconds"), b();
                }, 1500));
            };
            b();
        },
        _launch: function() {
            var a = this;
            return this.ActiveX && (this._clearPlugin(), !f.isActiveXSupported()) ? (i.logServer(f.logFormat("[Hide] connecting tip of appPlugin, as ActiveX not supported")), 
            f.hideConnectingTip(), void (this.connecting = !1)) : (this._embed(), void setTimeout(function() {
                a._start();
            }, 1500));
        },
        _start: function() {
            i.logServer(f.logFormat("[Show] connecting tip of appPlugin _start")), f.showConnectingTip();
            var a = this;
            this.TRY_DIALOG = !1;
            var b = function() {
                var j = a._plugin(), k = !1;
                if (a.ActiveX ? j && j.object && (k = !0) : j && j.startApplication && (k = !0), 
                k) {
                    i.logServer(f.logFormat("[_start] plugin loaded, start to register callbacks")), 
                    clearTimeout(a.TIMEOUT.start), clearTimeout(a.TIMEOUT.permission), clearTimeout(a.TIMEOUT.download), 
                    f.hidePermissionTip(), f.hideDownloadTip(), j.addEvtListener("connectionCallback", function(b) {
                        i.logServer(f.logFormat("[onConnectionCallback] connection callback: " + b)), f.hideDownloadTip(), 
                        a.connected = !!b, a.connecting = !1, a.connected ? (i.logServer(f.logFormat("[Hide] connecting tip of appPlugin")), 
                        f.hideConnectingTip(), h.trigger("open"), MX.each(g.request, function(b) {
                            setTimeout(function() {
                                a._send(b);
                            }, 500);
                        }), g.request = [], h.trigger(e.action.audio.CHECK)) : (a._clearTimeout(), g.inSession && !a.TRY_DIALOG && (a.TRY_DIALOG = !0, 
                        i.logServer(f.logFormat("[Show] TRY_AGAIN dialog")), f.dialog("reconnect", e.action.plugin.RECONNECT)));
                    }), j.addEvtListener("textDataCallback", function(a) {
                        var b = f.json(a);
                        h.trigger(b.type, b), b.type !== e.response.ac.SPEAKER ? i.logServer(f.logFormat("[textDataCallback] message " + a)) : i.log("[textDataCallback] message " + a);
                    }), j.addEvtListener("base64DataCallback", function(a, b) {
                        var c = g.base64[a];
                        c && c.callback && c.callback.call(c.context, b);
                    }), j.addEvtListener("upgradeFailedCallback", function() {
                        i.logServer(f.logFormat("[upgradeFailedCallback] action. Web will reset UI and show download dialog.")), 
                        f.download(g.cfg.installer), a.TIMEOUT.download = setTimeout(function() {
                            f.hideDownloadTip();
                        }, 6e5);
                    }), j.addEvtListener("upgradeProgressCallback", function(a) {
                        i.logServer(f.logFormat("[upgradeProgressCallback] percent = " + a)), f.showUpgradeProgress(a);
                    }), j.addEvtListener("logCallback", function(a) {
                        i.logServer(a);
                    }), j.addEvtListener("reportCallback", function(a, b) {
                        i.logServer(f.logFormat("got crash reportCallback:" + a)), i.sendCrashReport(a, b);
                    }), c.isIntegrationVideo() && j.setWindowEmbedded(!0, d.pluginBgColor), i.logServer(f.logFormat("[_start] startApplication params: " + [ d.domain, g.cfg.pkg, d.lang, g.meetId, g.rosterId ].join(", ")));
                    var l = j.startApplication(d.domain, g.cfg.pkg, d.lang, g.meetId, g.rosterId);
                    i.logServer(f.logFormat("[_start] startApplication result: " + l)), l || (i.logServer(f.logFormat("[_start] startApplication failed, so reset UI and show download dialog")), 
                    f.download(g.cfg.installer), a.TIMEOUT.download = setTimeout(function() {
                        f.hideDownloadTip();
                    }, 6e5));
                } else a.ActiveX ? j && (i.warn("[_start] got plugin, but has not got object on activex. Loop to start after 1.5 seconds"), 
                g.downloading || (i.logServer(f.logFormat("[_check] trigger download installer_file")), 
                g.downloading = !0, f.download(g.cfg.installer), a.TIMEOUT.download = setTimeout(function() {
                    f.hideDownloadTip();
                }, 6e5)), a._clearPlugin(), a._embed()) : j ? (i.warn("[_start] got plugin, but has not got startApplication on plugin. Loop to start after 1.5 seconds"), 
                g.permissionTipPlugin || (g.permissionTipPlugin = !0, a.TIMEOUT.permission = setTimeout(function() {
                    f.showPermissionTip("plugin");
                }, 3e3))) : (i.warn("[_start] no plugin dom"), a._embed()), a.TIMEOUT.start = setTimeout(function() {
                    i.warn(a.ActiveX ? "[_start] No activex found, so loop to check activex every 1.5 seconds" : "[_start] Loop to launch plugin because of no plugin or plugin.startApplication found every 1.5 sec"), 
                    b();
                }, 1500);
            };
            b();
        },
        _embed: function() {
            if (this.ActiveX) {
                var a = d.activeX, b = MX.getOrigin();
                (/localhost/.test(b) || /(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])/.test(b)) && (b = "https://www.grouphour.com"), 
                a = MX.format(a, _.extend(g.cfg.ie, {
                    domain: b
                })), this._plugin() || (i.logServer(f.logFormat("[_embed] embed activex dom to html body")), 
                $(d.target).html(a));
            } else if (g.permissionTipPlugin = !1, !this._plugin()) {
                g.cfg.plugin_type = g.cfg.plugin_type || "application/moxtraplugin";
                var a = MX.format(d.element, g.cfg);
                i.logServer(f.logFormat("[_embed] embed plugin dom to html body")), $(d.target).html(a);
            }
        },
        _send: function(a) {
            i.logServer(f.logFormat("[_send] sent request: " + f.string(a)));
            var b = this._plugin();
            b && b.sendText(f.string(a));
        },
        _plugin: function() {
            return document.getElementById(d.pluginId);
        },
        _clearPlugin: function() {
            $(d.target).empty(), i.log("[_clearPlugin] ---------------- plugin dom removed ---------------");
        },
        _clearTimeout: function() {
            for (var a in this.TIMEOUT) clearTimeout(this.TIMEOUT[a]);
            i.log("[_clearTimeout] ---------------- all timer cleared ---------------");
        }
    }), j;
}), define("text!template/meet/connector/downloadExtension.html", [], function() {
    return '<div class="mx-app-download-tip">\n	<ul>\n		<li class="center">\n			<span class="msg">{{lang.install_chrome_extension_detail}}</span>\n		</li>\n		<li class="center">\n			<br /> <br />\n			<a class="btn btn-warning" data-action="addExtension">{{lang.install_chrome_extension_button}}</a>\n		</li>\n		<li class="center fallback-link hide">\n			<br />\n			<span>{{bbcode lang.install_chrome_extension_failed}}</span>\n		</li>\n	</ul>\n</div>';
}), define("meet/connector/dialogs/downloadExtension", [ "moxtra", "lang", "text!template/meet/connector/downloadExtension.html" ], function(a, b, c) {
    "use strict";
    return a.Controller.extend({
        template: c,
        title: b.install_chrome_extension,
        handleAction: !0,
        init: function(a) {
            a = a || {}, this.onAdd = a.onAdd || function() {}, this.$scope.lang = b;
        },
        rendered: function() {},
        addExtension: function() {
            this.handleEvent.preventDefault(), this.handleEvent.stopPropagation(), this.onAdd();
        },
        onFailed: function() {
            this.$(".fallback-link").removeClass("hide");
        }
    });
}), define("meet/connector/extension", [ "moxtra", "lang", "meet/connector/dialogs/downloadExtension", "meet/connector/config", "meet/connector/type", "meet/connector/util", "meet/connector/cache", "meet/connector/listener", "uuid" ], function(a, b, c, d, e, f, g, h, i) {
    "use strict";
    var j = MX.logger("meet:connector:extension"), k = function() {
        function a() {
            w = !1, x = !1, y = !1, z = !1, A = null, B = null;
        }
        function b() {
            for (var a in C) C.hasOwnProperty(a) && clearTimeout(C[a]);
            C = {};
        }
        function k() {
            x = !1, z = !1, f.hideConnectingTip();
        }
        function l() {
            a(), x = !0;
            var b = i();
            try {
                A = chrome.runtime.connect(f.getExtensionId(), {
                    name: b
                }), A.onMessage.addListener(o), A.onDisconnect.addListener(p), j.logServer(f.logFormat("[extension] _connectExtension: " + A.name));
            } catch (c) {
                j.logServer(f.logFormat("[extension] _connectExtension: failed to connect to extension with port.name= " + b));
            }
        }
        function m() {
            try {
                A.disconnect();
            } catch (b) {
                j.logServer(f.logFormat("[extension] _connectExtension: failed to disconnect to extension"));
            }
            a();
        }
        function n(b) {
            try {
                j.logServer(f.logFormat("[extension] _sendMessageToExtension: " + f.string(b))), 
                A.postMessage(b);
            } catch (c) {
                console.error("failed to send message to extension", c), j.logServer(f.logFormat("[extension] _sendMessageToExtension: failed to send message to extension")), 
                a();
            }
        }
        function o(a) {
            if (j.log("got message from extension", a), a || a.status || a.type) {
                if (a.status) switch (a.status) {
                  case "success":
                    switch (a.message) {
                      case "ExtensionConnected":
                        b(), x = !0, g.downloading = !1, f.hideDownloadTip(), j.logServer(f.logFormat("[ExtensionConnected] try to _requestToConnectNativeHost.")), 
                        u();
                        break;

                      case "NativeHostConnected":
                        b(), x = !0, g.downloading = !1, f.hideDownloadTip(), j.logServer(f.logFormat("[NativeHostConnected] try to _startApplication.")), 
                        q();
                    }
                    break;

                  case "error":
                    switch (a.message) {
                      case "NativeHostNotFound":
                      case "NativeHostForbidden":
                        g.downloading || (g.downloading = !0, f.download(g.cfg.addon_installer, {
                            type: "application",
                            onClose: function() {
                                k();
                            }
                        })), C.checkAddOn = setTimeout(function() {
                            j.logServer(f.logFormat("[checkAddOn]" + a.message + " try to postMessage: NeedConnectNative after 1.5s")), 
                            u();
                        }, 1500);
                        break;

                      case "NativeHostExited":
                        if (w = !1, j.logServer(f.logFormat("[_handleExtensionMessage] NativeHostExited, Native host crashed or deleted")), 
                        g.downloading) return;
                        z && (f.hideDownloadTip(), z = !1), g.inSession && !y && (y = !0, j.logServer(f.logFormat("[Show] TRY_AGAIN dialog as NativeHostExited")), 
                        f.dialog("reconnect", e.action.extension.RECONNECT, {
                            cancelCallback: b
                        }));
                    }
                }
                switch (a.type) {
                  case "MEET_ADDON_NEED_UPDATE":
                    j.logServer(f.logFormat("[extension] _handleExtensionMessage: MEET_ADDON_NEED_UPDATE")), 
                    g.downloading || (g.downloading = !0, f.download(g.cfg.addon_installer, {
                        type: "application",
                        onClose: function() {
                            k();
                        }
                    }), C.checkAddOn = setTimeout(function() {
                        j.logServer(f.logFormat("[checkAddOn]" + a.type + " try to postMessage: NeedConnectNative after 1.5s")), 
                        u();
                    }, 1500));
                    break;

                  case "MEET_APP_NEED_UPDATE":
                    j.logServer(f.logFormat("[extension] _handleExtensionMessage: MEET_APP_NEED_UPDATE")), 
                    z || (z = !0, f.download(g.cfg.installer, {
                        type: "application",
                        onClose: function() {
                            k();
                        }
                    }));
                    break;

                  case "MEET_APP_UPGRADE_PROGRESS":
                    j.logServer(f.logFormat("[upgradeProgressCallback] percent = " + a.percent)), f.showUpgradeProgress(a.percent);
                    break;

                  case "MEET_APP_STARTED":
                    j.logServer(f.logFormat("[extension]_handleExtensionMessage: MEET_APP_STARTED")), 
                    w = !0, x = !1, g.downloading = !1, f.hideConnectingTip(), f.hideDownloadTip(), 
                    h.trigger("open"), MX.each(g.request, function(a) {
                        setTimeout(function() {
                            n(a);
                        }, 500);
                    }), g.request = [], h.trigger(e.action.audio.CHECK);
                    break;

                  case "MEET_APP_STOPPED":
                    j.logServer(f.logFormat("[extension] _handleExtensionMessage: MEET_APP_STOPPED")), 
                    w = !1;
                    break;

                  case "MEET_APP_LOG":
                    j.logServer(a.log);
                    break;

                  case "MEET_APP_CRASHREPORT":
                    j.logServer(f.logFormat("got crash reportCallback:" + a.filename)), j.sendCrashReport && j.sendCrashReport(a.filename, a.report);
                    break;

                  case "MEET_APP_BASE64DATA":
                    var c = g.base64[a.datatype];
                    c && c.callback && c.callback.call(c.context, a.datacode);
                    break;

                  default:
                    h.trigger(a.type, a), a.type !== e.response.ac.SPEAKER ? j.logServer(f.logFormat("[textDataCallback] message " + JSON.stringify(a))) : j.log("[textDataCallback] message " + JSON.stringify(a));
                }
            }
        }
        function p() {
            j.logServer(f.logFormat("[_handleExtensionDisconnect]" + (A && A.name))), chrome.runtime && chrome.runtime.lastError && j.logServer(f.logFormat(chrome.runtime.lastError.message)), 
            g.inSession && !y && (y = !0, j.logServer(f.logFormat("[Show] TRY_AGAIN dialog from _handleExtensionDisconnect")), 
            f.dialog("reconnect", e.action.extension.RECONNECT, {
                cancelCallback: b
            })), w = !1, A = null;
        }
        function q() {
            var a = {
                type: "MEET_APP_REQUEST_START",
                add_on_version: g.cfg.addon_version,
                meetid: g.meetId,
                rosterid: g.rosterId,
                application_pkg: g.cfg.pkg,
                domain: d.domain,
                language: d.lang
            };
            n(a);
        }
        function r() {
            var a = {
                type: "MEET_APP_REQUEST_STOP",
                meetid: g.meetId,
                rosterid: g.rosterId
            };
            n(a);
        }
        function s() {
            if (!f.installFromChromeStore()) return void (f.isPartnerExtension() ? f.download(d.partnerExtensionCrx, {
                type: "extension",
                crx_name: d.partnerCrxName
            }) : f.download(d.moxtraExtensionCrx, {
                type: "extension",
                crx_name: d.moxtraCrxName
            }));
            var a = top === window;
            B = new c({
                onAdd: function() {
                    a ? (j.logServer(f.logFormat("try extension inline installation")), t()) : (j.logServer(f.logFormat("link to Chrome webstore for extension installation.")), 
                    window.open("https://chrome.google.com/webstore/detail/meet-extension-by-moxtra/" + f.getExtensionId()));
                }
            });
            var b = new MX.ui.Dialog({
                width: 400,
                iframeShim: !0,
                content: B
            });
            b.on("close", function() {
                B && B.destroy && B.destroy(), B = null, k();
            }), g.downloadDialog = b;
        }
        function t() {
            try {
                chrome.webstore.install(void 0, function() {
                    j.logServer(f.logFormat("extension installed successfully.")), f.hideDownloadTip();
                }, function(a) {
                    j.logServer(f.logFormat("chrome extension install failed: " + a)), "cancel" !== a.toLowerCase().match("cancel") ? (j.logServer(f.logFormat("extension install failed: " + a)), 
                    B && B.onFailed && B.onFailed()) : j.logServer(f.logFormat("User cancelled extension installation"));
                });
            } catch (a) {
                console.error(a), j.logServer(f.logFormat("chrome.webstore.install failed")), B && B.onFailed && B.onFailed();
            }
        }
        function u() {
            try {
                A.postMessage({
                    type: "NeedConnectNative"
                });
            } catch (a) {
                j.logServer(f.logFormat("_requestToConnectNativeHost failed: "));
            }
        }
        function v() {
            b(), g.downloading = !1;
            var a = 0, c = f.getExtensionId(), d = function() {
                chrome.runtime.sendMessage(c, {
                    message: "version"
                }, function(b) {
                    b && b.version ? (console.log("extension installed"), clearTimeout(C.checkExtension), 
                    j.logServer(f.logFormat("[_checkExtension] extension installed, version: " + b.version + ", start to connect")), 
                    l()) : (console.log("extension not installed"), g.downloading || (g.downloading = !0, 
                    s()), C.checkExtension = setTimeout(function() {
                        a++, a % 20 === 0 && j.logServer(f.logFormat("[_checkExtension] check extension again after 1.5s")), 
                        d();
                    }, 1500));
                });
            };
            d();
        }
        var w = !1, x = !1, y = !1, z = !1, A = null, B = null, C = {};
        return {
            init: function() {
                h.on(e.action.extension.RECONNECT, v), j.logServer(f.logFormat("[Show] connecting tip of extension init")), 
                f.showConnectingTip(), j.logServer(f.logFormat("[int] set extension connecting status: true")), 
                x = !0, j.logServer(f.logFormat("[int] _checkExtension")), v();
            },
            send: function(a) {
                w ? (j.log("[send] try to send: ", a), n(a)) : (j.logServer(f.logFormat("[send] has not connected!")), 
                g.request = a, !x && f.needConnection(a.type) && (j.logServer(f.logFormat("[send] connected:false and connecting:false, set connecting status: true, then goto _checkExtension flow")), 
                x = !0, v()));
            },
            close: function() {
                j.logServer(f.logFormat("[close] closed...")), j.logServer(f.logFormat("[Hide] connecting tip of extension")), 
                f.hideDownloadTip(), f.hideConnectingTip(), r(), m(), a();
            },
            stopApplication: function() {
                r();
            }
        };
    };
    return k;
}), define("meet/connector/peer", [ "moxtra", "meet/connector/config", "meet/connector/type", "meet/connector/util", "meet/connector/cache", "meet/connector/listener" ], function(a, b, c, d, e, f) {
    var g = MX.logger("meet:connector:peer"), h = function() {
        this.ALIVE_INTERVAL = null, this.TIMEOUT = {}, this.connected = !1, this.addrUpdated = !1, 
        this.addr = "", this.server = "";
    };
    return _.extend(h.prototype, {
        init: function() {
            f.on(c.action.peer.RECONNECT, this._connect, this), f.on(c.action.peer.REFRESH, function() {
                location.reload();
            }), this._connect();
        },
        send: function(a) {
            this.connected ? this._send(a) : (e.request = a, e.connecting ? this._connected() && this._load() : d.needConnection(a.type) && this._connect());
        },
        update: function() {
            this.addr && this._connected() && this.addr != e.peer.server_addr && (this._disconnect(), 
            this.addrUpdated = !0);
        },
        close: function() {
            this._disconnect(), this._clearTimeout(), this.connected = !1, this.addrUpdated = !1;
        },
        _connect: function() {
            var a = this;
            this.websocket = new WebSocket(this._uri()), this.websocket.binaryType = "arraybuffer", 
            this.websocket.onopen = function() {
                g.log("[peer:_connect] opened"), a.addrUpdated = !1, d.hideConnectingTip(), a._keepalive(), 
                a._load();
            }, this.websocket.onmessage = function(b) {
                if ("1" !== b.data) {
                    var e = d.json(b.data);
                    g.log("[peer:_connect] got message: ", e.type), e.type === c.response.peer.CONNECTED ? a._handle() : f.trigger(e.type, e);
                }
            }, this.websocket.onclose = function() {
                g.log("[peer:_connect] cloesed"), clearInterval(a.ALIVE_INTERVAL), e.connecting = !1, 
                a.connected = !1, a.addrUpdated ? (a.addrUpdated = !1, f.trigger(c.action.peer.RECONNECT), 
                d.showConnectingTip()) : e.inSession && d.dialog("reconnect", c.action.peer.RECONNECT);
            }, this.websocket.onerror = function() {
                clearInterval(a.ALIVE_INTERVAL);
            };
        },
        _disconnect: function() {
            this.websocket && this.websocket.close();
        },
        _handle: function() {
            var a = this;
            e.connecting = !1, this.connected = !0, f.trigger("open"), MX.each(e.request, function(b) {
                setTimeout(function() {
                    a._send(b);
                }, 500);
            }), e.request = [];
        },
        _load: function() {
            var a = this, b = function() {
                d.hasPlugin(e.cfg.plugin) ? (e.downloading = !1, clearTimeout(a.TIMEOUT.checking), 
                a._launch()) : (g.log("[peer:_load] Not found plugin, waiting until Moxtra Application Plugin installed"), 
                e.downloading || (g.log("[peer:_load] trigger download installer_file"), e.downloading = !0, 
                d.download(e.cfg.installer)), a.TIMEOUT.checking = setTimeout(function() {
                    g.warn("[peer:_load] No plugin found, so loop to load plugin every 1.5 seconds"), 
                    b();
                }, 1500));
            };
            this.connected || b();
        },
        _send: function(a) {
            this._connected() && this.websocket.send(d.string(a));
        },
        _uri: function() {
            this.addr = e.peer.server_addr, this.server = MX.format("wss://{0}/peer", this.addr);
            var a = MX.format("?session_id={0}&session_key={1}&session_token={2}&session_resource=web", b.sessionId, e.peer.conf_id, encodeURIComponent(e.peer.token));
            return this.server + a;
        },
        _connected: function() {
            return this.websocket && this.websocket.readyState === this.websocket.OPEN;
        },
        _keepalive: function() {
            var a = this;
            this.ALIVE_INTERVAL = setInterval(function() {
                g.log("sending keepalive..."), a._send("1");
            }, 15e3);
        },
        _launch: function() {
            var a = this;
            this._embed(), setTimeout(function() {
                a._start();
            }, 1500);
        },
        _start: function() {
            var a = this, f = function() {
                try {
                    g.log("[peer:_start] StartApplication params: ", [ b.domain, e.cfg.pkg, e.cfg.version, e.cfg.name, b.lang, e.peer.conf_id, b.sessionId, e.peer.token, a.server ].join(", "));
                    var h = a._plugin().StartApplication(b.domain, e.cfg.pkg, e.cfg.version, e.cfg.name, b.lang, e.peer.conf_id, b.sessionId, e.peer.token, a.server);
                    g.log("[peer:_start] StartApplication result: ", h), h || (g.error("[peer:_start] StartApplication result is failure, so show manual download dialog on UI"), 
                    d.dialog("refresh", c.action.peer.REFRESH));
                } catch (i) {
                    g.error("[peer:_start] StartApplication error: ", i), a.TIMEOUT.start = setTimeout(function() {
                        f(), g.error("[peer:_start] Loop to StartApplication every 1.5 seconds");
                    }, 1500);
                }
            };
            f();
        },
        _embed: function() {
            this._plugin() || $(b.target).html(b.element);
        },
        _plugin: function() {
            return document.getElementById(b.pluginId);
        },
        _clearTimeout: function() {
            g.log("[peer:_clearTimeout] clear all timeout");
            for (var a in this.TIMEOUT) clearTimeout(this.TIMEOUT[a]);
            clearInterval(this.ALIVE_INTERVAL);
        }
    }), h;
}), define("meet/connector/connector", [ "moxtra", "lang", "app", "meet/connector/type", "meet/connector/config", "meet/connector/util", "meet/connector/cache", "meet/connector/appPlugin", "meet/connector/extension", "meet/connector/peer" ], function(a, b, c, d, e, f, g, h, i, j) {
    function k(a) {
        var b = !1;
        try {
            (JSON.stringify(a).length - 26) % 256 === 0 && (b = !0);
        } catch (c) {
            b = !1;
        }
        return b && (a.normalized = 1), a;
    }
    var l = MX.logger("meet:connector"), m = function() {
        this.connection = null, g.inSession = !0;
    };
    return _.extend(m.prototype, {
        send: function(a) {
            l.log("[send] ", a), a = f.json(a), MX.env.isChrome && MX.env.browserVersion >= 42 && MX.env.isWin && (a = k(a)), 
            this.connection ? this.connection.send(a) : (g.request = a, this._create(a));
        },
        close: function() {
            l.logServer(f.logFormat("[close] try to close connection"), !0), g.inSession = !1, 
            this.connection && this.connection.close();
        },
        stopApplication: function() {
            this.connection && this.connection.stopApplication();
        },
        update: function() {
            f.hasFunction("update", this.connection) && this.connection.update();
        },
        _create: function(a) {
            f.needConnection(a.type) && this._load();
        },
        _load: function() {
            l.logServer(f.logFormat("[_load] start to load " + e.appcfg));
            var a = this;
            $.ajax({
                url: e.appcfg + "?" + Math.random(),
                type: "GET",
                dataType: "json",
                success: function(b) {
                    g.cfg = f.parse(b), a._router();
                },
                error: function(c) {
                    l.error("[_load] ajax: ", c), l.logServer(f.logFormat("[Show] Try_Again dialog (load config.json error) ")), 
                    new MX.ui.Dialog({
                        title: "",
                        width: 400,
                        content: b.system_unknown_error,
                        iframeShim: !0,
                        buttons: [ {
                            text: b.cancel,
                            className: "btn-default",
                            click: function() {
                                l.logServer(f.logFormat('[User Action] click "Cancel" ')), this.close();
                            }
                        }, {
                            text: b.try_again,
                            className: "btn-warning mx-branding-meet-dialog-btn",
                            click: function() {
                                l.logServer(f.logFormat('[User Action] click "Try Again" ')), this.close(), a._load();
                            }
                        } ]
                    });
                }
            });
        },
        _router: function() {
            this.connection || (MX.env.isIE ? (l.logServer(f.logFormat("[_router] browser use Active X")), 
            this.connection = new h()) : MX.env.isChrome && MX.env.browserVersion >= 42 ? (l.logServer(f.logFormat("[_router] browser use extension to connect to native")), 
            this.connection = new i()) : f.isNewPlugin(g.cfg.plugin) ? (l.logServer(f.logFormat("[_router] browser use Plugin")), 
            this.connection = new h()) : (l.logServer(f.logFormat("[_router] browser use Peer Server & Plugin")), 
            this.connection = new j()), this.connection.init());
        }
    }), m;
}), define("meet/audio/native", [ "moxtra", "meet/connector/type", "meet/connector/listener", "meet/connector/util" ], function(a, b, c, d) {
    var e = MX.logger("meet:ac:native"), f = function(a) {
        this.controller = a.controller, this.model = a.model, this.REGISTERED = !1, this.model.setWebrtc(!1);
    };
    return f.prototype = {
        join: function(a) {
            this.REGISTERED || (c.on(b.response.ac.JOINED, this._joinedSession, this), c.on(b.response.ac.MUTED, this._mutedSession, this), 
            c.on(b.response.ac.UNMUTED, this._unmutedSession, this), c.on(b.response.ac.LEFT, this._leftSession, this), 
            c.on(b.response.ac.SPEAKER, this._setSpeaker, this), c.on(b.response.ac.NETWORK, this._setNetwork, this), 
            c.on(b.response.ac.CONNECTING, this._showConnecting, this), c.on(b.response.ac.DEVICELEVEL, this._updateDeviceLevel, this), 
            c.on(b.response.ac.MIC_STATUS, this._micStatus, this), this.REGISTERED = !0), a ? this.controller.handle("ac:join_native", {
                type: a
            }) : this.controller.handle("ac:join_native");
        },
        mute: function() {
            this.controller.handle("ac:mute_native");
        },
        unmute: function() {
            this.controller.handle("ac:unmute_native");
        },
        leave: function() {
            this.controller.handle("ac:leave_native");
        },
        config: function() {
            this.controller.handle("ac:config_native");
        },
        close: function() {},
        _joinedSession: function(a) {
            0 === a.code && (this.model.setActionDone(), this.model.setEnabled(!0), this.model.setNativeConnected(), 
            a.action && a.action.ac_conf && a.action.ac_conf.ssrc && this.model.setSSRC(a.action.ac_conf.ssrc), 
            this.controller.handle("publish:ac_joined"), e.logServer(d.logFormat("[Hide] connecting tip of audio native")), 
            d.hideConnectingTip());
        },
        _mutedSession: function(a) {
            0 === a.code && (this.model.setMuted(!0), this.model.setMutedDone(), this.model.setActionDone(), 
            this.controller.handle("publish:ac_muted"));
        },
        _unmutedSession: function(a) {
            0 === a.code && (this.model.setMuted(!1), this.model.setActionDone(), this.controller.handle("publish:ac_unmuted"));
        },
        _leftSession: function(a) {
            0 === a.code && (this.model.setEnabled(!1), this.model.setActionDone(), this.model.setLeft(!0), 
            this.controller.handle("publish:ac_left"));
        },
        _setSpeaker: function(a) {
            0 === a.code && a.action && a.action.ac_conf && a.action.ac_conf.speakers && this.model.setSpeakers(a.action.ac_conf.speakers);
        },
        _setNetwork: function(a) {
            0 === a.code && a.action && a.action.ac_conf && a.action.ac_conf.rosters && this.model.setNetworks(a.action.ac_conf.rosters);
        },
        _showConnecting: function() {
            e.logServer(d.logFormat("[Show] connecting tip of audio native")), d.showConnectingTip(), 
            this.model.setNativeConnecting();
        },
        _updateDeviceLevel: function(a) {
            0 === a.code && a.action && a.action.ac_conf && this.model.setDeviceLevel({
                speaker: MX.isUndefined(a.action.ac_conf.speaker) ? 200 : a.action.ac_conf.speaker,
                microphone: MX.isUndefined(a.action.ac_conf.microphone) ? 200 : a.action.ac_conf.microphone
            });
        },
        _micStatus: function(a) {
            0 === a.code && a.action && a.action.ac_conf && this.model.setMicStatus(a.action.ac_conf.status);
        }
    }, f;
}), define("meet/audio/webrtcBiz", [ "moxtra" ], function() {
    function a(a) {
        function c(b) {
            a.onIceConnectionStateChange && a.onIceConnectionStateChange(b.currentTarget.iceConnectionState);
        }
        function d(c) {
            if (c.candidate && g) {
                a.onICE && a.onICE(c.candidate);
                var d = new k(c.candidate);
                b.log("onicecandidate", d), g.addIceCandidate(d);
            }
        }
        function e(c) {
            b.log("Added remote stream"), g && a.onRemoteStreamAdded && a.onRemoteStreamAdded(c.stream);
        }
        function f(c) {
            b.log("Removed remote stream"), g && a.onRemoteStreamRemoved && a.onRemoteStreamRemoved(c.stream);
        }
        b.log("new RTCPeerConnection..."), a = a || {};
        var g, h = window, i = h.mozRTCPeerConnection || h.webkitRTCPeerConnection || h.RTCPeerConnection, j = h.mozRTCSessionDescription || h.RTCSessionDescription, k = h.mozRTCIceCandidate || h.RTCIceCandidate, l = {
            iceServers: []
        }, m = a.constraints || {
            optional: [],
            mandatory: {
                OfferToReceiveAudio: !0,
                OfferToReceiveVideo: !1
            }
        };
        if (MX.env.isChrome && MX.env.browserVersion >= 35) {
            var n = {
                optional: [ {
                    DtlsSrtpKeyAgreement: !1
                } ]
            };
            g = new i(l, n);
        } else g = new i(l);
        return g.onicecandidate = d, g.onaddstream = e, g.onremovestream = f, g.onnegotiationneeded = function(a) {
            b.log("onnegotiationneeded", a);
        }, g.onsignalingstatechange = function(a) {
            b.log("onsignalingstatechange", a);
        }, g.oniceconnectionstatechange = c, {
            addAnswerSDP: function(a) {
                a = new j(a), b.log("sdp in answer", a), g && g.setRemoteDescription(a, function() {
                    b.log("set remote sdp ok");
                }, function(a) {
                    b.error("set remote sdp failed", a);
                });
            },
            addICE: function(a) {
                g && g.addIceCandidate(new k({
                    sdpMLineIndex: a.sdpMLineIndex,
                    candidate: a.candidate
                }));
            },
            createOffer: function(a) {
                g && g.createOffer(function(c) {
                    g.setLocalDescription(c), b.log("created offer ok, execute callback now..."), b.log("sdp in offer", c), 
                    a && a(c);
                }, function(a) {
                    b.error("create offer failed", a);
                }, m);
            },
            peerConn: g,
            close: function() {
                g && g.close(), g = null;
            },
            startVideo: function(a) {
                function c(b) {
                    g && g.addStream(b), a && a.success && a.success(b);
                }
                function d(c) {
                    b.error("webrtc start video", c), a && a.error && a.error(c);
                }
                navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;
                var e;
                try {
                    e ? navigator.getUserMedia({
                        audio: e,
                        video: !1
                    }, c, d) : navigator.getUserMedia({
                        audio: !0,
                        video: !1
                    }, c, d);
                } catch (f) {
                    console.error(f), navigator.getUserMedia("video,audio", c, d);
                }
            }
        };
    }
    var b = MX.logger("meet:ac:webrtc");
    return a;
}), define("meet/audio/webrtc", [ "moxtra", "lang", "meet/audio/webrtcBiz", "meet/connector/type", "meet/connector/cache", "meet/connector/util", "meet/connector/listener" ], function(a, b, c, d, e, f, g) {
    var h = MX.logger("meet:ac:webrtc"), i = function(a) {
        this.controller = a.controller, this.model = a.model, this.model.setWebrtc(!0), 
        this.MAX_PC_NUMBER = 5, this.pcList = [], this.local_offers = [], this.localStream = "", 
        this.STATE = {
            STARTING: 0,
            CHECKING: 1,
            CONNECTED: 2,
            DISCONNECTED: 3,
            FAILED: 4,
            CLOSED: 5
        }, this._states = [ 0, 0, 0, 0, 0 ], this._connected = !1, this._connected_times = 0, 
        this._reconnecting = !1, this._reconnect_times = 0, this.TIMEOUT = {}, this.RETRY_MAX = 3, 
        this._retry_times = 0, this.WAITING_TIME = 5e3, this.TIMEOUT_TIMER = null, this.REGISTERED = !1;
    };
    return i.prototype = {
        join: function() {
            var a = this;
            this.REGISTERED || (g.on(d.response.ac.MUTED, this._mutedSession, this), g.on(d.response.ac.UNMUTED, this._unmutedSession, this), 
            g.on(d.action.audio.CHECK, function() {
                a.model.get("isEnabled") && a._switchToNative(!0);
            }), this.REGISTERED = !0), this._reconnecting = !1, h.logServer(f.logFormat("[join] start to join audio")), 
            this._connect(), e.permissionTipWebrtc = !1, this.TIMEOUT.jointip = setTimeout(function() {
                e.permissionTipWebrtc || (e.permissionTipWebrtc = !0, f.showPermissionTip("webrtc"));
            }, 5e3);
        },
        mute: function(a) {
            if (a = a || {}, this.localStream) {
                h.logServer(f.logFormat("[mute] start to mute audio"));
                for (var b = this.localStream.getAudioTracks ? this.localStream.getAudioTracks() : this.localStream.audioTracks, c = 0, d = b.length; d > c; c++) b[c].enabled = !1;
                this.model.setMuted(!0), this.model.setMutedDone(), this.model.setActionDone(), 
                a.notifyOff || this.controller.handle("notify:ac_muted"), a.publishOff || this.controller.handle("publish:ac_muted");
            }
        },
        unmute: function(a) {
            if (a = a || {}, this.localStream && !$("#unmute").hasClass("disabled")) {
                h.logServer(f.logFormat("[unmute] start to unmute audio"));
                for (var b = this.localStream.getAudioTracks ? this.localStream.getAudioTracks() : this.localStream.audioTracks, c = 0, d = b.length; d > c; c++) b[c].enabled = !0;
                this.model.setMuted(!1), this.model.setActionDone(), a.notifyOff || this.controller.handle("notify:ac_unmuted"), 
                a.publishOff || this.controller.handle("publish:ac_unmuted");
            }
        },
        leave: function() {
            h.logServer(f.logFormat("[leave] start to leave audio")), g.off(d.action.audio.CHECK), 
            this._reconnecting = !1, this._clearStreams(), this.model.setEnabled(!1), this.model.setActionDone(), 
            this.model.setLeft(!0), this.controller.handle("notify:ac_left"), this.controller.handle("publish:ac_left");
        },
        _connect: function() {
            h.logServer(f.logFormat("[Show] connecting tip of audio webrtc")), f.showConnectingTip(), 
            h.logServer(f.logFormat("[_connect] start to create connection"));
            var a, b = this;
            a = new c({
                is_local_stream: !0,
                onIceConnectionStateChange: function(a) {
                    h.logServer(f.logFormat("[_connect] state: " + a)), b._setState(0, a);
                }
            }), this.pcList[0] = a, a.startVideo({
                success: function(c) {
                    h.logServer(f.logFormat("[_connect] start local stream ok")), b.localStream = c, 
                    clearTimeout(b.TIMEOUT.jointip), f.hidePermissionTip();
                    var d = document.getElementById("sourcevid");
                    void 0 !== d.mozSrcObject ? d.mozSrcObject = c : d.src = window.URL && window.URL.createObjectURL(c) || c, 
                    a.createOffer(function(a) {
                        h.logServer(f.logFormat("[_connect] create offer ok for pc 0"));
                        try {
                            var c = parseInt(a.sdp.match(/a=ssrc:\d+/gi)[0].split(":")[1]);
                            b.model.setSSRC(c);
                        } catch (d) {
                            h.errorServer(f.logFormat(d));
                        }
                        b.local_offers.push(a), b._checkLocalOffer(), b._createOtherPCs();
                    });
                },
                error: function() {}
            });
        },
        _checkLocalOffer: function() {
            this.local_offers.length === this.MAX_PC_NUMBER && this._sendMessage();
        },
        _createOtherPCs: function() {
            for (var a = 1; a < this.MAX_PC_NUMBER; a++) this._createPeerConnection(a);
        },
        _createPeerConnection: function(a) {
            h.logServer(f.logFormat("[_createPeerConnection] createPeerConnection " + a));
            var b, d = this;
            b = new c({
                onRemoteStreamAdded: function(b) {
                    h.logServer(f.logFormat("[_createPeerConnection] on remote stream added - view " + a)), 
                    document.getElementById("remotevid" + a).src = window.webkitURL.createObjectURL(b);
                },
                onRemoteStreamRemoved: function() {
                    h.logServer(f.logFormat("[_createPeerConnection] on remote stream removed - view " + a)), 
                    document.getElementById("remotevid" + a).src = "";
                },
                onIceConnectionStateChange: function(b) {
                    h.logServer(f.logFormat("[_createPeerConnection] state " + b)), d._setState(a, b);
                }
            }), d.pcList[a] = b, b.createOffer(function(b) {
                h.logServer(f.logFormat("[_createPeerConnection] create offer ok for pc " + a)), 
                d.local_offers.push(b), d._checkLocalOffer();
            });
        },
        _sendMessage: function() {
            h.logServer(f.logFormat("[_sendMessage] send offer to server for answers"));
            for (var a = this, b = [], c = 0; c < this.MAX_PC_NUMBER; c++) b.push({
                channel_id: c,
                webrtc_offer: this.local_offers[c].sdp
            });
            var d = {
                type: "SESSION_REQUEST_WEBRTC_OFFER",
                action: {
                    session_key: this._getAudioConf().conf_id,
                    user_roster: [ {
                        audio_status: {
                            channels: b
                        }
                    } ]
                }
            };
            $.ajax({
                url: "/board?sessionid=" + Moxtra.getMe().sessionId,
                data: JSON.stringify(d),
                global: !1,
                type: "POST",
                dataType: "json",
                timeout: 6e4,
                contentType: "application/json; charset=UTF-8",
                success: function(b) {
                    h.log(b), h.logServer(f.logFormat("got answers from server, then set remote sdp and icecandidate"));
                    var c, d = b.action.user_roster[0].audio_status.channels;
                    for (c = 0; c < d.length; c++) a.pcList[d[c].channel_id].addAnswerSDP({
                        sdp: d[c].webrtc_answer,
                        type: "answer"
                    });
                    for (c = 0; c < d.length; c++) a.pcList[c].addICE({
                        sdpMLineIndex: 0,
                        candidate: a._getCandidate()
                    });
                    0 == a._connected_times && (a.TIMEOUT_TIMER = setTimeout(function() {
                        a._timer();
                    }, a.WAITING_TIME));
                },
                error: function(a) {
                    h.errorServer(f.logFormat(a));
                }
            });
        },
        _clearStreams: function() {
            h.log("clear streams", this.pcList), h.logServer(f.logFormat("clear streams")), 
            _.each(this.pcList, function(a) {
                a.close(), a = null;
            }), this.pcList = [], this.local_offers = [];
            try {
                this.localStream && this.localStream.stop(), this.localStream = null, document.getElementById("sourcevid").src = "";
                for (var a = 1; a < this.MAX_PC_NUMBER; a++) document.getElementById("remotevid" + a).src = "";
            } catch (b) {
                h.errorServer(f.logFormat(b));
            }
        },
        _getAudioConf: function() {
            return this.model.getAudioConf();
        },
        _getCandidate: function() {
            var a = this._getAudioConf();
            return "a=candidate:2305546779 1 udp 2113937151 " + a.server_addr + " " + a.port + " typ host generation 0\r\n";
        },
        _setState: function(a, b) {
            switch (h.logServer(f.logFormat("[_setState] index: " + a + " state: " + b)), b) {
              case "starting":
                this._states[a] = this.STATE.STARTING;
                break;

              case "checking":
                this._states[a] = this.STATE.CHECKING;
                break;

              case "connected":
              case "completed":
                this._states[a] = this.STATE.CONNECTED;
                break;

              case "disconnected":
                this._states[a] = this.STATE.DISCONNECTED;
                break;

              case "failed":
                this._states[a] = this.STATE.FAILED;
                break;

              case "closed":
                this._states[a] = this.STATE.CLOSED;
            }
            this._checkState();
        },
        _checkState: function() {
            var a = parseInt(this._states.join(""), 10);
            if (a >= 0 && 11111 > a ? h.logServer(f.logFormat("[_checkState] starting")) : 11111 === a ? h.logServer(f.logFormat("[_checkState] checking")) : a > 11111 && 22222 > a ? h.logServer(f.logFormat("[_checkState] some channels connected but others not")) : 22222 === a ? (h.logServer(f.logFormat("[_checkState] all channels connected")), 
            clearTimeout(this.TIMEOUT_TIMER), h.logServer(f.logFormat("[Hide] connecting tip of audio webrtc")), 
            f.hideConnectingTip(), this._connected = !0, this._connected_times++, this._reconnecting = !1, 
            this._reconnectUI(!1), this.model.setEnabled(!0), this.model.setActionDone(), this.model.get("isMuted") ? this.mute({
                notifyOff: !0,
                publishOff: !0
            }) : this.unmute({
                notifyOff: !0,
                publishOff: !0
            }), this.controller.handle("notify:ac_joined")) : a > 22222 && 33333 >= a ? (h.logServer(f.logFormat("[_checkState] channel(s) disconnected, need reconnect")), 
            this._reconnecting || this._reconnectAll()) : a > 33333 && 44444 > a || (44444 === a ? (h.logServer(f.logFormat("[_checkState] All 5 channels failed, switch to Native")), 
            this._switchToNative()) : a > 44444 && 55555 > a ? h.logServer(f.logFormat("[_checkState] some channels closed!")) : 55555 === a && h.logServer(f.logFormat("[_checkState] All 5 channels closed!"))), 
            5555 === parseInt(this._states.slice(1, 5).join(""), 10) && this._connected_times > 0) {
                var b = this;
                this._clearAllTimeout(), this.TIMEOUT.reconnectAsClosed = setTimeout(function() {
                    !b._isMeetEnd() && b._reconnecting && (h.logServer(f.logFormat("[_checkState] channel(s) closed and meet not end, need reconnect")), 
                    b._reconnectAll());
                }, 2e3);
            }
        },
        _reconnectAll: function() {
            this._connected = !1, this._reconnectUI(), this._reconnecting = !0, this._states = [ 0, 0, 0, 0, 0 ], 
            this._clearStreams(), this._connect();
        },
        _reconnectUI: function(a) {
            var b = this;
            if (void 0 === a || a) {
                this.model.setReconnecting(!0);
                var c = function() {
                    return b._isMeetEnd() ? void clearTimeout(b.TIMEOUT.reconnectUI) : (b._reconnect_times++, 
                    b._reconnect_times % 5 === 0 && h.logServer(f.logFormat("[_reconnectUI] reconnect because of bad net work")), 
                    h.logServer(f.logFormat("[_reconnectUI] reconnect times: " + b._reconnect_times)), 
                    b._reconnect_times > 60 ? (clearTimeout(b.TIMEOUT.reconnectUI), h.logServer(f.logFormat("[_reconnectUI] your network disconnected")), 
                    void b.model.setReconnectTimeout(!0)) : void (b.TIMEOUT.reconnectUI = setTimeout(c, 1e3)));
                };
                return void c();
            }
            return a ? void 0 : (this._reconnect_times = 0, b.model.setReconnected(!0), void clearTimeout(this.TIMEOUT.reconnectUI));
        },
        _timer: function() {
            var a = this._states.join(""), b = this.STATE.CONNECTED + "";
            a.indexOf(b) > -1 ? this._retry_times < this.RETRY_MAX ? (this._retry_times++, h.logServer(f.logFormat("[_timer] some channel connected, some not, try: " + this._retry_times)), 
            this._reconnectAll()) : (h.logServer(f.logFormat("[_timer] some channel connected, some not, tried 3 times, still can not all connected, switch to Native")), 
            this._switchToNative()) : (h.logServer(f.logFormat("[_timer] none of 5 channels connected, switch to Native")), 
            this._switchToNative());
        },
        _switchToNative: function(a) {
            if (!this._isMeetEnd()) {
                var b = {};
                a || (b.type = "tcp"), this.controller.handle("ac:switch_to_native", b);
            }
        },
        _isMeetEnd: function() {
            return location.href.indexOf("meet/") > 0 || location.href.indexOf("note/") > 0 ? !1 : (this.close(), 
            !0);
        },
        _clearAllTimeout: function() {
            for (var a in this.TIMEOUT) clearTimeout(this.TIMEOUT[a]);
        },
        _mutedSession: function(a) {
            0 === a.code && this.mute();
        },
        _unmutedSession: function(a) {
            0 === a.code && this.unmute();
        },
        close: function() {
            h.logServer(f.logFormat("[close] close audio")), this._connected = !1, this._connected_times = 0, 
            this._retry_times = 0, clearTimeout(this.TIMEOUT_TIMER), this._clearAllTimeout(), 
            this._clearStreams();
        }
    }, i;
}), define("meet/audio/ac", [ "moxtra", "lang", "app", "meet/audio/native", "meet/audio/webrtc" ], function(a, b, c, d) {
    var e = MX.logger("meet:ac"), f = function(a) {
        this.controller = a, this.model = a.audioModel, this.audio = null;
    };
    return f.prototype = {
        join: function(a) {
            a = a || {}, this._match(a.forceNative), this.audio && this.audio.join(a.type);
        },
        mute: function(a) {
            a = a || {}, this.audio && this.audio.mute(a);
        },
        unmute: function() {
            this.audio && this.audio.unmute();
        },
        leave: function() {
            this.audio && this.audio.leave();
        },
        config: function() {
            this.audio && this.audio.config();
        },
        switchToNative: function(a) {
            a = a || {}, this.audio && (this.audio.leave(), this.audio = null), this.join({
                type: a.type || a.tcp || null,
                forceNative: !0
            });
        },
        _match: function() {
            this.audio && this.audio.close(), this.audio = new d(this);
        },
        close: function() {
            e.log("[AudioConference] close, cleanup..."), this.audio && (this.audio.close(), 
            this.audio = null);
        },
        _hasInstalledPlugin: function() {
            var a = navigator.plugins, b = !1, c = "Moxtra Application Plugin";
            navigator.plugins.refresh(!1);
            for (var d in a) if (a[d] && a[d].name && a[d].name.indexOf(c) >= 0) {
                b = !0;
                break;
            }
            return b;
        },
        _isWebrtcSupported: function() {
            return (navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia) && (window.RTCPeerConnection || window.webkitRTCPeerConnection || window.mozRTCPeerConnection);
        }
    }, f;
}), define("meet/video/native", [ "moxtra", "meet/connector/type", "meet/connector/listener", "meet/connector/util" ], function(a, b, c, d) {
    var e = function(a) {
        this.controller = a.controller, this.model = a.model, this.REGISTERED = !1;
    }, f = MX.logger("meet:av:native");
    return e.prototype = {
        join: function(a) {
            this.REGISTERED || (c.on(b.response.av.JOINED, this._joinedVideo, this), c.on(b.response.av.LEFT, this._leftVideo, this), 
            c.on(b.response.av.BROADCASTED, this._broadcastedVideo, this), c.on(b.response.av.UNBROADCASTED, this._unbroadcastedVideo, this), 
            c.on(b.response.av.CONNECTING, this._showConnecting, this), this.REGISTERED = !0), 
            this.controller.handle("av:join_native", {
                broadcast: a
            });
        },
        leave: function(a) {
            this.controller.handle("av:leave_native", {
                broadcast: a
            });
        },
        layout: function(a) {
            this.controller.handle("av:layout_native", {
                layout: a
            });
        },
        close: function() {},
        _joinedVideo: function(a) {
            0 === a.code && (this.model.setJoined(!0), a.action && a.action.av_conf && this.model.setBroadcast(a.action.av_conf.broadcasted), 
            this.controller.handle("publish:av_status"), f.logServer(d.logFormat("[Hide] connecting tip of video native")), 
            d.hideConnectingTip());
        },
        _leftVideo: function(a) {
            0 === a.code && (this.model.setJoined(!1), this.controller.handle("publish:av_status"));
        },
        _broadcastedVideo: function() {
            this.model.setBroadcast(!0), this.controller.handle("publish:av_status");
        },
        _unbroadcastedVideo: function() {
            this.model.setBroadcast(!1), this.controller.handle("publish:av_status");
        },
        _updatedStatus: function(a) {
            0 === a.code;
        },
        _showConnecting: function() {
            f.logServer(d.logFormat("[Show] connecting tip of video native")), d.showConnectingTip();
        }
    }, e;
}), define("meet/video/av", [ "moxtra", "lang", "app", "meet/video/native" ], function(a, b, c, d) {
    var e = function(a) {
        this.controller = a, this.model = a.videoModel, this.video = null;
    };
    return e.prototype = {
        join: function(a) {
            this._match(), this.video && this.video.join(a);
        },
        leave: function(a) {
            this.video && this.video.leave(a);
        },
        layout: function(a) {
            this.video && this.video.layout(a);
        },
        close: function() {
            this.video && (this.video.close(), this.video = null);
        },
        _match: function() {
            this.video || (this.video = new d(this));
        }
    }, e;
}), define("meet/ds/presenter", [ "moxtra", "lang", "meet/connector/type", "meet/connector/listener", "meet/connector/util" ], function(a, b, c, d, e) {
    var f = MX.logger("meet:ds:presenter");
    return {
        init: function(a) {
            this.parent = a, this.model = a.model, this.controller = a.controller, this.sequence = this.model.getSequence() || 0, 
            this._isStarted = !1;
        },
        open: function() {
            this._isStarted || (d.on(c.response.ds.STARTED, this._started, this), d.on(c.response.ds.STOPPED, this._stopped, this), 
            d.on(c.response.ds.CONNECTING, this._showConnecting, this), f.log("start ds with sequence: ", this.sequence), 
            this.sequence && this.controller.handle("ds:start_presenter", {
                sequence: this.sequence
            }));
        },
        close: function() {
            f.log("dspresenter close"), this._isStarted && (this._isStarted = !1, this.controller.handle("ds:stop_presenter", {
                sequence: this.sequence
            }), f.logServer(e.logFormat("[Hide] connecting tip of ds presenter close")), e.hideConnectingTip());
        },
        _started: function(a) {
            0 === a.code && (this._isStarted = !0, this.model.setPresenterStarted(!0), this.controller.handle("publish:ds_started", {
                sequence: this.sequence
            }), f.logServer(e.logFormat("[Hide] connecting tip of ds presenter started")), e.hideConnectingTip());
        },
        _stopped: function(a) {
            0 === a.code && (this._isStarted = !1, this.model.setPresenterStopped(!0), d.off(c.response.ds.STARTED), 
            d.off(c.response.ds.STOPPED), this.controller.handle("publish:ds_stopped", {
                sequence: this.sequence
            }), f.logServer(e.logFormat("[Hide] connecting tip of ds presenter stopped")), e.hideConnectingTip());
        },
        _showConnecting: function() {
            f.logServer(e.logFormat("[Show] connecting tip of ds presenter")), e.showConnectingTip();
        }
    };
}), define("meet/ds/attendee", [ "moxtra", "lang", "app", "uuid", "ProtoBuf", "meet/connector/type", "meet/connector/cache", "meet/connector/listener", "meet/connector/util" ], function(a, b, c, d, e, f, g, h, i) {
    var j = MX.logger("meet:ds:attendee"), k = {
        STARTED: "DS_STARTED",
        PAUSED: "DS_PAUSED",
        RESUMED: "DS_RESUMED",
        STOPPED: "DS_STOPPED"
    }, l = function(a) {
        a = a || {}, this.model = a.model, this._viewer = $("#attendeeviewer" + this.model.getSequence()), 
        this._status = "", this._reconnect_times = 0, this._binary = a.binary, this._ds_id = a.ds_id, 
        this._ds_conf = a.ds_conf, this._session_key = a.session_key || g.meetId, this._session_id = a.session_id, 
        this._presenterRosterId = a.presenterRosterId, this.readyState = WebSocket.CLOSED, 
        this.forceClose = !1, this._uri = [ "wss://", this._ds_conf.server_addr, ":", this._ds_conf.port || 443, "/ds?session_id=", this._session_id, "&session_key=", this._session_key, "&session_token=", encodeURIComponent(this._ds_conf.token), "&protobuf=1&rnd=" ].join(""), 
        this.dsMouse = {}, this.ds_data = {}, this.ds_data.blocks_array = [], this.ds_data.monitors = {}, 
        this.ds_data.monitors_coord = [], this.TIMEOUT = {}, this.TYPE = {
            KEEPALIVE: "DS_DATA_KEEPALIVE",
            COMMAND: "DS_DATA_COMMAND",
            JOIN: "DS_DATA_JOIN",
            SUCCESS: "DS_CODE_SUCCESS",
            STOP: "DS_DATA_STOP",
            LEAVE: "DS_DATA_LEAVE",
            GET_CACHES: "DS_DATA_GET_CACHES",
            GET_KEYFRAME: "DS_DATA_GET_KEYFRAME",
            DISCONNECT: "DS_DATA_SERVER_DISCONNECT"
        }, this.IMAGE_HEADER = {
            DS_CACHE_JPEG: "data:image/jpeg;base64,",
            DS_CACHE_GIF: "data:image/gif;base64,",
            DS_CACHE_PNG: "data:image/png;base64,"
        }, this.DS_COMMAND_TYPE = {
            DS_COMMAND_TYPE_NONE: 0,
            DS_COMMAND_TYPE_REQUEST_CONTROL: 1,
            DS_COMMAND_TYPE_REMOTE_CONTROLLING: 2,
            DS_COMMAND_TYPE_GIVEUP_CONTROL: 3,
            DS_COMMAND_TYPE_REQUEST_ANNOTATION: 10,
            DS_COMMAND_TYPE_GIVEUP_ANNOTATION: 11
        }, this.MOUSE_EVENT_TYPE = {
            DS_MOUSEMOVE: 1,
            DS_MOUSEWHEEL: 2,
            DS_LBUTTONCLICK: 3,
            DS_LBUTTONDBLCLK: 4,
            DS_LBUTTONDOWN: 5,
            DS_LBUTTONUP: 6,
            DS_MBUTTONDBLCLK: 6,
            DS_MBUTTONDOWN: 7,
            DS_MBUTTONUP: 8
        }, this.DS_COMMAND_ANSWER = {
            DS_COMMAND_ANSWER_NONE: 0,
            DS_COMMAND_ANSWER_DENIED: 1,
            DS_COMMAND_ANSWER_ACCEPTED: 2
        };
    };
    l.prototype = {
        start: function() {
            if (j.logServer(i.logFormat("Attendee.start func")), c.isForceViewSharingInNative()) return j.logServer(i.logFormat("Attendee.start force to use native")), 
            void this._switchToNative();
            if (this.readyState === WebSocket.OPEN || this.readyState === WebSocket.CONNECTING) {
                var a = "Attendee.start, but websocket is {0}, just return (do nothing)";
                return a = this.readyState === WebSocket.OPEN ? MX.format(a, "OPEN") : MX.format(a, "CONNECTING"), 
                void j.logServer(i.logFormat(a));
            }
            return g.attendeeWebsocket || "base64" !== g.attendeeConnection ? void (void 0 === window.WebSocket ? (j.logServer(i.logFormat("Attendee.start, but websocket not supported, need switch to Native (application)")), 
            this._switchToNative()) : (j.logServer(i.logFormat("Attendee.start, try to new Websocket")), 
            this.model.setAttendeeLoad(!0), this._connect())) : (j.logServer(i.logFormat("Attendee.start, but websocket issue, need switch to Native (application)")), 
            void this._switchToNative());
        },
        _switchToNative: function() {
            return this.readyState = WebSocket.CLOSED, MX.env.isEdge ? void MX.ui.notifyWarning(b.edge_browser_not_supported) : (g.attendeeConnection = "base64", 
            g.base64[f.base64.ds.ATTENDEE] = {
                callback: function(a) {
                    this._onMessage(this._binary.getData(a, "base64"));
                },
                context: this
            }, void h.trigger(f.action.attendee.NATIVE));
        },
        _connect: function() {
            var a = this._uri + Math.random(), b = this;
            j.logServer(i.logFormat("[_connect] ds_id: " + this._ds_id + " new WebSocket: " + a)), 
            clearInterval(b._keepAliveInterval), clearTimeout(b.TIMEOUT.reconnect), this.readyState = WebSocket.CONNECTING, 
            b.websocket = new WebSocket(a), b.websocket.binaryType = "arraybuffer", b.websocket.onopen = function() {
                j.logServer(i.logFormat("websocket onopen event")), j.log("onopen"), b.readyState = WebSocket.OPEN, 
                g.attendeeWebsocket = !0, b._reconnect_times = 0, b.model.setAttendeeReconnect(!1), 
                clearTimeout(b.TIMEOUT.reconnect), b._keepAlive(), b._join();
            }, b.websocket.onerror = function(a) {
                j.log("onerror"), j.log(a), j.logServer(i.logFormat("websocket onerror event"));
            }, b.websocket.onclose = function() {
                j.log("onclose"), j.logServer(i.logFormat("websocket onclose event")), j.logServer(i.logFormat("that.forceClose=" + b.forceClose)), 
                j.log(b._status), b.websocket = null, b.model.setAttendeeStarted(!1), g.attendeeWebsocket ? b.forceClose ? (j.logServer(i.logFormat("Force to close, no reconnect again.")), 
                b.readyState = WebSocket.CLOSED) : (j.log("still use websocket try to reconnect after 3s."), 
                b.readyState = WebSocket.CONNECTING, b.TIMEOUT.reconnect = setTimeout(function() {
                    (b._status === k.STARTED || b._status === k.PAUSED) && (b._reconnect_times++, b.model.setAttendeeReconnect(!0), 
                    b._reconnect_times % 4 === 0 && (b.model.setAttendeeReconnect(!1), b.model.setAttendeeTimeout(b._reconnect_times)), 
                    j.logServer(i.logFormat("websocket closed, but current status: " + b._status + ", so attendee view reconnect after 3s.")), 
                    b._connect());
                }, 3e3)) : (j.log("use native way"), setTimeout(function() {
                    (b._status === k.STARTED || b._status === k.PAUSED) && (j.logServer(i.logFormat("Use native way as first try websocket failed.")), 
                    b._switchToNative());
                }, 1500));
            }, b.websocket.onmessage = function(a) {
                b._onMessage(b._binary.getData(a));
            };
        },
        sendRemoteControlRequest: function() {
            var a = {
                type: this.TYPE.COMMAND,
                sequence: d.v1(),
                command: {
                    type: this.DS_COMMAND_TYPE.DS_COMMAND_TYPE_REQUEST_CONTROL,
                    src_roster_id: this._session_id,
                    dst_roster_id: this.presenterRosterId
                }
            };
            this._send(a);
        },
        setStatus: function(a) {
            j.log("dsattendee->set status ", a), this._status = a;
        },
        close: function(a) {
            clearInterval(this._keepAliveInterval), a && (clearTimeout(this.TIMEOUT.reconnect), 
            this._status = "", this.forceClose = !0, this.model.setAttendeeStarted(!1)), this.websocket && (this.websocket.close(), 
            this.websocket = null);
        },
        _keepAlive: function() {
            var a = this;
            this._keepAliveInterval = setInterval(function() {
                j.log("sending keepalive..."), a._send({
                    type: a.TYPE.KEEPALIVE
                });
            }, 15e3);
        },
        _join: function() {
            this._send({
                type: this.TYPE.JOIN,
                sequence: d.v1(),
                ds_id: this._ds_id
            });
        },
        _send: function(a) {
            "base64" === g.attendeeConnection ? (j.log("send request to ds server through native:", a), 
            h.trigger(f.action.attendee.SEND, a)) : this.websocket && this.websocket.readyState === WebSocket.OPEN && ("string" != typeof a && (a = JSON.stringify(a)), 
            j.log("send request to ds server:", a), this.websocket.send(a));
        },
        _onMessage: function(a) {
            var b = !1;
            switch (a.code = this._binary.getString("code", a.code), a.type = this._binary.getString("type", a.type), 
            a.type) {
              case this.TYPE.JOIN:
                this.isFirstScreenShown = !1, j.logServer(i.logFormat("[attendee _onMessage] DS_DATA_JOIN")), 
                a.code === this.TYPE.SUCCESS ? this.ds_data.caches = new Array(5e3) : j.logServer(i.logFormat("[attendee _onMessage] DS_DATA_JOIN failed, data.code=" + a.code));
                break;

              case this.TYPE.STOP:
                this._clearCanvas();

              case this.TYPE.LEAVE:
              case this.TYPE.DISCONNECT:
                j.logServer(i.logFormat("[attendee _onMessage] " + a.type)), this.close(!0);
                break;

              case this.TYPE.KEEPALIVE:
                j.log("connection alive...");
            }
            a.sharing_info && (j.logServer(i.logFormat("[attendee _onMessage] got sharing_info")), 
            this._setSharingInfo(a.sharing_info)), a.caches && (this._log("_onMessageAttendee::caches " + a.caches.length), 
            this._setCaches(a.caches), a.caches.length > 0 && a.type === this.TYPE.GET_CACHES && (b = !0)), 
            a.mouse_info && (this._log("_onMessageAttendee::mouse_info"), this._setMouseInfo(a.mouse_info)), 
            a.blocks && (this._log("_onMessageAttendee::blocks " + a.blocks.length), 1 == a.blocks.length && 0 == this._parseBlock(a.blocks[0]).position ? j.log("-------> mouse block") : a.blocks.length > 0 && a.type !== this.TYPE.GET_CACHES && (this._setBlocks(a.blocks), 
            b = !0), a.type === this.TYPE.GET_KEYFRAME && (j.logServer(i.logFormat("[attendee _onMessage] got keyframe")), 
            this.model.setAttendeeStarted(!0))), b && (this.isFirstScreenShown || (this.isFirstScreenShown = !0, 
            j.logServer(i.logFormat("[attendee _onMessage] ready to show screen"))), this._showScreen()), 
            a.command && (this._print("_onMessageAttendee::command"), this._setCommand(a.command)), 
            this._log("--------------------------------------");
        },
        _setSharingInfo: function(a) {
            if (this.model.setAttendeeConnected(!0), a.monitors && (!a.monitors || a.monitors[0])) {
                j.log("got SHARINGINFO, start to init...", a), this.ds_data.sharing_info_src = a, 
                this.dsMouse.img = $("<img>", {
                    css: {
                        width: "100%",
                        height: "100%",
                        "vertical-align": "text-top",
                        "line-height": "0",
                        "-moz-user-select": "none",
                        "-webkit-user-select": "none",
                        "user-select": "none"
                    }
                }), this.dsMouse.position = $("<div>", {
                    css: {
                        position: "absolute",
                        "z-index": this._getZIndex("mouse")
                    }
                }), this.dsMouse.position.append(this.dsMouse.img), this._viewer.append(this.dsMouse.position), 
                this.ds_data.blocks_array = [], this.ds_data.monitors = {}, this.ds_data.monitors_coord = [];
                var b = this._preprocessSharingInfo(a.monitors);
                j.log("processed SHARINGINFO ", b), this.ds_data.sharing_screen_height = b.rect.height, 
                this.ds_data.sharing_screen_width = b.rect.width;
                var c = this;
                _.each(b.monitors, function(a) {
                    a = c._parseMonitor(a), c.ds_data.monitors[a.monitor_id] = a, c.ds_data.monitors_coord.push({
                        monitor_id: a.monitor_id,
                        L: a.rect.x,
                        R: a.rect.x + a.rect.width,
                        T: a.rect.y,
                        B: a.rect.y + a.rect.height
                    });
                    var d = $("<div>", {
                        css: {
                            position: "absolute",
                            top: a.rect.y / b.rect.height * 100 + "%",
                            left: a.rect.x / b.rect.width * 100 + "%",
                            width: a.rect.width / b.rect.width * 100 + "%",
                            height: a.rect.height / b.rect.height * 100 + "%"
                        },
                        "data-monitor": a.monitor_id,
                        "data-rnd": Math.random()
                    }), e = c._getRGBA(a.background_color), f = '<canvas id="screen_share_viewer' + a.monitor_id + '" style="width:100%;height:100%;background:' + e + '" width="' + a.rect.width + '" height="' + a.rect.height + '"></canvas>';
                    d.append(f), c._viewer.append(d);
                }), j.log("[Attendee] resize screen: ", b.rect), this.model.setAttendeeResize(b.rect);
            }
        },
        _preprocessSharingInfo: function(a) {
            var b = {
                height: 0,
                width: 0,
                x: 0,
                y: 0
            }, c = this;
            if (a[0] = c._parseMonitor(a[0]), 1 == a.length) b.height = this._getInt(a[0].rect.height), 
            b.width = this._getInt(a[0].rect.width), a[0].rect.x = 0, a[0].rect.y = 0; else {
                var d = a[0].rect.x || 0, e = a[0].rect.y || 0, f = a[0].rect.x || 0, g = a[0].rect.y || 0, h = a[0].rect.width || 0, i = a[0].rect.height || 0;
                _.each(a, function(a) {
                    a = c._parseMonitor(a), j.log(a), a.rect.x < d && (d = a.rect.x), a.rect.x > f && (f = a.rect.x, 
                    h = a.rect.width), a.rect.y < e && (e = a.rect.y), a.rect.y > g && (g = a.rect.y, 
                    i = a.rect.height);
                }), b.height = Math.abs(e) + g + i, b.width = Math.abs(d) + f + h, (0 > d || 0 > e) && _.each(a, function(a) {
                    0 > d && (a.rect.x = a.rect.x + Math.abs(d)), 0 > e && (a.rect.y = a.rect.y + Math.abs(e));
                });
            }
            return {
                monitors: a,
                rect: b
            };
        },
        _setCaches: function(a) {
            var b = this;
            b.ds_data.caches || (b.ds_data.caches = new Array(5e3)), _.each(a, function(a) {
                a = b._parseCache(a), b.ds_data.caches[a.index] = {
                    index: a.index,
                    pdu_id: a.pdu_id,
                    data: a.cache_data[0].data,
                    type: a.cache_data[0].type
                };
            });
        },
        _setMouseInfo: function(a) {
            var b = this;
            if (a = b._parseMouse(a), b.ds_data.caches[a.cache_index] && b.ds_data.caches[a.cache_index].pdu_id == a.cache_pdu_id) {
                var c = Math.abs(a.rect.y) / b.ds_data.sharing_screen_height, d = Math.abs(a.rect.x) / b.ds_data.sharing_screen_width, e = a.rect.width / b.ds_data.sharing_screen_width, f = a.rect.height / b.ds_data.sharing_screen_height;
                b.dsMouse.position.css({
                    position: "absolute",
                    top: 100 * c + "%",
                    left: 100 * d + "%",
                    width: 100 * e + "%",
                    height: 100 * f + "%",
                    "z-index": b._getZIndex("mouse")
                }), b.dsMouse.img.attr("src", b._binary.getImg(b.ds_data.caches[a.cache_index]));
            } else {
                var g = {
                    type: "DS_DATA_GET_CACHES",
                    blocks: [ {
                        index: 0,
                        pdu_id: 0,
                        position: 0,
                        rect: a.rect,
                        cache_index: a.cache_index,
                        cache_pdu_id: a.cache_pdu_id
                    } ]
                };
                b._send(g);
            }
        },
        _setBlocks: function(a) {
            var b = this;
            _.each(a, function(a) {
                a = b._parseBlock(a), (!b.ds_data.blocks_array[a.index] || a.pdu_id > b.ds_data.blocks_array[a.index].pdu_id) && (b.ds_data.blocks_array[a.index] = a);
            });
        },
        _setCommand: function(a) {
            a.answer == this.DS_COMMAND_ANSWER.DS_COMMAND_ANSWER_ACCEPTED ? (this.isInRemoteControling = !0, 
            this.isBindMouseEvent || this._bindMouseEvent()) : (this.isInRemoteControling = !1, 
            this._unbindMouseEvent());
        },
        _createImg: function(a) {
            var b = this._getCanvas(a.monitor_id);
            if (!b) return null;
            var c = new Image();
            return c.onload = function() {
                b.drawImage(this, a.rect.x, a.rect.y, a.rect.width, a.rect.height);
            }, c;
        },
        _clearCanvas: function() {
            var a = this;
            MX.each(a.ds_data.monitors, function(b, c) {
                var d = a._getCanvas(c);
                if (d) {
                    var e = document.getElementById("screen_share_viewer" + c), f = e.width, g = e.height;
                    f && g && d.clearRect(0, 0, f, g);
                }
            });
        },
        _getCanvas: function(a) {
            var b = "screen_share_viewer" + a, c = document.getElementById(b);
            return c ? c.getContext("2d") : null;
        },
        _showScreen: function() {
            var a = this, b = [], c = [];
            for (var d in a.ds_data.blocks_array) {
                var e = a.ds_data.blocks_array[d];
                if (0 != e.position) {
                    var f = e.cache_index;
                    a.ds_data.caches[f] && a.ds_data.caches[f].pdu_id == e.cache_pdu_id ? b.push({
                        index: e.index,
                        src: a.ds_data.caches[f]
                    }) : c.push(e);
                }
            }
            if (0 == c.length) a._log("_showScreen update screen !!!"), _.each(b, function(b) {
                a.ds_data.blocks_array[b.index].img || (a.ds_data.blocks_array[b.index].img = a._createImg(a.ds_data.blocks_array[b.index])), 
                a.ds_data.blocks_array[b.index].img && (a.ds_data.blocks_array[b.index].img.src = a._binary.getImg(b.src));
            }), a.ds_data.blocks_array = []; else {
                var g = {
                    type: "DS_DATA_GET_CACHES",
                    blocks: []
                };
                _.each(c, function(a) {
                    g.blocks.push({
                        index: a.index,
                        pdu_id: a.pdu_id,
                        monitor_id: a.monitor_id,
                        position: a.position,
                        cache_index: a.cache_index,
                        cache_pdu_id: a.cache_pdu_id,
                        rect: a.rect
                    });
                }), a._send(g);
            }
        },
        _attendeeMouseClick: function(a) {
            this._sendMouseRequest(this.MOUSE_EVENT_TYPE.DS_LBUTTONCLICK, a);
        },
        _attendeeMouseDoubleClick: function(a) {
            this._sendMouseRequest(this.MOUSE_EVENT_TYPE.DS_LBUTTONDBLCLK, a);
        },
        _attendeeMouseMove: function(a) {
            this._sendMouseRequest(this.MOUSE_EVENT_TYPE.DS_MOUSEMOVE, a);
        },
        _getLParam: function(a) {
            var b = Math.floor(a.x * this.ds_data.sharing_screen_width / this._viewer.width()), c = Math.floor(a.y * this.ds_data.sharing_screen_height / this._viewer.height()), d = "0x" + parseInt(b).toString(16), e = "0x" + parseInt(c).toString(16);
            return d | e << 16;
        },
        _getMouseParams: function(a) {
            var b = Math.floor(a.x * this.ds_data.sharing_screen_width / this._viewer.width()), c = Math.floor(a.y * this.ds_data.sharing_screen_height / this._viewer.height()), d = this, e = -1, f = 0, g = 0;
            for (var h in d.ds_data.monitors_coord) {
                var i = d.ds_data.monitors_coord[h];
                if (b >= i.L && b <= i.R && c >= i.T && c <= i.B) {
                    e = i.monitor_id;
                    break;
                }
            }
            -1 != e && (f = d.ds_data.monitors[e].rect.x, g = d.ds_data.monitors[e].rect.y);
            var j = "0x" + parseInt(b - f).toString(16), k = "0x" + parseInt(c - g).toString(16), l = j | k << 16;
            return {
                lparam: l,
                monitor_id: e
            };
        },
        _sendMouseRequest: function(a, b) {
            if (this.isInRemoteControling) {
                var c = this._getMouseParams(b);
                if (c.monitor_id < 0) return !1;
                var e = {
                    type: "DS_DATA_COMMAND",
                    sequence: d.v1(),
                    command: {
                        type: this.DS_COMMAND_TYPE.DS_COMMAND_TYPE_REMOTE_CONTROLLING,
                        src_roster_id: this._session_id,
                        dst_roster_id: this.presenterRosterId,
                        mouse_event: {
                            type: a,
                            lparam: c.lparam,
                            monitor_id: c.monitor_id
                        }
                    }
                };
                this._send(e);
            }
        },
        _bindMouseEvent: function() {
            j.log("bindMouseEvent");
            var a = this;
            a.isBindMouseEvent = !0, a._viewer.bind("click", function(b) {
                a._attendeeMouseClick(a._getMousePoint(b));
            }).bind("dblclick", function(b) {
                a._attendeeMouseDoubleClick(a._getMousePoint(b));
            }).bind("mousemove", function(b) {
                a._attendeeMouseMove(a._getMousePoint(b));
            });
        },
        _unbindMouseEvent: function() {
            j.log("unbindMouseEvent"), this.isBindMouseEvent = !1, this._viewer && this._viewer.unbind("click", function() {
                j.log("unbind mouse click");
            }).unbind("dblclick", function() {
                j.log("unbind mouse dblclick");
            }).unbind("mousemove", function() {
                j.log("unbind mouse move");
            });
        },
        _getMousePoint: function(a) {
            var b = this._viewer.offset();
            return {
                x: a.pageX - b.left,
                y: a.pageY - b.top
            };
        },
        _parseMonitor: function(a) {
            return a.monitor_id = this._getInt(a.monitor_id), a.background_color = this._getInt(a.background_color), 
            a.rect.x = this._getInt(a.rect.x), a.rect.y = this._getInt(a.rect.y), a.rect.width = this._getInt(a.rect.width), 
            a.rect.height = this._getInt(a.rect.height), a;
        },
        _parseCache: function(a) {
            return a.index = this._getInt(a.index), a.pdu_id = this._getInt(a.pdu_id), a;
        },
        _parseBlock: function(a) {
            return a.index = this._getInt(a.index), a.pdu_id = this._getInt(a.pdu_id), a.monitor_id = this._getInt(a.monitor_id), 
            a.position = this._getInt(a.position), a.cache_index = this._getInt(a.cache_index), 
            a.cache_pdu_id = this._getInt(a.cache_pdu_id), a.rect.x = this._getInt(a.rect.x), 
            a.rect.y = this._getInt(a.rect.y), a.rect.width = this._getInt(a.rect.width), a.rect.height = this._getInt(a.rect.height), 
            a;
        },
        _parseMouse: function(a) {
            return a.monitor_id = this._getInt(a.monitor_id), a.cache_index = this._getInt(a.cache_index), 
            a.cache_pdu_id = this._getInt(a.cache_pdu_id), a.rect.x = this._getInt(a.rect.x), 
            a.rect.y = this._getInt(a.rect.y), a.rect.width = this._getInt(a.rect.width), a.rect.height = this._getInt(a.rect.height), 
            a;
        },
        _getInt: function(a) {
            return "number" == typeof a ? a : "object" == typeof a ? a && a.low || 0 : 0;
        },
        _getRGBA: function(a) {
            var b = parseInt(a).toString(2), c = b.substr(24, 8), d = b.substr(16, 8), e = b.substr(8, 8), f = b.substr(0, 8);
            return "rgba(" + parseInt(c, 2) + "," + parseInt(d, 2) + "," + parseInt(e, 2) + "," + parseInt(f, 2) / 255 + ")";
        },
        _getZIndex: function(a) {
            var b = 100;
            return "canvas" == a ? b + 10 : "mouse" == a ? b + 20 : b;
        },
        _getImageHeader: function(a) {
            return this.IMAGE_HEADER[a] || this.IMAGE_HEADER.DS_CACHE_PNG;
        },
        _log: function() {},
        _print: function(a) {
            j.log(a);
        }
    };
    var m = function() {
        this._ns = null, this._processor = null, this._strings = {}, this._init();
    };
    return m.prototype = {
        _init: function() {
            var a = e.protoFromFile("vendor/protobuf/dsdef.proto");
            this._ns = a.build("moxtra.dsapp"), this._processor = this._ns.DsData, this._buildStrings();
        },
        _buildStrings: function() {
            this._strings.DsDataType = {}, this._strings.DsDataType[this._ns.DsDataType.DS_DATA_KEEPALIVE] = "DS_DATA_KEEPALIVE", 
            this._strings.DsDataType[this._ns.DsDataType.DS_DATA_START] = "DS_DATA_START", this._strings.DsDataType[this._ns.DsDataType.DS_DATA_STOP] = "DS_DATA_STOP", 
            this._strings.DsDataType[this._ns.DsDataType.DS_DATA_JOIN] = "DS_DATA_JOIN", this._strings.DsDataType[this._ns.DsDataType.DS_DATA_LEAVE] = "DS_DATA_LEAVE", 
            this._strings.DsDataType[this._ns.DsDataType.DS_DATA_CREATE_CACHES] = "DS_DATA_CREATE_CACHES", 
            this._strings.DsDataType[this._ns.DsDataType.DS_DATA_CREATE_BLOCKS] = "DS_DATA_CREATE_BLOCKS", 
            this._strings.DsDataType[this._ns.DsDataType.DS_DATA_CREATE_SHARINGINFO] = "DS_DATA_CREATE_SHARINGINFO", 
            this._strings.DsDataType[this._ns.DsDataType.DS_DATA_CREATE_MOUSEINFO] = "DS_DATA_CREATE_MOUSEINFO", 
            this._strings.DsDataType[this._ns.DsDataType.DS_DATA_GET_KEYFRAME] = "DS_DATA_GET_KEYFRAME", 
            this._strings.DsDataType[this._ns.DsDataType.DS_DATA_GET_CACHES] = "DS_DATA_GET_CACHES", 
            this._strings.DsDataType[this._ns.DsDataType.DS_DATA_COMMAND] = "DS_DATA_COMMAND", 
            this._strings.DsDataType[this._ns.DsDataType.DS_DATA_SERVER_DISCONNECT] = "DS_DATA_SERVER_DISCONNECT", 
            this._strings.DsDataCode = {}, this._strings.DsDataCode[this._ns.DsDataCode.DS_CODE_SUCCESS] = "DS_CODE_SUCCESS", 
            this._strings.DsDataCode[this._ns.DsDataCode.DS_CODE_ERROR] = "DS_CODE_ERROR", this._strings.DsDataCode[this._ns.DsDataCode.DS_CODE_INVALID_TOKEN] = "DS_CODE_INVALID_TOKEN", 
            this._strings.DsDataCode[this._ns.DsDataCode.DS_CODE_INVALID_DSID] = "DS_CODE_INVALID_DSID", 
            this._strings.DsDataCode[this._ns.DsDataCode.DS_CODE_DSID_ALREADY_START] = "DS_CODE_DSID_ALREADY_START", 
            this._strings.DsDataCode[this._ns.DsDataCode.DS_CODE_DSID_NOT_JOIN] = "DS_CODE_DSID_NOT_JOIN", 
            this._strings.DsDataCode[this._ns.DsDataCode.DS_CODE_INVALID_DST] = "DS_CODE_INVALID_DST", 
            this._strings.DsDataCode[this._ns.DsDataCode.DS_CODE_INVALID_CONFID] = "DS_CODE_INVALID_CONFID", 
            this._strings.DsDataCode[this._ns.DsDataCode.DS_CODE_CONF_END] = "DS_CODE_CONF_END", 
            this._strings.DsDataCode[this._ns.DsDataCode.DS_CODE_KICKOFF_BY_NEW_CONNECTION] = "DS_CODE_KICKOFF_BY_NEW_CONNECTION", 
            this._strings.DsCacheType = {}, this._strings.DsCacheType[this._ns.DsCacheType.DS_CACHE_JPEG] = "image/jpeg", 
            this._strings.DsCacheType[this._ns.DsCacheType.DS_CACHE_GIF] = "image/gif", this._strings.DsCacheType[this._ns.DsCacheType.DS_CACHE_PNG] = "image/png", 
            this._strings.DsCacheType[this._ns.DsCacheType.DS_CACHE_DATA] = "data", this._strings.DsCacheTypeBase64 = {}, 
            this._strings.DsCacheTypeBase64[this._ns.DsCacheType.DS_CACHE_JPEG] = "data:image/jpeg;base64,", 
            this._strings.DsCacheTypeBase64[this._ns.DsCacheType.DS_CACHE_GIF] = "data:image/gif;base64,", 
            this._strings.DsCacheTypeBase64[this._ns.DsCacheType.DS_CACHE_PNG] = "data:image/png;base64,", 
            this._strings.DsCacheTypeBase64[this._ns.DsCacheType.DS_CACHE_DATA] = "data";
        },
        getString: function(a, b) {
            return "type" == a && (a = "DsDataType"), "code" == a && (a = "DsDataCode"), "cache" == a && (a = "DsCacheType"), 
            "base64" == a && (a = "DsCacheTypeBase64"), this._strings[a] && this._strings[a][b];
        },
        getData: function(a, b) {
            return "base64" === b ? this._processor.decode64(a) : this._processor.decode(a.data);
        },
        getImg: function(a) {
            return this.getString("base64", a.type) + window.btoa(String.fromCharCode.apply(null, new Uint8Array(a.data.toArrayBuffer())));
        }
    }, {
        init: function(a) {
            this.parent = a, this.model = a.model, this.controller = a.controller, this._current_state = "", 
            this.TIMEOUT = {}, h.on(f.action.attendee.NATIVE, function() {
                a.controller.handle("ds:join_attendee");
            }), h.on(f.action.attendee.SEND, function(b) {
                a.controller.handle("ds:send_data", b);
            });
        },
        open: function(a) {
            if (a = a || this._getState()) {
                switch (j.logServer(i.logFormat("[attendee open:begin] state: " + JSON.stringify(a))), 
                this._current_state = a, j.log(a.status), a.status) {
                  case k.STARTED:
                    this._openAttendee(a), this._setStatus(k.STARTED);
                    break;

                  case k.PAUSED:
                    this._openAttendee(a), this._setStatus(k.PAUSED);
                    break;

                  case k.RESUMED:
                    this._setStatus(k.RESUMED);
                    break;

                  case k.STOPPED:
                    "base64" === g.attendeeConnection && this.parent.controller.handle("ds:stop_attendee", {
                        sequence: a.sequence
                    }), this._setStatus(k.STOPPED), this._clear(), this.model.setAttendeeStopped(!0);
                }
                j.logServer(i.logFormat("[attendee open:end] state: " + JSON.stringify(a)));
            } else j.logServer(i.logFormat("[attendee open] Could not find correct ds_state"));
        },
        checkState: function(a) {
            j.logServer(i.logFormat("[attendee checkState:begin]")), a = a || this._getState(), 
            a && this._current_state && a.page_sequence === this._current_state.page_sequence && (j.logServer(i.logFormat("[attendee checkState] state ready")), 
            a.revision > this._current_state.revision && (j.logServer(i.logFormat("[attendee checkState] try to call this.open()")), 
            this.open(a))), j.logServer(i.logFormat("[attendee checkState:end]"));
        },
        close: function() {
            j.log("dsattendee close"), this._clear(), this._current_state = null, this.binary = null;
        },
        _openAttendee: function(a) {
            this.binary || (this.binary = new m()), this.attendee || (j.logServer(i.logFormat("[attendee _openAttendee] Create Attendee instance of ds_id: " + this._getSequence())), 
            this.attendee = new l({
                model: this.model,
                binary: this.binary,
                ds_id: this._getSequence() + "",
                ds_conf: this.model.getDSConf(),
                session_key: this.model.getSessionKey(),
                session_id: this.model.getSessionId(),
                presenterRosterId: a.id
            }));
            try {
                ("base64" === g.attendeeConnection || "base64" !== g.attendeeConnection && (!this.model.get("aStarted") || this.model.get("aStopped"))) && this.attendee.start();
            } catch (b) {
                console.error(b);
            }
        },
        _getSequence: function() {
            var a = 0;
            return this.model && (a = this.model.getSequence()), a;
        },
        _setStatus: function(a) {
            this.attendee && this.attendee.setStatus(a);
        },
        _getState: function() {
            return this.model ? this.model.getDSState() : null;
        },
        _clear: function() {
            this.attendee && (j.logServer(i.logFormat("[attendee _clear] Destroy Attendee instance")), 
            this.attendee.close(!0), this.attendee = null);
        }
    };
}), define("meet/ds/ds", [ "moxtra", "meet/meetUtil", "meet/connector/util", "meet/ds/presenter", "meet/ds/attendee" ], function(a, b, c, d, e) {
    var f = MX.logger("meet:ds"), g = function(a) {
        this.controller = a, this.meetModel = a.model, this.model = a.dsModel, this.TIMEOUT = {};
    };
    return g.prototype = {
        start: function() {
            var a = this, g = function() {
                var h = a.model.getDSConf(), i = a.meetModel.toJSON();
                if (f.log("dsConf: ", h), h && h.token) if (clearTimeout(a.TIMEOUT.action), i.isMeetPresenter) b.isBrowserSupported() ? (f.log("init and open screenshare"), 
                d.init(a), f.logServer(c.logFormat("[ds start] try to call DSPresenter.open(), <Call Sstack> biz.startDS()")), 
                d.open()) : a.model.setPresenterNotSupported(!0); else {
                    if (MX.env.isIE && 9 == MX.env.browserVersion) return void a.model.setAttendeeNotSupported(!0);
                    if (b.isBrowserSupported()) {
                        var j = function() {
                            f.log(a.model.getDSState()), a.model.getDSState() ? (clearTimeout(a.TIMEOUT.openattendee), 
                            e.init(a), f.logServer(c.logFormat("[ds start] try to call DSAttendee.open(), <Call Sstack> biz.startDS()")), 
                            e.open()) : a.TIMEOUT.openattendee = setTimeout(j, 1e3);
                        };
                        j();
                    } else a.model.setAttendeeNotSupported(!0);
                } else a.TIMEOUT.action = setTimeout(g, 1500);
            };
            g();
        },
        checkState: function(a) {
            e.checkState(a);
        },
        close: function() {
            f.log("[ScreenShare] close, cleanup..."), clearTimeout(this.TIMEOUT.action), clearTimeout(this.TIMEOUT.openattendee), 
            d.close(), e.close();
        }
    }, g;
}), define("meet/connector/controller", [ "moxtra", "app", "lang", "meet/connector/type", "meet/connector/helper", "meet/connector/cache", "meet/connector/listener", "meet/connector/util", "meet/connector/connector", "meet/audio/ac", "meet/video/av", "meet/ds/ds" ], function(a, b, c, d, e, f, g, h, i, j, k, l) {
    var m = MX.logger("meet:controller"), n = function(a) {
        a = a || {}, this.model = a.meetModel, this.audioModel = a.audioModel, this.videoModel = a.videoModel, 
        this.dsModel = a.dsModel, this.connector = null, this._init(), f.meet = this.model.toJSON(), 
        f.ds = this.dsModel.toJSON(), f.peer = this.dsModel.get("dsConf"), f.audio = this.audioModel.toJSON(), 
        f.video = this.videoModel.toJSON(), this.model.on("change", function(a) {
            f.meet = a.toJSON();
        }), this.dsModel.on("change", function(a) {
            f.ds = a.toJSON(), f.peer = a.get("dsConf");
        }), this.audioModel.on("change", function(a) {
            f.audio = a.toJSON();
        }), b.isIntegrationVideo() && this.videoModel.on("change", function(a) {
            f.video = a.toJSON();
        });
    }, o = function(a) {
        if (MX.isString(a)) {
            a = a.toLowerCase();
            var b = a.split(":");
            return b.length > 1 && [ "meet", "ds", "ac", "av", "notify", "publish", "peer" ].indexOf(b[0]) > -1 ? [ b[0], b[1] ] : [ "defaults", "unknown" ];
        }
        return [ "defaults", "error" ];
    };
    return _.extend(n.prototype, {
        handle: function(a, b) {
            var c, d = o(a);
            c = this.actions[d[0]][d[1]], MX.isFunction(c) && (b = b || {}, m.logServer(h.logFormat("[controller handle] process action: " + a + ", options: " + JSON.stringify(b))), 
            c.call(this, a, b));
        },
        actions: {
            meet: {
                stop_application: function() {
                    this.connector.stopApplication();
                },
                cleanup: function() {
                    this.connector.close(), this.connector = null, this.ds.close(), this.ac.close();
                },
                clean_ds: function() {
                    this.ds.close();
                },
                presenter_changed: function() {
                    this.ds.close();
                }
            },
            ds: {
                start: function(a, b) {
                    this.ds.start(b);
                },
                start_presenter: function(a, b) {
                    this._send(e.dsReq(d.request.ds.START, this.model.toJSON(), this.dsModel.toJSON(), b.sequence));
                },
                stop: function() {},
                stop_presenter: function(a, b) {
                    this._send(e.dsReq(d.request.ds.STOP, this.model.toJSON(), this.dsModel.toJSON(), b.sequence));
                },
                join_attendee: function() {
                    this._send(e.dsReq(d.request.ds.JOIN, this.model.toJSON(), this.dsModel.toJSON()));
                },
                stop_attendee: function(a, b) {
                    this._send(e.dsReq(d.request.ds.STOP, this.model.toJSON(), this.dsModel.toJSON(), b.sequence));
                },
                update: function() {
                    m.log("[actions ds:update]"), f.dsActive && (m.log("[actions ds:update] need to update as ds in active"), 
                    this._send(e.dsReq(d.request.ds.UPDATE, this.model.toJSON(), this.dsModel.toJSON())));
                },
                check_state: function(a, b) {
                    this.ds.checkState(b.state);
                },
                send_data: function(a, b) {
                    this._send(b);
                }
            },
            ac: {
                join: function() {
                    this.ac.join();
                },
                mute: function(a, b) {
                    this.ac.mute(b);
                },
                unmute: function() {
                    this.ac.unmute();
                },
                leave: function() {
                    this.ac.leave();
                },
                config: function() {
                    this.ac.config();
                },
                join_native: function(a, b) {
                    this._send(e.acReq(d.request.ac.JOIN, this.model.toJSON(), this.audioModel.toJSON(), b.type));
                },
                mute_native: function() {
                    this._send(e.acReq(d.request.ac.MUTE, this.model.toJSON(), this.audioModel.toJSON()));
                },
                unmute_native: function() {
                    this._send(e.acReq(d.request.ac.UNMUTE, this.model.toJSON(), this.audioModel.toJSON()));
                },
                leave_native: function() {
                    this._send(e.acReq(d.request.ac.LEAVE, this.model.toJSON(), this.audioModel.toJSON()));
                },
                config_native: function() {
                    this._send(e.acReq(d.request.ac.CONFIG, this.model.toJSON(), this.audioModel.toJSON()));
                },
                update: function() {
                    m.log("[actions ac:update]"), f.audioActive && (m.log("[actions ds:update] need to update as ac in active"), 
                    this._send(e.acReq(d.request.ac.UPDATE, this.model.toJSON(), this.audioModel.toJSON())));
                },
                switch_to_native: function(a, b) {
                    this.ac.switchToNative(b);
                }
            },
            av: {
                join: function(a, c) {
                    b.isIntegrationVideo() && this.av.join(c.broadcast);
                },
                leave: function(a, c) {
                    b.isIntegrationVideo() && this.av.leave(c.broadcast);
                },
                layout: function(a, c) {
                    b.isIntegrationVideo() && this.av.layout(c.layout);
                },
                join_native: function(a, c) {
                    b.isIntegrationVideo() && this._send(e.avReq(d.request.av.JOIN, this.model.toJSON(), this.videoModel.toJSON(), c.broadcast));
                },
                leave_native: function(a, c) {
                    b.isIntegrationVideo() && this._send(e.avReq(d.request.av.LEAVE, this.model.toJSON(), this.videoModel.toJSON(), c.broadcast));
                },
                layout_native: function(a, c) {
                    b.isIntegrationVideo() && this._send(e.avLayoutReq(d.request.av.LAYOUT, this.model.toJSON(), this.videoModel.toJSON(), c.layout));
                },
                update: function() {
                    b.isIntegrationVideo() && (m.log("[actions av:update]"), f.videoActive && (m.log("[actions av:update] need to update as av in active"), 
                    this._send(e.avReq(d.request.av.UPDATE, this.model.toJSON(), this.videoModel.toJSON()))));
                },
                camera_on: function() {
                    b.isIntegrationVideo() && this._send(e.avReqSimple(d.request.av.CAMERA_ON, this.model.toJSON(), this.videoModel.toJSON()));
                },
                camera_off: function() {
                    b.isIntegrationVideo() && this._send(e.avReqSimple(d.request.av.CAMERA_OFF, this.model.toJSON(), this.videoModel.toJSON()));
                },
                config: function() {
                    b.isIntegrationVideo() && this._send(e.avReqSimple(d.request.av.CONFIG, this.model.toJSON(), this.videoModel.toJSON()));
                }
            },
            notify: {
                ac_joined: function() {
                    this._send(e.acReq(d.request.webrtc_ac.JOINED, this.model.toJSON(), this.audioModel.toJSON()));
                },
                ac_muted: function() {
                    this._send(e.acReq(d.request.webrtc_ac.MUTED, this.model.toJSON(), this.audioModel.toJSON()));
                },
                ac_unmuted: function() {
                    this._send(e.acReq(d.request.webrtc_ac.UNMUTED, this.model.toJSON(), this.audioModel.toJSON()));
                },
                ac_left: function() {
                    this._send(e.acReq(d.request.webrtc_ac.LEFT, this.model.toJSON(), this.audioModel.toJSON()));
                },
                roster_added: function(a, b) {
                    this._send(e.rosterReq(d.action.roster.ADD, [ b.roster ]));
                },
                roster_removed: function(a, b) {
                    this._send(e.rosterReq(d.action.roster.REMOVE, [ b.roster ]));
                }
            },
            publish: {
                ds_started: function(a, b) {
                    e.publishDS(d.status.ds.STARTED, this.model.toJSON(), b.sequence);
                },
                ds_stopped: function(a, b) {
                    e.publishDS(d.status.ds.STOPPED, this.model.toJSON(), b.sequence);
                },
                ac_joined: function() {
                    e.publishAC(d.status.ac.JOINED, this.model.toJSON(), this.audioModel.toJSON());
                },
                ac_muted: function() {
                    e.publishAC(d.status.ac.MUTED, this.model.toJSON(), this.audioModel.toJSON());
                },
                ac_unmuted: function() {
                    e.publishAC(d.status.ac.UNMUTED, this.model.toJSON(), this.audioModel.toJSON());
                },
                ac_left: function() {
                    e.publishAC(d.status.ac.LEFT, this.model.toJSON(), this.audioModel.toJSON());
                },
                ac_mute_single: function(a, b) {
                    b.telephone ? e.publishTelephone(d.status.ac.MUTED, this.model.toJSON(), b.rosterId) : e.publishAC(d.status.ac.MUTED, this.model.toJSON(), this.audioModel.toJSON(), b.rosterId);
                },
                ac_unmute_single: function(a, b) {
                    b.telephone ? e.publishTelephone(d.status.ac.UNMUTED, this.model.toJSON(), b.rosterId) : e.publishAC(d.status.ac.UNMUTED, this.model.toJSON(), this.audioModel.toJSON(), b.rosterId);
                },
                ac_mute_all: function() {
                    e.publishMuteAll(this.model.toJSON());
                },
                av_status: function() {
                    b.isIntegrationVideo() && e.publishAV(this.model.toJSON(), this.videoModel.toJSON());
                }
            },
            peer: {
                update: function() {
                    this.connector.update(this.dsModel.get("dsConf"));
                }
            },
            defaults: {
                error: function(a) {
                    m.error("error action: ", a);
                },
                unknown: function(a) {
                    m.warn("unknown action: ", a);
                }
            }
        },
        close: function() {
            this.connector.close(), this.connector = null, f.clear(), this.ds.close(), this.ac.close(), 
            g.off();
        },
        _init: function() {
            f.clear(), this.connector || (this.connector = new i()), this.ac = new j(this), 
            this.av = new k(this), this.ds = new l(this), g.on("open", this._onAppConnected, this), 
            g.on(d.notify_web.ac.JOIN, this._notifyAudioJoin, this), g.on(d.notify_web.ac.MUTE, this._notifyAudioMute, this), 
            g.on(d.notify_web.ac.UNMUTE, this._notifyAudioUnmute, this), g.on(d.notify_web.ac.LEAVE, this._notifyAudioLeave, this), 
            g.on(d.response.ds.ERROR, this._handleDSError, this), g.on(d.response.ac.ERROR, this._handleACError, this), 
            g.on(d.response.av.ERROR, this._handleAVError, this), g.on(d.response.sys_error, this._handleSysError, this);
        },
        _onAppConnected: function() {
            var a, b = this.model.toJSON(), c = [];
            this._send(e.appConfigReq(b.appConfig)), a = _.values(b.userRoster), MX.each(a, function(a) {
                a.is_deleted || c.push(a);
            }), this._send(e.rosterReq(d.action.roster.ADD, c));
        },
        _send: function(a) {
            this.connector && this.connector.send(a);
        },
        _notifyAudioJoin: function() {
            this.handle("ac:join");
        },
        _notifyAudioMute: function() {
            this.handle("ac:mute");
        },
        _notifyAudioUnmute: function() {
            this.handle("ac:unmute");
        },
        _notifyAudioLeave: function() {
            this.handle("ac:leave");
        },
        _handleDSError: function(a) {
            var b = MX.get("code", a), c = MX.get("codetype", a);
            this._handleModuleError(d.response.ds.ERROR, b, c);
        },
        _handleACError: function(a) {
            console.log(a);
            var b = MX.get("code", a), e = MX.get("codetype", a);
            b === d.defines.ERR_DEVICE_NOTFOUND ? MX.ui.Alert(c.device_microphone_error, {
                className: "mx-branding-meet-dialog-btn"
            }) : b === d.defines.ERR_AUDIO_NOPLAYBACK ? MX.ui.Alert(c.audio_device_playback_error, {
                className: "mx-branding-meet-dialog-btn"
            }) : b === d.defines.ERROR_INVALID_TOKEN ? MX.ui.Alert(c.audio_invalid_token_error, {
                className: "mx-branding-meet-dialog-btn"
            }) : this._handleModuleError(d.response.ac.ERROR, b, e);
        },
        _handleAVError: function(a) {
            var b = MX.get("code", a), e = MX.get("codetype", a);
            b === d.defines.ERR_DEVICE_NOTFOUND ? MX.ui.Alert(c.device_camera_error, {
                className: "mx-branding-meet-dialog-btn"
            }) : this._handleModuleError(d.response.av.ERROR, b, e);
        },
        _handleModuleError: function(a, b, e) {
            if (e !== d.codeTypes.proxy) {
                if (f.errorModules = a, !f.tryAgainShown) {
                    f.tryAgainShown = !0, m.logServer(h.logFormat("[Show] Try_Again dialog (module error)"));
                    var g = this, i = new MX.ui.Dialog({
                        title: "",
                        width: 400,
                        content: c.system_unknown_error,
                        iframeShim: !0,
                        buttons: [ {
                            text: c.cancel,
                            className: "btn-default",
                            click: function() {
                                m.logServer(h.logFormat('[User Action] click "Cancel" ')), this.close(), f.tryAgainShown = !1, 
                                g._cancelTryAction();
                            }
                        }, {
                            text: c.try_again,
                            className: "btn-warning mx-branding-meet-dialog-btn",
                            click: function() {
                                m.logServer(h.logFormat('[User Action] click "Try Again" ')), this.close(), f.tryAgainShown = !1, 
                                g._tryAgainAction();
                            }
                        } ]
                    });
                    i.on("close", function() {
                        f.tryAgainShown = !1;
                    });
                }
            } else if (!f.tryAgainShown) {
                f.tryAgainShown = !0;
                var i = MX.ui.Alert(c.proxy_denied_error, {
                    className: "mx-branding-meet-dialog-btn",
                    title: c.proxy_error_title
                });
                i.on("close", function() {
                    f.tryAgainShown = !1;
                });
            }
        },
        _cancelTryAction: function() {
            MX.each(f.errorModules, function(a) {
                switch (a) {
                  case d.response.ds.ERROR:
                    g.trigger(d.response.ds.STOPPED, {
                        code: 0
                    });
                    break;

                  case d.response.ac.ERROR:
                    g.trigger(d.response.ac.LEFT, {
                        code: 0
                    });
                    break;

                  case d.response.av.ERROR:
                    g.trigger(d.response.av.LEFT, {
                        code: 0
                    }), m.warn("[_cancelTryAction] av error");
                    break;

                  default:
                    m.log("[_cancelTryAction] error type: ", a);
                }
            }), f.errorModules = [];
        },
        _tryAgainAction: function() {
            var a = this;
            MX.each(f.errorModules, function(b) {
                switch (b) {
                  case d.response.ds.ERROR:
                    a._send(e.dsTryReq(f.meet, f.ds));
                    break;

                  case d.response.ac.ERROR:
                    a._send(e.acTryReq(f.meet, f.audio));
                    break;

                  case d.response.av.ERROR:
                    a._send(e.avTryReq(f.meet, f.video));
                    break;

                  default:
                    m.log("[_tryAgainAction] error type: ", b);
                }
            }), f.errorModules = [];
        },
        _handleSysError: function(a) {
            var b = MX.get("code", a);
            switch (b) {
              case d.defines.BLOCKED_GROUP_POLICY:
                MX.env.isWin && MX.ui.Alert(c.plugin_error_block_group_policy, {
                    className: "mx-branding-meet-dialog-btn"
                });
                break;

              case d.defines.DENY_EXECUTION:
                MX.env.isWin && (f.denyExecutionOnIEShown = !0);
            }
        }
    }), n;
}), define("meet/meetBiz", [ "moxtra", "lang", "app", "const", "common/messageListener", "meet/meetUtil", "meet/meetModel", "meet/audio/audioModel", "meet/video/videoModel", "meet/telephony/telephonyModel", "meet/ds/dsModel", "meet/pagesCollection", "meet/participant/participantCollection", "meet/chat/chatCollection", "meet/connector/controller" ], function(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o) {
    "use strict";
    function p() {
        q(), J = new o({
            meetModel: O,
            audioModel: P,
            videoModel: Q,
            dsModel: S
        });
    }
    function q() {
        J && (J.close(), J = null);
    }
    function r(a, b) {
        J ? J.handle(a, b) : U.push({
            type: a,
            options: b
        });
    }
    function s(a) {
        var b = O.toJSON();
        if (K.logServer(f.logFormat("Got subscribe " + Date.now(), {
            meetId: b.sessionKey,
            rosterId: b.sessionId
        })), a) {
            if (a && ("RESPONSE_ERROR_PERMISSION" === a.code || "RESPONSE_ERROR_NOT_FOUND" === a.code)) return void O.setNoPermission(!0);
            var c = a.object && a.object.board, e = a.action;
            c && (MX.each(c.resources, function(a) {
                switch (a.status) {
                  case d.binder.resourceStatus.queued:
                    L.trigger("convert", 0, a);
                    break;

                  case d.binder.resourceStatus.converting:
                    L.trigger("convert", a.converted_pages / a.total_pages * 100, a);
                    break;

                  case d.binder.resourceStatus.converted:
                    L.trigger("convert", 100, a);
                    break;

                  case d.binder.resourceStatus.failed:
                    L.trigger("convert", -1, a);
                }
            }), w(c), E(c), c && c.tags && u(c)), e && (K.log(e), z(e), D(e), A(e), Y && B(e), 
            C(e), F(e), x(), y(), Z || O.set({
                firstSubscribe: !0
            }), Z = e.revision), c && (K.log(c), v(c)), t(a);
        }
    }
    function t(a) {
        O.setNotifyStatus(a.isFullData);
    }
    function u(a) {
        if (a.tags) {
            V = _.union(V, a.tags);
            var b = function(a) {
                var b = "";
                return MX.each(V, function(c) {
                    if (c.name && 0 === c.name.indexOf("MessageID_")) try {
                        var d = JSON.parse(c.string_value);
                        if (d.message_id === a) return b = d.sender, !1;
                    } catch (e) {}
                }), b;
            }, d = O.get("sessionKey"), e = c.status.get("mxMeetMsgTimestamp") || {}, f = e[d] || 0, g = Moxtra.getMe().sessionId, h = f, i = [];
            if (MX.each(a.tags, function(a) {
                if (a.name && 0 === a.name.indexOf("MessageID_")) try {
                    var c = JSON.parse(a.string_value);
                    c.sender !== g && a.created_time > f && ("broadcast" === c.delivery_mode || "reply" === c.delivery_mode && b(c.reply_to) === g) && (i.push({
                        message_id: c.message_id,
                        message: c.message
                    }), h = a.created_time);
                } catch (d) {}
            }), i.length && c.sendMessage({
                action: "message",
                messages: i,
                binder_id: O.get("boardId"),
                session_key: d,
                session_id: g
            }), h !== f) {
                var j = {};
                j[d] = h, c.status.set("mxMeetMsgTimestamp", j);
            }
        }
    }
    function v(a) {
        a.comments && (O.get("boardId") && O.get("sessionKey") ? MX.each(a.comments, function(a) {
            N.add(a, {
                parse: !0,
                meet: O.toJSON()
            });
        }) : T = a.comments);
    }
    function w(a) {
        if (a.pages) {
            K.log("process pages: ", a.pages);
            var b, c = a.pages, e = {}, f = {};
            X || (X = !0, MX.each(c, function(a) {
                a.page_group && (e[a.page_group] ? parseFloat(a.page_number) < e[a.page_group] && (e[a.page_group] = parseFloat(a.page_number)) : e[a.page_group] = parseFloat(a.page_number));
            }), a.page_groups && MX.each(a.page_groups, function(a) {
                f[a.client_uuid] = a.order_number ? parseFloat(a.order_number) : e[a.client_uuid] || 0;
            }), c.sort(function(a, b) {
                var c, d;
                return c = parseFloat(a.page_number), d = parseFloat(b.page_number), a.page_group && b.page_group ? a.page_group.client_uuid === b.page_group.client_uuid ? d > c ? -1 : c > d ? 1 : a.sequence < b.sequence ? -1 : 1 : f[a.page_group.client_uuid] < f[b.page_group.client_uuid] ? -1 : 1 : a.page_group && !b.page_group ? f[a.page_group.client_uuid] < d ? -1 : 1 : !a.page_group && b.page_group ? c < f[b.page_group.client_uuid] ? -1 : 1 : d > c ? -1 : c > d ? 1 : a.sequence < b.sequence ? -1 : 1;
            })), MX.each(c, function(c) {
                if (c.is_deleted) b = L.get(c.sequence), b && L.remove(b); else {
                    if (b = L.get(c.sequence)) {
                        var e = b.get("type");
                        c.page_type || (c.page_type = d.binder.pageType[e]), c.width || (c.width = b.get("width")), 
                        c.height || (c.height = b.get("height"));
                    }
                    L.add(c, {
                        parse: !0,
                        merge: !0,
                        boardid: a.id
                    }), c.contents && L.trigger("page:annotate", c);
                }
            }), L.updatePageIndex(), L.trigger("complete");
        }
        X = !0;
    }
    function x() {
        T.length && (MX.each(T, function(a) {
            N.add(a, {
                parse: !0,
                meet: O.toJSON()
            });
        }), T = []);
    }
    function y() {
        U.length && (MX.each(U, function(a) {
            r(a.type, a.options);
        }), U = []);
    }
    function z(a) {
        O.setData(a);
    }
    function A(a) {
        P.setData(a);
    }
    function B(a) {
        Q.setData(a);
    }
    function C(a) {
        R.setData(a);
    }
    function D(a) {
        if (S.setData(a), a.ds_state && !O.get("isMeetPresenter")) {
            var b, c = a.ds_state.length - 1;
            c > -1 && (b = a.ds_state[0]), K.logServer(f.logFormat("[meetBiz updateDS] ds:check_state current state: " + JSON.stringify(b), {
                meetId: O.get("sessionKey"),
                rosterId: O.get("sessionId")
            })), r("ds:check_state", {
                state: b
            });
        }
    }
    function E(a) {
        if (a.users) {
            var b = a.id || c.request.page() || O.get("boardId");
            MX.each(a.users, function(a) {
                var c = MX.get("email", a.user) || MX.get("id", a.user) || MX.get("id", a.group);
                a.id = c, W[c] = a, a.type === d.binder.role.Owner && (a.is_host = !0), M.add(a, {
                    parse: !0,
                    merge: !0,
                    inSession: !1,
                    boardId: b,
                    meet: O.toJSON()
                });
            });
        }
    }
    function F(a) {
        if (a.user_roster) {
            var b = a.board_id || c.request.page() || O.get("boardId"), d = O.get("sessionKey"), e = O.get("sessionId");
            MX.each(a.user_roster, function(a) {
                if (a.is_invisible) return void (a.is_deleted ? r("notify:roster_removed", {
                    roster: a
                }) : r("notify:roster_added", {
                    roster: a
                }));
                var c, g = a.user && (a.user.email || a.user.id);
                if (a.is_deleted) {
                    if (c = M.get(a.id), c && (K.logServer(f.logFormat("Remove participant AS is_deleted:true, " + a.id, {
                        meetId: d,
                        rosterId: e
                    })), M.remove(c), r("notify:roster_removed", {
                        roster: a
                    })), g && W[g]) {
                        var h = !1;
                        MX.each(M.models, function(a) {
                            return a.get("email") === g || a.get("id") === g ? (h = !0, !1) : void 0;
                        }), h || M.add(W[g], {
                            parse: !0,
                            merge: !0,
                            inSession: !1,
                            boardId: b,
                            meet: O.toJSON()
                        });
                    }
                } else g && (c = M.get(g), c && (K.logServer(f.logFormat("Remove participant AS invited user joined meet, " + a.id, {
                    meetId: d,
                    rosterId: e
                })), M.remove(c))), M.add(a, {
                    parse: !0,
                    merge: !0,
                    inSession: !0,
                    boardId: b,
                    meet: O.toJSON()
                }), r("notify:roster_added", {
                    roster: a
                });
            }), M.trigger("sort");
        }
    }
    function G(a) {
        a || (L.reset(), c.status.remove("mxNote"), c.status.remove("mxMeetEnableVoice"), 
        c.status.remove("mxMeetRecorder"), c.status.remove("mxMeetShareType"), c.status.remove("mxMeetEnableVideo"), 
        c.status.remove("mxMeetMsgTimestamp"), Z = 0, O.off(), P.off(), Q.off(), S.off()), 
        M.reset(), N.reset(), O.reset(), P.reset(), Q.reset(), R.reset(), S.reset(), V = [], 
        W = {}, X = !1;
    }
    function H(a) {
        return (void 0 === a || isNaN(a)) && (a = 0), a = parseInt(a), 0 > a && (a = 0), 
        a;
    }
    function I(a, b) {
        a = a || "", O.setShareType(a, b);
        var d = {};
        d[O.get("sessionKey")] = a, c.status.set("mxMeetShareType", d);
    }
    var J, K = MX.logger("meet:biz"), L = new l(), M = new m(), N = new n(), O = new g(), P = new h(), Q = new i(), R = new j(), S = new k(), T = [], U = [], V = [], W = {}, X = !1, Y = c.isIntegrationVideo(), Z = 0;
    return {
        getPageList: function() {
            return L;
        },
        getParticipantList: function() {
            return M;
        },
        getChatList: function() {
            return N;
        },
        getMeetModel: function() {
            return O;
        },
        getAudioModel: function() {
            return P;
        },
        getVideoModel: function() {
            return Q;
        },
        getTelephonyModel: function() {
            return R;
        },
        getDSModel: function() {
            return S;
        },
        start: function(a, b) {
            K.log(a, b), e.on({
                binder_id: a,
                session_key: b,
                session_id: Moxtra.getMe().sessionId
            }), Y = c.isIntegrationVideo(), G(!0);
            var d = c.status.get("mxMeetShareType") || {};
            I(d[b]), p(), MX.unsubscribe("/binders/" + a), MX.subscribe("/binders/" + a, {
                data: {
                    session_key: b
                }
            }, s, this);
            try {
                K.logServer(f.logFormat("[User Agent] " + navigator.userAgent, {
                    meetId: b,
                    rosterId: Moxtra.getMe().sessionId
                }));
            } catch (g) {
                console.error(g);
            }
        },
        stop: function(a) {
            e.off(), G(), q(), MX.unsubscribe("/binders/" + a, s, this);
            var b = c.status.get("mxMeetAnchorHref");
            if (b) {
                if ("blank" === b) return;
                "#mymeet?action=default" !== b ? setTimeout(function() {
                    location.href = b;
                }, 500) : location.href = b;
            } else c.navigate("/timeline", !0);
        },
        makePresenter: function(a) {
            MX.api("/meets/" + O.get("sessionKey"), "PUT", {
                action: "set_presenter",
                data: {
                    roster_id: a
                }
            }, function() {});
        },
        presenterChanged: function() {
            r("meet:presenter_changed");
            var a = O.toJSON(), b = S.get("sequence");
            a.isMeetPresenter && b && (this.destroyDSPage(b), r("publish:ds_stopped", {
                sequence: b
            }));
        },
        muteSingle: function(a, b) {
            r("publish:ac_mute_single", {
                rosterId: a,
                telephone: b
            });
        },
        unmuteSingle: function(a, b) {
            r("publish:ac_unmute_single", {
                rosterId: a,
                telephone: b
            });
        },
        muteAll: function() {
            r("publish:ac_mute_all");
        },
        joinAudio: function() {
            r("ac:join");
        },
        muteAudio: function(a) {
            r("ac:mute", {
                silent: !!a
            });
        },
        unmuteAudio: function() {
            r("ac:unmute");
        },
        leaveAudio: function() {
            r("ac:leave");
        },
        configAudio: function() {
            r("ac:config");
        },
        joinVideo: function(a, b) {
            b = b || {}, Q.setLayout(H(b.layout)), MX.isUndefined(b.quality) || Q.setQuality(b.quality), 
            MX.isUndefined(b.audiobutton) || Q.setAudiobutton(b.audiobutton), r("av:join", {
                broadcast: a
            });
        },
        leaveVideo: function(a) {
            r("av:leave", {
                broadcast: a
            });
        },
        setVideoLayout: function(a) {
            Q.setLayout(H(a)), r("av:layout", {
                layout: H(a)
            });
        },
        cameraOff: function() {
            r("av:camera_off");
        },
        cameraOn: function() {
            r("av:camera_on");
        },
        configVideo: function() {
            r("av:config");
        },
        setAudioStatus: function(a) {
            if (a) {
                var b = {};
                b[O.get("sessionKey")] = a, c.status.set("mxMeetEnableVoice", b);
            } else c.status.remove("mxMeetEnableVoice");
        },
        getAudioStatus: function() {
            var a = c.status.get("mxMeetEnableVoice") || {};
            return a[O.get("sessionKey")];
        },
        setVideoStatus: function(a) {
            if (a) {
                var b = {};
                b[O.get("sessionKey")] = a, c.status.set("mxMeetEnableVideo", b);
            } else c.status.remove("mxMeetEnableVideo");
        },
        getVideoStatus: function() {
            var a = c.status.get("mxMeetEnableVideo") || {};
            return a[O.get("sessionKey")];
        },
        sendChat: function(a, b) {
            var d = O.toJSON(), e = d.boardId || c.request.page();
            MX.api("/binders/" + e + "/comments", "POST", {
                data: {
                    text: a
                }
            }, function(a) {
                a && a.data ? b && b.success && b.success(a.data) : b && b.error && b.error(), b && b.complete && b.complete();
            });
        },
        inviteToMeet: function(b) {
            var d = [], e = O.toJSON(), f = e.boardId || c.request.page();
            return MX.each(b, function(a) {
                d.push(a.email ? {
                    email: a.email.toLowerCase()
                } : a);
            }), K.log(d), new a.ChainObject(function() {
                MX.api(a.format("/meets/{0}/users", f), "POST", {
                    data: {
                        users: d,
                        session_key: e.sessionKey
                    }
                }, this.callback, this);
            });
        },
        removeInvitation: function(b, d) {
            var e = [], f = O.toJSON(), g = f.boardId || c.request.page();
            return e.push(d ? {
                email: b,
                id: d
            } : {
                email: b
            }), new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}/users", g), "DELETE", {
                    data: {
                        users: e
                    }
                }, this.callback, this);
            });
        },
        saveMeetAsBinder: function(b, c) {
            return new a.ChainObject(function() {
                MX.api("/binders", "POST", {
                    action: "saveFrom",
                    data: {
                        idFromBinder: b,
                        name: c
                    }
                }, this.callback, this);
            });
        },
        publishSwitchPage: function(b) {
            O.setCurrentPage(b);
            var c = O.toJSON();
            return new a.ChainObject(function() {
                c.isMeetPresenter && (K.logServer(f.logFormat("publish switchPage: " + b, {
                    meetId: c.sessionKey,
                    rosterId: c.sessionId
                })), MX.api(a.format("/meets/{0}", c.boardId), "PUT", {
                    action: "page_switch",
                    data: {
                        sequence: b,
                        session_key: c.sessionKey
                    }
                }, this.callback, this));
            });
        },
        publishPageAction: function(b) {
            K.log("publish pageAction params : ", b), 0 === b.currentTime && (b.currentTime = 1e-6);
            var c = O.toJSON(), d = {
                session_key: c.sessionKey,
                currentTime: b.currentTime,
                sequence: b.page_sequence,
                cmd: b.cmd
            };
            return new a.ChainObject(function() {
                c.isMeetPresenter && (K.log("publish pageAction data : ", d), MX.api(a.format("/meets/{0}", c.boardId), "PUT", {
                    action: "page_action",
                    data: d
                }, this.callback, this));
            });
        },
        publishLaserPointer: function(b) {
            var c = O.toJSON();
            return b.session_key = c.sessionKey, new a.ChainObject(function() {
                K.log("publish laserPointer: ", b), MX.api(a.format("/meets/{0}", c.boardId), "PUT", {
                    action: "laser_pointer",
                    data: b
                }, this.callback, this);
            });
        },
        startDS: function() {
            I(d.meet.shareType.screen), r("ds:start");
        },
        stopDS: function() {
            r("ds:stop_presenter");
        },
        startShareFile: function(a) {
            a && (c.request.sequence(a), this.publishSwitchPage(a)), I(d.meet.shareType.file);
        },
        stopShareFile: function() {
            c.request.sequence() && this.setSharingPage(parseInt(c.request.sequence())), this.resetShareType(), 
            this.publishSwitchPage(0);
        },
        setSharingPage: function(a) {
            var b, e = {};
            e[O.get("sessionKey")] = a, c.status.set("mxMeetSharingPage", e), a ? (b = L.get(a), 
            b ? I("ds" === b.get("type") ? d.meet.shareType.screen : d.meet.shareType.file) : this.resetShareType()) : (this.resetShareType(), 
            this.publishSwitchPage(0));
        },
        getSharingPage: function() {
            var a = c.status.get("mxMeetSharingPage") || {};
            return a[O.get("sessionKey")] || 0;
        },
        setShareType: function(a, b) {
            I(a, b);
        },
        resetShareType: function() {
            I(""), c.request.sequence("");
        },
        isSharing: function(a) {
            var b = a || O.get("shareType");
            return [ d.meet.shareType.file, d.meet.shareType.screen ].indexOf(b) > -1;
        },
        createDSPage: function() {
            var b = O.toJSON();
            return new a.ChainObject(function() {
                MX.api(a.format("/meets/{0}", b.boardId), "PUT", {
                    action: "start_share",
                    data: {
                        session_key: b.sessionKey
                    }
                }, this.callback, this);
            });
        },
        destroyDSPage: function(b) {
            var c = O.toJSON();
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}/pages/{1}", c.boardId, b), "DELETE", null, this.callback, this);
            });
        },
        notifyParticipantAdded: function(a) {
            r("notify:roster_added", {
                roster: a
            });
        },
        notifyParticipantRemoved: function(a) {
            r("notify:roster_removed", {
                roster: a
            });
        },
        controlRecording: function(b, c, d) {
            var e = {}, f = O.toJSON(), g = this.getNoteStorage() || {};
            return e.cmd = b, e.session_key = f.sessionKey, "save" === b && c && (e.name = c, 
            e.destination_binder_id = d ? d : g.srcId || ""), new a.ChainObject(function() {
                K.log("recording control ", e), MX.api(a.format("/meets/{0}", f.boardId), "PUT", {
                    action: "recording_control",
                    data: e
                }, this.callback, this);
            });
        },
        setNoteStorage: function(a) {
            c.status.set("mxNote", a);
        },
        setNoteStopped: function(a) {
            var b = this.getNoteStorage();
            b && (b.isStopped = a), this.setNoteStorage(b);
        },
        isNoteStopped: function() {
            var a = this.getNoteStorage();
            return a ? !!a.isStopped : !1;
        },
        getNoteStorage: function() {
            return c.status.get("mxNote");
        },
        setDSAnchorPage: function(a) {
            c.status.set("mxDSAnchorPage", a);
        },
        getDSAnchorPage: function() {
            return c.status.get("mxDSAnchorPage") || 0;
        },
        updateAudioConf: function() {
            r("ac:update");
        },
        updateVideoConf: function() {
            r("av:update");
        },
        updateDSConf: function() {
            r("ds:update");
        },
        updatePeerConf: function() {
            r("peer:update");
        },
        setAppConfig: function(a) {
            O.setAppConfig(a);
        },
        stopApplication: function() {
            r("meet:stop_application");
        }
    };
}), define("text!template/meet/audio.html", [], function() {
    return '<div class="meet-audio-wrap">\n	{{#if voice}}\n		{{#if telephonyJoined}}\n			<span style="opacity: 0.8; cursor: default;">\n				{{#if telephonyMuted}}\n				<i class="mx-branding micon-telephone-muted size20"></i>\n				{{else}}\n				<i class="mx-branding micon-telephone-on size20"></i>\n				{{/if}}\n			</span>\n		{{else}}\n			<span class="dropdown pull-right">\n				<a id="mxMeetVoice" data-toggle="dropdown" data-placement="bottom" class="mx-btn mouse-hand topbar-action {{#unless audioConfigReady}}disabled{{/unless}}">\n					{{#if audioMuted}}\n					<i class="mx-branding micon-mic-muted size20"></i>\n					{{else}}\n					<i class="mx-branding micon-mic size20"></i>\n					{{/if}}\n					<span class="mx-branding caret caret-white marginLeft5"></span>\n				</a>\n				<ul class="dropdown-menu" aria-labelledby="mxMeetVoice">\n		        	<li>\n			        	{{#if audioMuted}}\n			        	<a class="mouse-hand mx-ie-relative" data-action="unmuteSelf">{{lang.unmute}}</a>\n			        	{{else}}\n			        	<a class="mouse-hand mx-ie-relative" data-action="muteSelf">{{lang.mute}}</a>\n			        	{{/if}}\n		        	</li>\n\n					<li class="divider"></li>\n					<li><a class="mouse-hand mx-ie-relative" data-action="configAudio">{{lang.test_audio}}</a></li>\n\n		        	<li class="divider"></li>\n		        	<li><a class="mouse-hand mx-ie-relative" data-action="leaveAudio">{{lang.leave_audio}}</a></li>\n\n		        	<li class="divider"></li>\n					<li>\n						<a class="mouse-hand mx-ie-relative" data-action="showNumbers">\n							<span>{{lang.call_using_phone}}</span>\n						</a>\n					</li>\n		        </ul>\n	       </span>\n		{{/if}}\n	{{else}}\n	<span class="dropdown pull-right">\n		<a id="mxMeetVoice" data-toggle="dropdown" data-placement="bottom" class="mx-btn mouse-hand topbar-action {{#unless audioConfigReady}}disabled{{/unless}}">\n			<i class="mx-branding micon-speaker-disabled size20"></i>\n			<span class="mx-branding caret caret-white marginLeft5"></span>\n		</a>\n		<ul class="dropdown-menu" aria-labelledby="mxMeetVoice">\n\n			<!-- handle plugin window covered web case -->\n			<iframe class="mx-iframe-shim" src="javascript:;" frameborder="0" allowtransparency="true" scrolling="no"></iframe>\n\n			<li>\n				<a class="mouse-hand mx-ie-relative" data-action="joinAudio">\n					<span>{{lang.call_using_computer}}</span>\n				</a>\n			</li>\n			<li class="divider"></li>\n			<li>\n				<a class="mouse-hand mx-ie-relative" data-action="showNumbers">\n					<span>{{lang.call_using_phone}}</span>\n				</a>\n			</li>\n\n		</ul>\n	</span>\n	{{/if}}\n</div>\n';
}), define("text!template/meet/audioVoIP.html", [], function() {
    return '<div class="meet-audio-wrap">\n	{{#if audioJoined}}\n		<span class="dropdown pull-right">\n		{{#if audioMuted}}\n		<a id="mxMeetVoice" data-toggle="dropdown" class="mx-btn mouse-hand topbar-action" title="{{lang.unmute}}" data-placement="bottom"><i class="mx-branding micon-mic-muted size20"></i> <span class="mx-branding caret caret-white"></span></a>\n		{{else}}\n		<a id="mxMeetVoice" data-toggle="dropdown" class="mx-btn mouse-hand topbar-action" title="{{lang.mute}}" data-placement="bottom"><i class="mx-branding micon-mic size20"></i> <span class="mx-branding caret caret-white"></span></a>\n		{{/if}}\n		<ul class="dropdown-menu" aria-labelledby="mxMeetAudio">\n			<li><a class="mouse-hand" data-action="configAudio">{{lang.test_audio}}</a></li>\n			<li class="divider"></li>\n\n			<li><a class="mouse-hand" data-action="leaveAudio">{{lang.leave_audio}}</a></li>\n		</ul>\n		</span>\n	{{else}}\n	<span><a id="mxMeetVoice" class="mx-btn mouse-hand topbar-action disabled" data-action="joinAudio" title="{{lang.enable_voice}}" data-placement="bottom"><i class="mx-branding micon-speaker-disabled size20"></i></a></span>\n	{{/if}}\n</div>';
}), define("text!template/meet/audioTelephony.html", [], function() {
    return '<div class="meet-audio-wrap">\n	<span class="mouse-hand topbar-action" data-action="showNumbers">\n		{{#if telephonyJoined}}\n			{{#if telephonyMuted}}\n			<i class="mx-branding micon-telephone-muted size20"></i>\n			{{else}}\n			<i class="mx-branding micon-telephone-on size20"></i>\n			{{/if}}\n		{{else}}\n		<i class="mx-branding micon-speaker-disabled size20"></i>\n		{{/if}}\n	</span>\n</div>';
}), define("text!template/meet/voice/options.html", [], function() {
    return '<div class="mx-voice-options">\n	<div class="options-note ellipsis">\n		{{#if voip}}\n		<div>{{lang.meet_join_audio_voip_introduction}}</div>\n		{{else}}\n		<div>{{lang.meet_join_audio_introduction}}</div>\n		{{/if}}\n		<div class="orange size12">({{lang.plugin_needed_to_join_audio}})</div>\n	</div>\n	<div class="row">\n		{{#unless voip}}\n		<div class="col-md-6 col-xs-6">\n			<div data-action="showNumbers" class="voice-option option-telephony pull-right">\n				<div class="voice-option-icon">\n					<i class="micon-telephony"></i>\n				</div>\n				<div class="voice-option-text paddingTop5">{{lang.phone}}</div>\n			</div>\n		</div>\n		{{/unless}}\n		<div {{#if voip}}class="col-md-12 col-xs-12"{{else}}class="col-md-6 col-xs-6"{{/if}}>\n			<div data-action="joinAudio" class="voice-option" {{#if voip}}style="margin:0 auto;"{{/if}}>\n				<div class="voice-option-icon">\n					<i class="micon-headphones"></i>\n				</div>\n				<div class="voice-option-text paddingTop5">{{lang.computer}}</div>\n			</div>\n		</div>\n	</div>\n	\n</div>';
}), define("text!template/meet/voice/numbers.html", [], function() {
    return '<div>\n	<div>\n		<div class="color-secondary">1. {{lang.dial}}</div>\n		<ul class="marginLeft15">\n			{{#each numbers}}\n			<li class="row">\n				<div class="col-sm-6">\n					<span class="pull-left">{{location}}</span>\n				</div>\n				<div class="col-sm-6">\n					<span class="pull-right">{{number}}</span>\n				</div>\n			</li>\n			{{/each}}\n		</ul>\n		<br/>\n	</div>\n	<div>\n		<div class="color-secondary">2. {{lang.meet_id}}</div>\n		<div class="marginLeft15">\n			{{sessionKey}} #\n		</div>\n		<br/>\n	</div>\n	<div>\n		<div class="color-secondary">3. {{lang.participant_number}}</div>\n		<div class="marginLeft15">\n			{{participantNumber}} #\n		</div>\n		<br/>\n	</div>\n</div>';
}), define("meet/telephony/numbers", [ "moxtra", "lang", "text!template/meet/voice/numbers.html", "meet/meetBiz", "meet/meetUtil" ], function(a, b, c, d, e) {
    "use strict";
    return a.Controller.extend({
        template: c,
        init: function() {
            this.telephony = d.getTelephonyModel(), this.meet = d.getMeetModel(), this.$scope.lang = b, 
            this.$scope.numbers = this.telephony.get("numbers"), this.$scope.sessionKey = e.formatMeetId(this.meet.get("sessionKey")), 
            this.$scope.participantNumber = this.meet.get("participantNumber");
        },
        rendered: function() {}
    });
}), define("meet/alerts/voiceOptions", [ "moxtra", "lang", "text!template/meet/voice/options.html", "meet/telephony/numbers" ], function(a, b, c, d) {
    "use strict";
    return a.Controller.extend({
        template: c,
        handleAction: !0,
        init: function(a) {
            a = a || {}, this.$scope.lang = b, this.$scope.voip = a.voip, this.onJoinAudio = a.onJoinAudio || function() {};
        },
        rendered: function() {},
        showNumbers: function() {
            if (this.dialog) {
                var a = new d();
                this.dialog.push({
                    width: 320,
                    title: b.call_using_phone,
                    content: a
                }), this.recovery(a);
            }
        },
        joinAudio: function() {
            this.onJoinAudio(), this.dialog && this.dialog.close();
        }
    });
}), define("meet/audio/audio", [ "moxtra", "lang", "app", "const", "text!template/meet/audio.html", "text!template/meet/audioVoIP.html", "text!template/meet/audioTelephony.html", "meet/alerts/voiceOptions", "meet/meetUtil", "meet/connector/util", "meet/meetBiz", "meet/telephony/numbers", "meet/brandingCache" ], function(a, b, c, d, e, f, g, h, i, j, k, l, m) {
    var n = MX.logger("meet:ac:audio"), o = Handlebars.compile(e), p = Handlebars.compile(f), q = Handlebars.compile(g);
    return a.Controller.extend({
        tagName: "div",
        handleAction: !0,
        init: function(a) {
            this.LOADING_TIMEOUT = null, this.model = k.getAudioModel(), this.meetModel = k.getMeetModel(), 
            this.participants = k.getParticipantList(), this.sessionKey = a.profile.sessionKey, 
            this.sessionId = this.meetModel.get("sessionId"), this.isInvisible = a.profile.isInvisible, 
            this.enableVoip = !m.getBoolTag(d.meet.tags.hideAudioVoip), this.enableTelephony = !m.getBoolTag(d.meet.tags.hideAudioTelephony), 
            this.enableAutoJoinAudio = m.getBoolTag(d.meet.tags.autoJoinAudio), this.model.once("change:audioConf", this.onAudioConfReady, this), 
            this.isInvisible, this.model.on("change:uiEnabled change:uiMuted change:telephonyJoined change:telephonyMuted", this.onStatusChanged, this), 
            this.model.on("change:telephonyJoined", this.onPhoneJoined, this), this.model.on("change:left", this.onLeft, this), 
            this.model.on("change:notify", this.notify, this), this.model.on("change:cmdMute", this.cmdMute, this), 
            this.model.on("change:actionDone", this.actionDone, this), this.model.on("change:serverAddr", this.updateConf, this);
            var b = this;
            this.recovery(function() {
                b.model && b.model.off();
            });
        },
        rendered: function() {
            this.$el.empty(), this.$el.append(this.isInvisible ? $(p({
                lang: b
            })) : this.enableVoip && this.enableTelephony ? $(o({
                lang: b
            })) : this.enableVoip ? $(p({
                lang: b
            })) : $(q({
                lang: b
            }))), this.$("a[title]").tooltip(), this.recovery(function() {
                k.setAudioStatus();
            });
        },
        onAudioConfReady: function() {
            var a = this;
            $("#mxMeetVoice").removeClass("disabled"), this.audioConfReady = !0, setTimeout(function() {
                var b = k.getAudioStatus();
                b ? (a.model.set({
                    isEnabled: !!b.enabled,
                    isMuted: !!b.muted
                }), b.enabled ? a._enableAudio() : a.isInvisible || (a.enableAutoJoinAudio ? a.enableVoip ? a.enableAudio() : a.showNumbers() : a.enableVoip && a.enableTelephony ? a.showVoiceOptions() : a.enableVoip ? a.enableAudio(!0) : a.showNumbers())) : a.isInvisible || (a.enableAutoJoinAudio ? a.enableVoip ? a.enableAudio() : a.showNumbers() : a.enableVoip && a.enableTelephony ? a.showVoiceOptions() : a.enableVoip ? a.enableAudio(!0) : a.showNumbers());
            }, 500);
        },
        showVoiceOptions: function(a) {
            var c, d = this;
            c = new h({
                voip: a,
                onJoinAudio: function() {
                    d.joinAudio();
                }
            }), this.recovery(c);
            var e = new MX.ui.Dialog({
                width: 360,
                title: b.join_audio,
                iframeShim: !0,
                content: c
            });
            d.recovery(function() {
                try {
                    e.close();
                } catch (a) {
                    console.error(a);
                }
            });
        },
        enableAudio: function(a) {
            var c = this;
            if (!i.isBrowserSupported()) return void MX.ui.notifyWarning(b.audio_msg_ie_supported);
            if (MX.env.isEdge) return void MX.ui.notifyWarning(b.edge_browser_not_supported);
            if (a === !0) {
                if (MX.env.isIE && !j.isActiveXSupported()) return;
                n.logServer(i.logFormat("[Show] Enable_Voice dialog ", {
                    meetId: this.sessionKey,
                    rosterId: this.sessionId
                })), c.showVoiceOptions(!0);
            } else this._enableAudio();
        },
        _enableAudio: function() {
            this.loading(), this.$("#mxMeetVoice").addClass("disabled"), n.logServer(i.logFormat("[action] try to enable audio ", {
                meetId: this.sessionKey,
                rosterId: this.sessionId
            })), k.joinAudio();
        },
        joinAudio: function() {
            return i.isOsSupported() ? i.isBrowserSupported() ? MX.env.isEdge ? void MX.ui.notifyWarning(b.edge_browser_not_supported) : void ((!MX.env.isIE || j.isActiveXSupported()) && this._enableAudio()) : void MX.ui.notifyWarning(b.audio_msg_ie_supported) : (MX.ui.notifyWarning(b.meet_application_os_supported), 
            void this.loading(!1));
        },
        muteSelf: function() {
            this.loading(), this.$("#mxMeetVoice").addClass("disabled"), n.logServer(i.logFormat('[User Action] click "Mute" ', {
                meetId: this.sessionKey,
                rosterId: this.sessionId
            })), n.logServer(i.logFormat("[action] try to mute audio ", {
                meetId: this.sessionKey,
                rosterId: this.sessionId
            })), k.muteAudio();
        },
        unmuteSelf: function() {
            this.loading(), this.$("#mxMeetVoice").addClass("disabled"), n.logServer(i.logFormat('[User Action] click "Unmute" ', {
                meetId: this.sessionKey,
                rosterId: this.sessionId
            })), n.logServer(i.logFormat("[action] try to unmute audio ", {
                meetId: this.sessionKey,
                rosterId: this.sessionId
            })), k.unmuteAudio();
        },
        leaveAudio: function() {
            this.loading(), this.$("#mxMeetVoice").addClass("disabled"), n.logServer(i.logFormat('[User Action] click "Leave Audio" ', {
                meetId: this.sessionKey,
                rosterId: this.sessionId
            })), n.logServer(i.logFormat("[action] try to leave audio ", {
                meetId: this.sessionKey,
                rosterId: this.sessionId
            })), k.leaveAudio();
        },
        configAudio: function() {
            k.configAudio();
        },
        cmdMute: function() {
            n.logServer(i.logFormat('[Command Action] command "Mute" ', {
                meetId: this.sessionKey,
                rosterId: this.sessionId
            })), n.logServer(i.logFormat("[action] try to mute audio ", {
                meetId: this.sessionKey,
                rosterId: this.sessionId
            })), k.muteAudio(!0);
        },
        onStatusChanged: function(a) {
            this._update(a), this._changeIconInParticipants(a), k.setAudioStatus({
                enabled: a.get("isEnabled"),
                muted: a.get("isMuted")
            });
        },
        _changeIconInParticipants: function(a) {
            var b, c = a.toJSON();
            for (b in this.participants.models) if (this.participants.models[b].get("id") === this.sessionId) {
                this.participants.models[b].set({
                    isAudioEnabled: c.isEnabled,
                    isAudioMuted: c.isMuted
                });
                break;
            }
        },
        _update: function(a) {
            var c = a.toJSON();
            this.$el.empty(), this.$el.append(this.isInvisible ? p({
                lang: b,
                audioJoined: c.uiEnabled,
                audioMuted: c.uiMuted
            }) : this.enableVoip && this.enableTelephony ? $(o({
                lang: b,
                production: !1,
                audioConfigReady: this.audioConfReady,
                sessionId: c.id,
                voice: c.uiEnabled || c.telephonyJoined,
                telephonyJoined: c.telephonyJoined,
                telephonyMuted: c.telephonyMuted,
                audioJoined: c.uiEnabled,
                audioMuted: c.uiMuted
            })) : this.enableVoip ? p({
                lang: b,
                audioJoined: c.uiEnabled,
                audioMuted: c.uiMuted
            }) : q({
                lang: b,
                telephonyJoined: c.telephonyJoined,
                telephonyMuted: c.telephonyMuted
            }));
        },
        onLeft: function() {
            this.model.set({
                isEnabled: !1,
                isMuted: !1,
                uiEnabled: !1,
                uiMuted: !1
            }, {
                silent: !0
            }), k.setAudioStatus({
                enabled: !1,
                muted: !1
            });
        },
        notify: function(a) {
            var c = a.toJSON();
            c.isEnabled && MX.ui.notifyInfo(c.isMuted ? b.muted : b.unmuted);
        },
        actionDone: function() {
            this.loading(!1);
        },
        updateConf: function(a) {
            a.get("isEnabled") && k.updateAudioConf();
        },
        loading: function(a) {
            if (MX.isUndefined(a) || a) {
                n.log("show loading"), this.$el.loading({
                    length: 2,
                    radius: 5,
                    left: 0,
                    top: 0,
                    width: 3
                });
                var b = this;
                this.LOADING_TIMEOUT = setTimeout(function() {
                    n.log("hide loading as timeout"), b.$el.loading(!1), b.$("#mxMeetVoice").removeClass("disabled");
                }, 1e4);
            } else n.log("hide loading"), this.$el.loading(!1), clearTimeout(this.LOADING_TIMEOUT), 
            this.$("#mxMeetVoice").removeClass("disabled");
        },
        muteTelephone: function(a) {
            k.muteSingle(a, !0);
        },
        unmuteTelephone: function(a) {
            k.unmuteSingle(a, !0);
        },
        showNumbers: function() {
            var a = new l();
            this.recovery(a), new MX.ui.Dialog({
                title: b.call_using_phone,
                width: 320,
                iframeShim: !0,
                content: a
            });
        },
        onAudioEnabled: function() {
            k.muteAudio();
        },
        onPhoneJoined: function(a) {
            a.get("telephonyJoined") && ($(".mx-meet-voice-alert .warning-tip").addClass("hide"), 
            a.get("isEnabled") && k.leaveAudio());
        },
        stopListen: function() {
            this.stopListening(), this.model && this.model.off("change");
        }
    });
}), define("text!template/meet/video.html", [], function() {
    return '{{#if isIntegrationVideo}}\n<div class="meet-video-wrap {{#if popupVideo}}{{#if enabled}}popup-video{{/if}}{{/if}}">\n	{{#if enabled}}\n\n		{{#if popupVideo}}\n		<a class="mouse-hand mx-branding topbar-action" data-action="openVideo">\n			<div class="progress-video-icon">\n				{{#if broadcasted}}\n				<i class="mx-branding micon-video size20"></i>\n				{{else}}\n				<i class="mx-branding micon-video-disabled size20"></i>\n				{{/if}}\n			</div>\n			<div class="hidden-xs-inline">\n				<span class="progress-video-title ellipsis mouse-hand">{{lang.video_in_progress}}</span>\n			</div>\n		</a>\n		{{/if}}\n\n		<span class="dropdown pull-right">\n			<a id="mxMeetVideo" data-toggle="dropdown" data-placement="bottom" class="mx-btn mouse-hand topbar-action">\n				{{#unless popupVideo}}\n				{{#if broadcasted}}\n				<i class="mx-branding micon-video size20"></i>\n				{{else}}\n				<i class="mx-branding micon-video-disabled size20"></i>\n				{{/if}}\n				{{/unless}}\n				<span class="mx-branding caret caret-white marginLeft5"></span>\n			</a>\n			<ul class="dropdown-menu" aria-labelledby="mxMeetVideo">\n\n				<!-- handle plugin window covered web case -->\n				<iframe class="mx-iframe-shim" src="javascript:;" frameborder="0" allowtransparency="true" scrolling="no"></iframe>\n\n				<li>\n					{{#if broadcasted}}\n					<a class="mouse-hand mx-ie-relative" data-action="cameraOff">\n						<span>{{lang.turn_off_camera}}</span>\n					</a>\n					{{else}}\n					<a class="mouse-hand mx-ie-relative" data-action="cameraOn">\n						<span>{{lang.turn_on_camera}}</span>\n					</a>\n					{{/if}}\n				</li>\n				<li class="divider"></li>\n				<li>\n					<a class="mouse-hand mx-ie-relative" data-action="configVideo">\n						<span>{{lang.video_options}}</span>\n					</a>\n				</li>\n			</ul>\n		</span>\n	{{else}}\n	<a id="mxMeetVideoOff" class="mouse-hand topbar-action {{#unless confReady}}disabled{{/unless}}" data-action="openVideo"><i class="mx-branding micon-video-empty size20" title="{{lang.turn_on_camera}}" data-placement="bottom"></i></a>\n	{{/if}}\n</div>\n{{/if}}\n\n';
}), !function(a) {
    function b(a) {
        return new RegExp("(^|\\s+)" + a + "(\\s+|$)");
    }
    function c(a, b) {
        var c = d(a, b) ? f : e;
        c(a, b);
    }
    var d, e, f;
    "classList" in document.documentElement ? (d = function(a, b) {
        return a.classList.contains(b);
    }, e = function(a, b) {
        a.classList.add(b);
    }, f = function(a, b) {
        a.classList.remove(b);
    }) : (d = function(a, c) {
        return b(c).test(a.className);
    }, e = function(a, b) {
        d(a, b) || (a.className = a.className + " " + b);
    }, f = function(a, c) {
        a.className = a.className.replace(b(c), " ");
    });
    var g = {
        hasClass: d,
        addClass: e,
        removeClass: f,
        toggleClass: c,
        has: d,
        add: e,
        remove: f,
        toggle: c
    };
    "function" == typeof define && define.amd ? define("classie/classie", g) : a.classie = g;
}(window), function() {
    function a() {}
    function b(a, b) {
        for (var c = a.length; c--; ) if (a[c].listener === b) return c;
        return -1;
    }
    function c(a) {
        return function() {
            return this[a].apply(this, arguments);
        };
    }
    var d = a.prototype;
    d.getListeners = function(a) {
        var b, c, d = this._getEvents();
        if ("object" == typeof a) {
            b = {};
            for (c in d) d.hasOwnProperty(c) && a.test(c) && (b[c] = d[c]);
        } else b = d[a] || (d[a] = []);
        return b;
    }, d.flattenListeners = function(a) {
        var b, c = [];
        for (b = 0; b < a.length; b += 1) c.push(a[b].listener);
        return c;
    }, d.getListenersAsObject = function(a) {
        var b, c = this.getListeners(a);
        return c instanceof Array && (b = {}, b[a] = c), b || c;
    }, d.addListener = function(a, c) {
        var d, e = this.getListenersAsObject(a), f = "object" == typeof c;
        for (d in e) e.hasOwnProperty(d) && -1 === b(e[d], c) && e[d].push(f ? c : {
            listener: c,
            once: !1
        });
        return this;
    }, d.on = c("addListener"), d.addOnceListener = function(a, b) {
        return this.addListener(a, {
            listener: b,
            once: !0
        });
    }, d.once = c("addOnceListener"), d.defineEvent = function(a) {
        return this.getListeners(a), this;
    }, d.defineEvents = function(a) {
        for (var b = 0; b < a.length; b += 1) this.defineEvent(a[b]);
        return this;
    }, d.removeListener = function(a, c) {
        var d, e, f = this.getListenersAsObject(a);
        for (e in f) f.hasOwnProperty(e) && (d = b(f[e], c), -1 !== d && f[e].splice(d, 1));
        return this;
    }, d.off = c("removeListener"), d.addListeners = function(a, b) {
        return this.manipulateListeners(!1, a, b);
    }, d.removeListeners = function(a, b) {
        return this.manipulateListeners(!0, a, b);
    }, d.manipulateListeners = function(a, b, c) {
        var d, e, f = a ? this.removeListener : this.addListener, g = a ? this.removeListeners : this.addListeners;
        if ("object" != typeof b || b instanceof RegExp) for (d = c.length; d--; ) f.call(this, b, c[d]); else for (d in b) b.hasOwnProperty(d) && (e = b[d]) && ("function" == typeof e ? f.call(this, d, e) : g.call(this, d, e));
        return this;
    }, d.removeEvent = function(a) {
        var b, c = typeof a, d = this._getEvents();
        if ("string" === c) delete d[a]; else if ("object" === c) for (b in d) d.hasOwnProperty(b) && a.test(b) && delete d[b]; else delete this._events;
        return this;
    }, d.emitEvent = function(a, b) {
        var c, d, e, f, g = this.getListenersAsObject(a);
        for (e in g) if (g.hasOwnProperty(e)) for (d = g[e].length; d--; ) c = g[e][d], 
        f = c.listener.apply(this, b || []), (f === this._getOnceReturnValue() || c.once === !0) && this.removeListener(a, c.listener);
        return this;
    }, d.trigger = c("emitEvent"), d.emit = function(a) {
        var b = Array.prototype.slice.call(arguments, 1);
        return this.emitEvent(a, b);
    }, d.setOnceReturnValue = function(a) {
        return this._onceReturnValue = a, this;
    }, d._getOnceReturnValue = function() {
        return this.hasOwnProperty("_onceReturnValue") ? this._onceReturnValue : !0;
    }, d._getEvents = function() {
        return this._events || (this._events = {});
    }, "function" == typeof define && define.amd ? define("eventEmitter/EventEmitter", [], function() {
        return a;
    }) : "object" == typeof module && module.exports ? module.exports = a : this.EventEmitter = a;
}.call(this), function(a) {
    var b = document.documentElement, c = function() {};
    b.addEventListener ? c = function(a, b, c) {
        a.addEventListener(b, c, !1);
    } : b.attachEvent && (c = function(b, c, d) {
        b[c + d] = d.handleEvent ? function() {
            var b = a.event;
            b.target = b.target || b.srcElement, d.handleEvent.call(d, b);
        } : function() {
            var c = a.event;
            c.target = c.target || c.srcElement, d.call(b, c);
        }, b.attachEvent("on" + c, b[c + d]);
    });
    var d = function() {};
    b.removeEventListener ? d = function(a, b, c) {
        a.removeEventListener(b, c, !1);
    } : b.detachEvent && (d = function(a, b, c) {
        a.detachEvent("on" + b, a[b + c]);
        try {
            delete a[b + c];
        } catch (d) {
            a[b + c] = void 0;
        }
    });
    var e = {
        bind: c,
        unbind: d
    };
    "function" == typeof define && define.amd ? define("eventie/eventie", e) : a.eventie = e;
}(this), function(a) {
    function b(a) {
        if (a) {
            if ("string" == typeof d[a]) return a;
            a = a.charAt(0).toUpperCase() + a.slice(1);
            for (var b, e = 0, f = c.length; f > e; e++) if (b = c[e] + a, "string" == typeof d[b]) return b;
        }
    }
    var c = "Webkit Moz ms Ms O".split(" "), d = document.documentElement.style;
    "function" == typeof define && define.amd ? define("get-style-property/get-style-property", [], function() {
        return b;
    }) : a.getStyleProperty = b;
}(window), function(a) {
    function b(a) {
        var b = parseFloat(a), c = -1 === a.indexOf("%") && !isNaN(b);
        return c && b;
    }
    function c() {
        for (var a = {
            width: 0,
            height: 0,
            innerWidth: 0,
            innerHeight: 0,
            outerWidth: 0,
            outerHeight: 0
        }, b = 0, c = g.length; c > b; b++) {
            var d = g[b];
            a[d] = 0;
        }
        return a;
    }
    function d(a) {
        function d(a) {
            if ("string" == typeof a && (a = document.querySelector(a)), a && "object" == typeof a && a.nodeType) {
                var d = f(a);
                if ("none" === d.display) return c();
                var i = {};
                i.width = a.offsetWidth, i.height = a.offsetHeight;
                for (var j = i.isBorderBox = !(!h || !d[h] || "border-box" !== d[h]), k = 0, l = g.length; l > k; k++) {
                    var m = g[k], n = d[m], o = parseFloat(n);
                    i[m] = isNaN(o) ? 0 : o;
                }
                var p = i.paddingLeft + i.paddingRight, q = i.paddingTop + i.paddingBottom, r = i.marginLeft + i.marginRight, s = i.marginTop + i.marginBottom, t = i.borderLeftWidth + i.borderRightWidth, u = i.borderTopWidth + i.borderBottomWidth, v = j && e, w = b(d.width);
                w !== !1 && (i.width = w + (v ? 0 : p + t));
                var x = b(d.height);
                return x !== !1 && (i.height = x + (v ? 0 : q + u)), i.innerWidth = i.width - (p + t), 
                i.innerHeight = i.height - (q + u), i.outerWidth = i.width + r, i.outerHeight = i.height + s, 
                i;
            }
        }
        var e, h = a("boxSizing");
        return function() {
            if (h) {
                var a = document.createElement("div");
                a.style.width = "200px", a.style.padding = "1px 2px 3px 4px", a.style.borderStyle = "solid", 
                a.style.borderWidth = "1px 2px 3px 4px", a.style[h] = "border-box";
                var c = document.body || document.documentElement;
                c.appendChild(a);
                var d = f(a);
                e = 200 === b(d.width), c.removeChild(a);
            }
        }(), d;
    }
    var e = document.defaultView, f = e && e.getComputedStyle ? function(a) {
        return e.getComputedStyle(a, null);
    } : function(a) {
        return a.currentStyle;
    }, g = [ "paddingLeft", "paddingRight", "paddingTop", "paddingBottom", "marginLeft", "marginRight", "marginTop", "marginBottom", "borderLeftWidth", "borderRightWidth", "borderTopWidth", "borderBottomWidth" ];
    "function" == typeof define && define.amd ? define("get-size/get-size", [ "get-style-property/get-style-property" ], d) : a.getSize = d(a.getStyleProperty);
}(window), function(a) {
    function b(a, b) {
        for (var c in b) a[c] = b[c];
        return a;
    }
    function c() {}
    function d(d, e, g, j, k) {
        function m(a, c) {
            this.element = "string" == typeof a ? f.querySelector(a) : a, this.options = b({}, this.options), 
            b(this.options, c), this._create();
        }
        function n() {
            return !1;
        }
        function o(a, b) {
            a.x = void 0 !== b.pageX ? b.pageX : b.clientX, a.y = void 0 !== b.pageY ? b.pageY : b.clientY;
        }
        function p(a, b, c) {
            return c = c || "round", b ? Math[c](a / b) * b : a;
        }
        var q = j("transform"), r = !!j("perspective");
        b(m.prototype, e.prototype), m.prototype.options = {}, m.prototype._create = function() {
            this.position = {}, this._getPosition(), this.startPoint = {
                x: 0,
                y: 0
            }, this.dragPoint = {
                x: 0,
                y: 0
            }, this.startPosition = b({}, this.position);
            var a = h(this.element);
            "relative" !== a.position && "absolute" !== a.position && (this.element.style.position = "relative"), 
            this.enable(), this.setHandles();
        }, m.prototype.setHandles = function() {
            this.handles = this.options.handle ? this.element.querySelectorAll(this.options.handle) : [ this.element ];
            for (var b = 0, c = this.handles.length; c > b; b++) {
                var d = this.handles[b];
                a.navigator.pointerEnabled ? (g.bind(d, "pointerdown", this), d.style.touchAction = "none") : a.navigator.msPointerEnabled ? (g.bind(d, "MSPointerDown", this), 
                d.style.msTouchAction = "none") : (g.bind(d, "mousedown", this), g.bind(d, "touchstart", this), 
                t(d));
            }
        };
        var s = "attachEvent" in f.documentElement, t = s ? function(a) {
            "IMG" === a.nodeName && (a.ondragstart = n);
            for (var b = a.querySelectorAll("img"), c = 0, d = b.length; d > c; c++) {
                var e = b[c];
                e.ondragstart = n;
            }
        } : c;
        m.prototype._getPosition = function() {
            var a = h(this.element), b = parseInt(a.left, 10), c = parseInt(a.top, 10);
            this.position.x = isNaN(b) ? 0 : b, this.position.y = isNaN(c) ? 0 : c, this._addTransformPosition(a);
        }, m.prototype._addTransformPosition = function(a) {
            if (q) {
                var b = a[q];
                if (0 === b.indexOf("matrix")) {
                    var c = b.split(","), d = 0 === b.indexOf("matrix3d") ? 12 : 4, e = parseInt(c[d], 10), f = parseInt(c[d + 1], 10);
                    this.position.x += e, this.position.y += f;
                }
            }
        }, m.prototype.handleEvent = function(a) {
            var b = "on" + a.type;
            this[b] && this[b](a);
        }, m.prototype.getTouch = function(a) {
            for (var b = 0, c = a.length; c > b; b++) {
                var d = a[b];
                if (d.identifier === this.pointerIdentifier) return d;
            }
        }, m.prototype.onmousedown = function(a) {
            var b = a.button;
            b && 0 !== b && 1 !== b || this.dragStart(a, a);
        }, m.prototype.ontouchstart = function(a) {
            this.isDragging || this.dragStart(a, a.changedTouches[0]);
        }, m.prototype.onMSPointerDown = m.prototype.onpointerdown = function(a) {
            this.isDragging || this.dragStart(a, a);
        };
        var u = {
            mousedown: [ "mousemove", "mouseup" ],
            touchstart: [ "touchmove", "touchend", "touchcancel" ],
            pointerdown: [ "pointermove", "pointerup", "pointercancel" ],
            MSPointerDown: [ "MSPointerMove", "MSPointerUp", "MSPointerCancel" ]
        };
        m.prototype.dragStart = function(b, c) {
            this.isEnabled && (b.preventDefault ? b.preventDefault() : b.returnValue = !1, this.pointerIdentifier = void 0 !== c.pointerId ? c.pointerId : c.identifier, 
            this._getPosition(), this.measureContainment(), o(this.startPoint, c), this.startPosition.x = this.position.x, 
            this.startPosition.y = this.position.y, this.setLeftTop(), this.dragPoint.x = 0, 
            this.dragPoint.y = 0, this._bindEvents({
                events: u[b.type],
                node: b.preventDefault ? a : f
            }), d.add(this.element, "is-dragging"), this.isDragging = !0, this.emitEvent("dragStart", [ this, b, c ]), 
            this.animate());
        }, m.prototype._bindEvents = function(a) {
            for (var b = 0, c = a.events.length; c > b; b++) {
                var d = a.events[b];
                g.bind(a.node, d, this);
            }
            this._boundEvents = a;
        }, m.prototype._unbindEvents = function() {
            var a = this._boundEvents;
            if (a && a.events) {
                for (var b = 0, c = a.events.length; c > b; b++) {
                    var d = a.events[b];
                    g.unbind(a.node, d, this);
                }
                delete this._boundEvents;
            }
        }, m.prototype.measureContainment = function() {
            var a = this.options.containment;
            if (a) {
                this.size = k(this.element);
                var b = this.element.getBoundingClientRect(), c = i(a) ? a : "string" == typeof a ? f.querySelector(a) : this.element.parentNode;
                this.containerSize = k(c);
                var d = c.getBoundingClientRect();
                this.relativeStartPosition = {
                    x: b.left - d.left,
                    y: b.top - d.top
                };
            }
        }, m.prototype.onmousemove = function(a) {
            this.dragMove(a, a);
        }, m.prototype.onMSPointerMove = m.prototype.onpointermove = function(a) {
            a.pointerId === this.pointerIdentifier && this.dragMove(a, a);
        }, m.prototype.ontouchmove = function(a) {
            var b = this.getTouch(a.changedTouches);
            b && this.dragMove(a, b);
        }, m.prototype.dragMove = function(a, b) {
            o(this.dragPoint, b);
            var c = this.dragPoint.x - this.startPoint.x, d = this.dragPoint.y - this.startPoint.y, e = this.options.grid, f = e && e[0], g = e && e[1];
            c = p(c, f), d = p(d, g), c = this.containDrag("x", c, f), d = this.containDrag("y", d, g), 
            c = "y" === this.options.axis ? 0 : c, d = "x" === this.options.axis ? 0 : d, this.position.x = this.startPosition.x + c, 
            this.position.y = this.startPosition.y + d, this.dragPoint.x = c, this.dragPoint.y = d, 
            this.emitEvent("dragMove", [ this, a, b ]);
        }, m.prototype.containDrag = function(a, b, c) {
            if (!this.options.containment) return b;
            var d = "x" === a ? "width" : "height", e = this.relativeStartPosition[a], f = p(-e, c, "ceil"), g = this.containerSize[d] - e - this.size[d];
            return g = p(g, c, "floor"), Math.min(g, Math.max(f, b));
        }, m.prototype.onmouseup = function(a) {
            this.dragEnd(a, a);
        }, m.prototype.onMSPointerUp = m.prototype.onpointerup = function(a) {
            a.pointerId === this.pointerIdentifier && this.dragEnd(a, a);
        }, m.prototype.ontouchend = function(a) {
            var b = this.getTouch(a.changedTouches);
            b && this.dragEnd(a, b);
        }, m.prototype.dragEnd = function(a, b) {
            this.isDragging = !1, delete this.pointerIdentifier, q && (this.element.style[q] = "", 
            this.setLeftTop()), this._unbindEvents(), d.remove(this.element, "is-dragging"), 
            this.emitEvent("dragEnd", [ this, a, b ]);
        }, m.prototype.onMSPointerCancel = m.prototype.onpointercancel = function(a) {
            a.pointerId === this.pointerIdentifier && this.dragEnd(a, a);
        }, m.prototype.ontouchcancel = function(a) {
            var b = this.getTouch(a.changedTouches);
            this.dragEnd(a, b);
        }, m.prototype.animate = function() {
            if (this.isDragging) {
                this.positionDrag();
                var a = this;
                l(function() {
                    a.animate();
                });
            }
        };
        var v = r ? function(a, b) {
            return "translate3d( " + a + "px, " + b + "px, 0)";
        } : function(a, b) {
            return "translate( " + a + "px, " + b + "px)";
        };
        return m.prototype.setLeftTop = function() {
            this.element.style.left = this.position.x + "px", this.element.style.top = this.position.y + "px";
        }, m.prototype.positionDrag = q ? function() {
            this.element.style[q] = v(this.dragPoint.x, this.dragPoint.y);
        } : m.prototype.setLeftTop, m.prototype.enable = function() {
            this.isEnabled = !0;
        }, m.prototype.disable = function() {
            this.isEnabled = !1, this.isDragging && this.dragEnd();
        }, m;
    }
    for (var e, f = a.document, g = f.defaultView, h = g && g.getComputedStyle ? function(a) {
        return g.getComputedStyle(a, null);
    } : function(a) {
        return a.currentStyle;
    }, i = "object" == typeof HTMLElement ? function(a) {
        return a instanceof HTMLElement;
    } : function(a) {
        return a && "object" == typeof a && 1 === a.nodeType && "string" == typeof a.nodeName;
    }, j = 0, k = "webkit moz ms o".split(" "), l = a.requestAnimationFrame, m = a.cancelAnimationFrame, n = 0; n < k.length && (!l || !m); n++) e = k[n], 
    l = l || a[e + "RequestAnimationFrame"], m = m || a[e + "CancelAnimationFrame"] || a[e + "CancelRequestAnimationFrame"];
    l && m || (l = function(b) {
        var c = new Date().getTime(), d = Math.max(0, 16 - (c - j)), e = a.setTimeout(function() {
            b(c + d);
        }, d);
        return j = c + d, e;
    }, m = function(b) {
        a.clearTimeout(b);
    }), "function" == typeof define && define.amd ? define("draggabilly", [ "classie/classie", "eventEmitter/EventEmitter", "eventie/eventie", "get-style-property/get-style-property", "get-size/get-size" ], d) : a.Draggabilly = d(a.classie, a.EventEmitter, a.eventie, a.getStyleProperty, a.getSize);
}(window), define("meet/video/video", [ "moxtra", "lang", "app", "const", "text!template/meet/video.html", "meet/meetBiz", "meet/meetUtil", "draggabilly" ], function(a, b, c, d, e, f, g, h) {
    var i = Handlebars.compile(e);
    return a.Controller.extend({
        tagName: "div",
        handleAction: !0,
        init: function() {
            this.model = f.getVideoModel(), this.audioModel = f.getAudioModel(), this.pages = f.getPageList(), 
            this.meetModel = f.getMeetModel(), this.audioModel.once("change:audioConf", this.onConfReady, this), 
            MX.env.isEdge || (this.model.on("change:isJoined change:isBroadcast", this.videoChanged, this), 
            this.model.on("change:cmdJoin", this.cmdJoin, this), this.model.on("change:cmdCheck", this.checkVideo, this), 
            this.model.on("change:serverAddr", this.updateConf, this), this._isChrome42() || c.isIntegrationVideo() && (this.model.on("change:isJoined", this._onJoined, this), 
            this.listenTo(this.pages, "add", this._updateLayout), this.listenTo(this.pages, "remove", this._updateLayout), 
            this.listenTo(this.pages, "complete", this._updateLayout), this.meetModel.on("change:shareType", this._updateLayout, this))), 
            this._confReady = !1;
            var a = this;
            a.recovery(function() {
                a.model && a.model.off();
            });
        },
        rendered: function() {
            this.$el.empty(), this.$el.append($(i({
                lang: b,
                confReady: this._confReady,
                popupVideo: this._isChrome42(),
                isIntegrationVideo: c.isIntegrationVideo()
            }))), this.recovery(function() {
                f.setVideoStatus();
            });
        },
        onConfReady: function() {
            this._confReady = !0, this.$("#mxMeetVideoOff").removeClass("disabled");
        },
        videoChanged: function(a) {
            this.$el.empty();
            var d = a.toJSON();
            this.$el.append($(i({
                lang: b,
                enabled: d.isJoined,
                broadcasted: d.isBroadcast,
                confReady: this._confReady,
                popupVideo: this._isChrome42(),
                isIntegrationVideo: c.isIntegrationVideo()
            }))), f.setVideoStatus({
                enabled: a.get("isJoined"),
                broadcast: a.get("isBroadcast")
            });
        },
        cmdJoin: function() {
            g.isOsSupported() && c.isIntegrationVideo() && f.joinVideo(!1, {
                quality: this._getQuality(),
                audiobutton: !1
            });
        },
        updateConf: function() {
            c.isIntegrationVideo() && f.updateVideoConf();
        },
        openVideo: function() {
            return g.isOsSupported() ? MX.env.isEdge ? void MX.ui.notifyWarning(b.edge_browser_not_supported) : void f.joinVideo(!0, {
                quality: this._getQuality(),
                audiobutton: !1
            }) : void MX.ui.notifyWarning(b.meet_application_os_supported);
        },
        checkVideo: function(a) {
            if (g.isOsSupported()) {
                var b = a.toJSON(), c = 0;
                if (MX.each(_.values(b.cameras), function(a) {
                    c += a;
                }), 0 === c && b.isJoined) this.closeVideo(); else if (!this._checkedRefresh && (this._checkedRefresh = !0, 
                0 === b.cmdJoin)) {
                    var d = f.getVideoStatus();
                    d && d.enabled && f.joinVideo(!!d.broadcast, {
                        quality: this._getQuality(),
                        audiobutton: !1
                    });
                }
            }
        },
        closeVideo: function() {
            f.leaveVideo(!1);
        },
        cameraOff: function() {
            f.cameraOff();
        },
        cameraOn: function() {
            f.cameraOn();
        },
        configVideo: function() {
            f.configVideo();
        },
        isVideoOpened: function() {
            return this.model.get("isJoined");
        },
        _onJoined: function() {
            if (this.model.get("isJoined")) {
                if (this.trigger("opened"), !this.draggabilly) {
                    var a = document.querySelector("#mxApplicationContainer"), b = a.querySelector("#mxApplicationWrap"), c = {
                        containment: !0,
                        handle: ".handle"
                    }, d = this;
                    d.draggabilly = new h(b, c), $("#mxApplicationWrap").on("mouseover", function() {
                        d.dragMode && $("#mxApplicationWrap .handle").removeClass("hide");
                    }).on("mouseout", function() {
                        d.dragMode && $("#mxApplicationWrap .handle").addClass("hide");
                    }), $(window).on("resize.mxVideoWindow", function() {
                        if (d.dragMode) {
                            var a = $(".mx-viewer-wrap"), b = $("#mxApplicationWrap"), c = a.width(), e = a.height(), f = 28, g = b.width(), h = b.height(), i = b.offset().top, j = b.offset().left, k = {};
                            h + f + i > e && (k.top = i - (h + f + i - e), k.top < 0 && (k.top = 0)), g + j > c && (k.left = j - (g + j - c), 
                            k.left < 0 && (k.left = 0)), b.css(k);
                        }
                    }), d.recovery(function() {
                        $(window).off("resize.mxVideoWindow");
                    });
                }
            } else this.trigger("closed");
            this._updateLayout();
        },
        _updateLayout: function() {
            var a = $("#mxApplicationWrap"), b = $("#mxApplicationWrap .handle"), c = $("#mxApplicationContainer"), e = {
                width: "300px",
                height: "200px",
                position: "absolute",
                "pointer-events": "auto",
                "padding-top": "30px",
                top: Math.abs(c.height() - 200),
                left: Math.abs(c.width() - 300),
                bottom: 0
            };
            if (this.dragMode && f.isSharing() || a.removeAttr("style"), !this.model.get("isJoined")) return b.addClass("hide"), 
            a.css({
                width: "0px",
                height: "0px"
            }), f.setVideoLayout(d.video.layout.normal), void (this.dragMode = !1);
            this.meetModel.get("shareType");
            this.pages.length && f.isSharing() ? this.dragMode || (a.css(e), f.setVideoLayout(d.video.layout.presenting), 
            this.dragMode = !0) : (b.addClass("hide"), a.css({
                width: "100%",
                height: "100%"
            }), f.setVideoLayout(d.video.layout.normal), this.dragMode = !1);
        },
        _isChrome42: function() {
            return MX.env.isChrome && MX.env.browserVersion >= 42 ? !0 : !1;
        },
        _getQuality: function() {
            var a = this.meetModel.get("appConfig") || {};
            return a[d.meet.tags.videoQuality] || d.video.quality.high;
        }
    });
}), define("text!template/meet/subheader.html", [], function() {
    return '<span>\r\n	{{#if showInvite}}\r\n	<a class="mouse-hand mxbrand-hide" data-action="invite" data-param="participants" ><i class="micon-user-add size20"></i> {{lang.invite}}</a>\r\n	{{/if}}\r\n	<span class="mx-mute-all">\r\n\r\n	</span>\r\n</span>';
}), define("text!template/meet/muteAll.html", [], function() {
    return '<a data-action="muteAll" class="pull-right mouse-hand">{{lang.mute_all}}</a>';
}), define("text!template/buy/link.html", [], function() {
    return '<div class="paddingTop5">\n	<span>{{bbcode message}}</span>\n</div>';
}), define("buy/link", [ "moxtra", "lang", "const", "text!template/buy/link.html" ], function(a, b, c, d) {
    "use strict";
    return a.Controller.extend({
        template: d,
        handleAction: !0,
        init: function(a) {
            a = a || {}, this.$scope.lang = b, this.message = this._message(a), this.$scope.message = this.message;
        },
        rendered: function() {},
        getMessage: function() {
            return this.message;
        },
        msgs: {
            meet_invite_onGroup_host: "Your free basic plan allows two participants only. You can invite as many attendees you want but only one more attendee can join the meeting. [url=https://www.moxtra.com/service/upgrade]Upgrade[/url] to Standard plan for 10 participant meetings or Pro for unlimited participant meetings.",
            meet_invite_onGroup_host_exceed: "Your free basic plan allows two participants only. You can’t invite additional attendees. [url=https://www.moxtra.com/service/upgrade]Upgrade[/url] to Standard plan for 10 participant, 60 minutes meetings or Pro for unlimited meetings.",
            meet_invite_onGroup_attendee: "Your free basic plan allows two participants only. You can invite as many attendees you want but only one more attendee can join the meeting. Contact meet host to upgrade to Standard plan for 10 participant meetings or Pro for unlimited participant meetings.",
            meet_invite_onGroup_attendee_exceed: "Your free basic plan allows two participants only. You can’t invite additional attendees. Contact meet host to upgrade to Standard plan for 10 participant meetings or Pro for unlimited participant meetings.",
            meet_invite_ownerUnpaid_host: "Your free basic plan allows two participants only. You can invite as many attendees you want but only one more attendee can join the meeting. [url=https://www.moxtra.com/service/upgrade]Upgrade[/url] to Standard plan for 10 participant meetings or Pro for unlimited participant meetings.",
            meet_invite_ownerUnpaid_host_exceed: "Your free basic plan allows two participants only. You can’t invite additional attendees. [url=https://www.moxtra.com/service/upgrade]Upgrade[/url] to Standard plan for 10 participant, 60 minutes meetings or Pro for unlimited meetings.",
            meet_invite_ownerUnpaid_attendee: "Your free basic plan allows two participants only. You can invite as many attendees you want but only one more attendee can join the meeting. Contact meet host to upgrade to Standard plan for 10 participant meetings or Pro for unlimited participant meetings.",
            meet_invite_ownerUnpaid_attendee_exceed: "Your free basic plan allows two participants only. You can’t invite additional attendees. Contact meet host to upgrade to Standard plan for 10 participant, 60 minutes meetings or Pro for unlimited meetings.",
            meet_invite_memberUnpaid_host: "Your free basic plan allows two participants only. You can invite as many attendees you want but only one more attendee can join the meeting. Contact your team owner to upgrade to Standard plan for 10 participant meetings or Pro for unlimited participant meetings.",
            meet_invite_memberUnpaid_host_exceed: "Your free basic plan allows two participants only. You can’t invite additional attendees. Contact your team owner to upgrade to Standard plan for 10 participant, 60 minutes meetings or Pro for unlimited meetings.",
            meet_invite_memberUnpaid_attendee: "Your free basic plan allows two participants only. You can invite as many attendees you want but only one more attendee can join the meeting. Contact meet host to upgrade to Standard plan for 10 participant meetings or Pro for unlimited participant meetings.",
            meet_invite_memberUnpaid_attendee_exceed: "Your free basic plan allows two participants only. You can’t invite additional attendees. Contact meet host to upgrade to Standard plan for 10 participant, 60 minutes meetings or Pro for unlimited meetings.",
            meet_invite_ownerPaid_host: "Your Standard plan allows 10 participants only. You can invite as many attendees you want but only x more attendee can join the meeting. If you want meeting with more then 10 participants, [url=https://www.moxtra.com/service/upgrade]upgrade[/url] to pro plan.",
            meet_invite_ownerPaid_host_exceed: "Your Standard plan allows 10 participants only. You can’t invite additional attendees. If you want meeting with more then 10 participants, [url=https://www.moxtra.com/service/upgrade]upgrade[/url] to pro plan.",
            meet_invite_ownerPaid_attendee: "Your Standard plan allows 10 participants only. You can invite as many attendees you want but only x more attendee can join the meeting. If you want meeting with more then 10 participants, contact meet host to upgrade to pro plan.",
            meet_invite_ownerPaid_attendee_exceed: "Your Standard plan allows 10 participants only. You can’t invite additional attendees. If you want meeting with more then 10 participants, contact meet host to upgrade to pro plan.",
            meet_invite_memberPaid_host: "Your Standard plan allows 10 participants only. You can invite as many attendees you want but only x more attendee can join the meeting. If you want meeting with more then 10 participants, ask your team owner <name> to upgrade to pro plan.",
            meet_invite_memberPaid_host_exceed: "Your Standard plan allows 10 participants only. You can’t invite additional attendees. If you want meeting with more then 10 participants, ask your team owner <name> to upgrade to pro plan.",
            meet_invite_memberPaid_attendee: "Your Standard plan allows 10 participants only. You can invite as many attendees you want but only x more attendee can join the meeting. If you want meeting with more then 10 participants, contact meet host to upgrade to pro plan.",
            meet_invite_memberPaid_attendee_exceed: "Your Standard plan allows 10 participants only. You can’t invite additional attendees. If you want meeting with more then 10 participants, contact meet host to upgrade to pro plan.",
            meet_time_onGroup_host: "Your free basic plan allows 15 minutes meeting. Your meeting will end in 5 minutes. [url=https://www.moxtra.com/service/upgrade]Upgrade[/url] to Standard plan for 60 minutes and 10 participant meetings or Pro for unlimited meetings.",
            meet_time_ownerUnpaid_host: "Your free basic plan allows 15 minutes meeting. Your meeting will end in 5 minutes. [url=https://www.moxtra.com/service/upgrade]Upgrade[/url] to Standard plan for 60 minutes and 10 participant meetings or Pro for unlimited meetings.",
            meet_time_memberUnpaid_host: "Your free basic plan allows 15 minutes meeting. Your meeting will end in 5 minutes. Contact your team owner to Standard plan for 60 minutes and 10 participant meetings or Pro for unlimited meetings.",
            meet_time_ownerPaid_host: "Your Standard plan allows 60 minutes meeting. Your meeting will end in 5 minutes.If you want longer meetings, [url=https://www.moxtra.com/service/upgrade]upgrade[/url] to pro plan.",
            meet_time_memberPaid_host: "Your Standard plan allows 60 minutes meeting. Your meeting will end in 5 minutes.If you want longer meetings, ask your team owner <name> to upgrade to pro plan.",
            storage_onGroup: "Your free basic plan allows 1 gig of storage. You have exceeded the storage limit and can’t add any more pages. To add more pages, delete existing pages or [url=https://www.moxtra.com/service/upgrade]upgrade[/url] to Standard or Pro plan",
            storage_ownerUnpaid: "Your free basic plan allows 1 gig of storage. You have exceeded the storage limit and can’t add any more pages. To add more pages, delete existing pages or [url=https://www.moxtra.com/service/upgrade]upgrade[/url] to Standard or Pro plan",
            storage_memberUnPaid: "Your free basic plan allows 1 gig of storage. You have exceeded the storage limit and can’t add any more pages. To add more pages, delete existing pages or contact your team owner to upgrade to Standard or Pro plan",
            storage_ownerPaid: "Your Standard plan allows 10 gig of storage. You have exceeded the storage limit and can’t add any more pages. To add more pages, delete existing pages or [url=https://www.moxtra.com/service/upgrade]upgrade[/url] to Pro plan.",
            storage_memberPaid: "Your Standard plan allows 10 gig of storage. You have exceeded the storage limit and can’t add any more pages. To add more pages, delete existing pages or ask team owner <name> to upgrade to Pro plan.",
            chat_history_onGroup: "[url=https://www.moxtra.com/service/upgrade]upgrade[/url] to Standard or Pro plan",
            chat_history_ownerUnpaid: "[url=https://www.moxtra.com/service/upgrade]upgrade[/url] to Standard or Pro plan",
            chat_history_memberUnpaid: "contact your team owner to upgrade to Standard or Pro plan",
            chat_history_ownerPaid: "[url=https://www.moxtra.com/service/upgrade]upgrade[/url] to Pro plan",
            chat_history_memberPaid: "ask team owner <name> to upgrade to Pro plan"
        },
        _message: function(a) {
            if (!a) return "";
            var b, c = [];
            switch (a.context) {
              case "meet":
                b = this._getState(MX.get("info.owner", a)), c.push(a.context), c.push(a.action), 
                c.push(b), c.push(MX.get("info.isHost", a) ? "host" : "attendee"), "invite" === a.action ? this._isMeetInviteExceed(b, MX.get("info.roster", a)) && c.push("exceed") : "time" === a.action;
                break;

              case "storage":
              case "chat_history":
                b = this._getState(), c.push(a.context), c.push(b);
            }
            return console.log(c.join("_")), this.msgs[c.join("_")] || "";
        },
        _getState: function(a) {
            var b, d, e;
            if (a && a.groups && (b = MX.get("groups.0.group.id", a), d = MX.get("groups.0.status", a), 
            e = MX.get("groups.0.type", a) === c.group.userRole.owner), b || (b = MX.get("id", Moxtra.getMyGroup()), 
            d = MX.get("status", Moxtra.getMyGroup()), e = MX.get("group.type", Moxtra.getMe()) === c.group.userRole.owner), 
            !b) return "noGroup";
            switch (d) {
              case c.group.status.normal:
                return e ? "ownerPaid" : "memberPaid";

              case c.group.status.canceled:
              case c.group.status.expired:
                return e ? "ownerExpired" : "memberExpired";

              default:
                return e ? "ownerUnpaid" : "memberUnpaid";
            }
        },
        _isMeetInviteExceed: function(a, b) {
            var c = {
                noGroup: 2,
                ownerUnpaid: 2,
                memberUnpaid: 2,
                ownerPaid: 10,
                memberPaid: 10
            };
            return this._calMeetAttendeeCount(b) >= c[a];
        },
        _calMeetAttendeeCount: function(a) {
            var b = 0;
            return a && MX.each(a, function(a) {
                a.is_deleted || b++;
            }), b;
        }
    });
}), define("common/loadingDialog", [ "moxtra", "lang" ], function(a, b) {
    var c = MX.Controller.extend({
        template: '<div style="width: 100%; min-height: 100px;"></div>',
        buttons: [],
        init: function(a) {
            _.extend(this, a);
        },
        rendered: function() {
            this.progress();
        }
    });
    return {
        genDialog: function(a) {
            a = a || {};
            var d = {
                title: b.loading,
                disableKeyboard: a.disableKeyboard,
                iframeShim: a.iframeShim,
                buttons: [ {
                    text: b.cancel,
                    click: function() {
                        this.close();
                    }
                } ],
                content: b.loading
            };
            return a.gif && (d.content = new c({
                buttons: [ {
                    text: b.cancel,
                    click: function() {
                        this.close();
                    }
                } ]
            })), _.extend(d, a), new MX.ui.Dialog(d);
        }
    };
}), define("meet/meetSubHeader", [ "moxtra", "lang", "app", "const", "text!template/meet/subheader.html", "text!template/meet/muteAll.html", "meet/meetBiz", "meet/connector/util", "meet/brandingCache", "buy/link", "common/loadingDialog", "component/selector/userSelector", "component/templateHelper" ], function(a, b, c, d, e, f, g, h, i, j, k) {
    "use strict";
    var l = Handlebars.compile(f), m = MX.logger("meet:subheader");
    return a.Controller.extend({
        template: e,
        handleAction: !0,
        init: function(a) {
            this.profile = a.profile || {};
            var c = !0;
            (this.profile.isInvisible || i.getBoolTag(d.meet.tags.hideInvite)) && (c = !1), 
            !this.profile.isHost && i.getBoolTag(d.meet.tags.hideAttendeeInvite) && (c = !1), 
            this.meetModel = g.getMeetModel(), this.$scope.lang = b, this.$scope.showInvite = c, 
            this.listenTo(this.meetModel, "change:isMeetPresenter", this.presenterChanged);
        },
        rendered: function() {
            (this.profile.isHost || this.profile.isPresenter) && this._renderMuteAll(), this.profile.isInvisible && $(".mx-meet-side .mx-meet-subheader").css({
                padding: 0,
                height: 0
            }), !this.profile.isHost && i.getBoolTag(d.meet.tags.hideAttendeeInvite) && $(".mx-meet-side .mx-meet-subheader").hide();
        },
        invite: function() {
            m.logServer(h.logFormat('[User Action] click "Invite User" '));
            var a = this;
            if (c.isIntegrationEnabled()) {
                c.sendMessage({
                    action: "invite",
                    binder_id: this.meetModel.get("boardId"),
                    session_key: this.meetModel.get("sessionKey"),
                    session_id: Moxtra.getMe().sessionId
                });
                var d = c.integration.get("extension");
                if (!d) return;
                var e = JSON.parse(d);
                if (!e.show_dialogs || !e.show_dialogs.meet_invite) return;
            }
            m.logServer(h.logFormat("[Show] User_Selector dialog "));
            var f, i, j = function() {
                return new MX.ui.UserSelector({
                    title: b.meet_invite_participants,
                    buttons: [ {
                        position: "right",
                        text: b.invite,
                        className: "btn-warning mx-branding-meet-dialog-btn",
                        click: "onSelectDone"
                    } ],
                    onSelectDone: function() {
                        var d = [], e = this.value();
                        e.each(function(a) {
                            var b = a.toJSON();
                            d.push(MX.isUndefined(b.isTeam) ? {
                                email: b.email
                            } : {
                                group_id: b.id
                            });
                        }), m.logServer(h.logFormat("[action] invite users: " + JSON.stringify(d))), g.inviteToMeet(d).success(function() {
                            c.isIntegrationEnabled() ? c.sendMessage({
                                action: "invited",
                                binder_id: a.meetModel.get("boardId"),
                                session_key: a.meetModel.get("sessionKey"),
                                users: d,
                                session_id: Moxtra.getMe().sessionId
                            }) : new MX.ui.Notify({
                                type: "success",
                                content: b.meet_invite_participants_success
                            });
                        }).error(function() {
                            new MX.ui.Notify({
                                type: "error",
                                content: b.meet_invite_participants_failed
                            });
                        }), this.dialog.close();
                    }
                });
            }, l = Moxtra.getMe();
            l.id && !l.revision ? (f = k.genDialog({
                title: b.meet_invite_participants,
                iframeShim: !0,
                disableKeyboard: !0
            }), l.subscribe(), Moxtra.onReady(function() {
                i = j(), a.recovery(i), f.push({
                    content: i
                });
            })) : (i = j(), a.recovery(i), f = new MX.ui.Dialog({
                iframeShim: !0,
                content: i
            }));
        },
        muteAll: function() {
            m.logServer(h.logFormat('[User Action] click "Mute All" ')), m.logServer(h.logFormat("[action] try to mute all ")), 
            g.muteAll();
        },
        presenterChanged: function(a, b) {
            var c = this.$(".mx-mute-all");
            c.empty(), (b || this.profile.isHost) && this._renderMuteAll();
        },
        _renderMuteAll: function() {
            i.getBoolTag(d.meet.tags.hideAudio) || this.$(".mx-mute-all").html($(l({
                lang: b
            })));
        }
    });
}), define("text!template/meet/participantItem.html", [], function() {
    return '<li id="{{cid}}" class="participant-item {{#unless showVoiceIndicator}}no-voice{{/unless}}">\n	<span class="item item-image mx-meet-role"><img class="img-circle {{#if isTeam}}mx-noborder mx-nobox-shadow{{/if}}" src="{{avatar}}" title="{{email}}"/><i class="icon {{#if isPresenter}}presenter{{/if}}"></i></span>\n	{{#if showVoiceIndicator}}\n	<span class="item item-audio-action">\n		{{#if inSession}}\n			{{#if isTelephoneEnabled}}\n				{{#if isTelephoneMuted}}\n				<span><i class="micon-telephone-muted mp-phone lightGray size16"></i></span>\n				{{else}}\n				<span><i class="micon-telephone-on mp-phone lightGray size16"></i></span>\n				{{/if}}\n			{{else}}\n				{{#if isMe}}\n					{{#if isAudioEnabled}}\n					<span class="mx-btn mx-position-relative mouse-hand active lightGray" data-action="{{#if isAudioMuted}}unmuteSelf{{else}}muteSelf{{/if}}">\n\n						{{#if isAudioMuted}}\n						<i class="micon-mic-muted size20 marginLeft5"></i>\n						{{else}}\n						<i class="micon-mic size20 marginLeft5"></i>\n						{{/if}}\n\n						{{qualityIndicator networkQuality}}\n					</span>\n					{{else}}\n					<span>\n						<i class="micon-speaker-disabled size20 marginLeft5"></i>\n					</span>\n					{{/if}}\n				{{else}}\n					{{#if enableMuteAction}}\n					<span class="mx-btn mx-position-relative mouse-hand active lightGray" data-action="muteParticipant" data-param="{{id}}">\n						<i class="micon-mic size20 marginLeft5"></i>\n\n						{{qualityIndicator networkQuality}}\n					</span>\n					{{else}}\n					<span class="mx-position-relative">\n						{{#if isAudioEnabled}}\n							{{#if isAudioMuted}}\n							<i class="micon-mic-muted size20 marginLeft5"></i>\n							{{else}}\n							<i class="micon-mic size20 marginLeft5"></i>\n							{{/if}}\n\n							{{qualityIndicator networkQuality}}\n						{{else}}\n						<i class="micon-speaker-disabled size20 marginLeft5"></i>\n						{{/if}}\n					</span>\n					{{/if}}\n				{{/if}}\n			{{/if}}\n		{{else}}\n		<span style="margin-left: 1px;"></span>\n		{{/if}}\n	</span>\n	{{/if}}\n    <div class="dropdown item-user item">\n	<span {{#ifCond enableOptions \'||\' enableReclaim}}data-toggle="dropdown" data-action="autoScroll" data-param="#participantOptions{{uid}}" class="mx-btn mouse-hand {{#unless inSession}}pending{{/unless}}"{{else}} class="{{#unless inSession}}pending{{/unless}}" {{/ifCond}}>\n        <span class="item-name">\n	        <span>{{bbcode name}}</span>\n	        {{#if isHost}}\n	            ({{lang.meet_host}}{{#if isMe}}, {{lang.me_lower_case}}{{/if}})\n	        {{else}}\n	            {{#if isMe}}\n	                {{lang.me_with_parentheses}}\n	            {{/if}}\n	        {{/if}}\n\n	        {{#unless inSession}}\n	        	{{#unless isHost}}\n	        	 <span class="user-status">\n	        	 ({{#when attendeeStatus \'==\' \'ACCEPTED\'}}\n	        	{{lang.accepted}}\n	        	{{/when}}\n	        	{{#when attendeeStatus \'==\' \'INVITED\'}}\n	        	{{lang.invited}}\n	        	{{/when}}\n	        	{{#when attendeeStatus \'==\' \'DECLINED\'}}\n	        	{{lang.declined}}\n	        	{{/when}})\n	        	</span>\n	        	{{/unless}}\n	        {{/unless}}\n        </span>\n    	<span class="item item-options pull-right">\n            {{#ifCond enableOptions \'||\' enableReclaim}}\n            <a id="participantOptions{{uid}}" ><span class="caret caret-white"></span></a>\n            {{/ifCond}}\n	    </span>\n    </span>\n    {{#if enableOptions}}\n    <ul class="dropdown-menu pull-right participant-options" aria-labelledby="participantOptions{{uid}}">\n        <li><span class="item-email">{{#if email}}{{email}}{{else}}{{bbcode name}}{{/if}}</span></li>\n        {{#unless pureCallIn}}\n        <li class="divider"></li>\n        {{/unless}}\n        {{#if inSession}}\n        	{{#unless pureCallIn}}\n		        {{#if isPresenter}}\n		        <li class="disabled"><a tabindex="-1"><span class="mxic24-meet-change-presenter"></span> {{lang.meet_presenter}}</a></li>\n		        {{else}}\n		        <li><a tabindex="-1" class="mouse-hand" data-action="makePresenter" data-param="{{id}}"><span class="mxic24-meet-change-presenter"></span> {{lang.meet_change_presenter}}</a></li>\n		        {{/if}}\n\n		        {{#if showVoiceIndicator}}\n		        {{#if isAudioEnabled}}\n		        	{{#if isMe}}\n		        		{{#if isAudioMuted}}\n		        		<li><a tabindex="-1" class="mouse-hand" data-action="unmuteSelf"><span class="micon-mic blue size20"></span> {{lang.unmute}}</a></li>\n		        		{{else}}\n		        		<li><a tabindex="-1" class="mouse-hand" data-action="muteSelf"><span class="micon-mic-muted blue size20"></span> {{lang.mute}}</a></li>\n		        		{{/if}}\n		        	{{else}}\n		        	<li><a tabindex="-1" class="mouse-hand" data-action="muteParticipant" data-param="{{id}}"><span class="micon-mic-muted blue size20"></span> {{lang.mute}}</a></li>\n		        	{{/if}}\n		        {{else}}\n		        <li class="disabled"><a tabindex="-1"><span class="micon-mic-muted gray size20"></span> {{lang.mute}}</a></li>\n		        {{/if}}\n		        {{/if}}\n	        {{/unless}}\n	        {{#if enableReclaim}}\n	        	<li class="divider"></li>\n	        	<li><a tabindex="-1" class="mouse-hand" data-action="reclaimHost">{{lang.reclaim_host}}</a></li>\n	        {{/if}}\n        {{else}}\n        	{{#if showResend}}\n	        	{{#unless isTeam}}\n	    		<li><a tabindex="-1" class="mouse-hand" data-action="resendInvitation" data-param="{{id}}"><i class="micon-email size16 blue marginRight5"></i> {{lang.resend_invitation}}</a></li>\n	        	{{/unless}}\n        	{{/if}}\n        	{{#when attendeeStatus \'!==\' \'DECLINED\'}}\n    		<li><a tabindex="-1" class="mouse-hand" data-action="cancelInvitation" data-param="{{id}}"><i class="micon-close-with-square size16 blue marginRight5"></i> {{lang.remove}}</a></li>\n        	{{/when}}\n        {{/if}}\n    </ul>\n    {{else}}\n    	{{#if enableReclaim}}\n    	<ul class="dropdown-menu pull-right participant-options" aria-labelledby="participantOptions{{uid}}">\n        	<li><span class="item-email">{{#if email}}{{email}}{{else}}{{bbcode name}}{{/if}}</span></li>\n        	<li class="divider"></li>\n        	<li><a tabindex="-1" class="mouse-hand" data-action="reclaimHost">{{lang.reclaim_host}}</a></li>\n        </ul>\n        {{/if}}\n    {{/if}}\n    </div>\n</li>\n';
}), define("meet/participant/participant", [ "moxtra", "lang", "app", "const", "text!template/meet/participant.html", "text!template/meet/participantItem.html", "meet/meetBiz", "meet/connector/util", "meet/brandingCache", "component/templateHelper" ], function(a, b, c, d, e, f, g, h, i) {
    var j = MX.logger("meet:participant");
    return a.Controller.extend({
        template: e,
        handleAction: !0,
        init: function(a) {
            this.profile = a.profile || {}, this.collection = g.getParticipantList(), this.meetModel = g.getMeetModel(), 
            this.$scope.lang = b, this.listenTo(this.collection, "add", this.notifyAdded), this.listenTo(this.collection, "remove", this.notifyRemoved), 
            this.listenTo(this.meetModel, "change:isMeetPresenter", this.presenterChanged);
        },
        rendered: function() {
            var e = !0, g = !0;
            i.getBoolTag(d.meet.tags.hideAudio) && (e = !1), c.isIntegrationEnabled() && (g = !1), 
            this.list = new a.List({
                parent: this,
                renderTo: ".participant-list",
                collection: this.collection,
                template: f,
                sortable: !1,
                lazyload: $(".mx-meet-participants"),
                unifyLazyload: !1,
                syncModel: !0,
                $scope: {
                    lang: b,
                    showVoiceIndicator: e,
                    showResend: g,
                    blankImg: d.defaults.blankImg
                }
            });
        },
        presenterChanged: function(a, b) {
            var c = this.collection.models, d = b || this.profile.isHost;
            MX.each(c, function(a) {
                a.set({
                    enableOptions: d
                });
            }), this.collection.reset(c);
        },
        makePresenter: function(a) {
            j.logServer(h.logFormat('[User Action] click "Change to Presenter" ')), j.logServer(h.logFormat("[action] try to change to presenter, id = " + a)), 
            g.makePresenter(a);
        },
        muteParticipant: function(a) {
            j.logServer(h.logFormat('[User Action] click "Mute Participant" ')), j.logServer(h.logFormat("[action] try to mute participant, id = " + a)), 
            g.muteSingle(a);
        },
        muteSelf: function() {
            j.logServer(h.logFormat('[User Action] click "Mute (self)" ')), j.logServer(h.logFormat("[action] try to mute self")), 
            g.muteAudio();
        },
        unmuteSelf: function() {
            j.logServer(h.logFormat('[User Action] click "Unmute (self)" ')), j.logServer(h.logFormat("[action] try to unmute self")), 
            g.unmuteAudio();
        },
        muteTelephone: function(a) {
            j.logServer(h.logFormat('[User Action] click "Mute Telephone" ')), j.logServer(h.logFormat("[action] try to mute participant, id = " + a)), 
            g.muteSingle(a, !0);
        },
        unmuteTelephone: function(a) {
            j.logServer(h.logFormat('[User Action] click "Unmute Telephone" ')), j.logServer(h.logFormat("[action] try to unmute participant, id = " + a)), 
            g.unmuteSingle(a, !0);
        },
        resendInvitation: function(a) {
            j.logServer(h.logFormat('[User Action] click "Resend (invitation)" ')), j.logServer(h.logFormat("[action] try to resend invitation, email = " + a));
            var d = this;
            g.inviteToMeet([ {
                email: a
            } ]).success(function() {
                c.isIntegrationEnabled() ? c.sendMessage({
                    action: "invited",
                    binder_id: d.meetModel.get("boardId"),
                    session_key: d.meetModel.get("sessionKey"),
                    users: [ {
                        email: a
                    } ],
                    session_id: Moxtra.getMe().sessionId
                }) : MX.ui.notifySuccess(b.meet_invite_participants_success);
            }).error(function() {
                MX.ui.notifyError(b.meet_invite_participants_failed);
            });
        },
        cancelInvitation: function(a) {
            j.logServer(h.logFormat('[User Action] click "Remove (invitation)" ')), j.logServer(h.logFormat("[action] try to remove invitation, email = " + a));
            var c = this.collection.get(a), d = 0, e = "", f = this;
            c && (d = c.get("attendeeSequence"), e = c.get("name"), MX.ui.Confirm(MX.format(b.confirm_remove_user, e), function() {
                g.removeInvitation(a, d).success(function() {
                    f.collection.remove(c);
                }).error(function() {
                    MX.ui.notifyError(MX.format(b.remove_username_failed, e));
                });
            }, null, {
                className: "mx-branding-meet-dialog-btn"
            }));
        },
        reclaimHost: function() {
            Moxtra.reclaimMeetHost(this.profile.sessionKey).success(function() {
                MX.ui.notifySuccess(b.meet_reclaim_host_success);
            }).error(function() {
                MX.ui.notifyError(b.meet_reclaim_host_failed);
            });
        },
        notifyAdded: function(a) {
            a.get("inSession") && !a.get("isMe") && this.meetModel.get("notifyStatus").notify && MX.ui.notifyInfo(MX.format(b.notify_participant_joined, a.get("name")));
        },
        notifyRemoved: function(a) {
            a.get("inSession") && !a.get("isMe") && this.meetModel.get("notifyStatus").notify && MX.ui.notifyInfo(MX.format(b.notify_participant_left, a.get("name")));
        },
        openOptions: function(a) {
            var b = this;
            setTimeout(function() {
                b.$(a).trigger("click"), b._scroll(a);
            }, 100);
        },
        autoScroll: function(a) {
            var b = this;
            setTimeout(function() {
                b._scroll(a);
            }, 100);
        },
        _scroll: function(a) {
            var b = $(".mx-meet-participants").height(), c = this.$(a).offset().top, d = $(".mx-meet-side .mx-meet-participants").scrollTop();
            c > b && $(".mx-meet-side .mx-meet-participants").scrollTop(d + 100);
        },
        stopListen: function() {
            this.stopListening();
        }
    });
}), define("text!template/meet/chat.html", [], function() {
    return '<div class="meet-chat">\n	<div class="chat-list" {{#unless showInput}}style="bottom: 20px;"{{/unless}}>\n\n	</div>\n	{{#if showInput}}\n	<div class="mx-action-bar">\n		<textarea type="text" name="message" class="form-control" placeholder="{{lang.chat_placeholder_write_comment}}" autofocus style="min-height: 54px;"></textarea>\n	</div>\n	{{/if}}\n</div>';
}), define("text!template/meet/chatItem.html", [], function() {
    return '<div class="chat-item-wrap arrow {{#if isMe}}to-right{{/if}}">\r\n    <div class="mx-user contact-avatar">\r\n	    <!-- <img src="{{blankImg}}" data-original="{{avatar}}" class="img-circle lazy"> -->\r\n	    <img src="{{avatar}}" class="img-circle">\r\n	</div>\r\n    <div class="chat-item">\r\n        <div class="mx-message"> {{linkMode msg}}</div>\r\n    </div>\r\n</div>';
}), define("meet/chat/chat", [ "moxtra", "lang", "app", "const", "text!template/meet/chat.html", "text!template/meet/chatItem.html", "meet/meetBiz" ], function(a, b, c, d, e, f, g) {
    return a.Controller.extend({
        template: e,
        events: {
            "keydown textarea": "postChat"
        },
        init: function(a) {
            this.profile = a.profile || {}, this.collection = g.getChatList(), this.meetModel = g.getMeetModel(), 
            this.$scope.lang = b, this.$scope.showInput = !this.profile.isInvisible, this.listenTo(this.collection, "add", this.chatUpdated);
        },
        rendered: function() {
            this.list = new a.List({
                parent: this,
                renderTo: ".chat-list",
                tagName: "div",
                collection: this.collection,
                template: f,
                sortable: !1,
                lazyload: this.$(".chat-list"),
                unifyLazyload: !1,
                $scope: {
                    lang: b,
                    blankImg: d.defaults.blankImg
                }
            }), MX.env.isIE && this.$("textarea").placeholder();
            var c = this.$(".chat-list");
            this.$("textarea").autosize({
                callback: function(a) {
                    var b = $(a).height(), d = b - 42, e = 110;
                    d > 0 ? (c.css({
                        bottom: e + d + "px"
                    }), c.length && c.scrollTop(c[0].scrollHeight + b)) : c.css({
                        bottom: e + "px"
                    });
                }
            }), (MX.env.isFF || MX.env.isIE) && this.$(".chat-list .mx-list").css({
                "padding-bottom": "10px"
            });
        },
        chatUpdated: function(a) {
            !a.get("isMe") && this.meetModel.get("notifyStatus").notify && MX.ui.notifyInfo(Handlebars.Utils.escapeExpression(a.get("msg"))), 
            this.scroll();
        },
        scroll: function() {
            var a = this;
            setTimeout(function() {
                a.$(".chat-list").scrollTop(a.$(".chat-list .mx-list").height());
            }, 300);
        },
        postChat: function(a) {
            var b = $(a.target);
            if (a.keyCode === d.keys.Enter && !a.shiftKey) {
                a.preventDefault();
                var c = $.trim(b.val());
                c.length > 0 && (g.sendChat(c), b.val(""), b.trigger("autosize.resize"));
            }
        },
        stopListen: function() {
            this.stopListening();
        }
    });
}), define("text!template/meet/topbar/topic.html", [], function() {
    return '<span class="dropdown">\n	<a id="mxMeetTopic" data-toggle="dropdown" data-meetid="{{meet.id}}" class="mx-branding topbar-action mouse-hand">{{lang.meet_id_colon}} <strong>{{meet.formatedId}}</strong> <span class="mx-branding caret caret-white"></span></a>\n	<ul class="dropdown-menu participant-options" aria-labelledby="mxMeetTopic">\n\n		<!-- handle plugin window covered web case -->\n		<iframe class="mx-iframe-shim" src="javascript:;" frameborder="0" allowtransparency="true" scrolling="no"></iframe>\n\n		<li><span class="meet-info mx-ie-relative">{{bbcode meet.topic}}</span></li>\n		<li><span class="meet-info mx-ie-relative">{{bbcode meet.host}}</span></li>\n		<li class="divider mxbrand-hide"></li>\n		{{#if flashEnabled}}\n		<!-- <li><a tabindex="-1" href="javascript:;" class="copy-info" id="mxMeetId"><i class="mx-icon-copy-link"></i> {{meet.formatedId}}</a></li> -->\n		<li><a tabindex="-1" class="copy-info mxbrand-hide mx-ie-relative" id="mxMeetLink"><i class="micon-web-link size16 blue"></i> {{meet.link}}</a></li>\n		{{else}}\n		<!-- <li><span class="meet-info">{{meet.formatedId}}</span></li> -->\n		<li><a tabindex="-1" class="copy-info mxbrand-hide mx-ie-relative">{{meet.link}}</a></li>\n		{{/if}}\n	</ul>\n</span>\n';
}), function(a, b) {
    "use strict";
    var c, d, e, f = a, g = f.document, h = f.navigator, i = f.setTimeout, j = f.clearTimeout, k = f.setInterval, l = f.clearInterval, m = f.getComputedStyle, n = f.encodeURIComponent, o = f.ActiveXObject, p = f.Error, q = f.Number.parseInt || f.parseInt, r = f.Number.parseFloat || f.parseFloat, s = f.Number.isNaN || f.isNaN, t = f.Date.now, u = f.Object.keys, v = f.Object.defineProperty, w = f.Object.prototype.hasOwnProperty, x = f.Array.prototype.slice, y = function() {
        var a = function(a) {
            return a;
        };
        if ("function" == typeof f.wrap && "function" == typeof f.unwrap) try {
            var b = g.createElement("div"), c = f.unwrap(b);
            1 === b.nodeType && c && 1 === c.nodeType && (a = f.unwrap);
        } catch (d) {}
        return a;
    }(), z = function(a) {
        return x.call(a, 0);
    }, A = function() {
        var a, c, d, e, f, g, h = z(arguments), i = h[0] || {};
        for (a = 1, c = h.length; c > a; a++) if (null != (d = h[a])) for (e in d) w.call(d, e) && (f = i[e], 
        g = d[e], i !== g && g !== b && (i[e] = g));
        return i;
    }, B = function(a) {
        var b, c, d, e;
        if ("object" != typeof a || null == a || "number" == typeof a.nodeType) b = a; else if ("number" == typeof a.length) for (b = [], 
        c = 0, d = a.length; d > c; c++) w.call(a, c) && (b[c] = B(a[c])); else {
            b = {};
            for (e in a) w.call(a, e) && (b[e] = B(a[e]));
        }
        return b;
    }, C = function(a, b) {
        for (var c = {}, d = 0, e = b.length; e > d; d++) b[d] in a && (c[b[d]] = a[b[d]]);
        return c;
    }, D = function(a, b) {
        var c = {};
        for (var d in a) -1 === b.indexOf(d) && (c[d] = a[d]);
        return c;
    }, E = function(a) {
        if (a) for (var b in a) w.call(a, b) && delete a[b];
        return a;
    }, F = function(a, b) {
        if (a && 1 === a.nodeType && a.ownerDocument && b && (1 === b.nodeType && b.ownerDocument && b.ownerDocument === a.ownerDocument || 9 === b.nodeType && !b.ownerDocument && b === a.ownerDocument)) do {
            if (a === b) return !0;
            a = a.parentNode;
        } while (a);
        return !1;
    }, G = function(a) {
        var b;
        return "string" == typeof a && a && (b = a.split("#")[0].split("?")[0], b = a.slice(0, a.lastIndexOf("/") + 1)), 
        b;
    }, H = function(a) {
        var b, c;
        return "string" == typeof a && a && (c = a.match(/^(?:|[^:@]*@|.+\)@(?=http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/), 
        c && c[1] ? b = c[1] : (c = a.match(/\)@((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/), 
        c && c[1] && (b = c[1]))), b;
    }, I = function() {
        var a, b;
        try {
            throw new p();
        } catch (c) {
            b = c;
        }
        return b && (a = b.sourceURL || b.fileName || H(b.stack)), a;
    }, J = function() {
        var a, c, d;
        if (g.currentScript && (a = g.currentScript.src)) return a;
        if (c = g.getElementsByTagName("script"), 1 === c.length) return c[0].src || b;
        if ("readyState" in c[0]) for (d = c.length; d--; ) if ("interactive" === c[d].readyState && (a = c[d].src)) return a;
        return "loading" === g.readyState && (a = c[c.length - 1].src) ? a : (a = I()) ? a : b;
    }, K = function() {
        var a, c, d, e = g.getElementsByTagName("script");
        for (a = e.length; a--; ) {
            if (!(d = e[a].src)) {
                c = null;
                break;
            }
            if (d = G(d), null == c) c = d; else if (c !== d) {
                c = null;
                break;
            }
        }
        return c || b;
    }, L = function() {
        var a = G(J()) || K() || "";
        return a + "ZeroClipboard.swf";
    }, M = function() {
        return null == a.opener && (!!a.top && a != a.top || !!a.parent && a != a.parent);
    }(), N = {
        bridge: null,
        version: "0.0.0",
        pluginType: "unknown",
        disabled: null,
        outdated: null,
        sandboxed: null,
        unavailable: null,
        degraded: null,
        deactivated: null,
        overdue: null,
        ready: null
    }, O = "11.0.0", P = {}, Q = {}, R = null, S = 0, T = 0, U = {
        ready: "Flash communication is established",
        error: {
            "flash-disabled": "Flash is disabled or not installed. May also be attempting to run Flash in a sandboxed iframe, which is impossible.",
            "flash-outdated": "Flash is too outdated to support ZeroClipboard",
            "flash-sandboxed": "Attempting to run Flash in a sandboxed iframe, which is impossible",
            "flash-unavailable": "Flash is unable to communicate bidirectionally with JavaScript",
            "flash-degraded": "Flash is unable to preserve data fidelity when communicating with JavaScript",
            "flash-deactivated": "Flash is too outdated for your browser and/or is configured as click-to-activate.\nThis may also mean that the ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity.\nMay also be attempting to run Flash in a sandboxed iframe, which is impossible.",
            "flash-overdue": "Flash communication was established but NOT within the acceptable time limit",
            "version-mismatch": "ZeroClipboard JS version number does not match ZeroClipboard SWF version number",
            "clipboard-error": "At least one error was thrown while ZeroClipboard was attempting to inject your data into the clipboard",
            "config-mismatch": "ZeroClipboard configuration does not match Flash's reality",
            "swf-not-found": "The ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity"
        }
    }, V = [ "flash-unavailable", "flash-degraded", "flash-overdue", "version-mismatch", "config-mismatch", "clipboard-error" ], W = [ "flash-disabled", "flash-outdated", "flash-sandboxed", "flash-unavailable", "flash-degraded", "flash-deactivated", "flash-overdue" ], X = new RegExp("^flash-(" + W.map(function(a) {
        return a.replace(/^flash-/, "");
    }).join("|") + ")$"), Y = new RegExp("^flash-(" + W.slice(1).map(function(a) {
        return a.replace(/^flash-/, "");
    }).join("|") + ")$"), Z = {
        swfPath: L(),
        trustedDomains: a.location.host ? [ a.location.host ] : [],
        cacheBust: !0,
        forceEnhancedClipboard: !1,
        flashLoadTimeout: 3e4,
        autoActivate: !0,
        bubbleEvents: !0,
        containerId: "global-zeroclipboard-html-bridge",
        containerClass: "global-zeroclipboard-container",
        swfObjectId: "global-zeroclipboard-flash-bridge",
        hoverClass: "zeroclipboard-is-hover",
        activeClass: "zeroclipboard-is-active",
        forceHandCursor: !1,
        title: null,
        zIndex: 999999999
    }, $ = function(a) {
        if ("object" == typeof a && null !== a) for (var b in a) if (w.call(a, b)) if (/^(?:forceHandCursor|title|zIndex|bubbleEvents)$/.test(b)) Z[b] = a[b]; else if (null == N.bridge) if ("containerId" === b || "swfObjectId" === b) {
            if (!nb(a[b])) throw new Error("The specified `" + b + "` value is not valid as an HTML4 Element ID");
            Z[b] = a[b];
        } else Z[b] = a[b];
        {
            if ("string" != typeof a || !a) return B(Z);
            if (w.call(Z, a)) return Z[a];
        }
    }, _ = function() {
        return Tb(), {
            browser: C(h, [ "userAgent", "platform", "appName" ]),
            flash: D(N, [ "bridge" ]),
            zeroclipboard: {
                version: Vb.version,
                config: Vb.config()
            }
        };
    }, ab = function() {
        return !!(N.disabled || N.outdated || N.sandboxed || N.unavailable || N.degraded || N.deactivated);
    }, bb = function(a, d) {
        var e, f, g, h = {};
        if ("string" == typeof a && a) g = a.toLowerCase().split(/\s+/); else if ("object" == typeof a && a && "undefined" == typeof d) for (e in a) w.call(a, e) && "string" == typeof e && e && "function" == typeof a[e] && Vb.on(e, a[e]);
        if (g && g.length) {
            for (e = 0, f = g.length; f > e; e++) a = g[e].replace(/^on/, ""), h[a] = !0, P[a] || (P[a] = []), 
            P[a].push(d);
            if (h.ready && N.ready && Vb.emit({
                type: "ready"
            }), h.error) {
                for (e = 0, f = W.length; f > e; e++) if (N[W[e].replace(/^flash-/, "")] === !0) {
                    Vb.emit({
                        type: "error",
                        name: W[e]
                    });
                    break;
                }
                c !== b && Vb.version !== c && Vb.emit({
                    type: "error",
                    name: "version-mismatch",
                    jsVersion: Vb.version,
                    swfVersion: c
                });
            }
        }
        return Vb;
    }, cb = function(a, b) {
        var c, d, e, f, g;
        if (0 === arguments.length) f = u(P); else if ("string" == typeof a && a) f = a.split(/\s+/); else if ("object" == typeof a && a && "undefined" == typeof b) for (c in a) w.call(a, c) && "string" == typeof c && c && "function" == typeof a[c] && Vb.off(c, a[c]);
        if (f && f.length) for (c = 0, d = f.length; d > c; c++) if (a = f[c].toLowerCase().replace(/^on/, ""), 
        g = P[a], g && g.length) if (b) for (e = g.indexOf(b); -1 !== e; ) g.splice(e, 1), 
        e = g.indexOf(b, e); else g.length = 0;
        return Vb;
    }, db = function(a) {
        var b;
        return b = "string" == typeof a && a ? B(P[a]) || null : B(P);
    }, eb = function(a) {
        var b, c, d;
        return a = ob(a), a && !vb(a) ? "ready" === a.type && N.overdue === !0 ? Vb.emit({
            type: "error",
            name: "flash-overdue"
        }) : (b = A({}, a), tb.call(this, b), "copy" === a.type && (d = Db(Q), c = d.data, 
        R = d.formatMap), c) : void 0;
    }, fb = function() {
        var a = N.sandboxed;
        if (Tb(), "boolean" != typeof N.ready && (N.ready = !1), N.sandboxed !== a && N.sandboxed === !0) N.ready = !1, 
        Vb.emit({
            type: "error",
            name: "flash-sandboxed"
        }); else if (!Vb.isFlashUnusable() && null === N.bridge) {
            var b = Z.flashLoadTimeout;
            "number" == typeof b && b >= 0 && (S = i(function() {
                "boolean" != typeof N.deactivated && (N.deactivated = !0), N.deactivated === !0 && Vb.emit({
                    type: "error",
                    name: "flash-deactivated"
                });
            }, b)), N.overdue = !1, Bb();
        }
    }, gb = function() {
        Vb.clearData(), Vb.blur(), Vb.emit("destroy"), Cb(), Vb.off();
    }, hb = function(a, b) {
        var c;
        if ("object" == typeof a && a && "undefined" == typeof b) c = a, Vb.clearData(); else {
            if ("string" != typeof a || !a) return;
            c = {}, c[a] = b;
        }
        for (var d in c) "string" == typeof d && d && w.call(c, d) && "string" == typeof c[d] && c[d] && (Q[d] = c[d]);
    }, ib = function(a) {
        "undefined" == typeof a ? (E(Q), R = null) : "string" == typeof a && w.call(Q, a) && delete Q[a];
    }, jb = function(a) {
        return "undefined" == typeof a ? B(Q) : "string" == typeof a && w.call(Q, a) ? Q[a] : void 0;
    }, kb = function(a) {
        if (a && 1 === a.nodeType) {
            d && (Lb(d, Z.activeClass), d !== a && Lb(d, Z.hoverClass)), d = a, Kb(a, Z.hoverClass);
            var b = a.getAttribute("title") || Z.title;
            if ("string" == typeof b && b) {
                var c = Ab(N.bridge);
                c && c.setAttribute("title", b);
            }
            var e = Z.forceHandCursor === !0 || "pointer" === Mb(a, "cursor");
            Rb(e), Qb();
        }
    }, lb = function() {
        var a = Ab(N.bridge);
        a && (a.removeAttribute("title"), a.style.left = "0px", a.style.top = "-9999px", 
        a.style.width = "1px", a.style.height = "1px"), d && (Lb(d, Z.hoverClass), Lb(d, Z.activeClass), 
        d = null);
    }, mb = function() {
        return d || null;
    }, nb = function(a) {
        return "string" == typeof a && a && /^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(a);
    }, ob = function(a) {
        var b;
        if ("string" == typeof a && a ? (b = a, a = {}) : "object" == typeof a && a && "string" == typeof a.type && a.type && (b = a.type), 
        b) {
            b = b.toLowerCase(), !a.target && (/^(copy|aftercopy|_click)$/.test(b) || "error" === b && "clipboard-error" === a.name) && (a.target = e), 
            A(a, {
                type: b,
                target: a.target || d || null,
                relatedTarget: a.relatedTarget || null,
                currentTarget: N && N.bridge || null,
                timeStamp: a.timeStamp || t() || null
            });
            var c = U[a.type];
            return "error" === a.type && a.name && c && (c = c[a.name]), c && (a.message = c), 
            "ready" === a.type && A(a, {
                target: null,
                version: N.version
            }), "error" === a.type && (X.test(a.name) && A(a, {
                target: null,
                minimumVersion: O
            }), Y.test(a.name) && A(a, {
                version: N.version
            })), "copy" === a.type && (a.clipboardData = {
                setData: Vb.setData,
                clearData: Vb.clearData
            }), "aftercopy" === a.type && (a = Eb(a, R)), a.target && !a.relatedTarget && (a.relatedTarget = pb(a.target)), 
            qb(a);
        }
    }, pb = function(a) {
        var b = a && a.getAttribute && a.getAttribute("data-clipboard-target");
        return b ? g.getElementById(b) : null;
    }, qb = function(a) {
        if (a && /^_(?:click|mouse(?:over|out|down|up|move))$/.test(a.type)) {
            var c = a.target, d = "_mouseover" === a.type && a.relatedTarget ? a.relatedTarget : b, e = "_mouseout" === a.type && a.relatedTarget ? a.relatedTarget : b, h = Nb(c), i = f.screenLeft || f.screenX || 0, j = f.screenTop || f.screenY || 0, k = g.body.scrollLeft + g.documentElement.scrollLeft, l = g.body.scrollTop + g.documentElement.scrollTop, m = h.left + ("number" == typeof a._stageX ? a._stageX : 0), n = h.top + ("number" == typeof a._stageY ? a._stageY : 0), o = m - k, p = n - l, q = i + o, r = j + p, s = "number" == typeof a.movementX ? a.movementX : 0, t = "number" == typeof a.movementY ? a.movementY : 0;
            delete a._stageX, delete a._stageY, A(a, {
                srcElement: c,
                fromElement: d,
                toElement: e,
                screenX: q,
                screenY: r,
                pageX: m,
                pageY: n,
                clientX: o,
                clientY: p,
                x: o,
                y: p,
                movementX: s,
                movementY: t,
                offsetX: 0,
                offsetY: 0,
                layerX: 0,
                layerY: 0
            });
        }
        return a;
    }, rb = function(a) {
        var b = a && "string" == typeof a.type && a.type || "";
        return !/^(?:(?:before)?copy|destroy)$/.test(b);
    }, sb = function(a, b, c, d) {
        d ? i(function() {
            a.apply(b, c);
        }, 0) : a.apply(b, c);
    }, tb = function(a) {
        if ("object" == typeof a && a && a.type) {
            var b = rb(a), c = P["*"] || [], d = P[a.type] || [], e = c.concat(d);
            if (e && e.length) {
                var g, h, i, j, k, l = this;
                for (g = 0, h = e.length; h > g; g++) i = e[g], j = l, "string" == typeof i && "function" == typeof f[i] && (i = f[i]), 
                "object" == typeof i && i && "function" == typeof i.handleEvent && (j = i, i = i.handleEvent), 
                "function" == typeof i && (k = A({}, a), sb(i, j, [ k ], b));
            }
            return this;
        }
    }, ub = function(a) {
        var b = null;
        return (M === !1 || a && "error" === a.type && a.name && -1 !== V.indexOf(a.name)) && (b = !1), 
        b;
    }, vb = function(a) {
        var b = a.target || d || null, f = "swf" === a._source;
        switch (delete a._source, a.type) {
          case "error":
            var g = "flash-sandboxed" === a.name || ub(a);
            "boolean" == typeof g && (N.sandboxed = g), -1 !== W.indexOf(a.name) ? A(N, {
                disabled: "flash-disabled" === a.name,
                outdated: "flash-outdated" === a.name,
                unavailable: "flash-unavailable" === a.name,
                degraded: "flash-degraded" === a.name,
                deactivated: "flash-deactivated" === a.name,
                overdue: "flash-overdue" === a.name,
                ready: !1
            }) : "version-mismatch" === a.name && (c = a.swfVersion, A(N, {
                disabled: !1,
                outdated: !1,
                unavailable: !1,
                degraded: !1,
                deactivated: !1,
                overdue: !1,
                ready: !1
            })), Pb();
            break;

          case "ready":
            c = a.swfVersion;
            var h = N.deactivated === !0;
            A(N, {
                disabled: !1,
                outdated: !1,
                sandboxed: !1,
                unavailable: !1,
                degraded: !1,
                deactivated: !1,
                overdue: h,
                ready: !h
            }), Pb();
            break;

          case "beforecopy":
            e = b;
            break;

          case "copy":
            var i, j, k = a.relatedTarget;
            !Q["text/html"] && !Q["text/plain"] && k && (j = k.value || k.outerHTML || k.innerHTML) && (i = k.value || k.textContent || k.innerText) ? (a.clipboardData.clearData(), 
            a.clipboardData.setData("text/plain", i), j !== i && a.clipboardData.setData("text/html", j)) : !Q["text/plain"] && a.target && (i = a.target.getAttribute("data-clipboard-text")) && (a.clipboardData.clearData(), 
            a.clipboardData.setData("text/plain", i));
            break;

          case "aftercopy":
            wb(a), Vb.clearData(), b && b !== Jb() && b.focus && b.focus();
            break;

          case "_mouseover":
            Vb.focus(b), Z.bubbleEvents === !0 && f && (b && b !== a.relatedTarget && !F(a.relatedTarget, b) && xb(A({}, a, {
                type: "mouseenter",
                bubbles: !1,
                cancelable: !1
            })), xb(A({}, a, {
                type: "mouseover"
            })));
            break;

          case "_mouseout":
            Vb.blur(), Z.bubbleEvents === !0 && f && (b && b !== a.relatedTarget && !F(a.relatedTarget, b) && xb(A({}, a, {
                type: "mouseleave",
                bubbles: !1,
                cancelable: !1
            })), xb(A({}, a, {
                type: "mouseout"
            })));
            break;

          case "_mousedown":
            Kb(b, Z.activeClass), Z.bubbleEvents === !0 && f && xb(A({}, a, {
                type: a.type.slice(1)
            }));
            break;

          case "_mouseup":
            Lb(b, Z.activeClass), Z.bubbleEvents === !0 && f && xb(A({}, a, {
                type: a.type.slice(1)
            }));
            break;

          case "_click":
            e = null, Z.bubbleEvents === !0 && f && xb(A({}, a, {
                type: a.type.slice(1)
            }));
            break;

          case "_mousemove":
            Z.bubbleEvents === !0 && f && xb(A({}, a, {
                type: a.type.slice(1)
            }));
        }
        return /^_(?:click|mouse(?:over|out|down|up|move))$/.test(a.type) ? !0 : void 0;
    }, wb = function(a) {
        if (a.errors && a.errors.length > 0) {
            var b = B(a);
            A(b, {
                type: "error",
                name: "clipboard-error"
            }), delete b.success, i(function() {
                Vb.emit(b);
            }, 0);
        }
    }, xb = function(a) {
        if (a && "string" == typeof a.type && a) {
            var b, c = a.target || null, d = c && c.ownerDocument || g, e = {
                view: d.defaultView || f,
                canBubble: !0,
                cancelable: !0,
                detail: "click" === a.type ? 1 : 0,
                button: "number" == typeof a.which ? a.which - 1 : "number" == typeof a.button ? a.button : d.createEvent ? 0 : 1
            }, h = A(e, a);
            c && d.createEvent && c.dispatchEvent && (h = [ h.type, h.canBubble, h.cancelable, h.view, h.detail, h.screenX, h.screenY, h.clientX, h.clientY, h.ctrlKey, h.altKey, h.shiftKey, h.metaKey, h.button, h.relatedTarget ], 
            b = d.createEvent("MouseEvents"), b.initMouseEvent && (b.initMouseEvent.apply(b, h), 
            b._source = "js", c.dispatchEvent(b)));
        }
    }, yb = function() {
        var a = Z.flashLoadTimeout;
        if ("number" == typeof a && a >= 0) {
            var b = Math.min(1e3, a / 10), c = Z.swfObjectId + "_fallbackContent";
            T = k(function() {
                var a = g.getElementById(c);
                Ob(a) && (Pb(), N.deactivated = null, Vb.emit({
                    type: "error",
                    name: "swf-not-found"
                }));
            }, b);
        }
    }, zb = function() {
        var a = g.createElement("div");
        return a.id = Z.containerId, a.className = Z.containerClass, a.style.position = "absolute", 
        a.style.left = "0px", a.style.top = "-9999px", a.style.width = "1px", a.style.height = "1px", 
        a.style.zIndex = "" + Sb(Z.zIndex), a;
    }, Ab = function(a) {
        for (var b = a && a.parentNode; b && "OBJECT" === b.nodeName && b.parentNode; ) b = b.parentNode;
        return b || null;
    }, Bb = function() {
        var a, b = N.bridge, c = Ab(b);
        if (!b) {
            var d = Ib(f.location.host, Z), e = "never" === d ? "none" : "all", h = Gb(A({
                jsVersion: Vb.version
            }, Z)), i = Z.swfPath + Fb(Z.swfPath, Z);
            c = zb();
            var j = g.createElement("div");
            c.appendChild(j), g.body.appendChild(c);
            var k = g.createElement("div"), l = "activex" === N.pluginType;
            k.innerHTML = '<object id="' + Z.swfObjectId + '" name="' + Z.swfObjectId + '" width="100%" height="100%" ' + (l ? 'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"' : 'type="application/x-shockwave-flash" data="' + i + '"') + ">" + (l ? '<param name="movie" value="' + i + '"/>' : "") + '<param name="allowScriptAccess" value="' + d + '"/><param name="allowNetworking" value="' + e + '"/><param name="menu" value="false"/><param name="wmode" value="transparent"/><param name="flashvars" value="' + h + '"/><div id="' + Z.swfObjectId + '_fallbackContent">&nbsp;</div></object>', 
            b = k.firstChild, k = null, y(b).ZeroClipboard = Vb, c.replaceChild(b, j), yb();
        }
        return b || (b = g[Z.swfObjectId], b && (a = b.length) && (b = b[a - 1]), !b && c && (b = c.firstChild)), 
        N.bridge = b || null, b;
    }, Cb = function() {
        var a = N.bridge;
        if (a) {
            var d = Ab(a);
            d && ("activex" === N.pluginType && "readyState" in a ? (a.style.display = "none", 
            function e() {
                if (4 === a.readyState) {
                    for (var b in a) "function" == typeof a[b] && (a[b] = null);
                    a.parentNode && a.parentNode.removeChild(a), d.parentNode && d.parentNode.removeChild(d);
                } else i(e, 10);
            }()) : (a.parentNode && a.parentNode.removeChild(a), d.parentNode && d.parentNode.removeChild(d))), 
            Pb(), N.ready = null, N.bridge = null, N.deactivated = null, c = b;
        }
    }, Db = function(a) {
        var b = {}, c = {};
        if ("object" == typeof a && a) {
            for (var d in a) if (d && w.call(a, d) && "string" == typeof a[d] && a[d]) switch (d.toLowerCase()) {
              case "text/plain":
              case "text":
              case "air:text":
              case "flash:text":
                b.text = a[d], c.text = d;
                break;

              case "text/html":
              case "html":
              case "air:html":
              case "flash:html":
                b.html = a[d], c.html = d;
                break;

              case "application/rtf":
              case "text/rtf":
              case "rtf":
              case "richtext":
              case "air:rtf":
              case "flash:rtf":
                b.rtf = a[d], c.rtf = d;
            }
            return {
                data: b,
                formatMap: c
            };
        }
    }, Eb = function(a, b) {
        if ("object" != typeof a || !a || "object" != typeof b || !b) return a;
        var c = {};
        for (var d in a) if (w.call(a, d)) if ("errors" === d) {
            c[d] = a[d] ? a[d].slice() : [];
            for (var e = 0, f = c[d].length; f > e; e++) c[d][e].format = b[c[d][e].format];
        } else if ("success" !== d && "data" !== d) c[d] = a[d]; else {
            c[d] = {};
            var g = a[d];
            for (var h in g) h && w.call(g, h) && w.call(b, h) && (c[d][b[h]] = g[h]);
        }
        return c;
    }, Fb = function(a, b) {
        var c = null == b || b && b.cacheBust === !0;
        return c ? (-1 === a.indexOf("?") ? "?" : "&") + "noCache=" + t() : "";
    }, Gb = function(a) {
        var b, c, d, e, g = "", h = [];
        if (a.trustedDomains && ("string" == typeof a.trustedDomains ? e = [ a.trustedDomains ] : "object" == typeof a.trustedDomains && "length" in a.trustedDomains && (e = a.trustedDomains)), 
        e && e.length) for (b = 0, c = e.length; c > b; b++) if (w.call(e, b) && e[b] && "string" == typeof e[b]) {
            if (d = Hb(e[b]), !d) continue;
            if ("*" === d) {
                h.length = 0, h.push(d);
                break;
            }
            h.push.apply(h, [ d, "//" + d, f.location.protocol + "//" + d ]);
        }
        return h.length && (g += "trustedOrigins=" + n(h.join(","))), a.forceEnhancedClipboard === !0 && (g += (g ? "&" : "") + "forceEnhancedClipboard=true"), 
        "string" == typeof a.swfObjectId && a.swfObjectId && (g += (g ? "&" : "") + "swfObjectId=" + n(a.swfObjectId)), 
        "string" == typeof a.jsVersion && a.jsVersion && (g += (g ? "&" : "") + "jsVersion=" + n(a.jsVersion)), 
        g;
    }, Hb = function(a) {
        if (null == a || "" === a) return null;
        if (a = a.replace(/^\s+|\s+$/g, ""), "" === a) return null;
        var b = a.indexOf("//");
        a = -1 === b ? a : a.slice(b + 2);
        var c = a.indexOf("/");
        return a = -1 === c ? a : -1 === b || 0 === c ? null : a.slice(0, c), a && ".swf" === a.slice(-4).toLowerCase() ? null : a || null;
    }, Ib = function() {
        var a = function(a) {
            var b, c, d, e = [];
            if ("string" == typeof a && (a = [ a ]), "object" != typeof a || !a || "number" != typeof a.length) return e;
            for (b = 0, c = a.length; c > b; b++) if (w.call(a, b) && (d = Hb(a[b]))) {
                if ("*" === d) {
                    e.length = 0, e.push("*");
                    break;
                }
                -1 === e.indexOf(d) && e.push(d);
            }
            return e;
        };
        return function(b, c) {
            var d = Hb(c.swfPath);
            null === d && (d = b);
            var e = a(c.trustedDomains), f = e.length;
            if (f > 0) {
                if (1 === f && "*" === e[0]) return "always";
                if (-1 !== e.indexOf(b)) return 1 === f && b === d ? "sameDomain" : "always";
            }
            return "never";
        };
    }(), Jb = function() {
        try {
            return g.activeElement;
        } catch (a) {
            return null;
        }
    }, Kb = function(a, b) {
        var c, d, e, f = [];
        if ("string" == typeof b && b && (f = b.split(/\s+/)), a && 1 === a.nodeType && f.length > 0) if (a.classList) for (c = 0, 
        d = f.length; d > c; c++) a.classList.add(f[c]); else if (a.hasOwnProperty("className")) {
            for (e = " " + a.className + " ", c = 0, d = f.length; d > c; c++) -1 === e.indexOf(" " + f[c] + " ") && (e += f[c] + " ");
            a.className = e.replace(/^\s+|\s+$/g, "");
        }
        return a;
    }, Lb = function(a, b) {
        var c, d, e, f = [];
        if ("string" == typeof b && b && (f = b.split(/\s+/)), a && 1 === a.nodeType && f.length > 0) if (a.classList && a.classList.length > 0) for (c = 0, 
        d = f.length; d > c; c++) a.classList.remove(f[c]); else if (a.className) {
            for (e = (" " + a.className + " ").replace(/[\r\n\t]/g, " "), c = 0, d = f.length; d > c; c++) e = e.replace(" " + f[c] + " ", " ");
            a.className = e.replace(/^\s+|\s+$/g, "");
        }
        return a;
    }, Mb = function(a, b) {
        var c = m(a, null).getPropertyValue(b);
        return "cursor" !== b || c && "auto" !== c || "A" !== a.nodeName ? c : "pointer";
    }, Nb = function(a) {
        var b = {
            left: 0,
            top: 0,
            width: 0,
            height: 0
        };
        if (a.getBoundingClientRect) {
            var c = a.getBoundingClientRect(), d = f.pageXOffset, e = f.pageYOffset, h = g.documentElement.clientLeft || 0, i = g.documentElement.clientTop || 0, j = 0, k = 0;
            if ("relative" === Mb(g.body, "position")) {
                var l = g.body.getBoundingClientRect(), m = g.documentElement.getBoundingClientRect();
                j = l.left - m.left || 0, k = l.top - m.top || 0;
            }
            b.left = c.left + d - h - j, b.top = c.top + e - i - k, b.width = "width" in c ? c.width : c.right - c.left, 
            b.height = "height" in c ? c.height : c.bottom - c.top;
        }
        return b;
    }, Ob = function(a) {
        if (!a) return !1;
        var b = m(a, null), c = r(b.height) > 0, d = r(b.width) > 0, e = r(b.top) >= 0, f = r(b.left) >= 0, g = c && d && e && f, h = g ? null : Nb(a), i = "none" !== b.display && "collapse" !== b.visibility && (g || !!h && (c || h.height > 0) && (d || h.width > 0) && (e || h.top >= 0) && (f || h.left >= 0));
        return i;
    }, Pb = function() {
        j(S), S = 0, l(T), T = 0;
    }, Qb = function() {
        var a;
        if (d && (a = Ab(N.bridge))) {
            var b = Nb(d);
            A(a.style, {
                width: b.width + "px",
                height: b.height + "px",
                top: b.top + "px",
                left: b.left + "px",
                zIndex: "" + Sb(Z.zIndex)
            });
        }
    }, Rb = function(a) {
        N.ready === !0 && (N.bridge && "function" == typeof N.bridge.setHandCursor ? N.bridge.setHandCursor(a) : N.ready = !1);
    }, Sb = function(a) {
        if (/^(?:auto|inherit)$/.test(a)) return a;
        var b;
        return "number" != typeof a || s(a) ? "string" == typeof a && (b = Sb(q(a, 10))) : b = a, 
        "number" == typeof b ? b : "auto";
    }, Tb = function(b) {
        var c, d, e, f = N.sandboxed, g = null;
        if (b = b === !0, M === !1) g = !1; else {
            try {
                d = a.frameElement || null;
            } catch (h) {
                e = {
                    name: h.name,
                    message: h.message
                };
            }
            if (d && 1 === d.nodeType && "IFRAME" === d.nodeName) try {
                g = d.hasAttribute("sandbox");
            } catch (h) {
                g = null;
            } else {
                try {
                    c = document.domain || null;
                } catch (h) {
                    c = null;
                }
                (null === c || e && "SecurityError" === e.name && /(^|[\s\(\[@])sandbox(es|ed|ing|[\s\.,!\)\]@]|$)/.test(e.message.toLowerCase())) && (g = !0);
            }
        }
        return N.sandboxed = g, f === g || b || Ub(o), g;
    }, Ub = function(a) {
        function b(a) {
            var b = a.match(/[\d]+/g);
            return b.length = 3, b.join(".");
        }
        function c(a) {
            return !!a && (a = a.toLowerCase()) && (/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(a) || "chrome.plugin" === a.slice(-13));
        }
        function d(a) {
            a && (i = !0, a.version && (l = b(a.version)), !l && a.description && (l = b(a.description)), 
            a.filename && (k = c(a.filename)));
        }
        var e, f, g, i = !1, j = !1, k = !1, l = "";
        if (h.plugins && h.plugins.length) e = h.plugins["Shockwave Flash"], d(e), h.plugins["Shockwave Flash 2.0"] && (i = !0, 
        l = "2.0.0.11"); else if (h.mimeTypes && h.mimeTypes.length) g = h.mimeTypes["application/x-shockwave-flash"], 
        e = g && g.enabledPlugin, d(e); else if ("undefined" != typeof a) {
            j = !0;
            try {
                f = new a("ShockwaveFlash.ShockwaveFlash.7"), i = !0, l = b(f.GetVariable("$version"));
            } catch (m) {
                try {
                    f = new a("ShockwaveFlash.ShockwaveFlash.6"), i = !0, l = "6.0.21";
                } catch (n) {
                    try {
                        f = new a("ShockwaveFlash.ShockwaveFlash"), i = !0, l = b(f.GetVariable("$version"));
                    } catch (o) {
                        j = !1;
                    }
                }
            }
        }
        N.disabled = i !== !0, N.outdated = l && r(l) < r(O), N.version = l || "0.0.0", 
        N.pluginType = k ? "pepper" : j ? "activex" : i ? "netscape" : "unknown";
    };
    Ub(o), Tb(!0);
    var Vb = function() {
        return this instanceof Vb ? void ("function" == typeof Vb._createClient && Vb._createClient.apply(this, z(arguments))) : new Vb();
    };
    v(Vb, "version", {
        value: "2.2.0",
        writable: !1,
        configurable: !0,
        enumerable: !0
    }), Vb.config = function() {
        return $.apply(this, z(arguments));
    }, Vb.state = function() {
        return _.apply(this, z(arguments));
    }, Vb.isFlashUnusable = function() {
        return ab.apply(this, z(arguments));
    }, Vb.on = function() {
        return bb.apply(this, z(arguments));
    }, Vb.off = function() {
        return cb.apply(this, z(arguments));
    }, Vb.handlers = function() {
        return db.apply(this, z(arguments));
    }, Vb.emit = function() {
        return eb.apply(this, z(arguments));
    }, Vb.create = function() {
        return fb.apply(this, z(arguments));
    }, Vb.destroy = function() {
        return gb.apply(this, z(arguments));
    }, Vb.setData = function() {
        return hb.apply(this, z(arguments));
    }, Vb.clearData = function() {
        return ib.apply(this, z(arguments));
    }, Vb.getData = function() {
        return jb.apply(this, z(arguments));
    }, Vb.focus = Vb.activate = function() {
        return kb.apply(this, z(arguments));
    }, Vb.blur = Vb.deactivate = function() {
        return lb.apply(this, z(arguments));
    }, Vb.activeElement = function() {
        return mb.apply(this, z(arguments));
    };
    var Wb = 0, Xb = {}, Yb = 0, Zb = {}, $b = {};
    A(Z, {
        autoActivate: !0
    });
    var _b = function(a) {
        var b = this;
        b.id = "" + Wb++, Xb[b.id] = {
            instance: b,
            elements: [],
            handlers: {}
        }, a && b.clip(a), Vb.on("*", function(a) {
            return b.emit(a);
        }), Vb.on("destroy", function() {
            b.destroy();
        }), Vb.create();
    }, ac = function(a, d) {
        var e, f, g, h = {}, i = Xb[this.id], j = i && i.handlers;
        if (!i) throw new Error("Attempted to add new listener(s) to a destroyed ZeroClipboard client instance");
        if ("string" == typeof a && a) g = a.toLowerCase().split(/\s+/); else if ("object" == typeof a && a && "undefined" == typeof d) for (e in a) w.call(a, e) && "string" == typeof e && e && "function" == typeof a[e] && this.on(e, a[e]);
        if (g && g.length) {
            for (e = 0, f = g.length; f > e; e++) a = g[e].replace(/^on/, ""), h[a] = !0, j[a] || (j[a] = []), 
            j[a].push(d);
            if (h.ready && N.ready && this.emit({
                type: "ready",
                client: this
            }), h.error) {
                for (e = 0, f = W.length; f > e; e++) if (N[W[e].replace(/^flash-/, "")]) {
                    this.emit({
                        type: "error",
                        name: W[e],
                        client: this
                    });
                    break;
                }
                c !== b && Vb.version !== c && this.emit({
                    type: "error",
                    name: "version-mismatch",
                    jsVersion: Vb.version,
                    swfVersion: c
                });
            }
        }
        return this;
    }, bc = function(a, b) {
        var c, d, e, f, g, h = Xb[this.id], i = h && h.handlers;
        if (!i) return this;
        if (0 === arguments.length) f = u(i); else if ("string" == typeof a && a) f = a.split(/\s+/); else if ("object" == typeof a && a && "undefined" == typeof b) for (c in a) w.call(a, c) && "string" == typeof c && c && "function" == typeof a[c] && this.off(c, a[c]);
        if (f && f.length) for (c = 0, d = f.length; d > c; c++) if (a = f[c].toLowerCase().replace(/^on/, ""), 
        g = i[a], g && g.length) if (b) for (e = g.indexOf(b); -1 !== e; ) g.splice(e, 1), 
        e = g.indexOf(b, e); else g.length = 0;
        return this;
    }, cc = function(a) {
        var b = null, c = Xb[this.id] && Xb[this.id].handlers;
        return c && (b = "string" == typeof a && a ? c[a] ? c[a].slice(0) : [] : B(c)), 
        b;
    }, dc = function(a) {
        if (ic.call(this, a)) {
            "object" == typeof a && a && "string" == typeof a.type && a.type && (a = A({}, a));
            var b = A({}, ob(a), {
                client: this
            });
            jc.call(this, b);
        }
        return this;
    }, ec = function(a) {
        if (!Xb[this.id]) throw new Error("Attempted to clip element(s) to a destroyed ZeroClipboard client instance");
        a = kc(a);
        for (var b = 0; b < a.length; b++) if (w.call(a, b) && a[b] && 1 === a[b].nodeType) {
            a[b].zcClippingId ? -1 === Zb[a[b].zcClippingId].indexOf(this.id) && Zb[a[b].zcClippingId].push(this.id) : (a[b].zcClippingId = "zcClippingId_" + Yb++, 
            Zb[a[b].zcClippingId] = [ this.id ], Z.autoActivate === !0 && lc(a[b]));
            var c = Xb[this.id] && Xb[this.id].elements;
            -1 === c.indexOf(a[b]) && c.push(a[b]);
        }
        return this;
    }, fc = function(a) {
        var b = Xb[this.id];
        if (!b) return this;
        var c, d = b.elements;
        a = "undefined" == typeof a ? d.slice(0) : kc(a);
        for (var e = a.length; e--; ) if (w.call(a, e) && a[e] && 1 === a[e].nodeType) {
            for (c = 0; -1 !== (c = d.indexOf(a[e], c)); ) d.splice(c, 1);
            var f = Zb[a[e].zcClippingId];
            if (f) {
                for (c = 0; -1 !== (c = f.indexOf(this.id, c)); ) f.splice(c, 1);
                0 === f.length && (Z.autoActivate === !0 && mc(a[e]), delete a[e].zcClippingId);
            }
        }
        return this;
    }, gc = function() {
        var a = Xb[this.id];
        return a && a.elements ? a.elements.slice(0) : [];
    }, hc = function() {
        Xb[this.id] && (this.unclip(), this.off(), delete Xb[this.id]);
    }, ic = function(a) {
        if (!a || !a.type) return !1;
        if (a.client && a.client !== this) return !1;
        var b = Xb[this.id], c = b && b.elements, d = !!c && c.length > 0, e = !a.target || d && -1 !== c.indexOf(a.target), f = a.relatedTarget && d && -1 !== c.indexOf(a.relatedTarget), g = a.client && a.client === this;
        return b && (e || f || g) ? !0 : !1;
    }, jc = function(a) {
        var b = Xb[this.id];
        if ("object" == typeof a && a && a.type && b) {
            var c = rb(a), d = b && b.handlers["*"] || [], e = b && b.handlers[a.type] || [], g = d.concat(e);
            if (g && g.length) {
                var h, i, j, k, l, m = this;
                for (h = 0, i = g.length; i > h; h++) j = g[h], k = m, "string" == typeof j && "function" == typeof f[j] && (j = f[j]), 
                "object" == typeof j && j && "function" == typeof j.handleEvent && (k = j, j = j.handleEvent), 
                "function" == typeof j && (l = A({}, a), sb(j, k, [ l ], c));
            }
        }
    }, kc = function(a) {
        return "string" == typeof a && (a = []), "number" != typeof a.length ? [ a ] : a;
    }, lc = function(a) {
        if (a && 1 === a.nodeType) {
            var b = function(a) {
                (a || (a = f.event)) && ("js" !== a._source && (a.stopImmediatePropagation(), a.preventDefault()), 
                delete a._source);
            }, c = function(c) {
                (c || (c = f.event)) && (b(c), Vb.focus(a));
            };
            a.addEventListener("mouseover", c, !1), a.addEventListener("mouseout", b, !1), a.addEventListener("mouseenter", b, !1), 
            a.addEventListener("mouseleave", b, !1), a.addEventListener("mousemove", b, !1), 
            $b[a.zcClippingId] = {
                mouseover: c,
                mouseout: b,
                mouseenter: b,
                mouseleave: b,
                mousemove: b
            };
        }
    }, mc = function(a) {
        if (a && 1 === a.nodeType) {
            var b = $b[a.zcClippingId];
            if ("object" == typeof b && b) {
                for (var c, d, e = [ "move", "leave", "enter", "out", "over" ], f = 0, g = e.length; g > f; f++) c = "mouse" + e[f], 
                d = b[c], "function" == typeof d && a.removeEventListener(c, d, !1);
                delete $b[a.zcClippingId];
            }
        }
    };
    Vb._createClient = function() {
        _b.apply(this, z(arguments));
    }, Vb.prototype.on = function() {
        return ac.apply(this, z(arguments));
    }, Vb.prototype.off = function() {
        return bc.apply(this, z(arguments));
    }, Vb.prototype.handlers = function() {
        return cc.apply(this, z(arguments));
    }, Vb.prototype.emit = function() {
        return dc.apply(this, z(arguments));
    }, Vb.prototype.clip = function() {
        return ec.apply(this, z(arguments));
    }, Vb.prototype.unclip = function() {
        return fc.apply(this, z(arguments));
    }, Vb.prototype.elements = function() {
        return gc.apply(this, z(arguments));
    }, Vb.prototype.destroy = function() {
        return hc.apply(this, z(arguments));
    }, Vb.prototype.setText = function(a) {
        if (!Xb[this.id]) throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");
        return Vb.setData("text/plain", a), this;
    }, Vb.prototype.setHtml = function(a) {
        if (!Xb[this.id]) throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");
        return Vb.setData("text/html", a), this;
    }, Vb.prototype.setRichText = function(a) {
        if (!Xb[this.id]) throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");
        return Vb.setData("application/rtf", a), this;
    }, Vb.prototype.setData = function() {
        if (!Xb[this.id]) throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");
        return Vb.setData.apply(this, z(arguments)), this;
    }, Vb.prototype.clearData = function() {
        if (!Xb[this.id]) throw new Error("Attempted to clear pending clipboard data from a destroyed ZeroClipboard client instance");
        return Vb.clearData.apply(this, z(arguments)), this;
    }, Vb.prototype.getData = function() {
        if (!Xb[this.id]) throw new Error("Attempted to get pending clipboard data from a destroyed ZeroClipboard client instance");
        return Vb.getData.apply(this, z(arguments));
    }, "function" == typeof define && define.amd ? define("zeroclipboard", [], function() {
        return Vb;
    }) : "object" == typeof module && module && "object" == typeof module.exports && module.exports ? module.exports = Vb : a.ZeroClipboard = Vb;
}(function() {
    return this || window;
}()), define("meet/topbar/topic", [ "moxtra", "app", "lang", "const", "text!template/meet/topbar/topic.html", "meet/meetUtil", "zeroclipboard" ], function(a, b, c, d, e, f, g) {
    MX.logger("meet:topic");
    return a.Controller.extend({
        template: e,
        handleAction: !0,
        init: function(a) {
            this.profile = a.profile || {}, this.sessionKey = this.profile.sessionKey, this.link = this._genLink(this.profile.sessionKey);
            var b = this.profile.host || {};
            this.$scope.lang = c, this.$scope.meet = {
                id: this.sessionKey,
                formatedId: f.formatMeetId(this.sessionKey),
                topic: Handlebars.Utils.escapeExpression(this.profile.topic) || "",
                host: MX.format(c.meet_hosted_by, {
                    name: Handlebars.Utils.escapeExpression(b.name || b.first_name || b.email)
                }),
                link: this.link
            };
            var d = MX.env.detectFlash();
            this.$scope.flashEnabled = d.isSupported ? !0 : !1;
        },
        rendered: function() {
            if (b.isMacAgentAppstore() || b.isMacAgentLocal()) {
                var a = this.link;
                this.$("#mxMeetLink").on("click", function() {
                    b.sendMessage({
                        action: "request_copy_text",
                        text: a,
                        session_id: Moxtra.getMe().sessionId
                    }), setTimeout(function() {
                        MX.ui.notifySuccess(c.meet_click_copy_link_success);
                    }, 300);
                });
            } else if (!b.isIntegrationAgent() || navigator.userAgent.indexOf(d.flags.windowsAgent) > 0) {
                var e = MX.env.detectFlash();
                if (e.isSupported) {
                    g.config({
                        swfPath: "lib/zeroclipboard/dist/ZeroClipboard.a573941f.swf"
                    });
                    var f = new g(this.$("#mxMeetLink")), h = this.link;
                    f.setText(h), f.on("ready", function(a) {
                        var b = a.client;
                        b.on("beforecopy", function() {
                            b.setText(h);
                        }), b.on("aftercopy", function() {
                            MX.ui.notifySuccess(c.meet_click_copy_link_success);
                        });
                    });
                }
                this.recovery(function() {
                    e.isSupported && g.destroy();
                });
            }
        },
        _genLink: function(a) {
            return MX.format("{0}//{1}/{2}", location.protocol, location.host, a);
        },
        stopListen: function() {}
    });
}), define("text!template/meet/topbar/add.html", [], function() {
    return '<div class="action-section hide">\r\n	<span class="dropdown add-file">\r\n		<a id="mxMeetAddFile" data-toggle="dropdown" class="mx-branding topbar-action mouse-hand" data-action="refreshUploader"><i class="mx-branding micon-plus-with-circle size20"></i> <span class="hidden-xs-inline">{{lang.share_file}} <span class="mx-branding caret caret-white"></span></span></a>\r\n		{{addPageMenu \'pull-right\' session_key }}\r\n	</span>\r\n</div>';
}), define("text!template/meet/topbar/endShareFile.html", [], function() {
    return '<li class="divider end-share-file hide"></li>\n<li class="add-page-item  mx-ie-relative end-share-file hide">\n	<a class="mouse-hand"><i class="micon-screen-share size16 blue marginRight5"></i>{{lang.end_share}}</a>\n</li>';
}), function() {
    var a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z, A, B, C, D, E, F = [].slice, G = [].indexOf || function(a) {
        for (var b = 0, c = this.length; c > b; b++) if (b in this && this[b] === a) return b;
        return -1;
    };
    return null == (A = window.Dropbox) && (window.Dropbox = {}), null == (B = Dropbox.baseUrl) && (Dropbox.baseUrl = "https://www.dropbox.com"), 
    null == (C = Dropbox.blockBaseUrl) && (Dropbox.blockBaseUrl = "https://dl.dropbox.com"), 
    Dropbox.addListener = function(a, b, c) {
        a.addEventListener ? a.addEventListener(b, c, !1) : a.attachEvent("on" + b, function(a) {
            return a.preventDefault = function() {
                return this.returnValue = !1;
            }, c(a);
        });
    }, Dropbox.removeListener = function(a, b, c) {
        a.removeEventListener ? a.removeEventListener(b, c, !1) : a.detachEvent("on" + b, c);
    }, d = function(a) {
        var b, c;
        return c = encodeURIComponent(Dropbox.VERSION), b = -1 === a.indexOf("?") ? "?" : "&", 
        "" + a + b + "version=" + c;
    }, f = function(a, b) {
        var c, e, f, g, h, i, j, k, l;
        return i = encodeURIComponent(window.location.protocol + "//" + window.location.host), 
        c = encodeURIComponent(Dropbox.appKey), g = encodeURIComponent(a.linkType || ""), 
        j = encodeURIComponent(a._trigger || "js"), h = Boolean(a.multiselect), e = encodeURIComponent((null != (l = a.extensions) && "function" == typeof l.join ? l.join(" ") : void 0) || ""), 
        f = Boolean(a.folderselect), b = Boolean(b), k = "" + Dropbox.baseUrl + "/chooser?origin=" + i + "&app_key=" + c + "&link_type=" + g, 
        k += "&trigger=" + j + "&multiselect=" + h + "&extensions=" + e + "&folderselect=" + f + "&iframe=" + b, 
        d(k);
    }, y = function() {
        var a, b, c;
        return b = encodeURIComponent(window.location.protocol + "//" + window.location.host), 
        a = encodeURIComponent(Dropbox.appKey), c = "" + Dropbox.baseUrl + "/saver?origin=" + b + "&app_key=" + a, 
        d(c);
    }, t = 1, o = function(a, b) {
        var c, e, f, g;
        return c = encodeURIComponent(Dropbox.appKey), g = "" + Dropbox.baseUrl + "/dropins/job_status?job=" + b + "&app_key=" + c, 
        g = d(g), f = function(b) {
            var c;
            "COMPLETE" === b.status ? ("function" == typeof a.progress && a.progress(1), "function" == typeof a.success && a.success()) : "PENDING" === (c = b.status) || "DOWNLOADING" === c ? (null != b.progress && "function" == typeof a.progress && a.progress(b.progress / 100), 
            setTimeout(e, 1500)) : "FAILED" === b.status && "function" == typeof a.error && a.error(b.error);
        }, e = "withCredentials" in new XMLHttpRequest() ? function() {
            var b;
            return b = new XMLHttpRequest(), b.onload = function() {
                return f(JSON.parse(b.responseText));
            }, b.onerror = function() {
                return "function" == typeof a.error ? a.error() : void 0;
            }, b.open("GET", g, !0), b.send();
        } : function() {
            var b, c, d;
            return b = "DropboxJsonpCallback" + t++, c = !1, window[b] = function(a) {
                return c = !0, f(a);
            }, d = document.createElement("script"), d.src = "" + g + "&callback=" + b, d.onreadystatechange = function() {
                var b;
                return "loaded" === d.readyState ? (c || "function" == typeof a.error && a.error(), 
                null != (b = d.parentNode) ? b.removeChild(d) : void 0) : void 0;
            }, document.getElementsByTagName("head")[0].appendChild(d);
        }, "function" == typeof a.progress && a.progress(0), e();
    }, p = function(a, b, c) {
        var d, e, f;
        switch (d = JSON.parse(a.data), d.method) {
          case "ready":
            null != c.files && (f = JSON.stringify({
                method: "files",
                params: c.files
            }), e = "undefined" != typeof q && null !== q && c._popup ? q.contentWindow : a.source, 
            e.postMessage(f, Dropbox.baseUrl)), "function" == typeof c.ready && c.ready();
            break;

          case "files_selected":
          case "files_saved":
            "function" == typeof b && b(), "function" == typeof c.success && c.success(d.params);
            break;

          case "progress":
            "function" == typeof c.progress && c.progress(d.params);
            break;

          case "close_dialog":
            "function" == typeof b && b(), "function" == typeof c.cancel && c.cancel();
            break;

          case "web_session_error":
            "function" == typeof b && b(), "function" == typeof c.webSessionFailure && c.webSessionFailure();
            break;

          case "web_session_unlinked":
            "function" == typeof b && b(), "function" == typeof c.webSessionUnlinked && c.webSessionUnlinked();
            break;

          case "resize":
            "function" == typeof c.resize && c.resize(d.params);
            break;

          case "error":
            "function" == typeof b && b(), "function" == typeof c.error && c.error(d.params);
            break;

          case "job_id":
            "function" == typeof b && b(), o(c, d.params);
            break;

          case "_debug_log":
            "undefined" != typeof console && null !== console && console.log(d.params.msg);
        }
    }, q = null, h = function() {
        "Microsoft Internet Explorer" === navigator.appName && (q = document.createElement("iframe"), 
        q.setAttribute("id", "dropbox_xcomm"), q.setAttribute("src", Dropbox.baseUrl + "/static/api/1/xcomm.html"), 
        q.style.display = "none", document.getElementsByTagName("body")[0].appendChild(q));
    }, Dropbox.createChooserWidget = function(a) {
        var b;
        return b = i(f(a, !0)), b._handler = function(c) {
            c.source === b.contentWindow && c.origin === Dropbox.baseUrl && p(c, null, a);
        }, Dropbox.addListener(window, "message", b._handler), b;
    }, Dropbox.cleanupWidget = function(a) {
        if (!a._handler) throw "Invalid widget!";
        Dropbox.removeListener(window, "message", a._handler), delete a._handler;
    }, x = function(a, b) {
        var c, d;
        return c = (window.screenX || window.screenLeft) + ((window.outerWidth || document.documentElement.offsetWidth) - a) / 2, 
        d = (window.screenY || window.screenTop) + ((window.outerHeight || document.documentElement.offsetHeight) - b) / 2, 
        "width=" + a + ",height=" + b + ",left=" + c + ",top=" + d;
    }, Dropbox._dropinsjs_loaded ? void ("undefined" != typeof console && null !== console && "function" == typeof console.warn && console.warn("dropins.js included more than once")) : (Dropbox._dropinsjs_loaded = !0, 
    null == (D = Dropbox.appKey) && (Dropbox.appKey = null != (E = document.getElementById("dropboxjs")) ? E.getAttribute("data-app-key") : void 0), 
    a = "https://www.dropbox.com/developers/dropins/chooser/js", c = [ "text", "documents", "images", "video", "audio" ], 
    Dropbox.init = function(a) {
        Dropbox.appKey = a.appKey;
    }, i = function(a) {
        var b;
        return b = document.createElement("iframe"), b.src = a, b.style.display = "block", 
        b.style.backgroundColor = "white", b.style.border = "none", b;
    }, w = function(a) {
        var b, c, d, e, f, g, h, i;
        if ("string" == typeof a[0]) e = a.shift(), c = "string" == typeof a[0] ? a.shift() : n(e), 
        d = {
            files: [ {
                url: e,
                filename: c
            } ]
        }; else {
            if (d = a.shift(), null == d) throw "Missing arguments. See documentation.";
            if ((null != (h = d.files) ? !h.length : !0) && "function" != typeof d.files) throw "Missing files. See documentation.";
            for (i = d.files, f = 0, g = i.length; g > f; f++) b = i[f], b.filename || (b.filename = n(b.url));
        }
        return d;
    }, Dropbox.save = function() {
        var a, b, c, d, e, f, g;
        if (a = 1 <= arguments.length ? F.call(arguments, 0) : [], d = w(a), !Dropbox.isBrowserSupported()) return void alert("Your browser does not support the Dropbox Saver");
        if (d._popup = !0, "object" != typeof d.files || !d.files.length) throw "Opening the saver failed. The object passed in must have a 'files' property that contains a list of objects.  See documentation.";
        for (g = d.files, e = 0, f = g.length; f > e; e++) if (c = g[e], "string" != typeof c.url) throw "File urls to download incorrectly configured.  Each file must have a url. See documentation.";
        return b = x(352, 237), v(y(d), b, d);
    }, v = function(a, b, c) {
        var d, e, f, g, h;
        return d = function() {
            g.closed || g.close(), Dropbox.removeListener(window, "message", e), clearInterval(h);
        }, e = function(a) {
            (a.source === g || a.source === (null != q ? q.contentWindow : void 0)) && p(a, d, c);
        }, f = function() {
            g.closed && (d(), "function" == typeof c.cancel && c.cancel());
        }, g = window.open(a, "dropbox", "" + b + ",resizable=yes,location=yes"), g.focus(), 
        h = setInterval(f, 100), Dropbox.addListener(window, "message", e), g;
    }, z = function(b) {
        var d, e, f, g, h;
        if (null == b.success && "undefined" != typeof console && null !== console && "function" == typeof console.warn && console.warn("You must provide a success callback to the Chooser to see the files that the user selects"), 
        e = function() {
            return "undefined" != typeof console && null !== console && "function" == typeof console.warn && console.warn("The provided list of extensions or file types is not valid. See Chooser documentation: " + a), 
            "undefined" != typeof console && null !== console && "function" == typeof console.warn && console.warn("Available file types are: " + c.join(", ")), 
            delete b.extensions;
        }, null != b.extensions) if ("[object Array]" === Object.prototype.toString.call(b.extensions)) for (h = b.extensions, 
        f = 0, g = h.length; g > f; f++) d = h[f], !d.match(/^\.[\.\w$#&+@!()\-'`_~]+$/) && G.call(c, d) < 0 && e(); else e();
        return b;
    }, e = function(a) {
        var b, c, d, e, g, h, j, k;
        return Dropbox.isBrowserSupported() ? (k = 660, e = 440, void (a.iframe ? (j = i(f(a, !0)), 
        j.style.width = k + "px", j.style.height = e + "px", h = document.createElement("div"), 
        h.style.position = "fixed", h.style.left = h.style.right = h.style.top = h.style.bottom = "0px", 
        h.style.zIndex = "1000", b = document.createElement("div"), b.style.position = "absolute", 
        b.style.left = b.style.right = b.style.top = b.style.bottom = "0px", b.style.backgroundColor = "rgb(160, 160, 160)", 
        b.style.opacity = "0.2", b.style.filter = "progid:DXImageTransform.Microsoft.Alpha(Opacity=20)", 
        g = document.createElement("div"), g.style.position = "relative", g.style.width = k + "px", 
        g.style.margin = "125px auto 0px auto", g.style.border = "1px solid #ACACAC", g.style.boxShadow = "rgba(0, 0, 0, .2) 0px 4px 16px", 
        g.appendChild(j), h.appendChild(b), h.appendChild(g), document.body.appendChild(h), 
        d = function(b) {
            b.source === j.contentWindow && p(b, function() {
                document.body.removeChild(h), Dropbox.removeListener(window, "message", d);
            }, a);
        }, Dropbox.addListener(window, "message", d)) : (c = x(k, e), v(f(a), c, a)))) : void alert("Your browser does not support the Dropbox Chooser");
    }, Dropbox.choose = function(a) {
        null == a && (a = {}), a = z(a), e(a);
    }, Dropbox.isBrowserSupported = function() {
        var a;
        return a = s(), Dropbox.isBrowserSupported = function() {
            return a;
        }, a;
    }, s = function() {
        var a, b, c, d;
        for (d = [ /Windows Phone/, /BB10;/, /CriOS/, /MSIE [67]\./ ], b = 0, c = d.length; c > b; b++) if (a = d[b], 
        a.test(navigator.userAgent)) return !1;
        return !0;
    }, m = function(a) {
        return a.replace(/\/+$/g, "").split("/").pop();
    }, n = function(a) {
        var b;
        return b = document.createElement("a"), b.href = a, m(b.pathname);
    }, g = function(a, b) {
        var c;
        return null != b ? b.innerHTML = "" : (b = document.createElement("a"), b.href = "#"), 
        b.className += " dropbox-dropin-btn", b.className += Dropbox.isBrowserSupported() ? " dropbox-dropin-default" : " dropbox-dropin-disabled", 
        c = document.createElement("span"), c.className = "dropin-btn-status", b.appendChild(c), 
        a = document.createTextNode(a), b.appendChild(a), b;
    }, Dropbox.createChooseButton = function(a) {
        var b;
        return null == a && (a = {}), a = z(a), b = g("Choose from Dropbox"), Dropbox.addListener(b, "click", function(c) {
            c.preventDefault(), e({
                success: function(c) {
                    b.className = "dropbox-dropin-btn dropbox-dropin-success", "function" == typeof a.success && a.success(c);
                },
                cancel: a.cancel,
                linkType: a.linkType,
                multiselect: a.multiselect,
                extensions: a.extensions,
                iframe: a.iframe,
                _trigger: "button"
            });
        }), b;
    }, Dropbox.createSaveButton = function() {
        var a, b, c;
        return a = 1 <= arguments.length ? F.call(arguments, 0) : [], c = w(a), b = a.shift(), 
        b = g("Save to Dropbox", b), Dropbox.addListener(b, "click", function(a) {
            var d;
            return a.preventDefault(), b.className.indexOf("dropbox-dropin-error") >= 0 || b.className.indexOf("dropbox-dropin-default") >= 0 || b.className.indexOf("dropbox-dropin-disabled") >= 0 ? (d = ("function" == typeof c.files ? c.files() : void 0) || c.files, 
            (null != d ? d.length : void 0) ? void Dropbox.save({
                files: d,
                success: function() {
                    b.className = "dropbox-dropin-btn dropbox-dropin-success", "function" == typeof c.success && c.success();
                },
                progress: function(a) {
                    b.className = "dropbox-dropin-btn dropbox-dropin-progress", "function" == typeof c.progress && c.progress(a);
                },
                cancel: function() {
                    "function" == typeof c.cancel && c.cancel();
                },
                error: function(a) {
                    b.className = "dropbox-dropin-btn dropbox-dropin-error", "function" == typeof c.error && c.error(a);
                }
            }) : (b.className = "dropbox-dropin-btn dropbox-dropin-error", void ("function" == typeof c.error && c.error("Missing files")))) : void 0;
        }), b;
    }, u = function(a, b) {
        return "background: " + a + ";\nbackground: -moz-linear-gradient(top, " + a + " 0%, " + b + " 100%);\nbackground: -webkit-linear-gradient(top, " + a + " 0%, " + b + " 100%);\nbackground: linear-gradient(to bottom, " + a + " 0%, " + b + " 100%);\nfilter: progid:DXImageTransform.Microsoft.gradient(startColorstr='" + a + "', endColorstr='" + b + "',GradientType=0);";
    }, j = document.createElement("style"), j.type = "text/css", k = '@-webkit-keyframes rotate {\n  from  { -webkit-transform: rotate(0deg); }\n  to   { -webkit-transform: rotate(360deg); }\n}\n\n@keyframes rotate {\n  from  { transform: rotate(0deg); }\n  to   { transform: rotate(360deg); }\n}\n\n.dropbox-dropin-btn, .dropbox-dropin-btn:link, .dropbox-dropin-btn:hover {\n  display: inline-block;\n  height: 14px;\n  font-family: "Lucida Grande", "Segoe UI", "Tahoma", "Helvetica Neue", "Helvetica", sans-serif;\n  font-size: 11px;\n  font-weight: 600;\n  color: #636363;\n  text-decoration: none;\n  padding: 1px 7px 5px 3px;\n  border: 1px solid #ebebeb;\n  border-radius: 2px;\n  border-bottom-color: #d4d4d4;\n  ' + u("#fcfcfc", "#f5f5f5") + "\n}\n\n.dropbox-dropin-default:hover, .dropbox-dropin-error:hover {\n  border-color: #dedede;\n  border-bottom-color: #cacaca;\n  " + u("#fdfdfd", "#f5f5f5") + "\n}\n\n.dropbox-dropin-default:active, .dropbox-dropin-error:active {\n  border-color: #d1d1d1;\n  box-shadow: inset 0 1px 1px rgba(0,0,0,0.1);\n}\n\n.dropbox-dropin-btn .dropin-btn-status {\n  display: inline-block;\n  width: 15px;\n  height: 14px;\n  vertical-align: bottom;\n  margin: 0 5px 0 2px;\n  background: transparent url('" + Dropbox.baseUrl + "/static/images/widgets/dbx-saver-status.png') no-repeat;\n  position: relative;\n  top: 2px;\n}\n\n.dropbox-dropin-default .dropin-btn-status {\n  background-position: 0px 0px;\n}\n\n.dropbox-dropin-progress .dropin-btn-status {\n  width: 18px;\n  margin: 0 4px 0 0;\n  background: url('" + Dropbox.baseUrl + "/static/images/widgets/dbx-progress.png') no-repeat center center;\n  -webkit-animation-name: rotate;\n  -webkit-animation-duration: 1.7s;\n  -webkit-animation-iteration-count: infinite;\n  -webkit-animation-timing-function: linear;\n  animation-name: rotate;\n  animation-duration: 1.7s;\n  animation-iteration-count: infinite;\n  animation-timing-function: linear;\n}\n\n.dropbox-dropin-success .dropin-btn-status {\n  background-position: -15px 0px;\n}\n\n.dropbox-dropin-disabled {\n  background: #e0e0e0;\n  border: 1px #dadada solid;\n  border-bottom: 1px solid #ccc;\n  box-shadow: none;\n}\n\n.dropbox-dropin-disabled .dropin-btn-status {\n  background-position: -30px 0px;\n}\n\n.dropbox-dropin-error .dropin-btn-status {\n  background-position: -45px 0px;\n}\n\n@media only screen and (-webkit-min-device-pixel-ratio: 1.4) {\n  .dropbox-dropin-btn .dropin-btn-status {\n    background-image: url('" + Dropbox.baseUrl + "/static/images/widgets/dbx-saver-status-2x.png');\n    background-size: 60px 14px;\n    -webkit-background-size: 60px 14px;\n  }\n\n  .dropbox-dropin-progress .dropin-btn-status {\n    background: url('" + Dropbox.baseUrl + "/static/images/widgets/dbx-progress-2x.png') no-repeat center center;\n    background-size: 20px 20px;\n    -webkit-background-size: 20px 20px;\n  }\n}\n\n.dropbox-saver:hover, .dropbox-chooser:hover {\n  text-decoration: none;\n  cursor: pointer;\n}\n\n.dropbox-chooser, .dropbox-dropin-btn {\n  line-height: 11px !important;\n  text-decoration: none !important;\n  box-sizing: content-box !important;\n  -webkit-box-sizing: content-box !important;\n  -moz-box-sizing: content-box !important;\n}\n", 
    j.styleSheet ? j.styleSheet.cssText = k : j.textContent = k, document.getElementsByTagName("head")[0].appendChild(j), 
    setTimeout(h, 0), b = function() {
        return document.removeEventListener ? document.removeEventListener("DOMContentLoaded", b, !1) : document.detachEvent && document.detachEvent("onreadystatechange", b), 
        r();
    }, "complete" === document.readyState ? setTimeout(b, 0) : document.addEventListener ? document.addEventListener("DOMContentLoaded", b, !1) : document.attachEvent("onreadystatechange", b), 
    Dropbox.VERSION = "1", Dropbox.createWidget = Dropbox.createChooserWidget, Dropbox.cleanupChooserWidget = Dropbox.cleanupWidget, 
    Dropbox.attach = Dropbox.choose, Dropbox.saveURL = function() {
        var a;
        return null != (a = window.console) && "function" == typeof a.warn && a.warn("Dropbox.saveURL is deprecated.  Please use Dropbox.save"), 
        Dropbox.save(arguments[0], arguments[1], arguments[2]);
    }, l = function(a, b, c) {
        var d, e, f;
        if (null == c && (c = {}), null != document.createEvent) {
            d = document.createEvent("Event"), d.initEvent(b, !0, !0);
            for (e in c) f = c[e], d[e] = f;
            a.dispatchEvent(d);
        }
    }, void (r = function() {
        var a, b, c, d, e, f, h;
        for (f = document.getElementsByTagName("input"), b = 0, d = f.length; d > b; b++) a = f[b], 
        "dropbox-chooser" === a.getAttribute("type") && !function(a) {
            var b;
            b = g("Choose from Dropbox"), a.style.display = "none", Dropbox.addListener(b, "click", function(c) {
                var d, e;
                c.preventDefault(), Dropbox.choose({
                    success: function(c) {
                        var d, e;
                        e = function() {
                            var a, b, e;
                            for (e = [], a = 0, b = c.length; b > a; a++) d = c[a], e.push(d.link);
                            return e;
                        }(), a.value = e.join(", "), a.files = c, l(a, "DbxChooserSuccess", {
                            files: c
                        }), b.className = "dropbox-dropin-btn dropbox-dropin-success";
                    },
                    cancel: function() {
                        l(a, "DbxChooserCancel");
                    },
                    linkType: a.getAttribute("data-link-type") || "preview",
                    multiselect: "True" === (d = a.getAttribute("data-multiselect")) || "true" === d || "1" === d || !1,
                    extensions: (null != (e = a.getAttribute("data-extensions")) ? e.split(/\s+/) : void 0) || [],
                    _trigger: "button"
                });
            }), a.parentNode.insertBefore(b, a);
        }(a);
        for (h = document.getElementsByTagName("a"), c = 0, e = h.length; e > c; c++) a = h[c], 
        G.call((a.getAttribute("class") || "").split(" "), "dropbox-saver") >= 0 && !function(a) {
            Dropbox.createSaveButton({
                files: function() {
                    return [ {
                        url: a.getAttribute("data-url") || a.href,
                        filename: a.getAttribute("data-filename") || m(a.pathname)
                    } ];
                },
                success: function() {
                    l(a, "DbxSaverSuccess");
                },
                progress: function(b) {
                    l(a, "DbxSaverProgress", {
                        progress: b
                    });
                },
                cancel: function() {
                    l(a, "DbxSaverCancel");
                },
                error: function(b) {
                    l(a, "DbxSaverError", {
                        error: b
                    });
                }
            }, a);
        }(a);
    }));
}.call(this), define("dropins", function() {}), function() {
    var a = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/", b = window.Crypto = {}, c = b.util = {
        rotl: function(a, b) {
            return a << b | a >>> 32 - b;
        },
        rotr: function(a, b) {
            return a << 32 - b | a >>> b;
        },
        endian: function(a) {
            if (a.constructor == Number) return 16711935 & c.rotl(a, 8) | 4278255360 & c.rotl(a, 24);
            for (var b = 0; b < a.length; b++) a[b] = c.endian(a[b]);
            return a;
        },
        randomBytes: function(a) {
            for (var b = []; a > 0; a--) b.push(Math.floor(256 * Math.random()));
            return b;
        },
        bytesToWords: function(a) {
            for (var b = [], c = 0, d = 0; c < a.length; c++, d += 8) b[d >>> 5] |= a[c] << 24 - d % 32;
            return b;
        },
        wordsToBytes: function(a) {
            for (var b = [], c = 0; c < 32 * a.length; c += 8) b.push(a[c >>> 5] >>> 24 - c % 32 & 255);
            return b;
        },
        bytesToHex: function(a) {
            for (var b = [], c = 0; c < a.length; c++) b.push((a[c] >>> 4).toString(16)), b.push((15 & a[c]).toString(16));
            return b.join("");
        },
        hexToBytes: function(a) {
            for (var b = [], c = 0; c < a.length; c += 2) b.push(parseInt(a.substr(c, 2), 16));
            return b;
        },
        bytesToBase64: function(b) {
            if ("function" == typeof btoa) return btoa(e.bytesToString(b));
            for (var c = [], d = 0; d < b.length; d += 3) for (var f = b[d] << 16 | b[d + 1] << 8 | b[d + 2], g = 0; 4 > g; g++) c.push(8 * d + 6 * g <= 8 * b.length ? a.charAt(f >>> 6 * (3 - g) & 63) : "=");
            return c.join("");
        },
        base64ToBytes: function(b) {
            if ("function" == typeof atob) return e.stringToBytes(atob(b));
            b = b.replace(/[^A-Z0-9+\/]/gi, "");
            for (var c = [], d = 0, f = 0; d < b.length; f = ++d % 4) 0 != f && c.push((a.indexOf(b.charAt(d - 1)) & Math.pow(2, -2 * f + 8) - 1) << 2 * f | a.indexOf(b.charAt(d)) >>> 6 - 2 * f);
            return c;
        }
    };
    b.mode = {};
    var d = b.charenc = {}, e = (d.UTF8 = {
        stringToBytes: function(a) {
            return e.stringToBytes(unescape(encodeURIComponent(a)));
        },
        bytesToString: function(a) {
            return decodeURIComponent(escape(e.bytesToString(a)));
        }
    }, d.Binary = {
        stringToBytes: function(a) {
            for (var b = [], c = 0; c < a.length; c++) b.push(a.charCodeAt(c));
            return b;
        },
        bytesToString: function(a) {
            for (var b = [], c = 0; c < a.length; c++) b.push(String.fromCharCode(a[c]));
            return b.join("");
        }
    });
}(), function() {
    var a = Crypto, b = a.util, c = a.charenc, d = c.UTF8, e = c.Binary, f = a.SHA1 = function(a, c) {
        var d = b.wordsToBytes(f._sha1(a));
        return c && c.asBytes ? d : c && c.asString ? e.bytesToString(d) : b.bytesToHex(d);
    };
    f._sha1 = function(a) {
        a.constructor == String && (a = d.stringToBytes(a));
        var c = b.bytesToWords(a), e = 8 * a.length, f = [], g = 1732584193, h = -271733879, i = -1732584194, j = 271733878, k = -1009589776;
        c[e >> 5] |= 128 << 24 - e % 32, c[(e + 64 >>> 9 << 4) + 15] = e;
        for (var l = 0; l < c.length; l += 16) {
            for (var m = g, n = h, o = i, p = j, q = k, r = 0; 80 > r; r++) {
                if (16 > r) f[r] = c[l + r]; else {
                    var s = f[r - 3] ^ f[r - 8] ^ f[r - 14] ^ f[r - 16];
                    f[r] = s << 1 | s >>> 31;
                }
                var t = (g << 5 | g >>> 27) + k + (f[r] >>> 0) + (20 > r ? (h & i | ~h & j) + 1518500249 : 40 > r ? (h ^ i ^ j) + 1859775393 : 60 > r ? (h & i | h & j | i & j) - 1894007588 : (h ^ i ^ j) - 899497514);
                k = j, j = i, i = h << 30 | h >>> 2, h = g, g = t;
            }
            g += m, h += n, i += o, j += p, k += q;
        }
        return [ g, h, i, j, k ];
    }, f._blocksize = 16;
}(), function() {
    var a = Crypto, b = a.util, c = a.charenc, d = c.UTF8, e = c.Binary;
    a.HMAC = function(a, c, f, g) {
        c.constructor == String && (c = d.stringToBytes(c)), f.constructor == String && (f = d.stringToBytes(f)), 
        f.length > 4 * a._blocksize && (f = a(f, {
            asBytes: !0
        }));
        for (var h = f.slice(0), i = f.slice(0), j = 0; j < 4 * a._blocksize; j++) h[j] ^= 92, 
        i[j] ^= 54;
        var k = a(h.concat(a(i.concat(c), {
            asBytes: !0
        })), {
            asBytes: !0
        });
        return g && g.asBytes ? k : g && g.asString ? e.bytesToString(k) : b.bytesToHex(k);
    };
}(), function() {
    var a = Crypto, b = a.util, c = a.charenc, d = c.UTF8, e = c.Binary;
    a.PBKDF2 = function(c, f, g, h) {
        function i(b, c) {
            return a.HMAC(j, c, b, {
                asBytes: !0
            });
        }
        c.constructor == String && (c = d.stringToBytes(c)), f.constructor == String && (f = d.stringToBytes(f));
        for (var j = h && h.hasher || a.SHA1, k = h && h.iterations || 1, l = [], m = 1; l.length < g; ) {
            for (var n = i(c, f.concat(b.wordsToBytes([ m ]))), o = n, p = 1; k > p; p++) {
                o = i(c, o);
                for (var q = 0; q < n.length; q++) n[q] ^= o[q];
            }
            l = l.concat(n), m++;
        }
        return l.length = g, h && h.asBytes ? l : h && h.asString ? e.bytesToString(l) : b.bytesToHex(l);
    };
}(), define("crypto", function() {}), define("text!template/binder/pageAddDesktop.html", [], function() {
    return '<div class="mx-add-page-desktop">\n    <div class="list hidden">\n        <div class="nav">\n\n            <ol class="breadcrumb hidden">\n            </ol>\n        </div>\n        <div class="get-failed alert alert-info hidden">\n            {{lang.get_remote_files_failed}}\n        </div>\n        <ul class="desktop-agents">\n        </ul>\n    </div>\n    <div class="no-agent alert alert-info hidden">\n        {{lang.no_moxtra_desktop_installed}}\n        <div class="btns">\n            <a class="btn btn-default btn-sm" href="http://www.moxtra.com/download/desktopapp">{{lang.download}}</a>\n        </div>\n    </div>\n    <div class="loading">\n        {{lang.loading}}\n    </div>\n    <div class="passcode-form">\n        <div class="input-group">\n            <input placeholder="{{lang.passcode}}" class="form-control passcode" type="password"/>\n            <span class="input-group-btn">\n                <button class="btn btn-default" data-action="submitPasscode">{{lang.submit}}</button></span>\n\n        </div>\n    </div>\n    <div class="popover left agent-popover">\n        <div class="arrow"></div>\n        <div class="popover-content"><img/></div>\n    </div>\n</div>\n';
}), define("text!template/binder/agentItem.html", [], function() {
    return '<li>\n    <a {{#if _offline}}class="disabled"{{else}}{{#unless _allowed}}class="disabled"{{/unless}} {{/if}} data-action="{{#if _is_file}}selectFile{{else}}gotoItem{{/if}}" data-param="{{_parent_path}},{{_name}},{{_agent_id}}" href="javascript:;"{{#if previewable}} preview="/agent/{{_agent_id}}/preview?path={{{preview_path}}}"{{/if}}>\n        <!-- NOTE: preview_path uses triple bracket to disable template encode because js already encodes it -->\n        <i class="mxic-addpage-list-{{_icon}}"></i>\n        {{name}}\n        <small class="status">\n            {{#if _online}}\n                {{lang.computer_status_online}}\n            {{/if}}\n            {{#if _offline}}\n                {{lang.computer_status_offline}}\n            {{/if}}\n            {{#if _is_drive}}\n                {{lang.computer_drive}}\n            {{/if}}\n            {{#if _is_folder}}\n                {{count}} {{lang.item_or_items}} | {{lang.updated_colon}} {{_time}}\n            {{/if}}\n            {{#if _is_file}}\n                {{_size}} | {{lang.updated_colon}} {{_time}}\n            {{/if}}\n        </small>\n        <!-- remove unlink support due to latest desktop design which is a user login instead of agent login 10/13/2014 -->\n        <!-- {{#ifCond type \'==\' \'USER_TYPE_AGENT\'}}\n        <i title="{{lang.unlink_moxtra_desktop}}" data-param="{{_agent_id}}" data-action="unregisterComputer" class="glyphicon glyphicon-remove-circle pull-right" data-placement="left" rel="tooltip"></i>\n        {{/ifCond}} -->\n        {{#if _allowed}}\n            {{#if _is_file}}\n            <input type="checkbox" data-action="selectItem" data-param="{{_parent_path}},{{_name}},{{_agent_id}}" />\n            {{/if}}\n        {{/if}}\n    </a>\n</li>\n';
}), define("binder/pageAddDesktop", [ "moxtra", "lang", "app", "crypto", "jqueryBase64", "text!template/binder/pageAddDesktop.html", "text!template/binder/agentItem.html" ], function(a, b, c, d, e, f, g) {
    var h = (MX.logger("addPage"), Handlebars.compile(g)), i = /^OS_TYPE_([^_]+).*$/, j = /^ENTRY_([^_]+).*$/, k = {
        txt: "txt,text,conf,js,css",
        img: "jpg,jpeg,gif,png,tif,psd,bmp",
        video: "mov,avi,wmv,mpeg,rm,rmvb,3gp,m4v,mp4,mkv,flv",
        audio: "mp3,wav,midi,wma",
        doc: "doc,docx",
        xsl: "xsl,xslx,cvs",
        ppt: "ppt,pptx",
        pdf: "pdf",
        zip: "zip,rar,7z,tar,taz,cab,iso,dmg"
    }, l = {
        k: 1024,
        m: 1048576,
        g: 1073741824,
        t: 1099511627776
    }, m = ",jpg,jpeg,jpe,png,gif,pdf,doc,docx,ppt,pptx,xls,xlsx,txt,mp4,m4v,mov,mp3,m4a,numbers,pages,key,html,htm,rtf,csv,";
    return d = d || window.Crypto, a.Controller.extend({
        template: f,
        title: b.add_from_desktop,
        buttons: [ {
            text: b.add_file,
            className: "btn-primary add-page-upload-botton",
            click: "onClickUpload",
            disabled: !0
        } ],
        init: function() {
            this.$scope.lang = b;
        },
        rendered: function() {
            var a = this;
            this.mxData = {
                selectedFiles: {}
            }, this.checkAgents(), setTimeout(function() {
                a.bindPreview();
            }, 200), this.$el.tooltip(), MX.env.isIE && $(":text, textarea").placeholder();
        },
        submitPasscode: function() {
            var a = $(this.handleEvent.currentTarget).parent().parent().parent().parent(), b = a.find("a"), c = b.attr("data-param").split(","), d = a.find("input.passcode").val();
            d && (this.current_agent_passcode = d, this.gotoItem.apply(this, c));
        },
        getSecurityPair: function(a, b, c) {
            if (!this.current_agent_passcode) return null;
            a = a || "AGENT_REQUEST_LIST_FOLDER";
            var e = c && void 0 !== c.current_path ? c.current_path : this.current_path;
            b && (e = e ? e + "\\" + b : b);
            var f = new Date().getTime(), g = [ a, f, e ].join("\n"), h = d.HMAC(d.SHA1, g, this.current_agent_passcode, {
                asString: !0
            }), i = {};
            return i.created_time = f, i.authorization = $.base64.encode(h), i;
        },
        bindPreview: function() {
            var a = this.$el.find(".agent-popover");
            this.$el.on("mouseover", ".desktop-agents>li>a", function(b) {
                var c = $(b.target), d = c.attr("preview");
                d && (a.find("img").attr("src", d), a.css({
                    left: -120,
                    top: c.offset().top - 140
                }).show());
            }).on("mouseout", ".desktop-agents>li>a", function() {
                a.hide();
            });
        },
        formatSize: function(a) {
            var b;
            return b = "number" == typeof a ? a < l.k ? a + " bytes" : a < l.m ? Math.round(a / l.k * 10) / 10 + " KB" : a < l.g ? Math.round(a / l.m * 100) / 100 + " MB" : a < l.t ? Math.round(a / l.g * 100) / 100 + " GB" : Math.round(a / l.t * 100) / 100 + " GB" : a;
        },
        getFileCollection: function(a) {
            var b = {
                col: "txt",
                allowed: !1
            }, c = (a && a.split(".").slice(-1))[0].toLowerCase();
            if (c) {
                c = "," + c + ",";
                for (var d in k) if (k[d] && ("," + k[d] + ",").indexOf(c) > -1) {
                    col = d, b.col = col;
                    break;
                }
                b.allowed = m.indexOf(c) > -1;
            }
            return b;
        },
        agentNav: function() {
            this.$el.find("ol.breadcrumb");
            this.handleEvent && (this.$el.find(".list").addClass("hidden"), this.$el.find(".loading").removeClass("hidden"), 
            this.checkAgents());
        },
        setNav: function(a, c, d) {
            var e, f, g = this.$el.find("ol.breadcrumb");
            g.empty(), g.append('<li><a href="javascript:;" data-action="handleNav" ><small>' + b.remote_desktop + "</small></a></li>"), 
            g.append('<li><a href="javascript:;" data-action="handleNav" data-param=",,' + d + '"><small>' + this.mxData.agents[d].name + "</small></a></li>"), 
            e = ((a ? a + "/" : "") + c).replace(/\\/g, "/"), f = "", aPath = e.split("/"), 
            _.forEach(aPath, function(a, b) {
                a && (f += (f ? "/" : "") + a, 0 === b && f && (f += "/"), g.append('<li><a href="javascript:;" data-action="handleNav" data-param="' + f + ",," + d + '"><small>' + a + "</small></a></li>"));
            }, this), g.text() ? g.removeClass("hidden") : g.addClass("hidden");
        },
        handleNav: function(a, b, c) {
            this.gotoItem(a, b, c);
        },
        selectFile: function(a, b, c) {
            var d = $(this.handleEvent.currentTarget).find("input"), e = $(this.handleEvent.target);
            "INPUT" != this.handleEvent.target.tagName && (e.attr("checkbox") || d.prop("checked", !d.prop("checked"))), 
            d.prop("checked") ? (this.mxData.selectedFiles.parent_path = a, this.mxData.selectedFiles.agent = c, 
            this.mxData.selectedFiles.files = this.mxData.selectedFiles.files || {}, this.mxData.selectedFiles.files[b] = !0) : this.mxData.selectedFiles.files && this.mxData.selectedFiles.files[b] && delete this.mxData.selectedFiles.files[b], 
            _.isEmpty(this.mxData.selectedFiles.files) ? this.dialog.$el.find("button.add-page-upload-botton").addClass("disabled") : this.dialog.$el.find("button.add-page-upload-botton").removeClass("disabled");
        },
        closeNotify: function() {
            $(this.handleEvent.currentTarget).parent().addClass("hidden");
        },
        gotoItem: function(a, c, d) {
            if (!d) return void this.checkAgents();
            var e, f, g, i, k = this.$el.find(".list"), l = this, m = this.agents[d];
            if (f = $(this.handleEvent.currentTarget), g = {
                parent_path: a,
                name: c
            }, !f.hasClass("disabled")) {
                if (m && m.agent.passcode_protected) {
                    if (!this.current_agent_passcode) return void f.parent().append(this.$el.find(".passcode-form").show());
                    g.auth = l.getSecurityPair("AGENT_REQUEST_LIST_FOLDER", c, {
                        current_path: a
                    });
                } else this.current_agent_passcode = void 0;
                k.addClass("hidden"), this.$el.find(".loading").removeClass("hidden"), this.$el.find(".get-failed").addClass("hidden"), 
                this.dialog.$el.find("button.upload").addClass("disabled"), this.mxData.selectedFiles = {}, 
                MX.api("/agents/" + d, "GET", {
                    data: g
                }, function(f) {
                    f && f.data ? (f.data.contents && f.data.contents.length && (k.find(".desktop-agents").empty(), 
                    f.data.contents.forEach(function(a) {
                        i = a.previewable && l.current_agent_passcode && l.getSecurityPair("AGENT_REQUEST_PREVIEW_FILE", a.name, {
                            current_path: f.data.parent_path
                        }) || void 0, e = a.type.replace(j, "$1").toLowerCase(), a._parent_path = f.data.parent_path, 
                        a._name = a.name, a._agent_id = d, a._is_drive = "drive" === e, a._is_folder = "folder" === e, 
                        a._is_file = "file" === e, a._auth = i ? "&Timestamp=" + i.created_time + "&Authorization=" + encodeURIComponent(i.authorization) : "", 
                        a._time = moment(1e3 * a.modified).format("lll"), a.preview_path = encodeURIComponent(MX.format("{{_parent_path}}\\{{_name}}", a)) + a._auth + "&width=120&height=120", 
                        "file" === e ? (oCol = l.getFileCollection(a.name), e = "file-" + oCol.col, a._size = l.formatSize(a.length), 
                        a._allowed = oCol.allowed) : a._allowed = !0, a._icon = e, k.find(".desktop-agents").append(h(_.extend(a, {
                            lang: b
                        })));
                    }), l.setNav(a, c, d), k.removeClass("hidden"), l.$el.find(".loading").addClass("hidden"), 
                    l.current_path = a ? a + "\\" + c : c), l.agentNav(a, c, d)) : (k.removeClass("hidden"), 
                    this.$el.find(".get-failed").removeClass("hidden"), l.$el.find(".loading").addClass("hidden"));
                }, this);
            }
        },
        renderAgents: function() {
            var a = this.agentsCollection, c = this, d = this.$el.find(".list");
            this.$el.find(".loading").addClass("hidden"), a && a.length ? (c.mxData.agents = c.mxData.agents || {}, 
            d.find(".desktop-agents").empty(), c.$el.find("ol.breadcrumb").empty().removeClass("hidden").append('<li><a href="javascript:;" data-action="handleNav" ><small>' + b.remote_desktop + "</small></a></li>"), 
            c.agents = {}, a.forEach(function(a) {
                "USER_TYPE_AGENT" === a.agent.type && (a.agent._parent_path = "", a.agent._name = "", 
                a.agent._online = a.online || !1, a.agent._offline = !a.online || !1, a.agent._agent_id = a.agent.id, 
                a.agent._allowed = !0, a.agent._icon = a.agent.os_type.replace(i, "$1").toLowerCase(), 
                c.mxData.agents[a.agent.id] = a.agent, d.find(".desktop-agents").append(h(_.extend(a.agent, {
                    lang: b
                }))), c.agents[a.agent.id] = a);
            }), d.removeClass("hidden"), this.$el.find(".alert").addClass("hidden")) : (this.$el.find(".no-agent").removeClass("hidden"), 
            d.addClass("hidden"));
        },
        checkAgents: function() {
            var a, b = Moxtra.getMe(), c = this;
            c.agentsCollection = b.agents, a = function() {
                c.$el.find(".loading").removeClass("hidden"), Moxtra.getOnlineStatus().success(function() {
                    c.renderAgents();
                }), c.listenTo(c.agentsCollection, "change", function() {
                    Moxtra.getOnlineStatus().success(function() {
                        c.renderAgents();
                    });
                });
            }, b.revision ? a() : (c.$el.find(".loading").addClass("hidden"), c.$el.loading(), 
            b.subscribe(), Moxtra.onReady(function() {
                c.$el.loading(!1), a();
            }));
        },
        onClickUpload: function() {
            var a, d = c.request.page(), e = this;
            this.mxData.selectedFiles && !_.isEmpty(this.mxData.selectedFiles.files) && (this.dialog.$el.find("button.add-page-upload-botton").addClass("disabled"), 
            this.$el.find(".list").addClass("hidden"), this.$el.find(".loading").removeClass("hidden"), 
            _.forEach(this.mxData.selectedFiles.files, function(c, f) {
                a = e.current_agent_passcode && e.getSecurityPair("AGENT_REQUEST_UPLOAD_RESOURCE", f) || void 0, 
                MX.api("/binders/" + d + "/pages", "POST", {
                    action: "agent",
                    data: {
                        agent_id: this.mxData.selectedFiles.agent,
                        file: this.mxData.selectedFiles.parent_path + "\\" + f,
                        auth: a
                    }
                }, function(a) {
                    a && "RESPONSE_SUCCESS" === a.code ? (MX.ui.notifySuccess(b.upload_file_success), 
                    e.dialog.$el.find('li input[type="checkbox"]').prop("checked", !1)) : (MX.ui.notifyError(b.upload_file_failed), 
                    e.dialog.$el.find("button.add-page-upload-botton").removeClass("disabled")), e.dialog.$el.find(".list").removeClass("hidden"), 
                    e.dialog.$el.find(".loading").addClass("hidden");
                });
            }, this));
        },
        unregisterComputer: function(a) {
            confirm(b.confirm_unlink_desktop) && MX.api("/agents/" + a, "DELETE", null, function(a) {
                a && "RESPONSE_SUCCESS" == a.code ? MX.ui.notifySuccess(b.unlink_desktop_success) : MX.ui.notifyError(b.unlink_desktop_failed);
            });
        }
    });
}), define("text!template/component/fileSelector.html", [], function() {
    return '<div>\n    <!--<form role="form" onsubmit="return false" class="form-with-icon" >\n        <i class="micon-search icon-control"></i>\n        <button type="button" class="close input-close hide" data-action="removeSearchKey" aria-hidden="true">\n            <span>×</span>\n        </button>\n        <input type="text" class="form-control" autofocus="autofocus" autocomplete="off" name="key" placeholder="{{lang.search}}">\n    </form>-->\n    <div class="mx-files-navigator">\n\n    </div>\n    <div class="mx-container mx-page-selector mx-box">\n        <div id="mx-page-zoom">\n            <img />\n        </div>\n    </div>\n</div>\n';
}), define("text!template/component/fileSelectorItem.html", [], function() {
    return '{{#if pageIndex}}\n	{{#if allowSelectPage}}\n		{{#if pages.length}}\n		<div class="panel-default group-panel">\n			<div class="panel-heading">\n				<h4 class="panel-title">\n					<a data-toggle="collapse" data-parent="#accordion" href="#pages{{pageIndex}}" class="ellipsis">\n						<i class="micon-arrow-right"></i> <span title="{{name}}">{{name}}</span>\n					</a>\n				</h4>\n			</div>\n			<div id="pages{{pageIndex}}" class="panel-collapse in">\n				<div class="panel-body">\n					<ul class="mx-list">\n						{{#each pages}}\n						<li class="single-page-selector-item" data-action="selectPage" data-param="{{sequence}}" data-title="{{name}}">\n							{{#if ../../multiple}}\n			                <input type="checkbox" value="{{sequence}}" data-file="{{../../client_uuid}}" class="mx-hide" name="selectedPage">\n			                {{else}}\n			                <input type="radio" value="{{sequence}}" data-file="{{../../client_uuid}}" class="mx-hide" name="selectedPage">\n			                {{/if}}\n						    <a class="mouse-hand">\n						        <img src="{{thumbnail}}" data-seq="{{sequence}}" data-rotate="{{rotate}}" data-original="{{thumbnail}}" {{#when thumbnail \'==\' defaultFileThumbnail}}class="mx-noborder"{{/when}}/>\n						    </a>\n						</li>\n						{{/each}}\n					</ul>\n				</div>\n			</div>\n		</div>\n		{{/if}}\n	{{else}}\n	<li class="page-selector-item row mousehand" data-action="selectPage" data-param="{{client_uuid}}" data-title="{{displayName}}">\n	    <div class="binder-thumb col-md-1">\n	        <div class="cover-wrap">\n	        	<span class="wrap-outer">\n	        		<span class="wrap-inner">\n						<img src="{{thumbnail}}" data-seq="{{sequence}}" data-rotate="{{rotate}}" data-original="{{thumbnail}}"  {{#when thumbnail \'==\' defaultFileThumbnail}}class="mx-noborder"{{/when}}>\n	                </span>\n	        	</span>\n	        </div>\n	    </div>\n	    <div class="col-md-9">\n	        <span class="page-name">\n	            <span class="ellipsis">{{displayName}}</span>\n	        </span>\n	    </div>\n	    <div class="col-md-2">\n	        <span class="page-action">\n	                {{#if multiple}}\n	                <input type="checkbox" value="{{client_uuid}}" class="mx-hide" name="selectedPages">\n	                {{else}}\n	                <input type="radio" value="{{client_uuid}}" class="mx-hide" name="selectedPages">\n	                {{/if}}\n	        </span>\n	    </div>\n	</li>\n	{{/if}}\n{{else}}\n<li class="folder-selector-item row mousehand" data-action="accessSubFolder" data-param="{{sequence}}" data-title="{{name}}">\n    <div class="binder-thumb col-md-1">\n        <div class="cover-wrap">\n	        	<span class="wrap-outer">\n	        		<span class="wrap-inner">\n                        <i class="micon-folder blue size20"></i>\n                    </span>\n	        	</span>\n        </div>\n    </div>\n    <div class="col-md-9">\n            <span class="page-name">\n                <span class="ellipsis">{{name}}</span>\n            </span>\n    </div>\n    <div class="col-md-2 folder-actions">\n            <span class="page-action">\n                    <a class="btn btn-link"><i class="micon-arrow-right"/></a>\n\n            </span>\n    </div>\n</li>\n{{/if}}\n';
}), define("text!template/binder/pagePathNode.html", [], function() {
    return '<a data-action="accessSubFolder" title="{{name}}" class="{{currentPosition}} mx-navigator-pathnode ellipsis" data-param="{{sequence}}" href="javascript:void(0)">{{name}}</a>\n';
}), define("component/selector/fileSelector", [ "moxtra", "lang", "app", "text!template/component/fileSelector.html", "text!template/component/fileSelectorItem.html", "text!template/binder/pagePathNode.html" ], function(a, b, c, d, e, f) {
    "use strict";
    var g = MX.logger("pageSelector"), h = Handlebars.compile(f);
    return MX.ui.FileSelector = a.Controller.extend({
        title: b.select_file,
        template: d,
        handleAction: !0,
        init: function(a) {
            this.$scope.lang = b, _.extend(this, {
                style: "none",
                multiple: !1
            }, a);
        },
        rendered: function() {
            var d = this, f = this.$(".mx-container");
            this.folderList = new a.List({
                renderTo: f,
                template: e,
                lazyload: !1,
                speedup: !0,
                $scope: {
                    lang: b,
                    blankImg: c.const.defaults.blankImg,
                    multiple: this.multiple
                },
                onAddItem: function(a) {
                    "form" === d.style && a.find('input[type="' + (d.multiple ? "checkbox" : "radio") + '"]').mxCheckbox();
                }
            }), this.fileList = new a.List({
                renderTo: f,
                template: e,
                lazyload: !1,
                speedup: !0,
                $scope: {
                    lang: b,
                    blankImg: c.const.defaults.blankImg,
                    multiple: this.multiple,
                    defaultFileThumbnail: Moxtra.config.defaults.thumbnail_file,
                    allowSelectPage: this.allowSelectPage ? !0 : !1
                },
                onAddItem: function(a) {
                    "form" === d.style && a.find('input[type="' + (d.multiple ? "checkbox" : "radio") + '"]').mxCheckbox();
                }
            }), d.$el.loading(), Moxtra.loadBoard(this.boardId).success(function(a) {
                d.$el.loading(!1), d.board = a, d.files = a.getFiles(), d.folders = a.getFolders(), 
                d.folderList.binding(d.folders), d.fileList.binding(d.files);
            });
            var g = "li.page-selector-item";
            this.allowSelectPage && (g = "li.single-page-selector-item"), this.$el.delegate(g, "mouseover", function() {
                if ($(this).find("img").attr("src") !== Moxtra.config.defaults.thumbnail_file) {
                    var a = $(this).position();
                    $("#mx-page-zoom").show().css({
                        left: a.left - 285,
                        top: a.top
                    }).find("img").attr("src", $(this).find("img").attr("src")).end().find(".page-title").text($(this).attr("data-title"));
                }
            }).delegate(g, "mouseout", function() {
                $("#mx-page-zoom").hide();
            }), this.$("form input").on("keyup", $.proxy(this.filterPages, this)), this.$el.addClass("mx-" + this.style);
        },
        removeSearchKey: function() {
            this.$("form input").val("").trigger("keyup").focus();
        },
        filterPages: function(a) {
            var b = $(a.target).val(), c = null;
            b.length ? (this.$(".input-close").removeClass("hide"), c = function(a) {
                var c = a.name;
                return c = c.toLowerCase(), c.indexOf(b.toLowerCase()) >= 0;
            }) : this.$(".input-close").addClass("hide"), this.list.filter(c);
        },
        getFormElements: function(a) {
            return a = a || this.$el, a.find(this.multiple ? 'input[type="checkbox"]' : 'input[type="radio"]');
        },
        selectPage: function() {
            var a = this.handleEvent, b = $(a.currentTarget), c = this.getFormElements(b), d = c.prop("checked");
            "INPUT" !== a.target.tagName && (d = !d, c.prop("checked", d).trigger("change")), 
            g.log("select page:" + b.html()), this.currSelected && this.currSelected.removeClass("selected"), 
            b.addClass("selected"), this.currSelected = b, this.trigger("select", this.value()), 
            this.onSelect(this.value()), a.stopPropagation();
        },
        accessSubFolder: function(a) {
            var b = this.board.getCacheObject(a);
            b ? (this.currentFolder = b, this.files = this.board.getFiles(a), this.folders = this.board.getFolders(a)) : (this.currentFolder = null, 
            this.files = this.board.getFiles(), this.folders = this.board.getFolders()), this.folderList.binding(this.folders), 
            this.fileList.binding(this.files), this.updateFolderMap();
        },
        updateFolderMap: function() {
            var a = this.$(".mx-files-navigator");
            if (a.empty(), this.currentFolder) {
                var c = $(h(_.extend(this.currentFolder))), d = [ this.currentFolder.sequence ];
                a.prepend(c);
                for (var e = this.currentFolder, f = 1; "BoardFolder" === e.parent.$name; ) e = e.parent, 
                d.unshift(e.sequence), 3 > f && (a.prepend('<span class="mx-map-divide">></span>'), 
                2 > f && a.prepend($(h(_.extend(e))))), f++;
                f >= 3 && a.prepend("<span>...</span>"), a.prepend('<span class="mx-map-divide">></span>');
            }
            a.children().length && a.prepend($(h({
                name: b.all,
                sequence: 0
            })));
        },
        onSelect: function() {},
        value: function() {
            var a = [], b = this;
            return b.getFormElements().each(function(c, d) {
                var e, f = $(d);
                if (f.prop("checked")) {
                    if (b.allowSelectPage) {
                        var g = b.files.get(f.data("file"));
                        g && (e = g.pages.get(f.val()));
                    } else e = b.files.get(f.val());
                    a.push(e);
                }
            }), a.length ? a : null;
        }
    }), MX.ui.FileSelector;
}), define("text!template/component/folderSelector.html", [], function() {
    return '<div>\n    <form role="form" onsubmit="return false" class="form-with-icon" >\n        <i class="micon-search icon-control"></i>\n        <button type="button" class="close input-close hide" data-action="removeSearchKey" aria-hidden="true">\n            <span>×</span>\n        </button>\n        <input type="text" class="form-control" autofocus="autofocus" autocomplete="off" name="key" placeholder="{{lang.search}}">\n    </form>\n    <div class="mx-container mx-box">\n\n    </div>\n</div>\n';
}), define("text!template/component/folderSelectorItem.html", [], function() {
    return '<tr class="folder-selector-item row mousehand " data-title="{{name}}">\n    <td class="panel panel-default">\n        <div class="panel-heading">\n            {{#if folders.length}}<div class="micon-arrow-right size18" data-action="accessSubFolder" data-param="{{sequence}}"></div>{{/if}}\n            <div class="folder-title" data-action="selectFolder" data-param="{{sequence}}" >\n                <span class="ellipsis" title="{{name}}"><i class="micon-folder blue size20"></i>{{name}}</span>\n            </div>\n\n        </div>\n        <table class="table">\n\n        </table>\n    </td>\n</tr>\n';
}), define("text!template/component/folderSelectorBinderItem.html", [], function() {
    return '<li class="mx-item panel panel-default" data-param="{{board.id}}">\n    <div class="mx-hover-effect row mouse-hand panel-heading">\n       {{#if board.has_folder}}<div class="micon-arrow-right" data-action="accessSubFolder" data-param="{{board.id}},true"></div>{{/if}}\n        <div data-action="selectFolder" class="binder-title" data-param="{{board.id}},true">\n            {{#if board.isconversation}}\n            <div class="col-md-2 col-xs-2 chat-avatar-{{avatarCount board.members.length}}" >\n                {{#when board.members.length \'>=\' 2}}\n                    {{#each board.members}}\n                        {{#when ../../myself \'!=\' user.primaryKey}}\n                            {{#if ../../showCount}}\n                                <span class="mx-presence">\n                                    <span class="avatar-wrap img-polaroid img-circle">\n                                        <img src="{{blankImg}}" data-original="{{avatar}}" class="lazy"  />\n                                    </span>\n                                    <i class="icon {{#if online}}online{{/if}}" data-online="{{user.id}}"></i>\n                                </span>\n                            {{/if}}\n                        {{/when}}\n                    {{/each}}\n                    {{showCount 0}}\n                {{/when}}\n\n                {{#when board.members.length \'<=\' 1}}\n                {{#each board.members}}\n                        <span class="mx-presence">\n                            <span class="avatar-wrap img-polaroid img-circle">\n                                <img src="{{blankImg}}" data-original="{{avatar}}" class="lazy" />\n                            </span>\n                        </span>\n                {{/each}}\n                {{/when}}\n            </div>\n            {{else}}\n            <div class="binder-thumb col-md-2 col-xs-2">\n                <div class="cover-wrap">\n                    <span class="wrap-outer">\n                        <span class="wrap-inner">\n                            <img src="{{blankImg}}" data-original="{{board.thumbnail_small}}" class="lazy"   />\n                        </span>\n                    </span>\n                </div>\n            </div>\n            {{/if}}\n            <div class="col-md-9 col-xs-9">\n                <span class="board-name">\n                    <span class="ellipsis">{{board.name}}</span>\n                </span>\n            </div>\n        </div>\n    </div>\n    <table class="table">\n\n    </table>\n</li>\n';
}), define("component/selector/folderSelector", [ "moxtra", "lang", "app", "text!template/component/folderSelector.html", "text!template/component/folderSelectorItem.html", "text!template/component/folderSelectorBinderItem.html" ], function(a, b, c, d, e, f) {
    "use strict";
    var g = MX.logger("folderSelector"), h = (Handlebars.compile(f), Handlebars.compile(e));
    return MX.ui.folderSelector = a.Controller.extend({
        title: b.select_folder,
        template: d,
        handleAction: !0,
        init: function(a) {
            this.$scope.lang = b, _.extend(this, {
                style: "none",
                multiple: !1
            }, a);
        },
        rendered: function() {
            var d = this;
            d.$(".mx-container").loading(), Moxtra.onReady(function() {
                d.$(".mx-container").loading(!1), d.list = new a.List({
                    renderTo: d.$(".mx-container"),
                    className: "mx-binder-selector mx-page-selector",
                    template: f,
                    itemHeight: 59,
                    speedup: !0,
                    lazyload: d.$(".mx-container"),
                    $scope: {
                        lang: b,
                        blankImg: c.const.defaults.blankImg,
                        multiple: d.multiple,
                        defaultUserAvatar: c.const.defaults.user.avatar,
                        defaultBoardAvatar: Moxtra.config.defaults.binder_cover,
                        myself: function() {
                            return Moxtra.getMe().primaryKey;
                        },
                        avatarCount: function(a) {
                            return 1 === a ? 1 : a > 5 ? 5 : a;
                        },
                        showCount: function(a) {
                            return 0 === a ? (d._showCountForAvatar = 0, !1) : (d._showCountForAvatar ? d._showCountForAvatar++ : d._showCountForAvatar = 1, 
                            d._showCountForAvatar <= 4);
                        }
                    }
                }), d.registerObject("collection", Moxtra.getTimelinePagingData(Moxtra.filter.canReadAndWriteBoards)), 
                d.list.binding(d.collection);
            }), this.$("form input").on("keyup", $.proxy(this.filterBinder, this)), this.$el.addClass("mx-" + this.style);
        },
        removeSearchKey: function() {
            this.$("form input").val("").trigger("keyup").focus();
        },
        filterBinder: function(a) {
            var b = $(a.target).val(), c = null, d = Moxtra.api.util.getBoardName;
            b.length ? (this.$(".input-close").removeClass("hide"), c = function(a) {
                var c;
                return c = d(a), c = c && c.toLowerCase() || "", c.indexOf(b.toLowerCase()) >= 0;
            }) : this.$(".input-close").addClass("hide"), this.registerObject("collection", Moxtra.getTimelinePagingData(c || Moxtra.filter.canReadAndWriteBoards)), 
            this.list.binding(this.collection);
        },
        renderItems: function(a, b) {
            var c = this;
            b = b || c.$el, a.each(function(a) {
                b.append($(h(_.extend({
                    cid: a.$id
                }, c.$scope, a))));
            });
        },
        getFormElements: function(a) {
            return a = a || this.$el, a.find(this.multiple ? 'input[type="checkbox"]' : 'input[type="radio"]');
        },
        selectPage: function() {
            var a = this.handleEvent, b = $(a.currentTarget), c = this.getFormElements(b), d = c.prop("checked");
            "INPUT" !== a.target.tagName && (d = !d, c.prop("checked", d).trigger("change")), 
            g.log("select folder:" + b.html()), this.currSelected && this.currSelected.removeClass("selected"), 
            b.addClass("selected"), this.currSelected = b, this.trigger("select", this.value()), 
            this.onSelect(this.value()), a.stopPropagation();
        },
        accessSubFolder: function(a, b) {
            var c, d = this.handleEvent, e = $(d.currentTarget), f = this;
            if (d.stopPropagation(), c = b ? e.closest("li").find(".table").eq(0) : e.closest("tr").find(".table").eq(0), 
            e.hasClass("micon-arrow-right")) {
                var g = e.closest("li").attr("data-param");
                Moxtra.loadBoard(g, {
                    igonrePublicView: !0
                }).success(function(d) {
                    var e;
                    e = b ? d.getFolders() : d.getFolders(a), e && f.renderItems(e, c);
                }), e.removeClass("micon-arrow-right").addClass("micon-arrow-down");
            } else e.removeClass("micon-arrow-down").addClass("micon-arrow-right"), c.empty();
        },
        selectFolder: function(a, b) {
            this.$el.find(".panel-heading").removeClass("selected");
            var c = this.handleEvent, d = $(c.currentTarget), e = this;
            c.stopPropagation(), d.closest(".panel-heading").addClass("selected");
            var f = d.closest("li").attr("data-param");
            if (b) {
                var g = Moxtra.getUserBoard(a);
                g && (e.currentFolder = g.board);
            } else Moxtra.loadBoard(f, {
                ignorePublicView: !0
            }).success(function(b) {
                var c = b.getCacheObject(a);
                e.currentFolder = c;
            });
        },
        onSelect: function() {},
        value: function() {
            return this.currentFolder;
        }
    }), MX.ui.folderSelector;
}), define("text!template/binder/webdocEditor.html", [], function() {
    return '<div class="mx-webdoc-editor">\n	<div class="auto-save-bar checkbox">\n		<label>\n			<input type="checkbox" checked="checked" data-action="toggleAutoSave" /> {{lang.auto_save}}\n		</label>\n	</div>\n    <div class="topbar">\n\n    	<button class="btn btn-primary btn-xs" id="closeEditor" type="button" data-action="closeEditor">{{lang.close}}</button>\n    </div>\n    <div class="wrap">\n        <textarea id="mx-webdoc-editor-textarea"></textarea>\n    </div>\n</div>\n';
}), define("binder/webdocEditor", [ "moxtra", "lang", "app", "binder/binderBiz", "text!template/binder/webdocEditor.html" ], function(a, b, c, d, e) {
    "use strict";
    var f = MX.logger("WebDocEditor");
    return a.Controller.extend({
        template: e,
        handleAction: !0,
        init: function(a) {
            this.$scope.lang = b, a && (this.board_id = a.board_id, this.page_seq = a.page_seq, 
            this.currentObj = a.currentObj), this.autoSave = !0, this.isSaved = !1;
            var c = this;
            require([ "tinymce" ], function() {
                c.initTinyMCE(tinymce);
            });
        },
        rendered: function() {
            this.$el.loading(!0);
        },
        initTinyMCE: function(a) {
            var b = this, c = "100%";
            MX.env.isIE && (c = window.innerHeight);
            var d = {}, e = Moxtra.getMe().language;
            d.font_formats = "", e && (e = e.toLowerCase(), e.indexOf("zh") > -1 ? "zh-tw" !== e ? (d.language = "zh_CN", 
            d.font_formats += "宋体=宋体,宋体-简;黑体=微软雅黑,黑体,冬青黑体简体中文,黑体-简;仿宋=华文仿宋，仿宋;楷体=楷体,楷体-简,华文楷体;隶书=隶书,报隶-简;幼圆=幼圆,圆体-简;") : d.language = "zh_TW" : d.language = /es|ja|pt|fr/.test(d.language) ? e : "en"), 
            d.font_formats += "Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings,zapf dingbats;", 
            setTimeout(function() {
                a.init($.extend({
                    convert_urls: !1,
                    content_css: "themes/styles/tinymce.23d9e881.css",
                    selector: "#mx-webdoc-editor-textarea",
                    script_url: "../../lib/tinymce/tiny_mce.min.js",
                    width: "100%",
                    height: c,
                    custom_undo_redo_levels: 10,
                    menubar: !1,
                    statusbar: !1,
                    save_enablewhendirty: !0,
                    save_onsavecallback: $.proxy(b.onClickSaveButton, b),
                    plugins: "autolink,lists,spellchecker,pagebreak,layer,save,autosave,hr,image,link,emoticons,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,template,textcolor,code,charmap,anchor",
                    toolbar1: "save print undo redo fontselect fontsizeselect forecolor backcolor bold italic underline strikethrough | alignleft aligncenter alignright alignjustify indent outdent bullist numlist | hr table link",
                    table_styles: "Header 1=header1;Header 2=header2;Header 3=header3",
                    table_cell_styles: "Header 1=header1;Header 2=header2;Header 3=header3;Table Cell=tableCel1",
                    table_row_styles: "Header 1=header1;Header 2=header2;Header 3=header3;Table Row=tableRow1",
                    table_cell_limit: 500,
                    table_default_border: 1,
                    auto_focus: "mx-webdoc-editor-textarea",
                    setup: function(a) {
                        b.editor = a, a.on("init", function() {
                            b.loadContent(), b.sendMessage("request_open_webnote");
                        }), a.on("keydown", function(a) {
                            return 9 === a.keyCode ? (this.execCommand(a.shiftKey ? "Outdent" : "Indent"), a.preventDefault(), 
                            a.stopPropagation(), !1) : void 0;
                        });
                    }
                }, d));
            }, 20);
        },
        startAutoSave: function() {
            var a = this;
            this.intervalId || (this.intervalId = setInterval(function() {
                f.debug("Auto Save Called!");
                var b = a.editor.getContent();
                MX.isEmpty(b) || a.autoSaveContent === b || (a.autoSaveContent = b, a.saveContent(!0, !0), 
                f.debug("Auto Save: ", b));
            }, 6e4));
        },
        stopAutoSave: function() {
            this.intervalId && (clearInterval(this.intervalId), this.intervalId = 0);
        },
        toggleAutoSave: function() {
            this.autoSave = this.$(".auto-save-bar input").is(":checked"), this.autoSave ? this.startAutoSave() : this.stopAutoSave();
        },
        onClickSaveButton: function() {
            this.saveContent(!1, !0);
        },
        saveContent: function(a, b) {
            var c = this.editor.getContent();
            this.page_seq ? (this.saveWebdoc(c, a, b), this.isSaved = !0) : this.creating || this.createWebdoc(c);
        },
        saveWebdoc: function(a, c, d, e) {
            var f = this;
            c || this.editor.setProgressState(!0);
            var g = Moxtra.getBoard(this.board_id).pages.get(this.page_seq);
            g && (/^<!--WEBDOCFORMOXTRA-->/.test(a) || (a = "<!--WEBDOCFORMOXTRA-->" + a), g.set("webdocContent", a), 
            g.updateWebDoc({
                nofeed: d
            }).success(function() {
                c || MX.ui.notifySuccess(b.save_webdoc_success), f.trigger("save", a), f.autoSaveContent = a, 
                c || f.editor.setProgressState(!1), e && f.destroyWebdoc();
            }).error(function() {
                e ? MX.ui.Confirm(b.leave_webdoc_save_failed_confirm, function() {
                    f.destroyWebdoc();
                }, function() {
                    $("#closeEditor").removeAttr("disabled");
                }) : MX.ui.notifyError(b.save_webdoc_failed);
            }));
        },
        loadContent: function() {
            var a = this;
            if (!this.page_seq) return this.autoSave && this.startAutoSave(), void a.$el.loading(!1);
            this.editor.setProgressState(!0);
            var d = Moxtra.getBoard(this.board_id).pages.get(this.page_seq);
            d.getResource().success(function() {
                var b = d.webdocContent || "<html><body><head></head><body></body></html>";
                b = b.replace(/<!--WEBDOCFORMOXTRA-->/, ""), a.originalContent = a.autoSaveContent = b, 
                a.autoSave && a.startAutoSave(), $(' <base href="/board/' + c.request.page() + "/" + c.request.sequence() + '/"/>').appendTo(a.editor.contentDocument.head), 
                a.editor.setContent(b), a.$el.loading(!1), a.editor.setProgressState(!1);
            }).error(function() {
                a.$el.loading(!1), MX.ui.notifyError(b.read_webdoc_failed), a.editor.destroy();
            });
        },
        closeEditor: function() {
            $("#closeEditor").attr("disabled", "disabled");
            var a = this, e = this.editor && this.editor.getContent(), f = this.autoSave;
            return f ? (this.stopAutoSave(), void (e && !MX.isEmpty(e) ? this.page_seq ? e !== this.originalContent || this.isSaved ? this.saveWebdoc(e, !0, !1, !0) : this.destroyWebdoc() : this.creating || this.createWebdoc(e, !0) : this.page_seq ? new MX.ui.Dialog({
                title: b.binder_delete_a_page,
                content: "<div>" + b.binder_confirm_delete_a_page + "</div>",
                buttons: [ {
                    text: b.ok,
                    className: "btn-primary",
                    click: function() {
                        var e = this;
                        d.deletePages(a.board_id, [ a.page_seq ]).success(function() {
                            MX.ui.notifySuccess(b.binder_delete_page_success), e.close(), a.destroyWebdoc(), 
                            c.navigate("/timeline/" + a.board_id, !0);
                        }).error(function() {
                            e.close(), a.destroyWebdoc();
                        });
                    }
                }, {
                    text: b.cancel,
                    click: function() {
                        this.close(), a.destroyWebdoc();
                    }
                } ]
            }) : this.destroyWebdoc())) : void this.destroyWebdoc();
        },
        destroyWebdoc: function() {
            var a = this, b = Moxtra.getBoard(this.board_id);
            if (b) {
                var c = b.pages.get(this.page_seq);
                c && c.unlock();
            }
            setTimeout(function() {
                a.sendMessage("request_close_webnote"), a.editor.destroy(), a.destroy();
            }, 1e3);
        },
        createWebdoc: function(a, c) {
            this.creating = !0;
            for (var d, e = this, f = {
                webdocContent: "<!--WEBDOCFORMOXTRA-->" + a
            }, g = $(a).text().split("\n"), h = 0; void 0 !== g[h] && !(d = g[h].replace(/(^\s+|[/\?%*:|"<>]+|\s+$)/g, "")); ) h++;
            d || (d = b.note + MX.lang.format(Date.now(), "lll"));
            var i = new Moxtra.model.BoardPage();
            i.set("page_type", Moxtra.const.PAGE_TYPE_WEB), i.set(f), i.set("name", MX.cutStr(d, 50)), 
            i.create(this.currentObj).success(function(b) {
                e.creating = !1, e.page_seq = b.sequence, e.isNewDoc = !0, e.trigger("save", i), 
                e.autoSaveContent = a, c ? e.destroyWebdoc() : b && b.lock();
            }).error(function() {
                e.creating = !1, c ? MX.ui.Confirm(b.leave_webdoc_save_failed_confirm, function() {
                    e.destroyWebdoc();
                }, function() {
                    $("#closeEditor").removeAttr("disabled");
                }) : MX.ui.notifyError(b.binder_create_whiteboard_failed);
            });
        },
        sendMessage: function(a) {
            var b = this.board_id, d = {
                action: a,
                binder_id: b,
                session_id: Moxtra.getMe().sessionId,
                page_id: this.page_seq
            };
            "request_close_webnote" === a && (d.close_from_create = !this.page_seq && !this.isNewDoc || this.page_seq && this.isNewDoc ? !0 : !1), 
            c.sendMessage(d);
        }
    });
}), define("common/shareBiz", [ "moxtra" ], function(a) {
    return {
        getShareBinderToken: function(b, c) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}", b), "PUT", {
                    action: "share",
                    data: {
                        message: c
                    }
                }, this.callback, this);
            });
        },
        shareBinder: function(b, c, d, e) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}", b), "PUT", {
                    action: "share",
                    data: {
                        users: c,
                        message: d
                    },
                    view_token: e
                }, this.callback, this);
            });
        },
        getSharePagesToken: function(b, c, d) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}/pages", b), "PUT", {
                    action: "share",
                    data: {
                        pages: c,
                        message: d
                    }
                }, this.callback, this);
            });
        },
        getShareFilesToken: function(a, b, c, d) {
            var e = Moxtra.getBoard(a);
            return e.shareFiles(b, c, d);
        },
        sharePages: function(b, c, d, e, f) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}/pages", b), "PUT", {
                    action: "share",
                    data: {
                        users: c,
                        pages: d,
                        message: e
                    },
                    view_token: f
                }, this.callback, this);
            });
        },
        shareFiles: function(b, c, d, e, f) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}/pages", b), "PUT", {
                    action: "share",
                    data: {
                        users: c,
                        files: d,
                        message: e
                    },
                    view_token: f
                }, this.callback, this);
            });
        },
        getResourcesShareViewToken: function(b, c) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}/resources", b), "PUT", {
                    action: "share",
                    data: {
                        resources: c
                    }
                }, this.callback, this);
            });
        },
        shareBinderResources: function(b, c, d) {
            return new a.ChainObject(function() {
                MX.api(a.format("/binders/{0}/resources", b), "PUT", {
                    action: "share",
                    data: {
                        resources: c,
                        users: d
                    }
                }, this.callback, this);
            });
        }
    };
}), define("text!template/common/shareLink.html", [], function() {
    return '<div class="share-option">\n    <div class="mx-container list-group">\n    	{{#if isShow}}\n		<a href="javascript:;" class="list-group-item email-link" data-action="selectEmail" >\n			<i class="micon-email blue"></i>\n			{{lang.share_email_link}}\n		</a>\n		{{/if}}\n\n        <a href="javascript:;" class="list-group-item" data-action="selectCopyLink">\n        	<i class="micon-web-link blue"></i>\n        	{{lang.share_copy_link}}\n    	</a>\n\n        {{#unless hideFacebook}}\n        <a href="javascript:;" class="list-group-item" data-action="selectFacebook">\n        	<i class="micon-logo-facebook facebook-blue"></i>\n        	{{lang.post_to_facebook}}\n    	</a>\n        {{/unless}}\n\n    </div>\n</div>\n';
}), define("text!template/common/shareCopyLink.html", [], function() {
    return '<div>\r\n	    <form id="share_by_email_form" class="form-horizontal" role="form">\r\n	    	<div class="form-group">\r\n	    		<div class="col-md-12">\r\n	    			<textarea id="binder_link" value="" class="form-control noResize" readonly="readonly"\r\n	    					style="background: #f2f2f2; cursor:text; margin-top:10px;"></textarea>\r\n	    		</div>\r\n	    	</div>\r\n	    	<!--\r\n	    	<div class="form-group">\r\n		  		<div class="col-md-3 col-md-offset-3">\r\n		  			<input type="button" id="btn_copy" class="btn btn-primary"  value="Copy" />\r\n		  		</div>\r\n	  		</div>\r\n	  		-->\r\n	  	</form>\r\n</div>';
}), define("common/shareLink", [ "moxtra", "lang", "app", "const", "common/shareBiz", "component/selector/userSelector", "text!template/common/shareLink.html", "text!template/common/shareCopyLink.html", "zeroclipboard" ], function(a, b, c, d, e, f, g, h, i) {
    "use strict";
    var j = MX.logger("share");
    return a.Controller.extend({
        template: g,
        title: b.share_pages_title,
        handleAction: !0,
        init: function(a) {
            this.$scope.lang = b, this.$scope.isShow = a.token ? !1 : !0, this.$scope.hideFacebook = c.accessFromChina() || c.isIntegrationEnabled(), 
            _.extend(this, a);
        },
        rendered: function() {},
        selectEmail: function() {
            var a = this;
            if (c.isIntegrationEnabled()) {
                var d = {
                    action: "share",
                    binder_id: a.binderId,
                    session_key: null,
                    session_id: Moxtra.getMe().sessionId || null
                };
                if (a.pages && a.pages.length) {
                    var f = [], g = [];
                    _.each(a.pages, function(a) {
                        isNaN(parseInt(a, 10)) || f.push({
                            sequence: 1 * a
                        }), g.push(1 * a);
                    }), d.binder_pages = f, d.page_id = g.join(",");
                }
                c.sendMessage(d), a.dialog.pop();
                var h = c.integration.get("extension");
                if (!h) return;
                var i = JSON.parse(h);
                if (!i.show_dialogs || !i.show_dialogs.member_invite) return;
            }
            this.dialog.push(new MX.ui.UserSelector({
                title: b.share_email_link,
                teamsPanel: !1,
                buttons: [ {
                    position: "left",
                    text: b.back,
                    click: function() {
                        this.pop();
                    }
                }, {
                    position: "right",
                    text: b.send,
                    className: "btn-primary",
                    click: "shareByEmail"
                } ],
                shareByEmail: function() {
                    var c = [], d = this.value();
                    d.each(function(a) {
                        c.push(a.get("email"));
                    });
                    var f = function(a) {
                        j.debug(a), MX.ui.notifySuccess(b.link_sent_success);
                    }, g = function() {
                        MX.ui.notifyError(b.link_sent_failed), j.debug("share binder(pages) by email error!");
                    }, h = Moxtra.getBoard(a.binderId);
                    a.pages && a.pages.length ? h.shareByEmail(c, {
                        pages: a.pages
                    }).success(f).error(g) : a.files && a.files.length || a.folders && a.folders.length ? h.shareByEmail(c, {
                        files: a.files,
                        folders: a.folders
                    }, a.parent).success(f).error(g) : e.shareBinder(a.binderId, c).success(f).error(g), 
                    a.dialog.pop();
                }
            }));
        },
        selectCopyLink: function() {
            var f = this, g = MX.env.detectFlash(), k = a.Controller.extend({
                template: h,
                title: b.share_copy_link,
                handleAction: !0,
                init: function(a) {
                    _.extend(this, a), this.buttons = this.buttons ? this.buttons : [], (c.isMacAgentAppstore() || c.isMacAgentLocal() || g.isSupported && !c.isIntegrationAgent()) && this.buttons.push({
                        position: "right",
                        text: b.copy,
                        className: "btn-primary",
                        click: "copyLink"
                    });
                    var h = this, i = function(a) {
                        var b = MX.getOrigin() + "/v/" + (a.data || a.object.board).view_tokens[0].token;
                        g.isSupported && (!c.isIntegrationAgent() || navigator.userAgent.indexOf(d.flags.windowsAgent) > 0) && h.prepareCopy(), 
                        h.$el.find("#binder_link").val(b), j.debug(a);
                    }, k = function() {
                        j.debug("share binder(pages) error!");
                    };
                    f.token ? setTimeout(function() {
                        i({
                            data: {
                                view_tokens: [ {
                                    token: f.token
                                } ]
                            }
                        });
                    }, 500) : !a.pages || a.pages.length <= 0 ? f.files && f.files.length > 0 || f.folders && f.folders.length > 0 ? e.getShareFilesToken(a.binderId, a.files, a.folders, a.parent).success(i).error(k) : e.getShareBinderToken(a.binderId).success(i).error(k) : e.getSharePagesToken(a.binderId, a.pages).success(i).error(k);
                },
                prepareCopy: function() {
                    if (!c.isMacAgentAppstore() && !c.isMacAgentLocal()) {
                        var a = this;
                        this.clip || (i.config({
                            swfPath: "lib/zeroclipboard/dist/ZeroClipboard.a573941f.swf"
                        }), this.clip = new i($("button[data-action=copyLink]"))), this.clip.on("ready", function(c) {
                            var d = c.client;
                            d.on("beforecopy", function() {
                                d.setText(a.$el.find("#binder_link").val());
                            }), d.on("aftercopy", function() {
                                MX.ui.notifySuccess(b.link_copied_to_clipboard);
                            });
                        }), this.recovery(function() {
                            i.destroy();
                        });
                    }
                },
                copyLink: function() {
                    return c.isMacAgentAppstore() || c.isMacAgentLocal() ? (c.sendMessage({
                        action: "request_copy_text",
                        text: this.$el.find("#binder_link").val(),
                        session_id: Moxtra.getMe().sessionId
                    }), void setTimeout(function() {
                        MX.ui.notifySuccess(b.link_copied_to_clipboard);
                    }, 300)) : void 0;
                }
            });
            this.dialog.push(new k({
                binderId: this.binderId,
                files: this.files,
                folders: this.folders,
                pages: this.pages,
                parent: this.parent,
                buttons: [ {
                    position: "left",
                    text: b.back,
                    click: function() {
                        this.pop();
                    }
                } ]
            }));
        },
        postToFacebook: function() {
            var a = this, d = function(a) {
                a && a.post_id ? MX.ui.notifySuccess(b.link_posted_to_facebook) : j.debug(a);
            };
            MX.env.isChrome && (a.fb_message.display = "popup"), window.FB ? FB.ui(a.fb_message, d) : require([ c.config.global.fb_sdk_endpoint ], function() {
                FB.init({
                    appId: c.config.global.fb_app_id,
                    status: !0,
                    cookie: !0,
                    version: "v2.0"
                }), FB.ui(a.fb_message, d), j.debug("post to facebook!");
            });
        },
        selectFacebook: function() {
            var a = this;
            if (a.fb_message) return void this.postToFacebook();
            var c = function(c) {
                var d = c.data || c.object.board, e = {
                    caption: b.powered_by_moxtra,
                    method: "feed",
                    link: MX.getOrigin() + "/v/" + d.view_tokens[0].token,
                    name: "",
                    description: ""
                };
                e.picture = MX.getOrigin() + "/t/" + d.thumbnail_view_token, a.fb_message = e, a.postToFacebook();
            }, d = function() {
                j.debug("share binder(pages) error!");
            };
            a.token ? (a.fb_message = {
                caption: b.powered_by_moxtra,
                method: "feed",
                link: MX.getOrigin() + "/v/" + a.token,
                picture: MX.getOrigin() + a.publicThumbnail,
                name: "",
                description: ""
            }, a.postToFacebook()) : this.pages && this.pages.length > 0 ? e.getSharePagesToken(this.binderId, this.pages).success(c).error(d) : this.files && this.files.length > 0 || this.folders && this.folders.length > 0 ? e.getShareFilesToken(this.binderId, this.files, this.folders, this.parent).success(c).error(d) : e.getShareBinderToken(this.binderId).success(c).error(d);
        }
    });
}), define("text!template/common/shareOriginal.html", [], function() {
    return '<div class="share-option">\r\n    <div class="mx-container list-group">\r\n    	{{#if resourcePage}}\r\n    	{{else}}\r\n    	\r\n    	{{#if hasLogin}}\r\n		<a href="javascript:;" class="list-group-item email-link" data-action="selectEmail" >\r\n			<i class="mx-icon-email-link"></i>\r\n			{{lang.share_email_link}}\r\n		</a>\r\n		{{/if}}\r\n\r\n        <a href="javascript:;" class="list-group-item" data-action="selectCopyLink">\r\n        	<i class="mx-icon-copy-link"></i>\r\n        	{{lang.share_copy_link}}\r\n    	</a>\r\n    	{{/if}}\r\n    </div>\r\n</div>';
}), define("common/shareOriginal", [ "moxtra", "lang", "app", "common/shareBiz", "component/selector/userSelector", "text!template/common/shareOriginal.html", "text!template/common/shareCopyLink.html", "zeroclipboard" ], function(a, b, c, d, e, f, g, h) {
    "use strict";
    return a.Controller.extend({
        template: f,
        handleAction: !0,
        init: function(a) {
            this.opts = a, this.$scope.lang = b, this.$scope.resourcePage = a.resourcePage, 
            this.$scope.hasLogin = !!Moxtra.getMe().id, _.extend(this, a);
        },
        rendered: function() {
            this.$(".download").removeClass("hide"), this.$(".facebook").addClass("hide");
        },
        selectEmail: function() {
            var a = this;
            if (c.isIntegrationEnabled()) {
                var d = {
                    action: "share",
                    binder_id: a.binderId,
                    session_key: null,
                    session_id: Moxtra.getMe().sessionId || null
                };
                if (a.originalResource) {
                    var e = [], f = [];
                    isNaN(parseInt(a.originalResource, 10)) || (e.push({
                        sequence: 1 * a.originalResource
                    }), f.push(1 * a.originalResource)), d.binder_pages = e, d.page_id = f.join(",");
                }
                c.sendMessage(d), a.dialog.pop();
                var g = c.integration.get("extension");
                if (!g) return;
                var h = JSON.parse(g);
                if (!h.show_dialogs || !h.show_dialogs.member_invite) return;
            }
            this.dialog.push(new MX.ui.UserSelector({
                title: b.share_email_link,
                teamsPanel: !1,
                buttons: [ {
                    position: "left",
                    text: b.back,
                    click: function() {
                        this.pop();
                    }
                }, {
                    position: "right",
                    text: b.send,
                    className: "btn-primary",
                    click: "shareByEmail"
                } ],
                shareByEmail: function() {
                    var c = [], d = this.value();
                    d.each(function(a) {
                        c.push(a.get("email"));
                    });
                    var e = Moxtra.getBoard(a.binderId);
                    e.shareByEmail(c, {
                        resources: [ a.originalResource ]
                    }).success(function() {
                        MX.ui.notifySuccess(b.link_sent_success), a.dialog.pop();
                    }).error(function() {
                        MX.ui.notifyError(b.share_original_content_failed);
                    });
                }
            }));
        },
        selectCopyLink: function() {
            var e = this, f = MX.env.detectFlash(), i = a.Controller.extend({
                template: g,
                title: b.share_copy_link,
                handleAction: !0,
                init: function(a) {
                    _.extend(this, a), this.buttons = this.buttons ? this.buttons : [], (f.isSupported || c.isMacAgentAppstore() || c.isMacAgentLocal()) && this.buttons.push({
                        position: "right",
                        text: b.copy,
                        className: "btn-primary",
                        click: "copyLink"
                    });
                },
                rendered: function() {
                    var a = this;
                    if (e.token) {
                        var b = MX.getOrigin() + "/v/" + e.token;
                        a.$el.find("#binder_link").val(b), f.isSupported && a.prepareCopy();
                    } else d.getResourcesShareViewToken(e.binderId, [ e.originalResource ]).success(function(b) {
                        var c = MX.getOrigin() + "/v/" + b.data.view_tokens[0].token;
                        a.$el.find("#binder_link").val(c), a.prepareCopy();
                    });
                },
                prepareCopy: function() {
                    if (!c.isMacAgentAppstore() && !c.isMacAgentLocal() && (!c.isIntegrationAgent() || navigator.userAgent.indexOf(consts.flags.windowsAgent) > 0)) {
                        var a = this;
                        this.clip || (h.config({
                            swfPath: "lib/zeroclipboard/dist/ZeroClipboard.a573941f.swf"
                        }), this.clip = new h($("button[data-action=copyLink]"))), this.clip.on("ready", function(c) {
                            var d = c.client;
                            d.on("beforecopy", function() {
                                d.setText(a.$el.find("#binder_link").val());
                            }), d.on("aftercopy", function() {
                                MX.ui.notifySuccess(b.link_copied_to_clipboard);
                            });
                        });
                    }
                },
                copyLink: function() {
                    return c.isMacAgentAppstore() || c.isMacAgentLocal() ? (c.sendMessage({
                        action: "request_copy_text",
                        text: this.$el.find("#binder_link").val(),
                        session_id: Moxtra.getMe().sessionId
                    }), void setTimeout(function() {
                        MX.ui.notifySuccess(b.link_copied_to_clipboard);
                    }, 300)) : void 0;
                }
            });
            this.dialog.push(new i({
                binderId: this.binderId,
                pages: this.pages,
                buttons: [ {
                    position: "left",
                    text: b.back,
                    click: function() {
                        this.pop();
                    }
                } ]
            }));
        }
    });
}), define("text!template/common/share.html", [], function() {
    return '<div id="mxShareBody">\n</div>';
}), define("common/share", [ "moxtra", "lang", "const", "common/shareBiz", "binder/binderBiz", "common/shareLink", "common/shareOriginal", "text!template/common/share.html" ], function(a, b, c, d, e, f, g, h) {
    MX.logger("share");
    return a.Controller.extend({
        template: h,
        title: b.share_a_page_title,
        handleAction: !0,
        init: function(a) {
            this.opts = a, this.$scope.lang = b, _.extend(this, a), "page" == this.type ? this.pages && this.pages.length > 1 && (this.title = b.share_pages_title) : "resource" == this.type && (this.title = b.share_a_resource_title);
        },
        rendered: function() {
            var a = f;
            "resource" == this.type && (this.originalResource = this.resourceSequence, a = g), 
            view = new a(_.extend(this.opts, {
                dialog: this.dialog,
                token: this.token,
                publicThumbnail: this.publicThumbnail,
                originalResource: this.originalResource,
                resourcePage: this.resourcePage
            })), this.recovery(view), view.renderTo(this.$el), view.$el.show();
        }
    });
}), define("text!template/common/download.html", [], function() {
    return '<div>\n	{{#if pageHasOrignal}}\n	<div class="share-option">\n	    <div class="mx-container list-group mx-download">\n	        <a href="javascript:;" class="list-group-item" data-loading-text="{{lang.download_started}}" data-action="downloadAsPdf">\n	        	<i class="micon-file-pdf size16 red"></i>\n	        	{{lang.pdf_with_annotation}} <i class="glyphicon glyphicon-question-sign gray marginLeft5" data-placement="right" title="{{lang.share_flattened_pdf_tooltip}}"></i>\n	    	</a>\n			<a href="javascript:;" class="list-group-item" data-loading-text="{{lang.download_started}}" data-action="downloadAsFile">\n	        	<i class="micon-page blue size16"></i>\n	        	{{lang.share_original_content}} <i class="glyphicon glyphicon-question-sign gray marginLeft5" data-placement="right" title="{{lang.share_original_content_tooltip}}"></i>\n	    	</a>\n	    </div>\n	</div>\n	{{else}}\n	    <div class="form-group">\n				<span>{{lang.download_started}}</span>\n		</div>\n	{{/if}}\n</div>\n';
}), define("common/download", [ "moxtra", "lang", "text!template/common/download.html", "binder/binderBiz" ], function(a, b, c) {
    return a.Controller.extend({
        template: c,
        handleAction: !0,
        init: function(a) {
            this.$scope.lang = b;
            var c = a.originalResource && ("page" == a.type || a.showDialog);
            return _.extend(this.$scope, {
                type: a.type,
                resourcePage: a.resourcePage,
                pageHasOrignal: c
            }), _.extend(this, a), "url" === this.type ? void this.downloadUrl(a.url) : void (c || ("resource" == this.type ? this.downloadFile() : this.downloadPdf()));
        },
        rendered: function() {
            this.$el.find("i").tooltip();
        },
        downloadAsPdf: function() {
            var a = $(this.handleEvent.currentTarget);
            this.handleEvent.stopPropagation(), a.button("loading"), setTimeout(function() {
                a.button("reset");
            }, 2e3), this.downloadPdf();
        },
        downloadAsFile: function() {
            var a = $(this.handleEvent.currentTarget);
            this.handleEvent.stopPropagation(), a.button("loading"), setTimeout(function() {
                a.button("reset");
            }, 2e3), this.downloadFile();
        },
        downloadPdf: function() {
            var a, b = this;
            a = "page" === this.type || this.pages ? "/board/" + this.binderId + "/download?d=&type=pdf&pages=" + this.pages : "/board/" + this.binderId + "/download?d=&type=pdf", 
            this.token && (a += "&t=" + this.token), a && setTimeout(function() {
                b._downloadURL(a);
            }, 500);
        },
        downloadFile: function() {
            var a, b = this;
            a = this.resourcePage ? "/board/" + this.binderId + "/" + this.resourcePage.sequence + "/" + this.originalResource + "?d=" : "/board/" + this.binderId + "/" + this.originalResource + "?d=", 
            this.token && (a += "&t=" + this.token), setTimeout(function() {
                b._downloadURL(a);
            }, 500);
        },
        downloadUrl: function(a) {
            a = a || "", a += a.indexOf("?") > 0 ? "&d=" : "?d=", this.token && (a += "&t=" + this.token), 
            a = Moxtra.util.makeAccessTokenUrl(a), this._downloadURL(a);
        },
        _downloadURL: function(a) {
            var b, c = this, d = "hiddenDownloader";
            b = document.getElementById(d), null === b && (b = document.createElement("iframe"), 
            b.id = "hiddenDownloader", b.style.display = "none", document.body.appendChild(b)), 
            b.src = Moxtra.util.makeAccessTokenUrl(a), setTimeout(function() {
                c.dialog && c.dialog.close();
            }, 2e3);
        }
    });
}), define("text!template/binder/newBinderOptions.html", [], function() {
    return '<div class="new-binder-options">\n	<div>{{lang.loading}}</div>\n</div>\n';
}), define("text!template/binder/newBinder.html", [], function() {
    return '<div class="create-binder">\n	{{#if showInput}}\n	<div id="createBinderForm">\n		<div class="form-group">\n			<input type="text" autofocus="autofocus" placeholder="{{lang.binder_topic}}" data-error-style="inline" class="form-control" name="binderName">\n		</div>\n	</div>\n	{{/if}}\n	<div class="user-selector">\n		\n	</div>\n</div>';
}), define("text!template/binder/newBinderReview.html", [], function() {
    return '<div class="new-binder-review">\n	<form>\n		<div class="form-group">\n			<div class="mx-form-sm-label">{{lang.binder_topic}}</div>\n			<div class="form-control">\n				<div class="ellipsis" title="{{displayTopic}}">{{displayTopic}}</div>\n			</div>\n		</div>\n		<div class="form-group">\n			<div class="mx-form-sm-label">{{lang.category}}</div>\n			<div class="form-control mouse-hand" data-action="updateCategory">\n				<div class="row">\n					<div class="col-sm-11">\n						<div class="ellipsis category-name">{{lang.default_category}}</div>\n					</div>\n					<div class="col-sm-1">\n						<span class="pull-right">\n							<i class="micon-arrow-right size16 gray"></i>\n						</span>\n					</div>\n				</div>\n			</div>\n		</div>\n		<div class="form-group">\n			<div class="mx-form-sm-label">{{lang.cover_image}}</div>\n			<div class="binder-cover">\n				<div class="row">\n					<div class="col-sm-2">\n						<div class="mx-cover-wrap mx-cover-sm">\n	                        <span class="mx-cover-img ">\n	                        	<img id="binderThumbnail" src="{{thumbnail}}"/>\n	                       </span>\n		                </div>\n	                </div>\n	                <div class="col-sm-10">\n						<div class="cover-actions">\n							<a class="pull-right btn btn-default btn-sm" data-action="chooseCover">{{lang.choose}}</a>\n							<a id="removeCoverAction" class="pull-right btn btn-default btn-sm hide" data-action="removeCover">{{lang.remove}}</a>\n						</div>\n					</div>\n				</div>\n			</div>\n		</div>\n        <div class="form-group">\n        	<div class="mx-form-sm-label">{{i18nCount membersCount lang.member lang.members}}</div>\n			<div class="invitees">\n				<ul class="mx-list list-section">\n					<li class="mx-item">\n						<div class="row">\n							<div class="col-sm-1">\n								<img src="{{owner.avatar}}" class="invitee-avatar img-circle"/>\n							</div>\n							<div class="col-sm-11">\n								<div class="invitee-name ellipsis">{{owner.name}} ({{lang.binder_owner}})</div>\n								<div class="invitee-email ellipsis">{{owner.email}}</div>\n							</div>\n						</div>\n					</li>\n					{{#each members}}\n					<li class="mx-item">\n						<div class="row">\n							<div class="col-sm-1">\n								<img src="{{#if group}}{{../../teamAvatar}}{{else}}{{avatar}}{{/if}}" class="invitee-avatar img-circle {{#if group}}mx-noborder mx-noborder-radius{{/if}}"/>\n							</div>\n							<div class="col-sm-11">\n								{{#if group}}\n								<div class="invitee-name ellipsis">{{group.name}}</div>\n								<div class="invitee-email ellipsis">{{i18nCount group.members.length ../../lang.member ../../lang.members}}</div>\n								{{else}}\n								<div class="invitee-name ellipsis">{{name}}</div>\n								<div class="invitee-email ellipsis">{{email}}</div>\n								{{/if}}\n							</div>\n						</div>\n					</li>\n					{{/each}}\n				</ul>\n			</div>\n		</div>\n		{{#if similarBinders.length}}\n		<div class="similar-title">\n			<strong>{{lang.similar_binders_uppercase}} ({{similarBinders.length}})</strong>\n			<div>{{lang.similar_binder_description}}</div>\n		</div>\n		<div class="form-group">\n			<div class="similar-binders">\n				<ul class="mx-list list-section">\n					{{#each similarBinders}}\n					<li class="mx-item">\n						<div class="row">\n							<div class="col-sm-1">\n								<div class="{{#unless board.isconversation}}board-avatar-small{{/unless}}">\n								{{boardAvatar this ../../binderCommon}}\n								</div>\n							</div>\n							<div class="col-sm-9">\n								<div class="name ellipsis" title="{{board.name}}">{{board.name}}</div>\n							</div>\n							<div class="col-sm-2">\n								<span class="pull-right">\n									{{#if isInvited}}\n									<a class="btn btn-warning btn-sm open-binder" data-action="acceptBinder" data-param="{{board.id}}">{{../../lang.accept}}</a>\n									{{else}}\n									<a class="btn btn-default btn-sm open-binder" data-action="openBinder" data-param="{{board.id}}">{{../../lang.open}}</a>\n									{{/if}}\n								</span>\n							</div>\n						</div>\n					</li>\n					{{/each}}\n				</ul>\n			</div>\n		</div>\n		{{/if}}\n	</form>\n</div>';
}), define("text!template/component/categorySelector.html", [], function() {
    return '<div class="category-selector">\n    <form class="form-inline clearfix" role="form"  id="createCategoryForm">\n        <div class="form-group col-xs-10">\n            <input type="text" class="form-control" name="name" autofocus data-error-style="inline" placeholder="{{lang.new_category}}">\n        </div>\n\n        <button type="submit" class="btn btn-default pull-right">{{lang.add}}</button>\n    </form>\n    <div class="mx-container list-group mx-box">\n    	<li class="mx-item default-category ">\n		    <a id={{cid}} href="javascript:;" class="btn name" data-action="selectCategory" data-param="0">\n		        {{lang.default_category}}\n		    </a>\n		</li>\n    </div>\n</div>\n';
}), define("text!template/component/categorySelectorItem.html", [], function() {
    return '<li class="mx-item ">\r\n    <div class="pull-right actions">\r\n        <a href="javascript:;" class="btn " data-action="editCategory" data-param="{{sequence}}" aria-hidden="true"><i class="micon-edit size16"/></a>\r\n        <a href="javascript:;" class="btn "  data-action="deleteCategory" data-param="{{sequence}}" aria-hidden="true"><i class="micon-close size16"/></a>\r\n    </div>\r\n    <a id={{cid}} href="javascript:;" class="btn name" data-action="selectCategory" data-param="{{sequence}}">\r\n        {{name}}\r\n    </a>\r\n</li>\r\n\r\n	\r\n\r\n';
}), define("binder/categoryModel", [ "moxtra", "lang", "const" ], function(a, b) {
    return a.Model.extend({
        idAttribute: "sequence",
        validation: {
            name: [ {
                required: !0,
                msg: b.category_name_reqired
            } ]
        },
        defaults: {
            sequence: "",
            name: ""
        },
        parse: function(a) {
            var b = MX.pick(a, [ "name", "sequence" ]);
            return b;
        },
        save: function() {
            var a = this.get("name");
            return new MX.ChainObject(function() {
                MX.api("/users/me/categories", "POST", {
                    data: {
                        name: a
                    }
                }, this.callback, this);
            });
        },
        update: function() {
            var b = this.toJSON();
            return new MX.ChainObject(function() {
                MX.api(a.format("/users/me/categories/{0}", b.sequence), "PUT", {
                    data: {
                        name: b.name
                    }
                }, this.callback, this);
            });
        }
    });
}), define("component/selector/categorySelector", [ "moxtra", "lang", "const", "text!template/component/categorySelector.html", "text!template/component/categorySelectorItem.html", "binder/binderBiz", "binder/categoryModel", "component/dialog/inputDialog", "component/dialog/dialog" ], function(a, b, c, d, e, f, g, h) {
    MX.logger("categorySelector");
    return a.ui.CategorySelector = a.Controller.extend({
        template: d,
        title: b.select_category,
        handleAction: !0,
        init: function(a) {
            this.$scope.lang = b, this.categories = Moxtra.getMe().categories, this.model = new g(), 
            this.recovery(this.categories), _.extend(this, a);
        },
        rendered: function() {
            this.list = new a.List({
                renderTo: this.$(".mx-container"),
                collection: this.categories,
                template: e,
                syncModel: !0,
                $scope: {
                    lang: b,
                    blankImg: c.defaults.blankImg,
                    multiple: this.multiple
                }
            }), this.recovery(this.list), this.form = new a.Form({
                form: this.$("#createCategoryForm"),
                model: this.model,
                submit: this.submit,
                scope: this
            }), this.$("form input").on("keyup", $.proxy(this.onKeyUp, this)), this.$el.addClass("mx-" + this.style);
        },
        selectCategory: function(a) {
            {
                var c = this.handleEvent;
                $(c.currentTarget);
            }
            c.stopPropagation();
            var d, e = this.categories.get(a);
            d = e ? e.toJSON() : {
                name: b.default_category,
                sequence: 0
            }, this.trigger("select", d), this.onSelect.call(this, d);
        },
        deleteCategory: function(a) {
            var c = this.handleEvent, d = this.categories.get(a), e = this;
            MX.ui.Confirm(b.confirm_delete_category, function() {
                d.delete().success(function() {
                    MX.ui.notifySuccess(b.delete_category_success), e.categories.remove(d);
                }).error(function() {
                    MX.ui.notifyError(b.delete_category_failed);
                });
            }), c.stopPropagation();
        },
        editCategory: function(a) {
            var c = this.handleEvent;
            c.stopPropagation();
            var d = this.categories.get(a), e = d.name, f = new MX.ui.Dialog(new h({
                model: d,
                title: b.rename,
                input: {
                    name: "name",
                    placeholder: b.please_enter_category_name
                },
                buttons: [ {
                    text: b.cancel,
                    className: "btn-default",
                    position: "left",
                    click: function() {
                        d.set("name", e), this.close();
                    }
                }, {
                    text: b.update,
                    className: "btn-primary",
                    position: "right",
                    click: "onSubmit"
                } ],
                onSubmit: function() {
                    var a = this;
                    d.name.length ? (a.dialog.progress(), d.update().success(function() {
                        MX.ui.notifySuccess(b.update_category_success), a.dialog.progress(!1), a.dialog.close();
                    }).error(function() {
                        MX.ui.notifyError(b.update_category_failed), a.dialog.progress(!1);
                    })) : a.dialog.$(".form-group").addClass("has-error");
                }
            }));
            f.on("close", function() {
                d.name.length || d.set("name", e);
            });
        },
        onKeyUp: function() {},
        onSelect: function() {},
        value: function() {},
        submit: function() {
            var a = new Moxtra.model.Category(), c = this;
            a.set("name", this.model.get("name")), a.create(Moxtra.getMe()).success(function() {
                MX.ui.notifySuccess(b.create_category_success), c.$("form input").val(""), c.onSelect.call(c, a);
            }).error(function() {
                MX.ui.notifyError(b.create_category_failed);
            });
        }
    }), a.ui.CategorySelector;
}), define("binder/newBinderReview", [ "moxtra", "lang", "app", "text!template/binder/newBinderReview.html", "binder/binderBiz", "user/userModel", "component/selector/categorySelector" ], function(a, b, c, d, e, f, g) {
    "use strict";
    return a.Controller.extend({
        title: b.review,
        template: d,
        handleAction: !0,
        buttons: [ {
            position: "left",
            text: b.back,
            click: "onBack"
        }, {
            position: "right",
            id: "btnCreateBinder",
            loadingText: b.creating_ellipsis,
            text: b.create,
            className: "btn-primary",
            click: "onCreate"
        } ],
        init: function(a) {
            a = a || {};
            var c = Moxtra.getMe();
            this.topic = a.topic, this.displayTopic = a.displayTopic, this.invitees = a.invitees || [], 
            this.members = [], this.users = [], this.lookupKeys = [], this.keysMapping = {}, 
            this.cover = "", this.thumbnail = c.branding.getDefaultCover() || Moxtra.config.defaults.binder_cover, 
            this.invitationMessage = a.invitationMessage, this.category = 0, this.onActionDone = a.onActionDone || function() {}, 
            this._parseInvitees(), this.$scope.lang = b, this.$scope.displayTopic = this.displayTopic, 
            this.$scope.owner = {
                name: c.name,
                email: c.email,
                avatar: c.avatar || c.branding.getDefaultUserAvatar()
            }, this.$scope.members = this.members, this.$scope.membersCount = this.invitees.length + 1, 
            this.$scope.teamAvatar = Moxtra.config.group.avatar, this.$scope.thumbnail = this.thumbnail, 
            this.$scope.similarBinders = this._getSimilarBinders(), this.$scope.binderCommon = {
                myself: c.primaryKey
            };
        },
        rendered: function() {},
        onBack: function() {
            this.dialog.pop();
        },
        onCreate: function() {
            var a, c = this.dialog.getButton("btnCreateBinder"), d = this;
            c.button("loading"), a = new Moxtra.model.Board(), a.set("name", d.topic), a.create().success(function() {
                d.users.length && a.inviteUsers(d.users, null, d.invitationMessage).success(function() {}).error(function() {
                    MX.ui.notifyError(b.invite_user_failed);
                }), d.cover && a.choosePageAsCover(d.cover), d.category && a.assignCategory(d.category), 
                d.dialog.close(), d.onActionDone(a.id), d._postBinderCreatedMsg(a.id);
            }).error(function() {
                c.button("reset"), MX.ui.notifyError(b.create_binder_failed);
            });
        },
        updateCategory: function() {
            var a = this, c = new g({
                buttons: [ {
                    position: "left",
                    text: b.cancel,
                    className: "btn-primary",
                    click: function() {
                        this.pop();
                    }
                } ],
                onSelect: function(c) {
                    a.category = c.sequence, a.$(".category-name").text(c.name || b.default_category), 
                    a.dialog.pop();
                }
            });
            a.dialog.push({
                hideClose: !0,
                content: c
            });
        },
        chooseCover: function() {
            var a, c = this;
            a = new MX.ui.BinderSelector({
                showCheckbox: !1,
                title: b.choose_cover_image,
                filter: "all",
                buttons: [ {
                    text: b.cancel,
                    position: "left",
                    className: "btn-primary",
                    click: function() {
                        this.pop();
                    }
                } ],
                onSelect: function() {
                    var a = this.value()[0], d = this.handleEvent;
                    if (d) {
                        var e = $(d.currentTarget), f = this.getFormElements(e), g = f.prop("checked");
                        "INPUT" !== d.target.tagName && (g = !g, f.prop("checked", g).trigger("change"));
                    }
                    this.dialog.push(new MX.ui.FileSelector({
                        title: b.choose,
                        boardId: a,
                        allowSelectPage: !0,
                        multiple: !1,
                        style: "form",
                        buttons: [ {
                            text: b.back,
                            position: "left",
                            click: function() {
                                this.pop();
                            }
                        }, {
                            text: b.choose,
                            position: "right",
                            className: "btn-primary",
                            click: "choosePageAsCover"
                        } ],
                        choosePageAsCover: function() {
                            var a, b = this.value(), d = this;
                            b && (a = b[0], a && (c.$("#binderThumbnail").attr("src", a.thumbnail), c.$("#removeCoverAction").removeClass("hide"), 
                            c.cover = a.thumbnail)), this.dialog.pop(), setTimeout(function() {
                                d.dialog.pop();
                            }, 1);
                        }
                    }));
                }
            }), c.dialog.push({
                hideClose: !0,
                content: a
            });
        },
        removeCover: function() {
            this.$("#binderThumbnail").attr("src", this.thumbnail), this.$("#removeCoverAction").addClass("hide"), 
            this.cover = "";
        },
        openBinder: function(a) {
            c.request.navigate("timeline", a), this.dialog.close();
        },
        acceptBinder: function(a) {
            e.acceptBinder(a).success(function() {
                c.request.navigate("timeline", a);
            }).error(function() {
                MX.ui.notifyError(b.invite_accept_failed);
            }), this.dialog.close();
        },
        _parseInvitees: function() {
            var a = this;
            MX.each(a.invitees, function(b) {
                var c = new f();
                MX.isUndefined(b.isTeam) ? a.keysMapping[b.id] || a.keysMapping[b.email] || (a.keysMapping[b.id] = b.id, 
                a.keysMapping[b.email] = b.email, a.lookupKeys.push({
                    id: b.id,
                    email: b.email
                }), b.id || (b.id = b.email), a.members.push(c.parse(b)), a.users.push({
                    email: b.email
                })) : a.keysMapping[b.id] || (a.keysMapping[b.id] = b.id, a.lookupKeys.push({
                    group_id: b.id
                }), c.set({
                    userid: b.id,
                    group: b
                }), a.members.push(c.toJSON()), a.users.push({
                    group_id: b.id
                }));
            });
        },
        _getSimilarBinders: function() {
            var a = [], b = Moxtra.getMe();
            return this.keysMapping[b.id] || this.keysMapping[b.email] || a.push({
                id: b.id,
                email: b.email
            }), a = _.union(a, this.lookupKeys), Moxtra.getSimilarBoards(a);
        },
        _postBinderCreatedMsg: function(a) {
            c.sendMessage({
                action: "create_binder",
                binder_id: a,
                session_id: Moxtra.getMe().sessionId
            });
        }
    });
}), define("binder/newBinder", [ "moxtra", "lang", "app", "const", "text!template/binder/newBinder.html", "binder/newBinderReview", "component/selector/userSelector" ], function(a, b, c, d, e, f) {
    "use strict";
    return a.Controller.extend({
        title: b.start_a_new_conversation,
        template: e,
        handleAction: !0,
        init: function(a) {
            a = a || {}, a.onActionDone && (this.onActionDone = a.onActionDone), this.binderType = a.binderType;
            var c = [], d = !0;
            c.push({
                position: "left",
                text: b.cancel,
                click: function() {
                    this.close(), a.onCancelDone && a.onCancelDone();
                }
            }), c.push({
                position: "right",
                text: b.next,
                className: "btn-primary",
                click: "onNext"
            }), this.buttons = c, this.$scope.lang = b, this.$scope.binderType = a.binderType, 
            this.$scope.showInput = d;
        },
        rendered: function() {
            var a = !0;
            ("project" === this.binderType || "team" === this.binderType) && (a = !1);
            var b = {
                autoFocus: a,
                expandSelected: !1,
                notifySelected: !0,
                needMessage: !0
            };
            this.dialog && (b.dialog = this.dialog), this.userSelector = new MX.ui.UserSelector(b), 
            this.userSelector.renderTo(this.$(".user-selector"));
        },
        onNext: function() {
            var a, b, c = this.$("#createBinderForm input").val().trim(), d = "", e = this.userSelector.invitationMessage(), g = this.userSelector.value() || [], h = [];
            if (d = c, c || g.length || (d = Moxtra.getMe().displayName), !d) {
                for (var i = 0; 6 > i; i++) a = g[i], a && h.push(MX.isUndefined(a.isTeam) ? a.displayName : a.name);
                d = h.join(", ");
            }
            b = new f({
                topic: c,
                displayTopic: d,
                invitees: g,
                invitationMessage: e,
                onActionDone: this.onActionDone
            }), this.dialog.push(b), this.recovery(b);
        },
        onActionDone: function() {}
    });
}), define("binder/newBinderOptions", [ "moxtra", "lang", "text!template/binder/newBinderOptions.html", "binder/newBinder" ], function(a, b, c, d) {
    "use strict";
    return a.Controller.extend({
        title: b.add,
        template: c,
        handleAction: !0,
        init: function(a) {
            this.$scope.lang = b, a.onCreatedBinder && (this.onActionDone = a.onCreatedBinder);
        },
        rendered: function() {
            var a = this;
            setTimeout(function() {
                a.dialog && a.dialog.push({
                    content: new d({
                        binderType: "project",
                        onActionDone: a.onActionDone
                    })
                });
            }, 100);
        }
    });
}), define("binder/binderActions", [ "moxtra", "lang", "app", "dropins", "binder/pageAddDesktop", "component/selector/binderSelector", "../component/selector/fileSelector", "component/selector/folderSelector", "binder/webdocEditor", "binder/binderBiz", "common/shareBiz", "common/share", "common/download", "binder/newBinderOptions", "binder/binderModel", "const", "component/dialog/inputDialog" ], function(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q) {
    var r = MX.logger("BinderActions:AddPage");
    d = d || window.Dropbox;
    var s = function(a) {
        var b, d, e, f, g, h, i = a.data || a.object.board, j = Moxtra.getBoard(i.id);
        b = i.view_tokens[0].token, d = MX.getOrigin() + "/v/" + b, e = [ MX.getOrigin(), "board", i.id, "download?d=&t=" + b ].join("/");
        var k = i.view_tokens[0];
        if (k.page_groups) {
            if (g = k.page_groups, 1 === g.length) {
                var l = j.getFiles().get(g[0].sequence);
                h = l && l.original;
            }
        } else if (k.folders) {
            var m = k.folders;
            if (1 === m.length) for (var n = m[0]; n.folders || n.files; ) {
                if (n.files || n.folders.length > 1) {
                    if (g = n.files, 1 === g.length) {
                        var o = j.getFiles(n.sequence).get(g[0].sequence);
                        h = o && o.original;
                    }
                    break;
                }
                n = n.folders[0];
            }
        }
        f = h ? [ MX.getOrigin(), "board", i.id, h, "?d=&t=" + b ].join("/") : e, c.sendMessage({
            action: "share",
            binder_id: i.id,
            session_id: Moxtra.getMe().sessionId,
            share_url: d,
            download_url: e,
            original_download_url: f
        });
    }, t = function() {
        r.debug("share binder(pages) error!"), c.sendMessage({
            action: "fail",
            session_id: Moxtra.getMe().sessionId,
            cmd: "share"
        });
    }, u = {
        destFolder: "",
        currentObj: null,
        setGroupInfo: function(a) {
            this.page_group = a;
        },
        clearGroupInfo: function() {
            this.page_group = null;
        },
        addPage: function(a, b) {
            var d = c.request.get("page");
            switch (a) {
              case "webdoc":
                u.addWebDoc(d, u.page_group);
                break;

              case "whiteboard":
                u.addPageBlank(b, d, Moxtra.const.PAGE_TYPE_WHITEBOARD);
                break;

              case "sf":
                break;

              case "desktop":
                break;

              case "webclip":
                break;

              case "binderPage":
                u.addPageFromBinder(d, b);
                break;

              case "remoteDesktop":
                new MX.ui.Dialog({
                    iframeShim: !0,
                    content: e
                });
                break;

              case "dropbox":
                c.config.global.dropbox_dropin_app_key && u.importFromDropbox(d, c.config.global.dropbox_dropin_app_key);
            }
        },
        addPageBlank: function(a, d, e) {
            this.currentObj || (this.currentObj = Moxtra.getBoard(d));
            var f = {}, g = $("body").get(0);
            f.width = g.offsetWidth - 300, f.height = g.offsetHeight - 50;
            var h = new Moxtra.model.BoardPage();
            h.set("page_type", e), h.set("width", Math.max(f.width, 800)), h.set("height", Math.max(f.height, 800)), 
            h.create(this.currentObj).success(function(b) {
                var f = b.sequence;
                f && (setTimeout(function() {
                    switch (e) {
                      case Moxtra.const.WEBDOC:
                        u.editWebDoc(d, f);
                        break;

                      case Moxtra.const.PAGE_TYPE_WHITEBOARD:
                        a && 1 * a === 1 * a || c.request.sequence(f);
                    }
                }, 500), r.info("webdoc added:", b));
            }).error(function(a) {
                r.info("add webdoc/whiteboard failed.", a), MX.ui.notifyError(b.binder_create_whiteboard_failed);
            });
        },
        addWebDoc: function(a, b) {
            return c.request.sequence(""), new i({
                renderTo: document.body,
                board_id: a,
                page_group: b,
                currentObj: this.currentObj || Moxtra.getBoard(a)
            });
        },
        editWebDoc: function(a, b) {
            return new i({
                renderTo: document.body,
                board_id: a,
                page_seq: b
            });
        },
        importFromDropbox: function(a, c) {
            var e = Moxtra.getBoard(a);
            d && a && c && (d.init({
                appKey: c
            }), d.choose({
                success: function(a) {
                    a && a.length && a.forEach(function(a) {
                        e.uploadFromDropbox(a.name, a.link, this.currentObj || e).success(function() {
                            MX.ui.notifySuccess(b.binder_import_dropbox_success);
                        });
                    });
                },
                linkType: "direct",
                multiselect: !0
            }));
        },
        addPageFromBinder: function(a, c) {
            var d, e, f, h = b.binder_add_from_binder, i = this;
            f = new MX.ui.BinderSelector({
                showCheckbox: !1,
                title: h,
                filter: "all",
                buttons: [ {
                    text: b.cancel,
                    click: function() {
                        this.pop();
                    }
                } ],
                onSelect: function() {
                    var f = this.value()[0], j = this.handleEvent;
                    if (j) {
                        var k = $(j.currentTarget);
                        if (!k.find(".open-board").length) return;
                        var l = this.getFormElements(k), m = l.prop("checked");
                        "INPUT" !== j.target.tagName && (m = !m, l.prop("checked", m).trigger("change"));
                    }
                    var n = "btn-primary";
                    c && 1 * c === 1 * c && (n += " mx-branding-meet-dialog-btn"), "Video_Clip" === c && (n += " mx-branding-note-dialog-btn"), 
                    this.dialog.push(new g({
                        title: h,
                        boardId: f,
                        multiple: !0,
                        style: "form",
                        buttons: [ {
                            text: b.back,
                            position: "left",
                            click: function() {
                                this.pop();
                            }
                        }, {
                            text: b.add,
                            position: "right",
                            className: n,
                            click: "addPageToBinder"
                        } ],
                        addPageToBinder: function() {
                            if (d = [], e = this.value(), e && e.length) {
                                e.forEach(function(a) {
                                    a && d.push(a.client_uuid);
                                });
                                var b = Moxtra.getBoard(f);
                                b.copyFiles(d, i.currentObj || Moxtra.getBoard(a), e[0].parent);
                            }
                            this.dialog.close();
                        }
                    }));
                }
            }), new MX.ui.Dialog({
                iframeShim: !0,
                content: f
            });
        },
        copyResourceTo: function(a, c) {
            new MX.ui.Dialog({
                content: new MX.ui.BinderSelector({
                    title: b.binder_copy_a_file_to,
                    buttons: [ {
                        text: b.copy,
                        position: "right",
                        className: "btn-primary",
                        click: "copyPageToBinder"
                    } ],
                    onChange: function() {
                        r.debug(this, arguments);
                    },
                    newBinder: function() {
                        var a = this;
                        this.dialog.push(new n({
                            onCreatedBinder: function(b) {
                                a.copyResourceTo(b);
                            }
                        }));
                    },
                    copyPageToBinder: function() {
                        var a = this.value();
                        this.copyResourceTo(a);
                    },
                    copyResourceTo: function(d) {
                        j.copyBinderResources(d, a, c).success(function() {
                            MX.ui.notifySuccess(b.binder_copy_file_success);
                        }).error(function() {
                            MX.ui.notifyError(b.binder_copy_file_fail);
                        }), this.dialog.close();
                    }
                })
            });
        },
        copyPageTo: function(a, c, d) {
            var e, f, g;
            return d ? (e = a, a = a.id) : e = Moxtra.getBoard(a), f || (f = c.length > 1 ? b.binder_copy_files_to : b.binder_copy_a_file_to), 
            g || (g = b.copy), new MX.ui.Dialog({
                content: new MX.ui.folderSelector({
                    showCheckbox: !1,
                    title: f,
                    buttons: [ {
                        text: b.copy,
                        position: "right",
                        click: "copyPageToBinder",
                        className: "btn-primary"
                    } ],
                    newBinder: function() {
                        var a = this;
                        this.dialog.push(new n({
                            onCreatedBinder: function(b) {
                                var c = Moxtra.getBoard(b);
                                a.copyPageTo(c);
                            }
                        }));
                    },
                    copyPageToBinder: function() {
                        var a = this.value();
                        this.copyPageTo(a);
                    },
                    copyPageTo: function(a) {
                        e.copyPage(c, a).success(function() {
                            MX.ui.notifySuccess(c.length > 1 ? b.binder_copy_files_success : b.binder_copy_file_success);
                        }).error(function(a) {
                            MX.ui.notifyError(a && a.xhr && 413 === a.xhr.status ? b.common_msg_reach_limit_pages : b.binder_copy_file_fail);
                        }), this.dialog.close();
                    }
                })
            });
        },
        movePageTo: function(a, c) {
            var d = new Moxtra.util.Request(), e = c.length > 1 ? b.binder_move_files_to : b.binder_move_a_file_to, f = Moxtra.getBoard(a);
            return new MX.ui.Dialog({
                content: new MX.ui.folderSelector({
                    showCheckbox: !1,
                    title: e,
                    buttons: [ {
                        text: b.move,
                        position: "right",
                        click: "movePageToBinder",
                        className: "btn-primary"
                    } ],
                    newBinder: function() {
                        var a = this;
                        this.dialog.push(new n({
                            onCreatedBinder: function(b) {
                                var c = Moxtra.getBoard(b);
                                a.movePageTo(c);
                            }
                        }));
                    },
                    movePageToBinder: function() {
                        var a = this.value();
                        this.movePageTo(a);
                    },
                    movePageTo: function(a) {
                        f.movePage(c, a).success(function() {
                            d.invoke("success"), MX.ui.notifySuccess(c.length > 1 ? b.binder_move_files_success : b.binder_move_file_success);
                        }).error(function(a) {
                            d.invoke("error"), MX.ui.notifyError(a && a.xhr && 413 === a.xhr.status ? b.common_msg_reach_limit_pages : b.binder_move_file_fail);
                        }), this.dialog.close();
                    }
                })
            }), d;
        },
        moveFileTo: function(a, c, d) {
            {
                var e = new Moxtra.util.Request(), f = c.length > 1 ? b.binder_move_files_to : b.binder_move_a_file_to, g = this;
                Moxtra.getBoard(a);
            }
            return new MX.ui.Dialog({
                content: new MX.ui.folderSelector({
                    showCheckbox: !1,
                    title: f,
                    buttons: [ {
                        text: b.move,
                        position: "right",
                        click: "movePageToBinder",
                        className: "btn-primary"
                    } ],
                    newBinder: function() {
                        var a = this;
                        this.dialog.push(new n({
                            onCreatedBinder: function(b) {
                                var c = Moxtra.getBoard(b);
                                a.movePageTo(c);
                            }
                        }));
                    },
                    movePageToBinder: function() {
                        var a = this.value();
                        this.movePageTo(a);
                    },
                    movePageTo: function(f) {
                        var h = Moxtra.getBoard(a);
                        h.moveFiles(c, f, d || g.currentObj).success(function() {
                            e.invoke("success"), MX.ui.notifySuccess(c.length > 1 ? b.binder_move_files_success : b.binder_move_file_success);
                        }).error(function(a) {
                            e.invoke("error"), MX.ui.notifyError(a && a.xhr && 413 === a.xhr.status ? b.common_msg_reach_limit_pages : b.binder_move_file_fail);
                        }), this.dialog.close();
                    }
                })
            }), e;
        },
        needSuppressShareDialog: function() {
            if (c.isIntegrationEnabled()) {
                var a = c.integration.get("extension");
                if (a) {
                    var b = JSON.parse(a);
                    if (b.show_dialogs && b.show_dialogs.share === !1) return !0;
                }
            }
            return !1;
        },
        copyFilesTo: function(a, c, d, e) {
            var f;
            e && e.token ? (f = c, c = c.id) : f = Moxtra.getBoard(c);
            var g = a.length;
            e = e || {};
            {
                var h = (e.token, e.title);
                e.btnText;
            }
            h || (h = g > 1 ? b.binder_copy_files_to : b.binder_copy_a_file_to);
            var i = this;
            return new MX.ui.Dialog({
                content: new MX.ui.folderSelector({
                    showCheckbox: !1,
                    title: h,
                    buttons: [ {
                        text: b.copy,
                        position: "right",
                        click: "copyPageToBinder",
                        className: "btn-primary"
                    } ],
                    newBinder: function() {
                        var a = this;
                        this.dialog.push(new n({
                            onCreatedBinder: function(b) {
                                var c = Moxtra.getBoard(b);
                                a.copyPageTo(c);
                            }
                        }));
                    },
                    copyPageToBinder: function() {
                        var a = this.value();
                        this.copyPageTo(a);
                    },
                    copyPageTo: function(c) {
                        var e = f.copyFiles;
                        e.apply(f, [ a, c, d || i.currentObj ]).success(function() {
                            MX.ui.notifySuccess(g > 1 ? b.binder_copy_files_success : b.binder_copy_file_success);
                        }).error(function(a) {
                            MX.ui.notifyError(a && a.xhr && 413 === a.xhr.status ? b.common_msg_reach_limit_pages : b.binder_copy_file_fail);
                        }), this.dialog.close();
                    }
                })
            });
        },
        transformFiles: function(a, b) {
            var c = [];
            return _.each(a, function(a) {
                c.push(b.getCacheObject(a).sequence);
            }), c;
        },
        shareFiles: function(a, b, c, d) {
            var e = this, f = Moxtra.getBoard(a);
            return this.needSuppressShareDialog() ? void (b.length || c.length ? f.shareFiles(b, c, d || this.currentObj).success(s).error(t) : k.getShareBinderToken(a).success(s).error(t)) : new MX.ui.Dialog(new l({
                type: "page",
                binderId: a,
                files: b,
                folders: c,
                parent: d || e.currentObj
            }));
        },
        sharePages: function(a, b) {
            return this.needSuppressShareDialog() ? void (!b || b.length <= 0 ? k.getShareBinderToken(a).success(s).error(t) : k.getSharePagesToken(a, b).success(s).error(t)) : new MX.ui.Dialog(new l({
                type: "page",
                binderId: a,
                pages: b
            }));
        },
        shareResource: function(a, b) {
            return this.needSuppressShareDialog() ? void k.getResourcesShareViewToken(a, [ b ]).success(s).error(t) : new MX.ui.Dialog(new l({
                type: "resource",
                binderId: a,
                resourceSequence: b
            }));
        },
        downloadResources: function(a, b, c) {
            var d = a, e = this, f = [];
            if (_.isString(a) ? d = Moxtra.getBoard(a) : a = d.id, 1 === b.length) {
                var g = !1, h = d.getCacheObject(b[0]), i = [];
                h ? h.isVirtual || !h.original ? h.pages.length && (_.each(h.pages, function(a) {
                    f.push(a.sequence);
                }), c ? e.downloadPagesWithToken(a, f, c) : e.downloadPages(a, f)) : (_.each(h.pages, function(a) {
                    i.push(a.sequence), a.contents && a.contents.length && (g = !0);
                }), this.downloadResource(a, h.original, c, {
                    showDialog: g,
                    pages: i
                })) : this.downloadResource(a, b[0], c);
            } else _.each(b, function(a) {
                a = d.getCacheObject(a), a.pages.length && _.each(a.pages, function(a) {
                    f.push(a.sequence);
                });
            }), c ? e.downloadPagesWithToken(a, f, c) : e.downloadPages(a, f);
        },
        downloadResource: function(a, b, c, d) {
            var e = _.extend({}, d, {
                type: "resource",
                binderId: a,
                originalResource: b
            });
            c && (e.token = c), this.openDownloadDialog(e);
        },
        downloadBinder: function(a, b) {
            {
                var c = {
                    type: "binder",
                    token: b,
                    binderId: a
                };
                new m(c);
            }
        },
        downloadPagesWithToken: function(a, b, c) {
            var d = {
                type: "page",
                token: c,
                binderId: a,
                pages: b
            };
            this.openDownloadDialog(d);
        },
        downloadPages: function(a, b) {
            var c = this, d = {
                type: "page",
                binderId: a,
                pages: b
            }, e = new o(MX.getUserBinder(a), {
                parse: !0
            });
            if (d.isViewer = e.get("isViewer"), !d.isViewer && b && 1 == b.length) {
                var f = Moxtra.getBoard(a);
                if (f) {
                    var g;
                    MX.each(f.pages, function(a) {
                        a.sequence == b[0] && (g = a);
                    }), g && g.page_type !== p.binder.pageType.pdf && (g.contents && g.contents.each(function(a) {
                        return a.is_deleted ? void 0 : (d.isAnnotated = !0, !1);
                    }), g.original_resource_sequence ? MX.each(f.resources, function(a) {
                        a.sequence == g.original_resource_sequence && (d.originalResource = a.sequence);
                    }) : (d.originalResource = g.original || g.vector, g.page_type === p.binder.pageType.image && (d.originalResource = d.originalResource || g.background), 
                    d.resourcePage = g), d.originalResource && !d.isAnnotated && (d.type = "resource")), 
                    c.openDownloadDialog(d);
                }
            } else this.openDownloadDialog(d);
        },
        openDownloadDialog: function(a) {
            new MX.ui.Dialog({
                content: new m(a),
                title: b.download
            });
        },
        addCustomPages: function(a, b, d) {
            var e = {
                action: d || a,
                binder_id: c.request.get("page") || null,
                session_key: b || null,
                session_id: Moxtra.getMe().sessionId || null
            };
            c.sendMessage(e);
        },
        addCustomActions: function(a, b, d) {
            var e = {
                action: a,
                binder_id: c.request.get("page") || null,
                session_id: Moxtra.getMe().sessionId || null,
                download_url: b,
                download_name: d
            };
            c.sendMessage(e);
        },
        createTodo: function(a, c, d, e) {
            var f = this, g = new Moxtra.util.Request(), h = Moxtra.createTodoModel(a);
            h.validation = {
                name: [ {
                    required: !0,
                    msg: b.name_is_required
                } ]
            };
            var i = Moxtra.getBoard(a), j = new q({
                model: h,
                title: b.create_todo,
                input: {
                    name: "name",
                    placeholder: b.add_to_do_item
                },
                buttons: [ {
                    text: b.cancel,
                    position: "left",
                    click: function() {
                        this.pop();
                    }
                }, {
                    id: "btnCreateTodo",
                    text: b.create,
                    className: "btn-primary",
                    position: "right",
                    click: "onSubmit"
                } ],
                onSubmit: function() {
                    var a = this;
                    h.isValid(!0) && (this.dialog.progress(), h.create().success(function() {
                        h.addAttachments(c, d, e || f.currentObj || i).success(function() {
                            g.invoke("success"), a.dialog.close(), MX.ui.notifySuccess(b.create_todo_success);
                        }).error(function() {
                            g.invoke("error"), a.dialog.close(), MX.ui.notifySuccess(b.add_attachment_failed);
                        });
                    }).error(function() {
                        g.invoke("error"), a.dialog.close(), MX.ui.notifySuccess(b.create_todo_fail);
                    }));
                }
            });
            return new MX.ui.Dialog({
                content: j
            }), g;
        },
        groupPage: function(a, c) {
            var d = this, e = new Moxtra.util.Request(), f = new Moxtra.model.BoardFile();
            f.name = "", f.validation = {
                name: [ {
                    required: !0,
                    msg: b.name_is_required
                } ]
            };
            var g = Moxtra.getBoard(a), h = new q({
                model: f,
                title: b.group_pages,
                input: {
                    name: "name",
                    placeholder: b.new_group_name
                },
                buttons: [ {
                    text: b.cancel,
                    position: "left",
                    click: function() {
                        this.pop();
                    }
                }, {
                    id: "btnCreateGroup",
                    text: b.create,
                    className: "btn-primary",
                    position: "right",
                    click: "onSubmit"
                } ],
                onSubmit: function() {
                    var a, h = this;
                    f.isValid(!0) && (this.dialog.progress(), a = d.page_group ? g.getCacheObject(d.page_group) : d.currentObj, 
                    f.create(a, c).success(function() {
                        e.invoke("success"), h.dialog.close(), MX.ui.notifySuccess(b.create_page_group_success);
                    }).error(function() {
                        e.invoke("error"), h.dialog.close(), MX.ui.notifyError(b.create_page_group_failed);
                    }));
                }
            });
            return new MX.ui.Dialog({
                content: h
            }), e;
        },
        removeFiles: function(c, d, e, f) {
            var g, h, i, j = new Moxtra.util.Request(), k = Moxtra.getBoard(c), l = d.length, m = e.length, n = this;
            l ? l + m > 1 ? (g = b.binder_delete_files, h = b.binder_confirm_delete_files, i = b.binder_delete_files_success) : (g = b.binder_delete_file, 
            h = b.binder_confirm_delete_a_file, i = b.binder_delete_file_success) : m && (m > 1 ? (g = b.binder_delete_folders, 
            h = b.binder_confirm_delete_folders, i = b.binder_delete_folders_success) : (g = b.binder_delete_folder, 
            h = b.binder_confirm_delete_a_folder, i = b.binder_delete_folder_success));
            new a.ui.Dialog({
                title: g,
                content: "<div>" + h + "</div>",
                buttons: [ {
                    text: b.cancel,
                    click: function() {
                        this.close();
                    }
                }, {
                    text: b.ok,
                    className: "btn-primary",
                    click: function() {
                        var a = this;
                        k.removeFiles(d, e, f || n.currentObj).success(function() {
                            j.invoke("success"), MX.ui.notifySuccess(i), a.close();
                        }).error(function() {
                            j.invoke("error");
                        });
                    }
                } ]
            });
            return j;
        },
        removeResource: function(c, d) {
            new a.ui.Dialog({
                title: b.binder_delete_file,
                content: "<div>" + b.binder_confirm_delete_a_file + "</div>",
                buttons: [ {
                    text: b.cancel,
                    click: function() {
                        this.close();
                    }
                }, {
                    text: b.ok,
                    className: "btn-primary",
                    click: function() {
                        var a = this, e = Moxtra.getBoard(c), f = e.resources.get(d);
                        f ? f.delete().success(function() {
                            MX.ui.notifySuccess(b.binder_delete_file_success), a.close();
                        }).error(function() {
                            a.close();
                        }) : a.close();
                    }
                } ]
            });
        },
        removePages: function(c, d, e, f, g) {
            {
                var h = Moxtra.getBoard(c), i = d.length + e.length, j = i ? b.binder_delete_files : b.binder_delete_file, k = i ? b.binder_confirm_delete_files : b.binder_confirm_delete_a_file;
                new a.ui.Dialog({
                    title: j,
                    content: "<div>" + k + "</div>",
                    buttons: [ {
                        text: b.cancel,
                        click: function() {
                            this.close();
                        }
                    }, {
                        text: b.ok,
                        className: "btn-primary",
                        click: function() {
                            var a = this;
                            h.deletePage(d, e).success(function() {
                                MX.ui.notifySuccess(i > 1 ? b.binder_delete_files_success : b.binder_delete_file_success), 
                                f && f(), a.close();
                            }).error(function() {
                                MX.ui.notifyError(b.binder_delete_resource_file_failed), g && g(), a.close();
                            });
                        }
                    } ]
                });
            }
        }
    };
    return u;
}), !function(a, b) {
    "use strict";
    function c(a, b) {
        for (var c, d = [], f = 0; f < a.length; ++f) {
            if (c = g[a[f]] || e(a[f]), !c) throw "module definition dependecy not found: " + a[f];
            d.push(c);
        }
        b.apply(null, d);
    }
    function d(a, d, e) {
        if ("string" != typeof a) throw "invalid module definition, module id must be defined and be a string";
        if (d === b) throw "invalid module definition, dependencies must be specified";
        if (e === b) throw "invalid module definition, definition function must be specified";
        c(d, function() {
            g[a] = e.apply(null, arguments);
        });
    }
    function e(b) {
        for (var c = a, d = b.split(/[.\/]/), e = 0; e < d.length; ++e) {
            if (!c[d[e]]) return;
            c = c[d[e]];
        }
        return c;
    }
    function f(c) {
        for (var d = 0; d < c.length; d++) {
            for (var e = a, f = c[d], h = f.split(/[.\/]/), i = 0; i < h.length - 1; ++i) e[h[i]] === b && (e[h[i]] = {}), 
            e = e[h[i]];
            e[h[h.length - 1]] = g[f];
        }
    }
    var g = {}, h = "moxie/core/utils/Basic", i = "moxie/core/I18n", j = "moxie/core/utils/Mime", k = "moxie/core/utils/Env", l = "moxie/core/utils/Dom", m = "moxie/core/Exceptions", n = "moxie/core/EventTarget", o = "moxie/core/utils/Encode", p = "moxie/runtime/Runtime", q = "moxie/runtime/RuntimeClient", r = "moxie/file/Blob", s = "moxie/file/File", t = "moxie/file/FileInput", u = "moxie/file/FileDrop", v = "moxie/runtime/RuntimeTarget", w = "moxie/file/FileReader", x = "moxie/core/utils/Url", y = "moxie/file/FileReaderSync", z = "moxie/xhr/FormData", A = "moxie/xhr/XMLHttpRequest", B = "moxie/runtime/Transporter", C = "moxie/image/Image", D = "moxie/runtime/html5/Runtime", E = "moxie/runtime/html5/file/Blob", F = "moxie/core/utils/Events", G = "moxie/runtime/html5/file/FileInput", H = "moxie/runtime/html5/file/FileDrop", I = "moxie/runtime/html5/file/FileReader", J = "moxie/runtime/html5/xhr/XMLHttpRequest", K = "moxie/runtime/html5/utils/BinaryReader", L = "moxie/runtime/html5/image/JPEGHeaders", M = "moxie/runtime/html5/image/ExifParser", N = "moxie/runtime/html5/image/JPEG", O = "moxie/runtime/html5/image/PNG", P = "moxie/runtime/html5/image/ImageInfo", Q = "moxie/runtime/html5/image/MegaPixel", R = "moxie/runtime/html5/image/Image", S = "moxie/runtime/flash/Runtime", T = "moxie/runtime/flash/file/Blob", U = "moxie/runtime/flash/file/FileInput", V = "moxie/runtime/flash/file/FileReader", W = "moxie/runtime/flash/file/FileReaderSync", X = "moxie/runtime/flash/xhr/XMLHttpRequest", Y = "moxie/runtime/flash/runtime/Transporter", Z = "moxie/runtime/flash/image/Image", $ = "moxie/runtime/silverlight/Runtime", _ = "moxie/runtime/silverlight/file/Blob", ab = "moxie/runtime/silverlight/file/FileInput", bb = "moxie/runtime/silverlight/file/FileDrop", cb = "moxie/runtime/silverlight/file/FileReader", db = "moxie/runtime/silverlight/file/FileReaderSync", eb = "moxie/runtime/silverlight/xhr/XMLHttpRequest", fb = "moxie/runtime/silverlight/runtime/Transporter", gb = "moxie/runtime/silverlight/image/Image", hb = "moxie/runtime/html4/Runtime", ib = "moxie/runtime/html4/file/FileInput", jb = "moxie/runtime/html4/file/FileReader", kb = "moxie/runtime/html4/xhr/XMLHttpRequest", lb = "moxie/runtime/html4/image/Image";
    d(h, [], function() {
        var a = function(a) {
            var b;
            return a === b ? "undefined" : null === a ? "null" : a.nodeType ? "node" : {}.toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase();
        }, b = function(d) {
            var e;
            return c(arguments, function(f, h) {
                h > 0 && c(f, function(c, f) {
                    c !== e && (a(d[f]) === a(c) && ~g(a(c), [ "array", "object" ]) ? b(d[f], c) : d[f] = c);
                });
            }), d;
        }, c = function(a, b) {
            var c, d, e, f;
            if (a) {
                try {
                    c = a.length;
                } catch (g) {
                    c = f;
                }
                if (c === f) {
                    for (d in a) if (a.hasOwnProperty(d) && b(a[d], d) === !1) return;
                } else for (e = 0; c > e; e++) if (b(a[e], e) === !1) return;
            }
        }, d = function(b) {
            var c;
            if (!b || "object" !== a(b)) return !0;
            for (c in b) return !1;
            return !0;
        }, e = function(b, c) {
            function d(e) {
                "function" === a(b[e]) && b[e](function(a) {
                    ++e < f && !a ? d(e) : c(a);
                });
            }
            var e = 0, f = b.length;
            "function" !== a(c) && (c = function() {}), b && b.length || c(), d(e);
        }, f = function(a, b) {
            var d = 0, e = a.length, f = new Array(e);
            c(a, function(a, c) {
                a(function(a) {
                    if (a) return b(a);
                    var g = [].slice.call(arguments);
                    g.shift(), f[c] = g, d++, d === e && (f.unshift(null), b.apply(this, f));
                });
            });
        }, g = function(a, b) {
            if (b) {
                if (Array.prototype.indexOf) return Array.prototype.indexOf.call(b, a);
                for (var c = 0, d = b.length; d > c; c++) if (b[c] === a) return c;
            }
            return -1;
        }, h = function(b, c) {
            var d = [];
            "array" !== a(b) && (b = [ b ]), "array" !== a(c) && (c = [ c ]);
            for (var e in b) -1 === g(b[e], c) && d.push(b[e]);
            return d.length ? d : !1;
        }, i = function(a, b) {
            var d = [];
            return c(a, function(a) {
                -1 !== g(a, b) && d.push(a);
            }), d.length ? d : null;
        }, j = function(a) {
            var b, c = [];
            for (b = 0; b < a.length; b++) c[b] = a[b];
            return c;
        }, k = function() {
            var a = 0;
            return function(b) {
                var c, d = new Date().getTime().toString(32);
                for (c = 0; 5 > c; c++) d += Math.floor(65535 * Math.random()).toString(32);
                return (b || "o_") + d + (a++).toString(32);
            };
        }(), l = function(a) {
            return a ? String.prototype.trim ? String.prototype.trim.call(a) : a.toString().replace(/^\s*/, "").replace(/\s*$/, "") : a;
        }, m = function(a) {
            if ("string" != typeof a) return a;
            var b, c = {
                t: 1099511627776,
                g: 1073741824,
                m: 1048576,
                k: 1024
            };
            return a = /^([0-9]+)([mgk]?)$/.exec(a.toLowerCase().replace(/[^0-9mkg]/g, "")), 
            b = a[2], a = +a[1], c.hasOwnProperty(b) && (a *= c[b]), a;
        };
        return {
            guid: k,
            typeOf: a,
            extend: b,
            each: c,
            isEmptyObj: d,
            inSeries: e,
            inParallel: f,
            inArray: g,
            arrayDiff: h,
            arrayIntersect: i,
            toArray: j,
            trim: l,
            parseSizeStr: m
        };
    }), d(i, [ h ], function(a) {
        var b = {};
        return {
            addI18n: function(c) {
                return a.extend(b, c);
            },
            translate: function(a) {
                return b[a] || a;
            },
            _: function(a) {
                return this.translate(a);
            },
            sprintf: function(b) {
                var c = [].slice.call(arguments, 1);
                return b.replace(/%[a-z]/g, function() {
                    var b = c.shift();
                    return "undefined" !== a.typeOf(b) ? b : "";
                });
            }
        };
    }), d(j, [ h, i ], function(a, b) {
        var c = "application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe", d = {
            mimes: {},
            extensions: {},
            addMimeType: function(a) {
                var b, c, d, e = a.split(/,/);
                for (b = 0; b < e.length; b += 2) {
                    for (d = e[b + 1].split(/ /), c = 0; c < d.length; c++) this.mimes[d[c]] = e[b];
                    this.extensions[e[b]] = d;
                }
            },
            extList2mimes: function(b, c) {
                var d, e, f, g, h = this, i = [];
                for (e = 0; e < b.length; e++) for (d = b[e].extensions.split(/\s*,\s*/), f = 0; f < d.length; f++) {
                    if ("*" === d[f]) return [];
                    if (g = h.mimes[d[f]]) -1 === a.inArray(g, i) && i.push(g); else {
                        if (!c || !/^\w+$/.test(d[f])) return [];
                        i.push("." + d[f]);
                    }
                }
                return i;
            },
            mimes2exts: function(b) {
                var c = this, d = [];
                return a.each(b, function(b) {
                    if ("*" === b) return d = [], !1;
                    var e = b.match(/^(\w+)\/(\*|\w+)$/);
                    e && ("*" === e[2] ? a.each(c.extensions, function(a, b) {
                        new RegExp("^" + e[1] + "/").test(b) && [].push.apply(d, c.extensions[b]);
                    }) : c.extensions[b] && [].push.apply(d, c.extensions[b]));
                }), d;
            },
            mimes2extList: function(c) {
                var d = [], e = [];
                return "string" === a.typeOf(c) && (c = a.trim(c).split(/\s*,\s*/)), e = this.mimes2exts(c), 
                d.push({
                    title: b.translate("Files"),
                    extensions: e.length ? e.join(",") : "*"
                }), d.mimes = c, d;
            },
            getFileExtension: function(a) {
                var b = a && a.match(/\.([^.]+)$/);
                return b ? b[1].toLowerCase() : "";
            },
            getFileMime: function(a) {
                return this.mimes[this.getFileExtension(a)] || "";
            }
        };
        return d.addMimeType(c), d;
    }), d(k, [ h ], function(a) {
        function b(a, b, c) {
            var d = 0, e = 0, f = 0, g = {
                dev: -6,
                alpha: -5,
                a: -5,
                beta: -4,
                b: -4,
                RC: -3,
                rc: -3,
                "#": -2,
                p: 1,
                pl: 1
            }, h = function(a) {
                return a = ("" + a).replace(/[_\-+]/g, "."), a = a.replace(/([^.\d]+)/g, ".$1.").replace(/\.{2,}/g, "."), 
                a.length ? a.split(".") : [ -8 ];
            }, i = function(a) {
                return a ? isNaN(a) ? g[a] || -7 : parseInt(a, 10) : 0;
            };
            for (a = h(a), b = h(b), e = Math.max(a.length, b.length), d = 0; e > d; d++) if (a[d] != b[d]) {
                if (a[d] = i(a[d]), b[d] = i(b[d]), a[d] < b[d]) {
                    f = -1;
                    break;
                }
                if (a[d] > b[d]) {
                    f = 1;
                    break;
                }
            }
            if (!c) return f;
            switch (c) {
              case ">":
              case "gt":
                return f > 0;

              case ">=":
              case "ge":
                return f >= 0;

              case "<=":
              case "le":
                return 0 >= f;

              case "==":
              case "=":
              case "eq":
                return 0 === f;

              case "<>":
              case "!=":
              case "ne":
                return 0 !== f;

              case "":
              case "<":
              case "lt":
                return 0 > f;

              default:
                return null;
            }
        }
        var c = function(a) {
            var b = "", c = "?", d = "function", e = "undefined", f = "object", g = "major", h = "name", i = "version", j = {
                has: function(a, b) {
                    return -1 !== b.toLowerCase().indexOf(a.toLowerCase());
                },
                lowerize: function(a) {
                    return a.toLowerCase();
                }
            }, k = {
                rgx: function() {
                    for (var b, c, g, h, i, j, k, l = 0, m = arguments; l < m.length; l += 2) {
                        var n = m[l], o = m[l + 1];
                        if (typeof b === e) {
                            b = {};
                            for (h in o) i = o[h], typeof i === f ? b[i[0]] = a : b[i] = a;
                        }
                        for (c = g = 0; c < n.length; c++) if (j = n[c].exec(this.getUA())) {
                            for (h = 0; h < o.length; h++) k = j[++g], i = o[h], typeof i === f && i.length > 0 ? 2 == i.length ? b[i[0]] = typeof i[1] == d ? i[1].call(this, k) : i[1] : 3 == i.length ? b[i[0]] = typeof i[1] !== d || i[1].exec && i[1].test ? k ? k.replace(i[1], i[2]) : a : k ? i[1].call(this, k, i[2]) : a : 4 == i.length && (b[i[0]] = k ? i[3].call(this, k.replace(i[1], i[2])) : a) : b[i] = k ? k : a;
                            break;
                        }
                        if (j) break;
                    }
                    return b;
                },
                str: function(b, d) {
                    for (var e in d) if (typeof d[e] === f && d[e].length > 0) {
                        for (var g = 0; g < d[e].length; g++) if (j.has(d[e][g], b)) return e === c ? a : e;
                    } else if (j.has(d[e], b)) return e === c ? a : e;
                    return b;
                }
            }, l = {
                browser: {
                    oldsafari: {
                        major: {
                            1: [ "/8", "/1", "/3" ],
                            2: "/4",
                            "?": "/"
                        },
                        version: {
                            "1.0": "/8",
                            1.2: "/1",
                            1.3: "/3",
                            "2.0": "/412",
                            "2.0.2": "/416",
                            "2.0.3": "/417",
                            "2.0.4": "/419",
                            "?": "/"
                        }
                    }
                },
                device: {
                    sprint: {
                        model: {
                            "Evo Shift 4G": "7373KT"
                        },
                        vendor: {
                            HTC: "APA",
                            Sprint: "Sprint"
                        }
                    }
                },
                os: {
                    windows: {
                        version: {
                            ME: "4.90",
                            "NT 3.11": "NT3.51",
                            "NT 4.0": "NT4.0",
                            2e3: "NT 5.0",
                            XP: [ "NT 5.1", "NT 5.2" ],
                            Vista: "NT 6.0",
                            7: "NT 6.1",
                            8: "NT 6.2",
                            8.1: "NT 6.3",
                            RT: "ARM"
                        }
                    }
                }
            }, m = {
                browser: [ [ /(opera\smini)\/((\d+)?[\w\.-]+)/i, /(opera\s[mobiletab]+).+version\/((\d+)?[\w\.-]+)/i, /(opera).+version\/((\d+)?[\w\.]+)/i, /(opera)[\/\s]+((\d+)?[\w\.]+)/i ], [ h, i, g ], [ /\s(opr)\/((\d+)?[\w\.]+)/i ], [ [ h, "Opera" ], i, g ], [ /(kindle)\/((\d+)?[\w\.]+)/i, /(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?((\d+)?[\w\.]+)*/i, /(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?((\d+)?[\w\.]*)/i, /(?:ms|\()(ie)\s((\d+)?[\w\.]+)/i, /(rekonq)((?:\/)[\w\.]+)*/i, /(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron)\/((\d+)?[\w\.-]+)/i ], [ h, i, g ], [ /(trident).+rv[:\s]((\d+)?[\w\.]+).+like\sgecko/i ], [ [ h, "IE" ], i, g ], [ /(yabrowser)\/((\d+)?[\w\.]+)/i ], [ [ h, "Yandex" ], i, g ], [ /(comodo_dragon)\/((\d+)?[\w\.]+)/i ], [ [ h, /_/g, " " ], i, g ], [ /(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?((\d+)?[\w\.]+)/i ], [ h, i, g ], [ /(dolfin)\/((\d+)?[\w\.]+)/i ], [ [ h, "Dolphin" ], i, g ], [ /((?:android.+)crmo|crios)\/((\d+)?[\w\.]+)/i ], [ [ h, "Chrome" ], i, g ], [ /((?:android.+))version\/((\d+)?[\w\.]+)\smobile\ssafari/i ], [ [ h, "Android Browser" ], i, g ], [ /version\/((\d+)?[\w\.]+).+?mobile\/\w+\s(safari)/i ], [ i, g, [ h, "Mobile Safari" ] ], [ /version\/((\d+)?[\w\.]+).+?(mobile\s?safari|safari)/i ], [ i, g, h ], [ /webkit.+?(mobile\s?safari|safari)((\/[\w\.]+))/i ], [ h, [ g, k.str, l.browser.oldsafari.major ], [ i, k.str, l.browser.oldsafari.version ] ], [ /(konqueror)\/((\d+)?[\w\.]+)/i, /(webkit|khtml)\/((\d+)?[\w\.]+)/i ], [ h, i, g ], [ /(navigator|netscape)\/((\d+)?[\w\.-]+)/i ], [ [ h, "Netscape" ], i, g ], [ /(swiftfox)/i, /(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?((\d+)?[\w\.\+]+)/i, /(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/((\d+)?[\w\.-]+)/i, /(mozilla)\/((\d+)?[\w\.]+).+rv\:.+gecko\/\d+/i, /(uc\s?browser|polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|qqbrowser)[\/\s]?((\d+)?[\w\.]+)/i, /(links)\s\(((\d+)?[\w\.]+)/i, /(gobrowser)\/?((\d+)?[\w\.]+)*/i, /(ice\s?browser)\/v?((\d+)?[\w\._]+)/i, /(mosaic)[\/\s]((\d+)?[\w\.]+)/i ], [ h, i, g ] ],
                engine: [ [ /(presto)\/([\w\.]+)/i, /(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i, /(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i, /(icab)[\/\s]([23]\.[\d\.]+)/i ], [ h, i ], [ /rv\:([\w\.]+).*(gecko)/i ], [ i, h ] ],
                os: [ [ /(windows)\snt\s6\.2;\s(arm)/i, /(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i ], [ h, [ i, k.str, l.os.windows.version ] ], [ /(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i ], [ [ h, "Windows" ], [ i, k.str, l.os.windows.version ] ], [ /\((bb)(10);/i ], [ [ h, "BlackBerry" ], i ], [ /(blackberry)\w*\/?([\w\.]+)*/i, /(tizen)\/([\w\.]+)/i, /(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego)[\/\s-]?([\w\.]+)*/i ], [ h, i ], [ /(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i ], [ [ h, "Symbian" ], i ], [ /mozilla.+\(mobile;.+gecko.+firefox/i ], [ [ h, "Firefox OS" ], i ], [ /(nintendo|playstation)\s([wids3portablevu]+)/i, /(mint)[\/\s\(]?(\w+)*/i, /(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)[\/\s-]?([\w\.-]+)*/i, /(hurd|linux)\s?([\w\.]+)*/i, /(gnu)\s?([\w\.]+)*/i ], [ h, i ], [ /(cros)\s[\w]+\s([\w\.]+\w)/i ], [ [ h, "Chromium OS" ], i ], [ /(sunos)\s?([\w\.]+\d)*/i ], [ [ h, "Solaris" ], i ], [ /\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i ], [ h, i ], [ /(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i ], [ [ h, "iOS" ], [ i, /_/g, "." ] ], [ /(mac\sos\sx)\s?([\w\s\.]+\w)*/i ], [ h, [ i, /_/g, "." ] ], [ /(haiku)\s(\w+)/i, /(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i, /(macintosh|mac(?=_powerpc)|plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos)/i, /(unix)\s?([\w\.]+)*/i ], [ h, i ] ]
            }, n = function(a) {
                var c = a || (window && window.navigator && window.navigator.userAgent ? window.navigator.userAgent : b);
                this.getBrowser = function() {
                    return k.rgx.apply(this, m.browser);
                }, this.getEngine = function() {
                    return k.rgx.apply(this, m.engine);
                }, this.getOS = function() {
                    return k.rgx.apply(this, m.os);
                }, this.getResult = function() {
                    return {
                        ua: this.getUA(),
                        browser: this.getBrowser(),
                        engine: this.getEngine(),
                        os: this.getOS()
                    };
                }, this.getUA = function() {
                    return c;
                }, this.setUA = function(a) {
                    return c = a, this;
                }, this.setUA(c);
            };
            return new n().getResult();
        }(), d = function() {
            var b = {
                define_property: function() {
                    return !1;
                }(),
                create_canvas: function() {
                    var a = document.createElement("canvas");
                    return !(!a.getContext || !a.getContext("2d"));
                }(),
                return_response_type: function(b) {
                    try {
                        if (-1 !== a.inArray(b, [ "", "text", "document" ])) return !0;
                        if (window.XMLHttpRequest) {
                            var c = new XMLHttpRequest();
                            if (c.open("get", "/"), "responseType" in c) return c.responseType = b, c.responseType !== b ? !1 : !0;
                        }
                    } catch (d) {}
                    return !1;
                },
                use_data_uri: function() {
                    var a = new Image();
                    return a.onload = function() {
                        b.use_data_uri = 1 === a.width && 1 === a.height;
                    }, setTimeout(function() {
                        a.src = "data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==";
                    }, 1), !1;
                }(),
                use_data_uri_over32kb: function() {
                    return b.use_data_uri && ("IE" !== e.browser || e.version >= 9);
                },
                use_data_uri_of: function(a) {
                    return b.use_data_uri && 33e3 > a || b.use_data_uri_over32kb();
                },
                use_fileinput: function() {
                    var a = document.createElement("input");
                    return a.setAttribute("type", "file"), !a.disabled;
                }
            };
            return function(c) {
                var d = [].slice.call(arguments);
                return d.shift(), "function" === a.typeOf(b[c]) ? b[c].apply(this, d) : !!b[c];
            };
        }(), e = {
            can: d,
            browser: c.browser.name,
            version: parseFloat(c.browser.major),
            os: c.os.name,
            osVersion: c.os.version,
            verComp: b,
            swf_url: "../flash/Moxie.swf",
            xap_url: "../silverlight/Moxie.xap",
            global_event_dispatcher: "moxie.core.EventTarget.instance.dispatchEvent"
        };
        return e.OS = e.os, e;
    }), d(l, [ k ], function(a) {
        var b = function(a) {
            return "string" != typeof a ? a : document.getElementById(a);
        }, c = function(a, b) {
            if (!a.className) return !1;
            var c = new RegExp("(^|\\s+)" + b + "(\\s+|$)");
            return c.test(a.className);
        }, d = function(a, b) {
            c(a, b) || (a.className = a.className ? a.className.replace(/\s+$/, "") + " " + b : b);
        }, e = function(a, b) {
            if (a.className) {
                var c = new RegExp("(^|\\s+)" + b + "(\\s+|$)");
                a.className = a.className.replace(c, function(a, b, c) {
                    return " " === b && " " === c ? " " : "";
                });
            }
        }, f = function(a, b) {
            return a.currentStyle ? a.currentStyle[b] : window.getComputedStyle ? window.getComputedStyle(a, null)[b] : void 0;
        }, g = function(b, c) {
            function d(a) {
                var b, c, d = 0, e = 0;
                return a && (c = a.getBoundingClientRect(), b = "CSS1Compat" === j.compatMode ? j.documentElement : j.body, 
                d = c.left + b.scrollLeft, e = c.top + b.scrollTop), {
                    x: d,
                    y: e
                };
            }
            var e, f, g, h = 0, i = 0, j = document;
            if (b = b, c = c || j.body, b && b.getBoundingClientRect && "IE" === a.browser && (!j.documentMode || j.documentMode < 8)) return f = d(b), 
            g = d(c), {
                x: f.x - g.x,
                y: f.y - g.y
            };
            for (e = b; e && e != c && e.nodeType; ) h += e.offsetLeft || 0, i += e.offsetTop || 0, 
            e = e.offsetParent;
            for (e = b.parentNode; e && e != c && e.nodeType; ) h -= e.scrollLeft || 0, i -= e.scrollTop || 0, 
            e = e.parentNode;
            return {
                x: h,
                y: i
            };
        }, h = function(a) {
            return {
                w: a.offsetWidth || a.clientWidth,
                h: a.offsetHeight || a.clientHeight
            };
        };
        return {
            get: b,
            hasClass: c,
            addClass: d,
            removeClass: e,
            getStyle: f,
            getPos: g,
            getSize: h
        };
    }), d(m, [ h ], function(a) {
        function b(a, b) {
            var c;
            for (c in a) if (a[c] === b) return c;
            return null;
        }
        return {
            RuntimeError: function() {
                function c(a) {
                    this.code = a, this.name = b(d, a), this.message = this.name + ": RuntimeError " + this.code;
                }
                var d = {
                    NOT_INIT_ERR: 1,
                    NOT_SUPPORTED_ERR: 9,
                    JS_ERR: 4
                };
                return a.extend(c, d), c.prototype = Error.prototype, c;
            }(),
            OperationNotAllowedException: function() {
                function b(a) {
                    this.code = a, this.name = "OperationNotAllowedException";
                }
                return a.extend(b, {
                    NOT_ALLOWED_ERR: 1
                }), b.prototype = Error.prototype, b;
            }(),
            ImageError: function() {
                function c(a) {
                    this.code = a, this.name = b(d, a), this.message = this.name + ": ImageError " + this.code;
                }
                var d = {
                    WRONG_FORMAT: 1,
                    MAX_RESOLUTION_ERR: 2
                };
                return a.extend(c, d), c.prototype = Error.prototype, c;
            }(),
            FileException: function() {
                function c(a) {
                    this.code = a, this.name = b(d, a), this.message = this.name + ": FileException " + this.code;
                }
                var d = {
                    NOT_FOUND_ERR: 1,
                    SECURITY_ERR: 2,
                    ABORT_ERR: 3,
                    NOT_READABLE_ERR: 4,
                    ENCODING_ERR: 5,
                    NO_MODIFICATION_ALLOWED_ERR: 6,
                    INVALID_STATE_ERR: 7,
                    SYNTAX_ERR: 8
                };
                return a.extend(c, d), c.prototype = Error.prototype, c;
            }(),
            DOMException: function() {
                function c(a) {
                    this.code = a, this.name = b(d, a), this.message = this.name + ": DOMException " + this.code;
                }
                var d = {
                    INDEX_SIZE_ERR: 1,
                    DOMSTRING_SIZE_ERR: 2,
                    HIERARCHY_REQUEST_ERR: 3,
                    WRONG_DOCUMENT_ERR: 4,
                    INVALID_CHARACTER_ERR: 5,
                    NO_DATA_ALLOWED_ERR: 6,
                    NO_MODIFICATION_ALLOWED_ERR: 7,
                    NOT_FOUND_ERR: 8,
                    NOT_SUPPORTED_ERR: 9,
                    INUSE_ATTRIBUTE_ERR: 10,
                    INVALID_STATE_ERR: 11,
                    SYNTAX_ERR: 12,
                    INVALID_MODIFICATION_ERR: 13,
                    NAMESPACE_ERR: 14,
                    INVALID_ACCESS_ERR: 15,
                    VALIDATION_ERR: 16,
                    TYPE_MISMATCH_ERR: 17,
                    SECURITY_ERR: 18,
                    NETWORK_ERR: 19,
                    ABORT_ERR: 20,
                    URL_MISMATCH_ERR: 21,
                    QUOTA_EXCEEDED_ERR: 22,
                    TIMEOUT_ERR: 23,
                    INVALID_NODE_TYPE_ERR: 24,
                    DATA_CLONE_ERR: 25
                };
                return a.extend(c, d), c.prototype = Error.prototype, c;
            }(),
            EventException: function() {
                function b(a) {
                    this.code = a, this.name = "EventException";
                }
                return a.extend(b, {
                    UNSPECIFIED_EVENT_TYPE_ERR: 0
                }), b.prototype = Error.prototype, b;
            }()
        };
    }), d(n, [ m, h ], function(a, b) {
        function c() {
            var c = {};
            b.extend(this, {
                uid: null,
                init: function() {
                    this.uid || (this.uid = b.guid("uid_"));
                },
                addEventListener: function(a, d, e, f) {
                    var g, h = this;
                    return a = b.trim(a), /\s/.test(a) ? void b.each(a.split(/\s+/), function(a) {
                        h.addEventListener(a, d, e, f);
                    }) : (a = a.toLowerCase(), e = parseInt(e, 10) || 0, g = c[this.uid] && c[this.uid][a] || [], 
                    g.push({
                        fn: d,
                        priority: e,
                        scope: f || this
                    }), c[this.uid] || (c[this.uid] = {}), void (c[this.uid][a] = g));
                },
                hasEventListener: function(a) {
                    return a ? !(!c[this.uid] || !c[this.uid][a]) : !!c[this.uid];
                },
                removeEventListener: function(a, d) {
                    a = a.toLowerCase();
                    var e, f = c[this.uid] && c[this.uid][a];
                    if (f) {
                        if (d) {
                            for (e = f.length - 1; e >= 0; e--) if (f[e].fn === d) {
                                f.splice(e, 1);
                                break;
                            }
                        } else f = [];
                        f.length || (delete c[this.uid][a], b.isEmptyObj(c[this.uid]) && delete c[this.uid]);
                    }
                },
                removeAllEventListeners: function() {
                    c[this.uid] && delete c[this.uid];
                },
                dispatchEvent: function(d) {
                    var e, f, g, h, i, j = {}, k = !0;
                    if ("string" !== b.typeOf(d)) {
                        if (h = d, "string" !== b.typeOf(h.type)) throw new a.EventException(a.EventException.UNSPECIFIED_EVENT_TYPE_ERR);
                        d = h.type, h.total !== i && h.loaded !== i && (j.total = h.total, j.loaded = h.loaded), 
                        j.async = h.async || !1;
                    }
                    if (-1 !== d.indexOf("::") ? function(a) {
                        e = a[0], d = a[1];
                    }(d.split("::")) : e = this.uid, d = d.toLowerCase(), f = c[e] && c[e][d]) {
                        f.sort(function(a, b) {
                            return b.priority - a.priority;
                        }), g = [].slice.call(arguments), g.shift(), j.type = d, g.unshift(j);
                        var l = [];
                        b.each(f, function(a) {
                            g[0].target = a.scope, l.push(j.async ? function(b) {
                                setTimeout(function() {
                                    b(a.fn.apply(a.scope, g) === !1);
                                }, 1);
                            } : function(b) {
                                b(a.fn.apply(a.scope, g) === !1);
                            });
                        }), l.length && b.inSeries(l, function(a) {
                            k = !a;
                        });
                    }
                    return k;
                },
                bind: function() {
                    this.addEventListener.apply(this, arguments);
                },
                unbind: function() {
                    this.removeEventListener.apply(this, arguments);
                },
                unbindAll: function() {
                    this.removeAllEventListeners.apply(this, arguments);
                },
                trigger: function() {
                    return this.dispatchEvent.apply(this, arguments);
                },
                convertEventPropsToHandlers: function(a) {
                    var c;
                    "array" !== b.typeOf(a) && (a = [ a ]);
                    for (var d = 0; d < a.length; d++) c = "on" + a[d], "function" === b.typeOf(this[c]) ? this.addEventListener(a[d], this[c]) : "undefined" === b.typeOf(this[c]) && (this[c] = null);
                }
            });
        }
        return c.instance = new c(), c;
    }), d(o, [], function() {
        var a = function(a) {
            return unescape(encodeURIComponent(a));
        }, b = function(a) {
            return decodeURIComponent(escape(a));
        }, c = function(a, c) {
            if ("function" == typeof window.atob) return c ? b(window.atob(a)) : window.atob(a);
            var d, e, f, g, h, i, j, k, l = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=", m = 0, n = 0, o = "", p = [];
            if (!a) return a;
            a += "";
            do g = l.indexOf(a.charAt(m++)), h = l.indexOf(a.charAt(m++)), i = l.indexOf(a.charAt(m++)), 
            j = l.indexOf(a.charAt(m++)), k = g << 18 | h << 12 | i << 6 | j, d = 255 & k >> 16, 
            e = 255 & k >> 8, f = 255 & k, p[n++] = 64 == i ? String.fromCharCode(d) : 64 == j ? String.fromCharCode(d, e) : String.fromCharCode(d, e, f); while (m < a.length);
            return o = p.join(""), c ? b(o) : o;
        }, d = function(b, c) {
            if (c && a(b), "function" == typeof window.btoa) return window.btoa(b);
            var d, e, f, g, h, i, j, k, l = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=", m = 0, n = 0, o = "", p = [];
            if (!b) return b;
            do d = b.charCodeAt(m++), e = b.charCodeAt(m++), f = b.charCodeAt(m++), k = d << 16 | e << 8 | f, 
            g = 63 & k >> 18, h = 63 & k >> 12, i = 63 & k >> 6, j = 63 & k, p[n++] = l.charAt(g) + l.charAt(h) + l.charAt(i) + l.charAt(j); while (m < b.length);
            o = p.join("");
            var q = b.length % 3;
            return (q ? o.slice(0, q - 3) : o) + "===".slice(q || 3);
        };
        return {
            utf8_encode: a,
            utf8_decode: b,
            atob: c,
            btoa: d
        };
    }), d(p, [ h, l, n ], function(a, b, c) {
        function d(c, e, g, h, i) {
            var j, k = this, l = a.guid(e + "_"), m = i || "browser";
            c = c || {}, f[l] = this, g = a.extend({
                access_binary: !1,
                access_image_binary: !1,
                display_media: !1,
                do_cors: !1,
                drag_and_drop: !1,
                filter_by_extension: !0,
                resize_image: !1,
                report_upload_progress: !1,
                return_response_headers: !1,
                return_response_type: !1,
                return_status_code: !0,
                send_custom_headers: !1,
                select_file: !1,
                select_folder: !1,
                select_multiple: !0,
                send_binary_string: !1,
                send_browser_cookies: !0,
                send_multipart: !0,
                slice_blob: !1,
                stream_upload: !1,
                summon_file_dialog: !1,
                upload_filesize: !0,
                use_http_method: !0
            }, g), c.preferred_caps && (m = d.getMode(h, c.preferred_caps, m)), j = function() {
                var b = {};
                return {
                    exec: function(a, c, d, e) {
                        return j[c] && (b[a] || (b[a] = {
                            context: this,
                            instance: new j[c]()
                        }), b[a].instance[d]) ? b[a].instance[d].apply(this, e) : void 0;
                    },
                    removeInstance: function(a) {
                        delete b[a];
                    },
                    removeAllInstances: function() {
                        var c = this;
                        a.each(b, function(b, d) {
                            "function" === a.typeOf(b.instance.destroy) && b.instance.destroy.call(b.context), 
                            c.removeInstance(d);
                        });
                    }
                };
            }(), a.extend(this, {
                initialized: !1,
                uid: l,
                type: e,
                mode: d.getMode(h, c.required_caps, m),
                shimid: l + "_container",
                clients: 0,
                options: c,
                can: function(b, c) {
                    var e = arguments[2] || g;
                    if ("string" === a.typeOf(b) && "undefined" === a.typeOf(c) && (b = d.parseCaps(b)), 
                    "object" === a.typeOf(b)) {
                        for (var f in b) if (!this.can(f, b[f], e)) return !1;
                        return !0;
                    }
                    return "function" === a.typeOf(e[b]) ? e[b].call(this, c) : c === e[b];
                },
                getShimContainer: function() {
                    var c, d = b.get(this.shimid);
                    return d || (c = this.options.container ? b.get(this.options.container) : document.body, 
                    d = document.createElement("div"), d.id = this.shimid, d.className = "moxie-shim moxie-shim-" + this.type, 
                    a.extend(d.style, {
                        position: "absolute",
                        top: "0px",
                        left: "0px",
                        width: "1px",
                        height: "1px",
                        overflow: "hidden"
                    }), c.appendChild(d), c = null), d;
                },
                getShim: function() {
                    return j;
                },
                shimExec: function(a, b) {
                    var c = [].slice.call(arguments, 2);
                    return k.getShim().exec.call(this, this.uid, a, b, c);
                },
                exec: function(a, b) {
                    var c = [].slice.call(arguments, 2);
                    return k[a] && k[a][b] ? k[a][b].apply(this, c) : k.shimExec.apply(this, arguments);
                },
                destroy: function() {
                    if (k) {
                        var a = b.get(this.shimid);
                        a && a.parentNode.removeChild(a), j && j.removeAllInstances(), this.unbindAll(), 
                        delete f[this.uid], this.uid = null, l = k = j = a = null;
                    }
                }
            }), this.mode && c.required_caps && !this.can(c.required_caps) && (this.mode = !1);
        }
        var e = {}, f = {};
        return d.order = "html5,flash,silverlight,html4", d.getRuntime = function(a) {
            return f[a] ? f[a] : !1;
        }, d.addConstructor = function(a, b) {
            b.prototype = c.instance, e[a] = b;
        }, d.getConstructor = function(a) {
            return e[a] || null;
        }, d.getInfo = function(a) {
            var b = d.getRuntime(a);
            return b ? {
                uid: b.uid,
                type: b.type,
                mode: b.mode,
                can: function() {
                    return b.can.apply(b, arguments);
                }
            } : null;
        }, d.parseCaps = function(b) {
            var c = {};
            return "string" !== a.typeOf(b) ? b || {} : (a.each(b.split(","), function(a) {
                c[a] = !0;
            }), c);
        }, d.can = function(a, b) {
            var c, e, f = d.getConstructor(a);
            return f ? (c = new f({
                required_caps: b
            }), e = c.mode, c.destroy(), !!e) : !1;
        }, d.thatCan = function(a, b) {
            var c = (b || d.order).split(/\s*,\s*/);
            for (var e in c) if (d.can(c[e], a)) return c[e];
            return null;
        }, d.getMode = function(b, c, d) {
            var e = null;
            if ("undefined" === a.typeOf(d) && (d = "browser"), c && !a.isEmptyObj(b)) {
                if (a.each(c, function(c, d) {
                    if (b.hasOwnProperty(d)) {
                        var f = b[d](c);
                        if ("string" == typeof f && (f = [ f ]), e) {
                            if (!(e = a.arrayIntersect(e, f))) return e = !1;
                        } else e = f;
                    }
                }), e) return -1 !== a.inArray(d, e) ? d : e[0];
                if (e === !1) return !1;
            }
            return d;
        }, d.capTrue = function() {
            return !0;
        }, d.capFalse = function() {
            return !1;
        }, d.capTest = function(a) {
            return function() {
                return !!a;
            };
        }, d;
    }), d(q, [ m, h, p ], function(a, b, c) {
        return function d() {
            var d;
            b.extend(this, {
                connectRuntime: function(e) {
                    function f(b) {
                        var g, i;
                        return b.length ? (g = b.shift(), (i = c.getConstructor(g)) ? (d = new i(e), d.bind("Init", function() {
                            d.initialized = !0, setTimeout(function() {
                                d.clients++, h.trigger("RuntimeInit", d);
                            }, 1);
                        }), d.bind("Error", function() {
                            d.destroy(), f(b);
                        }), d.mode ? void d.init() : void d.trigger("Error")) : void f(b)) : (h.trigger("RuntimeError", new a.RuntimeError(a.RuntimeError.NOT_INIT_ERR)), 
                        void (d = null));
                    }
                    var g, h = this;
                    if ("string" === b.typeOf(e) ? g = e : "string" === b.typeOf(e.ruid) && (g = e.ruid), 
                    g) {
                        if (d = c.getRuntime(g)) return d.clients++, d;
                        throw new a.RuntimeError(a.RuntimeError.NOT_INIT_ERR);
                    }
                    f((e.runtime_order || c.order).split(/\s*,\s*/));
                },
                getRuntime: function() {
                    return d && d.uid ? d : (d = null, null);
                },
                disconnectRuntime: function() {
                    d && --d.clients <= 0 && (d.destroy(), d = null);
                }
            });
        };
    }), d(r, [ h, o, q ], function(a, b, c) {
        function d(f, g) {
            function h(b, c, f) {
                var g, h = e[this.uid];
                return "string" === a.typeOf(h) && h.length ? (g = new d(null, {
                    type: f,
                    size: c - b
                }), g.detach(h.substr(b, g.size)), g) : null;
            }
            c.call(this), f && this.connectRuntime(f), g ? "string" === a.typeOf(g) && (g = {
                data: g
            }) : g = {}, a.extend(this, {
                uid: g.uid || a.guid("uid_"),
                ruid: f,
                size: g.size || 0,
                type: g.type || "",
                slice: function(a, b, c) {
                    return this.isDetached() ? h.apply(this, arguments) : this.getRuntime().exec.call(this, "Blob", "slice", this.getSource(), a, b, c);
                },
                getSource: function() {
                    return e[this.uid] ? e[this.uid] : null;
                },
                detach: function(a) {
                    this.ruid && (this.getRuntime().exec.call(this, "Blob", "destroy", e[this.uid]), 
                    this.disconnectRuntime(), this.ruid = null), a = a || "";
                    var c = a.match(/^data:([^;]*);base64,/);
                    c && (this.type = c[1], a = b.atob(a.substring(a.indexOf("base64,") + 7))), this.size = a.length, 
                    e[this.uid] = a;
                },
                isDetached: function() {
                    return !this.ruid && "string" === a.typeOf(e[this.uid]);
                },
                destroy: function() {
                    this.detach(), delete e[this.uid];
                }
            }), g.data ? this.detach(g.data) : e[this.uid] = g;
        }
        var e = {};
        return d;
    }), d(s, [ h, j, r ], function(a, b, c) {
        function d(d, e) {
            var f, g;
            if (e || (e = {}), g = e.type && "" !== e.type ? e.type : b.getFileMime(e.name), 
            e.name) f = e.name.replace(/\\/g, "/"), f = f.substr(f.lastIndexOf("/") + 1); else {
                var h = g.split("/")[0];
                f = a.guid(("" !== h ? h : "file") + "_"), b.extensions[g] && (f += "." + b.extensions[g][0]);
            }
            c.apply(this, arguments), a.extend(this, {
                type: g || "",
                name: f || a.guid("file_"),
                lastModifiedDate: e.lastModifiedDate || new Date().toLocaleString()
            });
        }
        return d.prototype = c.prototype, d;
    }), d(t, [ h, j, l, m, n, i, s, p, q ], function(a, b, c, d, e, f, g, h, i) {
        function j(e) {
            var j, l, m, n = this;
            if (-1 !== a.inArray(a.typeOf(e), [ "string", "node" ]) && (e = {
                browse_button: e
            }), l = c.get(e.browse_button), !l) throw new d.DOMException(d.DOMException.NOT_FOUND_ERR);
            m = {
                accept: [ {
                    title: f.translate("All Files"),
                    extensions: "*"
                } ],
                name: "file",
                multiple: !1,
                required_caps: !1,
                container: l.parentNode || document.body
            }, e = a.extend({}, m, e), "string" == typeof e.required_caps && (e.required_caps = h.parseCaps(e.required_caps)), 
            "string" == typeof e.accept && (e.accept = b.mimes2extList(e.accept)), j = c.get(e.container), 
            j || (j = document.body), "static" === c.getStyle(j, "position") && (j.style.position = "relative"), 
            j = l = null, i.call(n), a.extend(n, {
                uid: a.guid("uid_"),
                ruid: null,
                shimid: null,
                files: null,
                init: function() {
                    n.convertEventPropsToHandlers(k), n.bind("RuntimeInit", function(b, d) {
                        n.ruid = d.uid, n.shimid = d.shimid, n.bind("Ready", function() {
                            n.trigger("Refresh");
                        }, 999), n.bind("Change", function() {
                            var b = d.exec.call(n, "FileInput", "getFiles");
                            n.files = [], a.each(b, function(a) {
                                return 0 === a.size ? !0 : void n.files.push(new g(n.ruid, a));
                            });
                        }, 999), n.bind("Refresh", function() {
                            var b, f, g, h;
                            g = c.get(e.browse_button), h = c.get(d.shimid), g && (b = c.getPos(g, c.get(e.container)), 
                            f = c.getSize(g), h && a.extend(h.style, {
                                top: b.y + "px",
                                left: b.x + "px",
                                width: f.w + "px",
                                height: f.h + "px"
                            })), h = g = null;
                        }), d.exec.call(n, "FileInput", "init", e);
                    }), n.connectRuntime(a.extend({}, e, {
                        required_caps: {
                            select_file: !0
                        }
                    }));
                },
                disable: function(b) {
                    var c = this.getRuntime();
                    c && c.exec.call(this, "FileInput", "disable", "undefined" === a.typeOf(b) ? !0 : b);
                },
                refresh: function() {
                    n.trigger("Refresh");
                },
                destroy: function() {
                    var b = this.getRuntime();
                    b && (b.exec.call(this, "FileInput", "destroy"), this.disconnectRuntime()), "array" === a.typeOf(this.files) && a.each(this.files, function(a) {
                        a.destroy();
                    }), this.files = null;
                }
            });
        }
        var k = [ "ready", "change", "cancel", "mouseenter", "mouseleave", "mousedown", "mouseup" ];
        return j.prototype = e.instance, j;
    }), d(u, [ i, l, m, h, s, q, n, j ], function(a, b, c, d, e, f, g, h) {
        function i(c) {
            var g, i = this;
            "string" == typeof c && (c = {
                drop_zone: c
            }), g = {
                accept: [ {
                    title: a.translate("All Files"),
                    extensions: "*"
                } ],
                required_caps: {
                    drag_and_drop: !0
                }
            }, c = "object" == typeof c ? d.extend({}, g, c) : g, c.container = b.get(c.drop_zone) || document.body, 
            "static" === b.getStyle(c.container, "position") && (c.container.style.position = "relative"), 
            "string" == typeof c.accept && (c.accept = h.mimes2extList(c.accept)), f.call(i), 
            d.extend(i, {
                uid: d.guid("uid_"),
                ruid: null,
                files: null,
                init: function() {
                    i.convertEventPropsToHandlers(j), i.bind("RuntimeInit", function(a, b) {
                        i.ruid = b.uid, i.bind("Drop", function() {
                            var a = b.exec.call(i, "FileDrop", "getFiles");
                            i.files = [], d.each(a, function(a) {
                                i.files.push(new e(i.ruid, a));
                            });
                        }, 999), b.exec.call(i, "FileDrop", "init", c), i.dispatchEvent("ready");
                    }), i.connectRuntime(c);
                },
                destroy: function() {
                    var a = this.getRuntime();
                    a && (a.exec.call(this, "FileDrop", "destroy"), this.disconnectRuntime()), this.files = null;
                }
            });
        }
        var j = [ "ready", "dragenter", "dragleave", "drop", "error" ];
        return i.prototype = g.instance, i;
    }), d(v, [ h, q, n ], function(a, b, c) {
        function d() {
            this.uid = a.guid("uid_"), b.call(this), this.destroy = function() {
                this.disconnectRuntime(), this.unbindAll();
            };
        }
        return d.prototype = c.instance, d;
    }), d(w, [ h, o, m, n, r, s, v ], function(a, b, c, d, e, f, g) {
        function h() {
            function d(a, d) {
                function k(a) {
                    j.readyState = h.DONE, j.error = a, j.trigger("error"), l();
                }
                function l() {
                    f.destroy(), f = null, j.trigger("loadend");
                }
                function m(b) {
                    f.bind("Error", function(a, b) {
                        k(b);
                    }), f.bind("Progress", function(a) {
                        j.result = b.exec.call(f, "FileReader", "getResult"), j.trigger(a);
                    }), f.bind("Load", function(a) {
                        j.readyState = h.DONE, j.result = b.exec.call(f, "FileReader", "getResult"), j.trigger(a), 
                        l();
                    }), b.exec.call(f, "FileReader", "read", a, d);
                }
                if (f = new g(), this.convertEventPropsToHandlers(i), this.readyState === h.LOADING) return k(new c.DOMException(c.DOMException.INVALID_STATE_ERR));
                if (this.readyState = h.LOADING, this.trigger("loadstart"), d instanceof e) if (d.isDetached()) {
                    var n = d.getSource();
                    switch (a) {
                      case "readAsText":
                      case "readAsBinaryString":
                        this.result = n;
                        break;

                      case "readAsDataURL":
                        this.result = "data:" + d.type + ";base64," + b.btoa(n);
                    }
                    this.readyState = h.DONE, this.trigger("load"), l();
                } else m(f.connectRuntime(d.ruid)); else k(new c.DOMException(c.DOMException.NOT_FOUND_ERR));
            }
            var f, j = this;
            a.extend(this, {
                uid: a.guid("uid_"),
                readyState: h.EMPTY,
                result: null,
                error: null,
                readAsBinaryString: function(a) {
                    d.call(this, "readAsBinaryString", a);
                },
                readAsDataURL: function(a) {
                    d.call(this, "readAsDataURL", a);
                },
                readAsText: function(a) {
                    d.call(this, "readAsText", a);
                },
                abort: function() {
                    this.result = null, -1 === a.inArray(this.readyState, [ h.EMPTY, h.DONE ]) && (this.readyState === h.LOADING && (this.readyState = h.DONE), 
                    f && f.getRuntime().exec.call(this, "FileReader", "abort"), this.trigger("abort"), 
                    this.trigger("loadend"));
                },
                destroy: function() {
                    this.abort(), f && (f.getRuntime().exec.call(this, "FileReader", "destroy"), f.disconnectRuntime()), 
                    j = f = null;
                }
            });
        }
        var i = [ "loadstart", "progress", "load", "abort", "error", "loadend" ];
        return h.EMPTY = 0, h.LOADING = 1, h.DONE = 2, h.prototype = d.instance, h;
    }), d(x, [], function() {
        var a = function(b, c) {
            for (var d = [ "source", "scheme", "authority", "userInfo", "user", "pass", "host", "port", "relative", "path", "directory", "file", "query", "fragment" ], e = d.length, f = {
                http: 80,
                https: 443
            }, g = {}, h = /^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/, i = h.exec(b || ""); e--; ) i[e] && (g[d[e]] = i[e]);
            if (!g.scheme) {
                c && "string" != typeof c || (c = a(c || document.location.href)), g.scheme = c.scheme, 
                g.host = c.host, g.port = c.port;
                var j = "";
                /^[^\/]/.test(g.path) && (j = c.path, /(\/|\/[^\.]+)$/.test(j) ? j += "/" : j = j.replace(/\/[^\/]+$/, "/")), 
                g.path = j + (g.path || "");
            }
            return g.port || (g.port = f[g.scheme] || 80), g.port = parseInt(g.port, 10), g.path || (g.path = "/"), 
            delete g.source, g;
        }, b = function(b) {
            var c = {
                http: 80,
                https: 443
            }, d = a(b);
            return d.scheme + "://" + d.host + (d.port !== c[d.scheme] ? ":" + d.port : "") + d.path + (d.query ? d.query : "");
        }, c = function(b) {
            function c(a) {
                return [ a.scheme, a.host, a.port ].join("/");
            }
            return "string" == typeof b && (b = a(b)), c(a()) === c(b);
        };
        return {
            parseUrl: a,
            resolveUrl: b,
            hasSameOrigin: c
        };
    }), d(y, [ h, q, o ], function(a, b, c) {
        return function() {
            function d(a, b) {
                if (!b.isDetached()) {
                    var d = this.connectRuntime(b.ruid).exec.call(this, "FileReaderSync", "read", a, b);
                    return this.disconnectRuntime(), d;
                }
                var e = b.getSource();
                switch (a) {
                  case "readAsBinaryString":
                    return e;

                  case "readAsDataURL":
                    return "data:" + b.type + ";base64," + c.btoa(e);

                  case "readAsText":
                    for (var f = "", g = 0, h = e.length; h > g; g++) f += String.fromCharCode(e[g]);
                    return f;
                }
            }
            b.call(this), a.extend(this, {
                uid: a.guid("uid_"),
                readAsBinaryString: function(a) {
                    return d.call(this, "readAsBinaryString", a);
                },
                readAsDataURL: function(a) {
                    return d.call(this, "readAsDataURL", a);
                },
                readAsText: function(a) {
                    return d.call(this, "readAsText", a);
                }
            });
        };
    }), d(z, [ m, h, r ], function(a, b, c) {
        function d() {
            var a, d = [];
            b.extend(this, {
                append: function(e, f) {
                    var g = this, h = b.typeOf(f);
                    f instanceof c ? a = {
                        name: e,
                        value: f
                    } : "array" === h ? (e += "[]", b.each(f, function(a) {
                        g.append(e, a);
                    })) : "object" === h ? b.each(f, function(a, b) {
                        g.append(e + "[" + b + "]", a);
                    }) : "null" === h || "undefined" === h || "number" === h && isNaN(f) ? g.append(e, "false") : d.push({
                        name: e,
                        value: f.toString()
                    });
                },
                hasBlob: function() {
                    return !!this.getBlob();
                },
                getBlob: function() {
                    return a && a.value || null;
                },
                getBlobName: function() {
                    return a && a.name || null;
                },
                each: function(c) {
                    b.each(d, function(a) {
                        c(a.value, a.name);
                    }), a && c(a.value, a.name);
                },
                destroy: function() {
                    a = null, d = [];
                }
            });
        }
        return d;
    }), d(A, [ h, m, n, o, x, p, v, r, y, z, k, j ], function(a, b, c, d, e, f, g, h, i, j, k, l) {
        function m() {
            this.uid = a.guid("uid_");
        }
        function n() {
            function c(a, b) {
                return A.hasOwnProperty(a) ? 1 === arguments.length ? k.can("define_property") ? A[a] : z[a] : void (k.can("define_property") ? A[a] = b : z[a] = b) : void 0;
            }
            function i(b) {
                function d() {
                    x.destroy(), x = null, h.dispatchEvent("loadend"), h = null;
                }
                function e(e) {
                    x.bind("LoadStart", function(a) {
                        c("readyState", n.LOADING), h.dispatchEvent("readystatechange"), h.dispatchEvent(a), 
                        H && h.upload.dispatchEvent(a);
                    }), x.bind("Progress", function(a) {
                        c("readyState") !== n.LOADING && (c("readyState", n.LOADING), h.dispatchEvent("readystatechange")), 
                        h.dispatchEvent(a);
                    }), x.bind("UploadProgress", function(a) {
                        H && h.upload.dispatchEvent({
                            type: "progress",
                            lengthComputable: !1,
                            total: a.total,
                            loaded: a.loaded
                        });
                    }), x.bind("Load", function(b) {
                        c("readyState", n.DONE), c("status", Number(e.exec.call(x, "XMLHttpRequest", "getStatus") || 0)), 
                        c("statusText", o[c("status")] || ""), c("response", e.exec.call(x, "XMLHttpRequest", "getResponse", c("responseType"))), 
                        ~a.inArray(c("responseType"), [ "text", "" ]) ? c("responseText", c("response")) : "document" === c("responseType") && c("responseXML", c("response")), 
                        O = e.exec.call(x, "XMLHttpRequest", "getAllResponseHeaders"), h.dispatchEvent("readystatechange"), 
                        c("status") > 0 ? (H && h.upload.dispatchEvent(b), h.dispatchEvent(b)) : (J = !0, 
                        h.dispatchEvent("error")), d();
                    }), x.bind("Abort", function(a) {
                        h.dispatchEvent(a), d();
                    }), x.bind("Error", function(a) {
                        J = !0, c("readyState", n.DONE), h.dispatchEvent("readystatechange"), I = !0, h.dispatchEvent(a), 
                        d();
                    }), e.exec.call(x, "XMLHttpRequest", "send", {
                        url: r,
                        method: s,
                        async: B,
                        user: t,
                        password: u,
                        headers: C,
                        mimeType: E,
                        encoding: D,
                        responseType: h.responseType,
                        withCredentials: h.withCredentials,
                        options: N
                    }, b);
                }
                var h = this;
                v = new Date().getTime(), x = new g(), "string" == typeof N.required_caps && (N.required_caps = f.parseCaps(N.required_caps)), 
                N.required_caps = a.extend({}, N.required_caps, {
                    return_response_type: h.responseType
                }), b instanceof j && (N.required_caps.send_multipart = !0), K || (N.required_caps.do_cors = !0), 
                N.ruid ? e(x.connectRuntime(N)) : (x.bind("RuntimeInit", function(a, b) {
                    e(b);
                }), x.bind("RuntimeError", function(a, b) {
                    h.dispatchEvent("RuntimeError", b);
                }), x.connectRuntime(N));
            }
            function q() {
                c("responseText", ""), c("responseXML", null), c("response", null), c("status", 0), 
                c("statusText", ""), v = w = null;
            }
            var r, s, t, u, v, w, x, y, z = this, A = {
                timeout: 0,
                readyState: n.UNSENT,
                withCredentials: !1,
                status: 0,
                statusText: "",
                responseType: "",
                responseXML: null,
                responseText: null,
                response: null
            }, B = !0, C = {}, D = null, E = null, F = !1, G = !1, H = !1, I = !1, J = !1, K = !1, L = null, M = null, N = {}, O = "";
            a.extend(this, A, {
                uid: a.guid("uid_"),
                upload: new m(),
                open: function(f, g, h, i, j) {
                    var k;
                    if (!f || !g) throw new b.DOMException(b.DOMException.SYNTAX_ERR);
                    if (/[\u0100-\uffff]/.test(f) || d.utf8_encode(f) !== f) throw new b.DOMException(b.DOMException.SYNTAX_ERR);
                    if (~a.inArray(f.toUpperCase(), [ "CONNECT", "DELETE", "GET", "HEAD", "OPTIONS", "POST", "PUT", "TRACE", "TRACK" ]) && (s = f.toUpperCase()), 
                    ~a.inArray(s, [ "CONNECT", "TRACE", "TRACK" ])) throw new b.DOMException(b.DOMException.SECURITY_ERR);
                    if (g = d.utf8_encode(g), k = e.parseUrl(g), K = e.hasSameOrigin(k), r = e.resolveUrl(g), 
                    (i || j) && !K) throw new b.DOMException(b.DOMException.INVALID_ACCESS_ERR);
                    if (t = i || k.user, u = j || k.pass, B = h || !0, B === !1 && (c("timeout") || c("withCredentials") || "" !== c("responseType"))) throw new b.DOMException(b.DOMException.INVALID_ACCESS_ERR);
                    F = !B, G = !1, C = {}, q.call(this), c("readyState", n.OPENED), this.convertEventPropsToHandlers([ "readystatechange" ]), 
                    this.dispatchEvent("readystatechange");
                },
                setRequestHeader: function(e, f) {
                    var g = [ "accept-charset", "accept-encoding", "access-control-request-headers", "access-control-request-method", "connection", "content-length", "cookie", "cookie2", "content-transfer-encoding", "date", "expect", "host", "keep-alive", "origin", "referer", "te", "trailer", "transfer-encoding", "upgrade", "user-agent", "via" ];
                    if (c("readyState") !== n.OPENED || G) throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);
                    if (/[\u0100-\uffff]/.test(e) || d.utf8_encode(e) !== e) throw new b.DOMException(b.DOMException.SYNTAX_ERR);
                    return e = a.trim(e).toLowerCase(), ~a.inArray(e, g) || /^(proxy\-|sec\-)/.test(e) ? !1 : (C[e] ? C[e] += ", " + f : C[e] = f, 
                    !0);
                },
                getAllResponseHeaders: function() {
                    return O || "";
                },
                getResponseHeader: function(b) {
                    return b = b.toLowerCase(), J || ~a.inArray(b, [ "set-cookie", "set-cookie2" ]) ? null : O && "" !== O && (y || (y = {}, 
                    a.each(O.split(/\r\n/), function(b) {
                        var c = b.split(/:\s+/);
                        2 === c.length && (c[0] = a.trim(c[0]), y[c[0].toLowerCase()] = {
                            header: c[0],
                            value: a.trim(c[1])
                        });
                    })), y.hasOwnProperty(b)) ? y[b].header + ": " + y[b].value : null;
                },
                overrideMimeType: function(d) {
                    var e, f;
                    if (~a.inArray(c("readyState"), [ n.LOADING, n.DONE ])) throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);
                    if (d = a.trim(d.toLowerCase()), /;/.test(d) && (e = d.match(/^([^;]+)(?:;\scharset\=)?(.*)$/)) && (d = e[1], 
                    e[2] && (f = e[2])), !l.mimes[d]) throw new b.DOMException(b.DOMException.SYNTAX_ERR);
                    L = d, M = f;
                },
                send: function(c, e) {
                    if (N = "string" === a.typeOf(e) ? {
                        ruid: e
                    } : e ? e : {}, this.convertEventPropsToHandlers(p), this.upload.convertEventPropsToHandlers(p), 
                    this.readyState !== n.OPENED || G) throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);
                    if (c instanceof h) N.ruid = c.ruid, E = c.type || "application/octet-stream"; else if (c instanceof j) {
                        if (c.hasBlob()) {
                            var f = c.getBlob();
                            N.ruid = f.ruid, E = f.type || "application/octet-stream";
                        }
                    } else "string" == typeof c && (D = "UTF-8", E = "text/plain;charset=UTF-8", c = d.utf8_encode(c));
                    this.withCredentials || (this.withCredentials = N.required_caps && N.required_caps.send_browser_cookies && !K), 
                    H = !F && this.upload.hasEventListener(), J = !1, I = !c, F || (G = !0), i.call(this, c);
                },
                abort: function() {
                    if (J = !0, F = !1, ~a.inArray(c("readyState"), [ n.UNSENT, n.OPENED, n.DONE ])) c("readyState", n.UNSENT); else {
                        if (c("readyState", n.DONE), G = !1, !x) throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);
                        x.getRuntime().exec.call(x, "XMLHttpRequest", "abort", I), I = !0;
                    }
                },
                destroy: function() {
                    x && ("function" === a.typeOf(x.destroy) && x.destroy(), x = null), this.unbindAll(), 
                    this.upload && (this.upload.unbindAll(), this.upload = null);
                }
            });
        }
        var o = {
            100: "Continue",
            101: "Switching Protocols",
            102: "Processing",
            200: "OK",
            201: "Created",
            202: "Accepted",
            203: "Non-Authoritative Information",
            204: "No Content",
            205: "Reset Content",
            206: "Partial Content",
            207: "Multi-Status",
            226: "IM Used",
            300: "Multiple Choices",
            301: "Moved Permanently",
            302: "Found",
            303: "See Other",
            304: "Not Modified",
            305: "Use Proxy",
            306: "Reserved",
            307: "Temporary Redirect",
            400: "Bad Request",
            401: "Unauthorized",
            402: "Payment Required",
            403: "Forbidden",
            404: "Not Found",
            405: "Method Not Allowed",
            406: "Not Acceptable",
            407: "Proxy Authentication Required",
            408: "Request Timeout",
            409: "Conflict",
            410: "Gone",
            411: "Length Required",
            412: "Precondition Failed",
            413: "Request Entity Too Large",
            414: "Request-URI Too Long",
            415: "Unsupported Media Type",
            416: "Requested Range Not Satisfiable",
            417: "Expectation Failed",
            422: "Unprocessable Entity",
            423: "Locked",
            424: "Failed Dependency",
            426: "Upgrade Required",
            500: "Internal Server Error",
            501: "Not Implemented",
            502: "Bad Gateway",
            503: "Service Unavailable",
            504: "Gateway Timeout",
            505: "HTTP Version Not Supported",
            506: "Variant Also Negotiates",
            507: "Insufficient Storage",
            510: "Not Extended"
        };
        m.prototype = c.instance;
        var p = [ "loadstart", "progress", "abort", "error", "load", "timeout", "loadend" ];
        return n.UNSENT = 0, n.OPENED = 1, n.HEADERS_RECEIVED = 2, n.LOADING = 3, n.DONE = 4, 
        n.prototype = c.instance, n;
    }), d(B, [ h, o, q, n ], function(a, b, c, d) {
        function e() {
            function d() {
                k = l = 0, j = this.result = null;
            }
            function f(b, c) {
                var d = this;
                i = c, d.bind("TransportingProgress", function(b) {
                    l = b.loaded, k > l && -1 === a.inArray(d.state, [ e.IDLE, e.DONE ]) && g.call(d);
                }, 999), d.bind("TransportingComplete", function() {
                    l = k, d.state = e.DONE, j = null, d.result = i.exec.call(d, "Transporter", "getAsBlob", b || "");
                }, 999), d.state = e.BUSY, d.trigger("TransportingStarted"), g.call(d);
            }
            function g() {
                var a, c = this, d = k - l;
                m > d && (m = d), a = b.btoa(j.substr(l, m)), i.exec.call(c, "Transporter", "receive", a, k);
            }
            var h, i, j, k, l, m;
            c.call(this), a.extend(this, {
                uid: a.guid("uid_"),
                state: e.IDLE,
                result: null,
                transport: function(b, c, e) {
                    var g = this;
                    if (e = a.extend({
                        chunk_size: 204798
                    }, e), (h = e.chunk_size % 3) && (e.chunk_size += 3 - h), m = e.chunk_size, d.call(this), 
                    j = b, k = b.length, "string" === a.typeOf(e) || e.ruid) f.call(g, c, this.connectRuntime(e)); else {
                        var i = function(a, b) {
                            g.unbind("RuntimeInit", i), f.call(g, c, b);
                        };
                        this.bind("RuntimeInit", i), this.connectRuntime(e);
                    }
                },
                abort: function() {
                    var a = this;
                    a.state = e.IDLE, i && (i.exec.call(a, "Transporter", "clear"), a.trigger("TransportingAborted")), 
                    d.call(a);
                },
                destroy: function() {
                    this.unbindAll(), i = null, this.disconnectRuntime(), d.call(this);
                }
            });
        }
        return e.IDLE = 0, e.BUSY = 1, e.DONE = 2, e.prototype = d.instance, e;
    }), d(C, [ h, l, m, y, A, p, q, B, k, n, r, s, o ], function(a, b, c, d, e, f, g, h, i, j, k, l, m) {
        function n() {
            function d(a) {
                a || (a = this.getRuntime().exec.call(this, "Image", "getInfo")), this.size = a.size, 
                this.width = a.width, this.height = a.height, this.type = a.type, this.meta = a.meta, 
                "" === this.name && (this.name = a.name);
            }
            function j(b) {
                var d = a.typeOf(b);
                try {
                    if (b instanceof n) {
                        if (!b.size) throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);
                        p.apply(this, arguments);
                    } else if (b instanceof k) {
                        if (!~a.inArray(b.type, [ "image/jpeg", "image/png" ])) throw new c.ImageError(c.ImageError.WRONG_FORMAT);
                        q.apply(this, arguments);
                    } else if (-1 !== a.inArray(d, [ "blob", "file" ])) j.call(this, new l(null, b), arguments[1]); else if ("string" === d) /^data:[^;]*;base64,/.test(b) ? j.call(this, new k(null, {
                        data: b
                    }), arguments[1]) : r.apply(this, arguments); else {
                        if ("node" !== d || "img" !== b.nodeName.toLowerCase()) throw new c.DOMException(c.DOMException.TYPE_MISMATCH_ERR);
                        j.call(this, b.src, arguments[1]);
                    }
                } catch (e) {
                    this.trigger("error", e);
                }
            }
            function p(b, c) {
                var d = this.connectRuntime(b.ruid);
                this.ruid = d.uid, d.exec.call(this, "Image", "loadFromImage", b, "undefined" === a.typeOf(c) ? !0 : c);
            }
            function q(b, c) {
                function d(a) {
                    e.ruid = a.uid, a.exec.call(e, "Image", "loadFromBlob", b);
                }
                var e = this;
                e.name = b.name || "", b.isDetached() ? (this.bind("RuntimeInit", function(a, b) {
                    d(b);
                }), c && "string" == typeof c.required_caps && (c.required_caps = f.parseCaps(c.required_caps)), 
                this.connectRuntime(a.extend({
                    required_caps: {
                        access_image_binary: !0,
                        resize_image: !0
                    }
                }, c))) : d(this.connectRuntime(b.ruid));
            }
            function r(a, b) {
                var c, d = this;
                c = new e(), c.open("get", a), c.responseType = "blob", c.onprogress = function(a) {
                    d.trigger(a);
                }, c.onload = function() {
                    q.call(d, c.response, !0);
                }, c.onerror = function(a) {
                    d.trigger(a);
                }, c.onloadend = function() {
                    c.destroy();
                }, c.bind("RuntimeError", function(a, b) {
                    d.trigger("RuntimeError", b);
                }), c.send(null, b);
            }
            g.call(this), a.extend(this, {
                uid: a.guid("uid_"),
                ruid: null,
                name: "",
                size: 0,
                width: 0,
                height: 0,
                type: "",
                meta: {},
                clone: function() {
                    this.load.apply(this, arguments);
                },
                load: function() {
                    this.bind("Load Resize", function() {
                        d.call(this);
                    }, 999), this.convertEventPropsToHandlers(o), j.apply(this, arguments);
                },
                downsize: function(b, d, e, f) {
                    try {
                        if (!this.size) throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);
                        if (this.width > n.MAX_RESIZE_WIDTH || this.height > n.MAX_RESIZE_HEIGHT) throw new c.ImageError(c.ImageError.MAX_RESOLUTION_ERR);
                        (!b && !d || "undefined" === a.typeOf(e)) && (e = !1), b = b || this.width, d = d || this.height, 
                        f = "undefined" === a.typeOf(f) ? !0 : !!f, this.getRuntime().exec.call(this, "Image", "downsize", b, d, e, f);
                    } catch (g) {
                        this.trigger("error", g);
                    }
                },
                crop: function(a, b, c) {
                    this.downsize(a, b, !0, c);
                },
                getAsCanvas: function() {
                    if (!i.can("create_canvas")) throw new c.RuntimeError(c.RuntimeError.NOT_SUPPORTED_ERR);
                    var a = this.connectRuntime(this.ruid);
                    return a.exec.call(this, "Image", "getAsCanvas");
                },
                getAsBlob: function(a, b) {
                    if (!this.size) throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);
                    return a || (a = "image/jpeg"), "image/jpeg" !== a || b || (b = 90), this.getRuntime().exec.call(this, "Image", "getAsBlob", a, b);
                },
                getAsDataURL: function(a, b) {
                    if (!this.size) throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);
                    return this.getRuntime().exec.call(this, "Image", "getAsDataURL", a, b);
                },
                getAsBinaryString: function(a, b) {
                    var c = this.getAsDataURL(a, b);
                    return m.atob(c.substring(c.indexOf("base64,") + 7));
                },
                embed: function(d) {
                    function e() {
                        if (i.can("create_canvas")) {
                            var b = f.getAsCanvas();
                            if (b) return d.appendChild(b), b = null, f.destroy(), void o.trigger("embedded");
                        }
                        var e = f.getAsDataURL(g, j);
                        if (!e) throw new c.ImageError(c.ImageError.WRONG_FORMAT);
                        if (i.can("use_data_uri_of", e.length)) d.innerHTML = '<img src="' + e + '" width="' + f.width + '" height="' + f.height + '" />', 
                        f.destroy(), o.trigger("embedded"); else {
                            var k = new h();
                            k.bind("TransportingComplete", function() {
                                l = o.connectRuntime(this.result.ruid), o.bind("Embedded", function() {
                                    a.extend(l.getShimContainer().style, {
                                        top: "0px",
                                        left: "0px",
                                        width: f.width + "px",
                                        height: f.height + "px"
                                    }), l = null;
                                }, 999), l.exec.call(o, "ImageView", "display", this.result.uid, q, r), f.destroy();
                            }), k.transport(m.atob(e.substring(e.indexOf("base64,") + 7)), g, a.extend({}, p, {
                                required_caps: {
                                    display_media: !0
                                },
                                runtime_order: "flash,silverlight",
                                container: d
                            }));
                        }
                    }
                    var f, g, j, k, l, o = this, p = arguments[1] || {}, q = this.width, r = this.height;
                    try {
                        if (!(d = b.get(d))) throw new c.DOMException(c.DOMException.INVALID_NODE_TYPE_ERR);
                        if (!this.size) throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);
                        if (this.width > n.MAX_RESIZE_WIDTH || this.height > n.MAX_RESIZE_HEIGHT) throw new c.ImageError(c.ImageError.MAX_RESOLUTION_ERR);
                        if (g = p.type || this.type || "image/jpeg", j = p.quality || 90, k = "undefined" !== a.typeOf(p.crop) ? p.crop : !1, 
                        p.width) q = p.width, r = p.height || q; else {
                            var s = b.getSize(d);
                            s.w && s.h && (q = s.w, r = s.h);
                        }
                        return f = new n(), f.bind("Resize", function() {
                            e.call(o);
                        }), f.bind("Load", function() {
                            f.downsize(q, r, k, !1);
                        }), f.clone(this, !1), f;
                    } catch (t) {
                        this.trigger("error", t);
                    }
                },
                destroy: function() {
                    this.ruid && (this.getRuntime().exec.call(this, "Image", "destroy"), this.disconnectRuntime()), 
                    this.unbindAll();
                }
            });
        }
        var o = [ "progress", "load", "error", "resize", "embedded" ];
        return n.MAX_RESIZE_WIDTH = 6500, n.MAX_RESIZE_HEIGHT = 6500, n.prototype = j.instance, 
        n;
    }), d(D, [ h, m, p, k ], function(a, b, c, d) {
        function e(b) {
            var e = this, h = c.capTest, i = c.capTrue, j = a.extend({
                access_binary: h(window.FileReader || window.File && window.File.getAsDataURL),
                access_image_binary: function() {
                    return e.can("access_binary") && !!g.Image;
                },
                display_media: h(d.can("create_canvas") || d.can("use_data_uri_over32kb")),
                do_cors: h(window.XMLHttpRequest && "withCredentials" in new XMLHttpRequest()),
                drag_and_drop: h(function() {
                    var a = document.createElement("div");
                    return ("draggable" in a || "ondragstart" in a && "ondrop" in a) && ("IE" !== d.browser || d.version > 9);
                }()),
                filter_by_extension: h(function() {
                    return "Chrome" === d.browser && d.version >= 28 || "IE" === d.browser && d.version >= 10;
                }()),
                return_response_headers: i,
                return_response_type: function(a) {
                    return "json" === a && window.JSON ? !0 : d.can("return_response_type", a);
                },
                return_status_code: i,
                report_upload_progress: h(window.XMLHttpRequest && new XMLHttpRequest().upload),
                resize_image: function() {
                    return e.can("access_binary") && d.can("create_canvas");
                },
                select_file: function() {
                    return d.can("use_fileinput") && window.File;
                },
                select_folder: function() {
                    return e.can("select_file") && "Chrome" === d.browser && d.version >= 21;
                },
                select_multiple: function() {
                    return !(!e.can("select_file") || "Safari" === d.browser && "Windows" === d.os || "iOS" === d.os && d.verComp(d.osVersion, "7.0.4", "<"));
                },
                send_binary_string: h(window.XMLHttpRequest && (new XMLHttpRequest().sendAsBinary || window.Uint8Array && window.ArrayBuffer)),
                send_custom_headers: h(window.XMLHttpRequest),
                send_multipart: function() {
                    return !!(window.XMLHttpRequest && new XMLHttpRequest().upload && window.FormData) || e.can("send_binary_string");
                },
                slice_blob: h(window.File && (File.prototype.mozSlice || File.prototype.webkitSlice || File.prototype.slice)),
                stream_upload: function() {
                    return e.can("slice_blob") && e.can("send_multipart");
                },
                summon_file_dialog: h(function() {
                    return "Firefox" === d.browser && d.version >= 4 || "Opera" === d.browser && d.version >= 12 || "IE" === d.browser && d.version >= 10 || !!~a.inArray(d.browser, [ "Chrome", "Safari" ]);
                }()),
                upload_filesize: i
            }, arguments[2]);
            c.call(this, b, arguments[1] || f, j), a.extend(this, {
                init: function() {
                    this.trigger("Init");
                },
                destroy: function(a) {
                    return function() {
                        a.call(e), a = e = null;
                    };
                }(this.destroy)
            }), a.extend(this.getShim(), g);
        }
        var f = "html5", g = {};
        return c.addConstructor(f, e), g;
    }), d(E, [ D, r ], function(a, b) {
        function c() {
            function a(a, b, c) {
                var d;
                if (!window.File.prototype.slice) return (d = window.File.prototype.webkitSlice || window.File.prototype.mozSlice) ? d.call(a, b, c) : null;
                try {
                    return a.slice(), a.slice(b, c);
                } catch (e) {
                    return a.slice(b, c - b);
                }
            }
            this.slice = function() {
                return new b(this.getRuntime().uid, a.apply(this, arguments));
            };
        }
        return a.Blob = c;
    }), d(F, [ h ], function(a) {
        function b() {
            this.returnValue = !1;
        }
        function c() {
            this.cancelBubble = !0;
        }
        var d = {}, e = "moxie_" + a.guid(), f = function(f, g, h, i) {
            var j, k;
            g = g.toLowerCase(), f.addEventListener ? (j = h, f.addEventListener(g, j, !1)) : f.attachEvent && (j = function() {
                var a = window.event;
                a.target || (a.target = a.srcElement), a.preventDefault = b, a.stopPropagation = c, 
                h(a);
            }, f.attachEvent("on" + g, j)), f[e] || (f[e] = a.guid()), d.hasOwnProperty(f[e]) || (d[f[e]] = {}), 
            k = d[f[e]], k.hasOwnProperty(g) || (k[g] = []), k[g].push({
                func: j,
                orig: h,
                key: i
            });
        }, g = function(b, c, f) {
            var g, h;
            if (c = c.toLowerCase(), b[e] && d[b[e]] && d[b[e]][c]) {
                g = d[b[e]][c];
                for (var i = g.length - 1; i >= 0 && (g[i].orig !== f && g[i].key !== f || (b.removeEventListener ? b.removeEventListener(c, g[i].func, !1) : b.detachEvent && b.detachEvent("on" + c, g[i].func), 
                g[i].orig = null, g[i].func = null, g.splice(i, 1), f === h)); i--) ;
                if (g.length || delete d[b[e]][c], a.isEmptyObj(d[b[e]])) {
                    delete d[b[e]];
                    try {
                        delete b[e];
                    } catch (j) {
                        b[e] = h;
                    }
                }
            }
        }, h = function(b, c) {
            b && b[e] && a.each(d[b[e]], function(a, d) {
                g(b, d, c);
            });
        };
        return {
            addEvent: f,
            removeEvent: g,
            removeAllEvents: h
        };
    }), d(G, [ D, h, l, F, j, k ], function(a, b, c, d, e, f) {
        function g() {
            var a, g = [];
            b.extend(this, {
                init: function(h) {
                    var i, j, k, l, m, n, o = this, p = o.getRuntime();
                    a = h, g = [], k = a.accept.mimes || e.extList2mimes(a.accept, p.can("filter_by_extension")), 
                    j = p.getShimContainer(), j.innerHTML = '<input id="' + p.uid + '" type="file" style="font-size:999px;opacity:0;"' + (a.multiple && p.can("select_multiple") ? "multiple" : "") + (a.directory && p.can("select_folder") ? "webkitdirectory directory" : "") + (k ? ' accept="' + k.join(",") + '"' : "") + " />", 
                    i = c.get(p.uid), b.extend(i.style, {
                        position: "absolute",
                        top: 0,
                        left: 0,
                        width: "100%",
                        height: "100%"
                    }), l = c.get(a.browse_button), p.can("summon_file_dialog") && ("static" === c.getStyle(l, "position") && (l.style.position = "relative"), 
                    m = parseInt(c.getStyle(l, "z-index"), 10) || 1, l.style.zIndex = m, j.style.zIndex = m - 1, 
                    d.addEvent(l, "click", function(a) {
                        var b = c.get(p.uid);
                        b && !b.disabled && b.click(), a.preventDefault();
                    }, o.uid)), n = p.can("summon_file_dialog") ? l : j, d.addEvent(n, "mouseover", function() {
                        o.trigger("mouseenter");
                    }, o.uid), d.addEvent(n, "mouseout", function() {
                        o.trigger("mouseleave");
                    }, o.uid), d.addEvent(n, "mousedown", function() {
                        o.trigger("mousedown");
                    }, o.uid), d.addEvent(c.get(a.container), "mouseup", function() {
                        o.trigger("mouseup");
                    }, o.uid), i.onchange = function q() {
                        if (g = [], a.directory ? b.each(this.files, function(a) {
                            "." !== a.name && g.push(a);
                        }) : g = [].slice.call(this.files), "IE" !== f.browser) this.value = ""; else {
                            var c = this.cloneNode(!0);
                            this.parentNode.replaceChild(c, this), c.onchange = q;
                        }
                        o.trigger("change");
                    }, o.trigger({
                        type: "ready",
                        async: !0
                    }), j = null;
                },
                getFiles: function() {
                    return g;
                },
                disable: function(a) {
                    var b, d = this.getRuntime();
                    (b = c.get(d.uid)) && (b.disabled = !!a);
                },
                destroy: function() {
                    var b = this.getRuntime(), e = b.getShim(), f = b.getShimContainer();
                    d.removeAllEvents(f, this.uid), d.removeAllEvents(a && c.get(a.container), this.uid), 
                    d.removeAllEvents(a && c.get(a.browse_button), this.uid), f && (f.innerHTML = ""), 
                    e.removeInstance(this.uid), g = a = f = e = null;
                }
            });
        }
        return a.FileInput = g;
    }), d(H, [ D, h, l, F, j ], function(a, b, c, d, e) {
        function f() {
            function a(a) {
                for (var c = [], d = 0; d < a.length; d++) [].push.apply(c, a[d].extensions.split(/\s*,\s*/));
                return -1 === b.inArray("*", c) ? c : [];
            }
            function f(a) {
                var c = e.getFileExtension(a.name);
                return !c || !m.length || -1 !== b.inArray(c, m);
            }
            function g(a, c) {
                var d = [];
                b.each(a, function(a) {
                    var b = a.webkitGetAsEntry();
                    if (b) if (b.isFile) {
                        var c = a.getAsFile();
                        f(c) && l.push(c);
                    } else d.push(b);
                }), d.length ? h(d, c) : c();
            }
            function h(a, c) {
                var d = [];
                b.each(a, function(a) {
                    d.push(function(b) {
                        i(a, b);
                    });
                }), b.inSeries(d, function() {
                    c();
                });
            }
            function i(a, b) {
                a.isFile ? a.file(function(a) {
                    f(a) && l.push(a), b();
                }, function() {
                    b();
                }) : a.isDirectory ? j(a, b) : b();
            }
            function j(a, b) {
                function c(a) {
                    e.readEntries(function(b) {
                        b.length ? ([].push.apply(d, b), c(a)) : a();
                    }, a);
                }
                var d = [], e = a.createReader();
                c(function() {
                    h(d, b);
                });
            }
            var k, l = [], m = [];
            b.extend(this, {
                init: function(c) {
                    var e, h = this;
                    k = c, m = a(k.accept), e = k.container, d.addEvent(e, "dragover", function(a) {
                        a.preventDefault(), a.stopPropagation(), a.dataTransfer.dropEffect = "copy";
                    }, h.uid), d.addEvent(e, "drop", function(a) {
                        a.preventDefault(), a.stopPropagation(), l = [], a.dataTransfer.items && a.dataTransfer.items[0].webkitGetAsEntry ? g(a.dataTransfer.items, function() {
                            h.trigger("drop");
                        }) : (b.each(a.dataTransfer.files, function(a) {
                            f(a) && l.push(a);
                        }), h.trigger("drop"));
                    }, h.uid), d.addEvent(e, "dragenter", function(a) {
                        a.preventDefault(), a.stopPropagation(), h.trigger("dragenter");
                    }, h.uid), d.addEvent(e, "dragleave", function(a) {
                        a.preventDefault(), a.stopPropagation(), h.trigger("dragleave");
                    }, h.uid);
                },
                getFiles: function() {
                    return l;
                },
                destroy: function() {
                    d.removeAllEvents(k && c.get(k.container), this.uid), l = m = k = null;
                }
            });
        }
        return a.FileDrop = f;
    }), d(I, [ D, o, h ], function(a, b, c) {
        function d() {
            function a(a) {
                return b.atob(a.substring(a.indexOf("base64,") + 7));
            }
            var d, e = !1;
            c.extend(this, {
                read: function(a, b) {
                    var f = this;
                    d = new window.FileReader(), d.addEventListener("progress", function(a) {
                        f.trigger(a);
                    }), d.addEventListener("load", function(a) {
                        f.trigger(a);
                    }), d.addEventListener("error", function(a) {
                        f.trigger(a, d.error);
                    }), d.addEventListener("loadend", function() {
                        d = null;
                    }), "function" === c.typeOf(d[a]) ? (e = !1, d[a](b.getSource())) : "readAsBinaryString" === a && (e = !0, 
                    d.readAsDataURL(b.getSource()));
                },
                getResult: function() {
                    return d && d.result ? e ? a(d.result) : d.result : null;
                },
                abort: function() {
                    d && d.abort();
                },
                destroy: function() {
                    d = null;
                }
            });
        }
        return a.FileReader = d;
    }), d(J, [ D, h, j, x, s, r, z, m, k ], function(a, b, c, d, e, f, g, h, i) {
        function j() {
            function a(a, b) {
                var c, d, e = this;
                c = b.getBlob().getSource(), d = new window.FileReader(), d.onload = function() {
                    b.append(b.getBlobName(), new f(null, {
                        type: c.type,
                        data: d.result
                    })), o.send.call(e, a, b);
                }, d.readAsBinaryString(c);
            }
            function j() {
                return !window.XMLHttpRequest || "IE" === i.browser && i.version < 8 ? function() {
                    for (var a = [ "Msxml2.XMLHTTP.6.0", "Microsoft.XMLHTTP" ], b = 0; b < a.length; b++) try {
                        return new ActiveXObject(a[b]);
                    } catch (c) {}
                }() : new window.XMLHttpRequest();
            }
            function k(a) {
                var b = a.responseXML, c = a.responseText;
                return "IE" === i.browser && c && b && !b.documentElement && /[^\/]+\/[^\+]+\+xml/.test(a.getResponseHeader("Content-Type")) && (b = new window.ActiveXObject("Microsoft.XMLDOM"), 
                b.async = !1, b.validateOnParse = !1, b.loadXML(c)), b && ("IE" === i.browser && 0 !== b.parseError || !b.documentElement || "parsererror" === b.documentElement.tagName) ? null : b;
            }
            function l(a) {
                var b = "----moxieboundary" + new Date().getTime(), c = "--", d = "\r\n", e = "", g = this.getRuntime();
                if (!g.can("send_binary_string")) throw new h.RuntimeError(h.RuntimeError.NOT_SUPPORTED_ERR);
                return m.setRequestHeader("Content-Type", "multipart/form-data; boundary=" + b), 
                a.each(function(a, g) {
                    e += a instanceof f ? c + b + d + 'Content-Disposition: form-data; name="' + g + '"; filename="' + unescape(encodeURIComponent(a.name || "blob")) + '"' + d + "Content-Type: " + (a.type || "application/octet-stream") + d + d + a.getSource() + d : c + b + d + 'Content-Disposition: form-data; name="' + g + '"' + d + d + unescape(encodeURIComponent(a)) + d;
                }), e += c + b + c + d;
            }
            var m, n, o = this;
            b.extend(this, {
                send: function(c, e) {
                    var h = this, k = "Mozilla" === i.browser && i.version >= 4 && i.version < 7, o = "Android Browser" === i.browser, p = !1;
                    if (n = c.url.replace(/^.+?\/([\w\-\.]+)$/, "$1").toLowerCase(), m = j(), m.open(c.method, c.url, c.async, c.user, c.password), 
                    e instanceof f) e.isDetached() && (p = !0), e = e.getSource(); else if (e instanceof g) {
                        if (e.hasBlob()) if (e.getBlob().isDetached()) e = l.call(h, e), p = !0; else if ((k || o) && "blob" === b.typeOf(e.getBlob().getSource()) && window.FileReader) return void a.call(h, c, e);
                        if (e instanceof g) {
                            var q = new window.FormData();
                            e.each(function(a, b) {
                                a instanceof f ? q.append(b, a.getSource()) : q.append(b, a);
                            }), e = q;
                        }
                    }
                    m.upload ? (c.withCredentials && (m.withCredentials = !0), m.addEventListener("load", function(a) {
                        h.trigger(a);
                    }), m.addEventListener("error", function(a) {
                        h.trigger(a);
                    }), m.addEventListener("progress", function(a) {
                        h.trigger(a);
                    }), m.upload.addEventListener("progress", function(a) {
                        h.trigger({
                            type: "UploadProgress",
                            loaded: a.loaded,
                            total: a.total
                        });
                    })) : m.onreadystatechange = function() {
                        switch (m.readyState) {
                          case 1:
                            break;

                          case 2:
                            break;

                          case 3:
                            var a, b;
                            try {
                                d.hasSameOrigin(c.url) && (a = m.getResponseHeader("Content-Length") || 0), m.responseText && (b = m.responseText.length);
                            } catch (e) {
                                a = b = 0;
                            }
                            h.trigger({
                                type: "progress",
                                lengthComputable: !!a,
                                total: parseInt(a, 10),
                                loaded: b
                            });
                            break;

                          case 4:
                            m.onreadystatechange = function() {}, h.trigger(0 === m.status ? "error" : "load");
                        }
                    }, b.isEmptyObj(c.headers) || b.each(c.headers, function(a, b) {
                        m.setRequestHeader(b, a);
                    }), "" !== c.responseType && "responseType" in m && (m.responseType = "json" !== c.responseType || i.can("return_response_type", "json") ? c.responseType : "text"), 
                    p ? m.sendAsBinary ? m.sendAsBinary(e) : function() {
                        for (var a = new Uint8Array(e.length), b = 0; b < e.length; b++) a[b] = 255 & e.charCodeAt(b);
                        m.send(a.buffer);
                    }() : m.send(e), h.trigger("loadstart");
                },
                getStatus: function() {
                    try {
                        if (m) return m.status;
                    } catch (a) {}
                    return 0;
                },
                getResponse: function(a) {
                    var b = this.getRuntime();
                    try {
                        switch (a) {
                          case "blob":
                            var d = new e(b.uid, m.response), f = m.getResponseHeader("Content-Disposition");
                            if (f) {
                                var g = f.match(/filename=([\'\"'])([^\1]+)\1/);
                                g && (n = g[2]);
                            }
                            return d.name = n, d.type || (d.type = c.getFileMime(n)), d;

                          case "json":
                            return i.can("return_response_type", "json") ? m.response : 200 === m.status && window.JSON ? JSON.parse(m.responseText) : null;

                          case "document":
                            return k(m);

                          default:
                            return "" !== m.responseText ? m.responseText : null;
                        }
                    } catch (h) {
                        return null;
                    }
                },
                getAllResponseHeaders: function() {
                    try {
                        return m.getAllResponseHeaders();
                    } catch (a) {}
                    return "";
                },
                abort: function() {
                    m && m.abort();
                },
                destroy: function() {
                    o = n = null;
                }
            });
        }
        return a.XMLHttpRequest = j;
    }), d(K, [], function() {
        return function() {
            function a(a, b) {
                var c, d = f ? 0 : -8 * (b - 1), g = 0;
                for (c = 0; b > c; c++) g |= e.charCodeAt(a + c) << Math.abs(d + 8 * c);
                return g;
            }
            function c(a, b, c) {
                c = 3 === arguments.length ? c : e.length - b - 1, e = e.substr(0, b) + a + e.substr(c + b);
            }
            function d(a, b, d) {
                var e, g = "", h = f ? 0 : -8 * (d - 1);
                for (e = 0; d > e; e++) g += String.fromCharCode(255 & b >> Math.abs(h + 8 * e));
                c(g, a, d);
            }
            var e, f = !1;
            return {
                II: function(a) {
                    return a === b ? f : void (f = a);
                },
                init: function(a) {
                    f = !1, e = a;
                },
                SEGMENT: function(a, b, d) {
                    switch (arguments.length) {
                      case 1:
                        return e.substr(a, e.length - a - 1);

                      case 2:
                        return e.substr(a, b);

                      case 3:
                        c(d, a, b);
                        break;

                      default:
                        return e;
                    }
                },
                BYTE: function(b) {
                    return a(b, 1);
                },
                SHORT: function(b) {
                    return a(b, 2);
                },
                LONG: function(c, e) {
                    return e === b ? a(c, 4) : void d(c, e, 4);
                },
                SLONG: function(b) {
                    var c = a(b, 4);
                    return c > 2147483647 ? c - 4294967296 : c;
                },
                STRING: function(b, c) {
                    var d = "";
                    for (c += b; c > b; b++) d += String.fromCharCode(a(b, 1));
                    return d;
                }
            };
        };
    }), d(L, [ K ], function(a) {
        return function b(c) {
            var d, e, f, g = [], h = 0;
            if (d = new a(), d.init(c), 65496 === d.SHORT(0)) {
                for (e = 2; e <= c.length; ) if (f = d.SHORT(e), f >= 65488 && 65495 >= f) e += 2; else {
                    if (65498 === f || 65497 === f) break;
                    h = d.SHORT(e + 2) + 2, f >= 65505 && 65519 >= f && g.push({
                        hex: f,
                        name: "APP" + (15 & f),
                        start: e,
                        length: h,
                        segment: d.SEGMENT(e, h)
                    }), e += h;
                }
                return d.init(null), {
                    headers: g,
                    restore: function(a) {
                        var b, c;
                        for (d.init(a), e = 65504 == d.SHORT(2) ? 4 + d.SHORT(4) : 2, c = 0, b = g.length; b > c; c++) d.SEGMENT(e, 0, g[c].segment), 
                        e += g[c].length;
                        return a = d.SEGMENT(), d.init(null), a;
                    },
                    strip: function(a) {
                        var c, e, f;
                        for (e = new b(a), c = e.headers, e.purge(), d.init(a), f = c.length; f--; ) d.SEGMENT(c[f].start, c[f].length, "");
                        return a = d.SEGMENT(), d.init(null), a;
                    },
                    get: function(a) {
                        for (var b = [], c = 0, d = g.length; d > c; c++) g[c].name === a.toUpperCase() && b.push(g[c].segment);
                        return b;
                    },
                    set: function(a, b) {
                        var c, d, e, f = [];
                        for ("string" == typeof b ? f.push(b) : f = b, c = d = 0, e = g.length; e > c && (g[c].name === a.toUpperCase() && (g[c].segment = f[d], 
                        g[c].length = f[d].length, d++), !(d >= f.length)); c++) ;
                    },
                    purge: function() {
                        g = [], d.init(null), d = null;
                    }
                };
            }
        };
    }), d(M, [ h, K ], function(a, c) {
        return function d() {
            function d(a, c) {
                var d, e, f, h, i, l, m, n, o = g.SHORT(a), p = [], q = {};
                for (d = 0; o > d; d++) if (m = l = a + 12 * d + 2, f = c[g.SHORT(m)], f !== b) {
                    switch (h = g.SHORT(m += 2), i = g.LONG(m += 2), m += 4, p = [], h) {
                      case 1:
                      case 7:
                        for (i > 4 && (m = g.LONG(m) + k.tiffHeader), e = 0; i > e; e++) p[e] = g.BYTE(m + e);
                        break;

                      case 2:
                        i > 4 && (m = g.LONG(m) + k.tiffHeader), q[f] = g.STRING(m, i - 1);
                        continue;

                      case 3:
                        for (i > 2 && (m = g.LONG(m) + k.tiffHeader), e = 0; i > e; e++) p[e] = g.SHORT(m + 2 * e);
                        break;

                      case 4:
                        for (i > 1 && (m = g.LONG(m) + k.tiffHeader), e = 0; i > e; e++) p[e] = g.LONG(m + 4 * e);
                        break;

                      case 5:
                        for (m = g.LONG(m) + k.tiffHeader, e = 0; i > e; e++) p[e] = g.LONG(m + 4 * e) / g.LONG(m + 4 * e + 4);
                        break;

                      case 9:
                        for (m = g.LONG(m) + k.tiffHeader, e = 0; i > e; e++) p[e] = g.SLONG(m + 4 * e);
                        break;

                      case 10:
                        for (m = g.LONG(m) + k.tiffHeader, e = 0; i > e; e++) p[e] = g.SLONG(m + 4 * e) / g.SLONG(m + 4 * e + 4);
                        break;

                      default:
                        continue;
                    }
                    n = 1 == i ? p[0] : p, q[f] = j.hasOwnProperty(f) && "object" != typeof n ? j[f][n] : n;
                }
                return q;
            }
            function e() {
                var a = k.tiffHeader;
                return g.II(18761 == g.SHORT(a)), 42 !== g.SHORT(a += 2) ? !1 : (k.IFD0 = k.tiffHeader + g.LONG(a += 2), 
                i = d(k.IFD0, h.tiff), "ExifIFDPointer" in i && (k.exifIFD = k.tiffHeader + i.ExifIFDPointer, 
                delete i.ExifIFDPointer), "GPSInfoIFDPointer" in i && (k.gpsIFD = k.tiffHeader + i.GPSInfoIFDPointer, 
                delete i.GPSInfoIFDPointer), !0);
            }
            function f(a, b, c) {
                var d, e, f, i = 0;
                if ("string" == typeof b) {
                    var j = h[a.toLowerCase()];
                    for (var l in j) if (j[l] === b) {
                        b = l;
                        break;
                    }
                }
                d = k[a.toLowerCase() + "IFD"], e = g.SHORT(d);
                for (var m = 0; e > m; m++) if (f = d + 12 * m + 2, g.SHORT(f) == b) {
                    i = f + 8;
                    break;
                }
                return i ? (g.LONG(i, c), !0) : !1;
            }
            var g, h, i, j, k = {};
            return g = new c(), h = {
                tiff: {
                    274: "Orientation",
                    270: "ImageDescription",
                    271: "Make",
                    272: "Model",
                    305: "Software",
                    34665: "ExifIFDPointer",
                    34853: "GPSInfoIFDPointer"
                },
                exif: {
                    36864: "ExifVersion",
                    40961: "ColorSpace",
                    40962: "PixelXDimension",
                    40963: "PixelYDimension",
                    36867: "DateTimeOriginal",
                    33434: "ExposureTime",
                    33437: "FNumber",
                    34855: "ISOSpeedRatings",
                    37377: "ShutterSpeedValue",
                    37378: "ApertureValue",
                    37383: "MeteringMode",
                    37384: "LightSource",
                    37385: "Flash",
                    37386: "FocalLength",
                    41986: "ExposureMode",
                    41987: "WhiteBalance",
                    41990: "SceneCaptureType",
                    41988: "DigitalZoomRatio",
                    41992: "Contrast",
                    41993: "Saturation",
                    41994: "Sharpness"
                },
                gps: {
                    0: "GPSVersionID",
                    1: "GPSLatitudeRef",
                    2: "GPSLatitude",
                    3: "GPSLongitudeRef",
                    4: "GPSLongitude"
                }
            }, j = {
                ColorSpace: {
                    1: "sRGB",
                    0: "Uncalibrated"
                },
                MeteringMode: {
                    0: "Unknown",
                    1: "Average",
                    2: "CenterWeightedAverage",
                    3: "Spot",
                    4: "MultiSpot",
                    5: "Pattern",
                    6: "Partial",
                    255: "Other"
                },
                LightSource: {
                    1: "Daylight",
                    2: "Fliorescent",
                    3: "Tungsten",
                    4: "Flash",
                    9: "Fine weather",
                    10: "Cloudy weather",
                    11: "Shade",
                    12: "Daylight fluorescent (D 5700 - 7100K)",
                    13: "Day white fluorescent (N 4600 -5400K)",
                    14: "Cool white fluorescent (W 3900 - 4500K)",
                    15: "White fluorescent (WW 3200 - 3700K)",
                    17: "Standard light A",
                    18: "Standard light B",
                    19: "Standard light C",
                    20: "D55",
                    21: "D65",
                    22: "D75",
                    23: "D50",
                    24: "ISO studio tungsten",
                    255: "Other"
                },
                Flash: {
                    0: "Flash did not fire.",
                    1: "Flash fired.",
                    5: "Strobe return light not detected.",
                    7: "Strobe return light detected.",
                    9: "Flash fired, compulsory flash mode",
                    13: "Flash fired, compulsory flash mode, return light not detected",
                    15: "Flash fired, compulsory flash mode, return light detected",
                    16: "Flash did not fire, compulsory flash mode",
                    24: "Flash did not fire, auto mode",
                    25: "Flash fired, auto mode",
                    29: "Flash fired, auto mode, return light not detected",
                    31: "Flash fired, auto mode, return light detected",
                    32: "No flash function",
                    65: "Flash fired, red-eye reduction mode",
                    69: "Flash fired, red-eye reduction mode, return light not detected",
                    71: "Flash fired, red-eye reduction mode, return light detected",
                    73: "Flash fired, compulsory flash mode, red-eye reduction mode",
                    77: "Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",
                    79: "Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",
                    89: "Flash fired, auto mode, red-eye reduction mode",
                    93: "Flash fired, auto mode, return light not detected, red-eye reduction mode",
                    95: "Flash fired, auto mode, return light detected, red-eye reduction mode"
                },
                ExposureMode: {
                    0: "Auto exposure",
                    1: "Manual exposure",
                    2: "Auto bracket"
                },
                WhiteBalance: {
                    0: "Auto white balance",
                    1: "Manual white balance"
                },
                SceneCaptureType: {
                    0: "Standard",
                    1: "Landscape",
                    2: "Portrait",
                    3: "Night scene"
                },
                Contrast: {
                    0: "Normal",
                    1: "Soft",
                    2: "Hard"
                },
                Saturation: {
                    0: "Normal",
                    1: "Low saturation",
                    2: "High saturation"
                },
                Sharpness: {
                    0: "Normal",
                    1: "Soft",
                    2: "Hard"
                },
                GPSLatitudeRef: {
                    N: "North latitude",
                    S: "South latitude"
                },
                GPSLongitudeRef: {
                    E: "East longitude",
                    W: "West longitude"
                }
            }, {
                init: function(a) {
                    return k = {
                        tiffHeader: 10
                    }, a !== b && a.length ? (g.init(a), 65505 === g.SHORT(0) && "EXIF\x00" === g.STRING(4, 5).toUpperCase() ? e() : !1) : !1;
                },
                TIFF: function() {
                    return i;
                },
                EXIF: function() {
                    var b;
                    if (b = d(k.exifIFD, h.exif), b.ExifVersion && "array" === a.typeOf(b.ExifVersion)) {
                        for (var c = 0, e = ""; c < b.ExifVersion.length; c++) e += String.fromCharCode(b.ExifVersion[c]);
                        b.ExifVersion = e;
                    }
                    return b;
                },
                GPS: function() {
                    var b;
                    return b = d(k.gpsIFD, h.gps), b.GPSVersionID && "array" === a.typeOf(b.GPSVersionID) && (b.GPSVersionID = b.GPSVersionID.join(".")), 
                    b;
                },
                setExif: function(a, b) {
                    return "PixelXDimension" !== a && "PixelYDimension" !== a ? !1 : f("exif", a, b);
                },
                getBinary: function() {
                    return g.SEGMENT();
                },
                purge: function() {
                    g.init(null), g = i = null, k = {};
                }
            };
        };
    }), d(N, [ h, m, L, K, M ], function(a, b, c, d, e) {
        function f(f) {
            function g() {
                for (var a, b, c = 0; c <= i.length; ) {
                    if (a = j.SHORT(c += 2), a >= 65472 && 65475 >= a) return c += 5, {
                        height: j.SHORT(c),
                        width: j.SHORT(c += 2)
                    };
                    b = j.SHORT(c += 2), c += b - 2;
                }
                return null;
            }
            function h() {
                l && k && j && (l.purge(), k.purge(), j.init(null), i = m = k = l = j = null);
            }
            var i, j, k, l, m, n;
            if (i = f, j = new d(), j.init(i), 65496 !== j.SHORT(0)) throw new b.ImageError(b.ImageError.WRONG_FORMAT);
            k = new c(f), l = new e(), n = !!l.init(k.get("app1")[0]), m = g.call(this), a.extend(this, {
                type: "image/jpeg",
                size: i.length,
                width: m && m.width || 0,
                height: m && m.height || 0,
                setExif: function(b, c) {
                    return n ? ("object" === a.typeOf(b) ? a.each(b, function(a, b) {
                        l.setExif(b, a);
                    }) : l.setExif(b, c), void k.set("app1", l.getBinary())) : !1;
                },
                writeHeaders: function() {
                    return arguments.length ? k.restore(arguments[0]) : i = k.restore(i);
                },
                stripHeaders: function(a) {
                    return k.strip(a);
                },
                purge: function() {
                    h.call(this);
                }
            }), n && (this.meta = {
                tiff: l.TIFF(),
                exif: l.EXIF(),
                gps: l.GPS()
            });
        }
        return f;
    }), d(O, [ m, h, K ], function(a, b, c) {
        function d(d) {
            function e() {
                var a, b;
                return a = g.call(this, 8), "IHDR" == a.type ? (b = a.start, {
                    width: i.LONG(b),
                    height: i.LONG(b += 4)
                }) : null;
            }
            function f() {
                i && (i.init(null), h = l = j = k = i = null);
            }
            function g(a) {
                var b, c, d, e;
                return b = i.LONG(a), c = i.STRING(a += 4, 4), d = a += 4, e = i.LONG(a + b), {
                    length: b,
                    type: c,
                    start: d,
                    CRC: e
                };
            }
            var h, i, j, k, l;
            h = d, i = new c(), i.init(h), function() {
                var b = 0, c = 0, d = [ 35152, 20039, 3338, 6666 ];
                for (c = 0; c < d.length; c++, b += 2) if (d[c] != i.SHORT(b)) throw new a.ImageError(a.ImageError.WRONG_FORMAT);
            }(), l = e.call(this), b.extend(this, {
                type: "image/png",
                size: h.length,
                width: l.width,
                height: l.height,
                purge: function() {
                    f.call(this);
                }
            }), f.call(this);
        }
        return d;
    }), d(P, [ h, m, N, O ], function(a, b, c, d) {
        return function(e) {
            var f, g = [ c, d ];
            f = function() {
                for (var a = 0; a < g.length; a++) try {
                    return new g[a](e);
                } catch (c) {}
                throw new b.ImageError(b.ImageError.WRONG_FORMAT);
            }(), a.extend(this, {
                type: "",
                size: 0,
                width: 0,
                height: 0,
                setExif: function() {},
                writeHeaders: function(a) {
                    return a;
                },
                stripHeaders: function(a) {
                    return a;
                },
                purge: function() {}
            }), a.extend(this, f), this.purge = function() {
                f.purge(), f = null;
            };
        };
    }), d(Q, [], function() {
        function a(a, d, e) {
            var f = a.naturalWidth, g = a.naturalHeight, h = e.width, i = e.height, j = e.x || 0, k = e.y || 0, l = d.getContext("2d");
            b(a) && (f /= 2, g /= 2);
            var m = 1024, n = document.createElement("canvas");
            n.width = n.height = m;
            for (var o = n.getContext("2d"), p = c(a, f, g), q = 0; g > q; ) {
                for (var r = q + m > g ? g - q : m, s = 0; f > s; ) {
                    var t = s + m > f ? f - s : m;
                    o.clearRect(0, 0, m, m), o.drawImage(a, -s, -q);
                    var u = s * h / f + j << 0, v = Math.ceil(t * h / f), w = q * i / g / p + k << 0, x = Math.ceil(r * i / g / p);
                    l.drawImage(n, 0, 0, t, r, u, w, v, x), s += m;
                }
                q += m;
            }
            n = o = null;
        }
        function b(a) {
            var b = a.naturalWidth, c = a.naturalHeight;
            if (b * c > 1048576) {
                var d = document.createElement("canvas");
                d.width = d.height = 1;
                var e = d.getContext("2d");
                return e.drawImage(a, -b + 1, 0), 0 === e.getImageData(0, 0, 1, 1).data[3];
            }
            return !1;
        }
        function c(a, b, c) {
            var d = document.createElement("canvas");
            d.width = 1, d.height = c;
            var e = d.getContext("2d");
            e.drawImage(a, 0, 0);
            for (var f = e.getImageData(0, 0, 1, c).data, g = 0, h = c, i = c; i > g; ) {
                var j = f[4 * (i - 1) + 3];
                0 === j ? h = i : g = i, i = h + g >> 1;
            }
            d = null;
            var k = i / c;
            return 0 === k ? 1 : k;
        }
        return {
            isSubsampled: b,
            renderTo: a
        };
    }), d(R, [ D, h, m, o, s, P, Q, j, k ], function(a, b, c, d, e, f, g, h, i) {
        function j() {
            function a() {
                if (!t && !r) throw new c.ImageError(c.DOMException.INVALID_STATE_ERR);
                return t || r;
            }
            function j(a) {
                return d.atob(a.substring(a.indexOf("base64,") + 7));
            }
            function k(a, b) {
                return "data:" + (b || "") + ";base64," + d.btoa(a);
            }
            function l(a) {
                var b = this;
                r = new Image(), r.onerror = function() {
                    q.call(this), b.trigger("error", new c.ImageError(c.ImageError.WRONG_FORMAT));
                }, r.onload = function() {
                    b.trigger("load");
                }, r.src = /^data:[^;]*;base64,/.test(a) ? a : k(a, v.type);
            }
            function m(a, b) {
                var d, e = this;
                return window.FileReader ? (d = new FileReader(), d.onload = function() {
                    b(this.result);
                }, d.onerror = function() {
                    e.trigger("error", new c.FileException(c.FileException.NOT_READABLE_ERR));
                }, void d.readAsDataURL(a)) : b(a.getAsDataURL());
            }
            function n(c, d, e, f) {
                var g, h, i, j, k, l, m = this, n = 0, q = 0;
                if (y = f, l = this.meta && this.meta.tiff && this.meta.tiff.Orientation || 1, -1 !== b.inArray(l, [ 5, 6, 7, 8 ])) {
                    var r = c;
                    c = d, d = r;
                }
                return i = a(), h = e ? Math.max : Math.min, g = h(c / i.width, d / i.height), g > 1 && (!e || f) ? void this.trigger("Resize") : (t || (t = document.createElement("canvas")), 
                j = Math.round(i.width * g), k = Math.round(i.height * g), e ? (t.width = c, t.height = d, 
                j > c && (n = Math.round((j - c) / 2)), k > d && (q = Math.round((k - d) / 2))) : (t.width = j, 
                t.height = k), y || p(t.width, t.height, l), o.call(this, i, t, -n, -q, j, k), this.width = t.width, 
                this.height = t.height, x = !0, void m.trigger("Resize"));
            }
            function o(a, b, c, d, e, f) {
                if ("iOS" === i.OS) g.renderTo(a, b, {
                    width: e,
                    height: f,
                    x: c,
                    y: d
                }); else {
                    var h = b.getContext("2d");
                    h.drawImage(a, c, d, e, f);
                }
            }
            function p(a, b, c) {
                switch (c) {
                  case 5:
                  case 6:
                  case 7:
                  case 8:
                    t.width = b, t.height = a;
                    break;

                  default:
                    t.width = a, t.height = b;
                }
                var d = t.getContext("2d");
                switch (c) {
                  case 2:
                    d.translate(a, 0), d.scale(-1, 1);
                    break;

                  case 3:
                    d.translate(a, b), d.rotate(Math.PI);
                    break;

                  case 4:
                    d.translate(0, b), d.scale(1, -1);
                    break;

                  case 5:
                    d.rotate(.5 * Math.PI), d.scale(1, -1);
                    break;

                  case 6:
                    d.rotate(.5 * Math.PI), d.translate(0, -b);
                    break;

                  case 7:
                    d.rotate(.5 * Math.PI), d.translate(a, -b), d.scale(-1, 1);
                    break;

                  case 8:
                    d.rotate(-.5 * Math.PI), d.translate(-a, 0);
                }
            }
            function q() {
                s && (s.purge(), s = null), u = r = t = v = null, x = !1;
            }
            var r, s, t, u, v, w = this, x = !1, y = !0;
            b.extend(this, {
                loadFromBlob: function(a) {
                    var b = this, d = b.getRuntime(), e = arguments.length > 1 ? arguments[1] : !0;
                    if (!d.can("access_binary")) throw new c.RuntimeError(c.RuntimeError.NOT_SUPPORTED_ERR);
                    return v = a, a.isDetached() ? (u = a.getSource(), void l.call(this, u)) : void m.call(this, a.getSource(), function(a) {
                        e && (u = j(a)), l.call(b, a);
                    });
                },
                loadFromImage: function(a, b) {
                    this.meta = a.meta, v = new e(null, {
                        name: a.name,
                        size: a.size,
                        type: a.type
                    }), l.call(this, b ? u = a.getAsBinaryString() : a.getAsDataURL());
                },
                getInfo: function() {
                    var b, c = this.getRuntime();
                    return !s && u && c.can("access_image_binary") && (s = new f(u)), b = {
                        width: a().width || 0,
                        height: a().height || 0,
                        type: v.type || h.getFileMime(v.name),
                        size: u && u.length || v.size || 0,
                        name: v.name || "",
                        meta: s && s.meta || this.meta || {}
                    };
                },
                downsize: function() {
                    n.apply(this, arguments);
                },
                getAsCanvas: function() {
                    return t && (t.id = this.uid + "_canvas"), t;
                },
                getAsBlob: function(a, b) {
                    return a !== this.type && n.call(this, this.width, this.height, !1), new e(null, {
                        name: v.name || "",
                        type: a,
                        data: w.getAsBinaryString.call(this, a, b)
                    });
                },
                getAsDataURL: function(a) {
                    var b = arguments[1] || 90;
                    if (!x) return r.src;
                    if ("image/jpeg" !== a) return t.toDataURL("image/png");
                    try {
                        return t.toDataURL("image/jpeg", b / 100);
                    } catch (c) {
                        return t.toDataURL("image/jpeg");
                    }
                },
                getAsBinaryString: function(a, b) {
                    if (!x) return u || (u = j(w.getAsDataURL(a, b))), u;
                    if ("image/jpeg" !== a) u = j(w.getAsDataURL(a, b)); else {
                        var c;
                        b || (b = 90);
                        try {
                            c = t.toDataURL("image/jpeg", b / 100);
                        } catch (d) {
                            c = t.toDataURL("image/jpeg");
                        }
                        u = j(c), s && (u = s.stripHeaders(u), y && (s.meta && s.meta.exif && s.setExif({
                            PixelXDimension: this.width,
                            PixelYDimension: this.height
                        }), u = s.writeHeaders(u)), s.purge(), s = null);
                    }
                    return x = !1, u;
                },
                destroy: function() {
                    w = null, q.call(this), this.getRuntime().getShim().removeInstance(this.uid);
                }
            });
        }
        return a.Image = j;
    }), d(S, [ h, k, l, m, p ], function(a, b, c, d, e) {
        function f() {
            var a;
            try {
                a = navigator.plugins["Shockwave Flash"], a = a.description;
            } catch (b) {
                try {
                    a = new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version");
                } catch (c) {
                    a = "0.0";
                }
            }
            return a = a.match(/\d+/g), parseFloat(a[0] + "." + a[1]);
        }
        function g(g) {
            var j, k = this;
            g = a.extend({
                swf_url: b.swf_url
            }, g), e.call(this, g, h, {
                access_binary: function(a) {
                    return a && "browser" === k.mode;
                },
                access_image_binary: function(a) {
                    return a && "browser" === k.mode;
                },
                display_media: e.capTrue,
                do_cors: e.capTrue,
                drag_and_drop: !1,
                report_upload_progress: function() {
                    return "client" === k.mode;
                },
                resize_image: e.capTrue,
                return_response_headers: !1,
                return_response_type: function(b) {
                    return "json" === b && window.JSON ? !0 : !a.arrayDiff(b, [ "", "text", "document" ]) || "browser" === k.mode;
                },
                return_status_code: function(b) {
                    return "browser" === k.mode || !a.arrayDiff(b, [ 200, 404 ]);
                },
                select_file: e.capTrue,
                select_multiple: e.capTrue,
                send_binary_string: function(a) {
                    return a && "browser" === k.mode;
                },
                send_browser_cookies: function(a) {
                    return a && "browser" === k.mode;
                },
                send_custom_headers: function(a) {
                    return a && "browser" === k.mode;
                },
                send_multipart: e.capTrue,
                slice_blob: e.capTrue,
                stream_upload: function(a) {
                    return a && "browser" === k.mode;
                },
                summon_file_dialog: !1,
                upload_filesize: function(b) {
                    return a.parseSizeStr(b) <= 2097152 || "client" === k.mode;
                },
                use_http_method: function(b) {
                    return !a.arrayDiff(b, [ "GET", "POST" ]);
                }
            }, {
                access_binary: function(a) {
                    return a ? "browser" : "client";
                },
                access_image_binary: function(a) {
                    return a ? "browser" : "client";
                },
                report_upload_progress: function(a) {
                    return a ? "browser" : "client";
                },
                return_response_type: function(b) {
                    return a.arrayDiff(b, [ "", "text", "json", "document" ]) ? "browser" : [ "client", "browser" ];
                },
                return_status_code: function(b) {
                    return a.arrayDiff(b, [ 200, 404 ]) ? "browser" : [ "client", "browser" ];
                },
                send_binary_string: function(a) {
                    return a ? "browser" : "client";
                },
                send_browser_cookies: function(a) {
                    return a ? "browser" : "client";
                },
                send_custom_headers: function(a) {
                    return a ? "browser" : "client";
                },
                stream_upload: function(a) {
                    return a ? "client" : "browser";
                },
                upload_filesize: function(b) {
                    return a.parseSizeStr(b) >= 2097152 ? "client" : "browser";
                }
            }, "client"), f() < 10 && (this.mode = !1), a.extend(this, {
                getShim: function() {
                    return c.get(this.uid);
                },
                shimExec: function(a, b) {
                    var c = [].slice.call(arguments, 2);
                    return k.getShim().exec(this.uid, a, b, c);
                },
                init: function() {
                    var c, e, f;
                    f = this.getShimContainer(), a.extend(f.style, {
                        position: "absolute",
                        top: "-8px",
                        left: "-8px",
                        width: "9px",
                        height: "9px",
                        overflow: "hidden"
                    }), c = '<object id="' + this.uid + '" type="application/x-shockwave-flash" data="' + g.swf_url + '" ', 
                    "IE" === b.browser && (c += 'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '), 
                    c += 'width="100%" height="100%" style="outline:0"><param name="movie" value="' + g.swf_url + '" /><param name="flashvars" value="uid=' + escape(this.uid) + "&target=" + b.global_event_dispatcher + '" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>', 
                    "IE" === b.browser ? (e = document.createElement("div"), f.appendChild(e), e.outerHTML = c, 
                    e = f = null) : f.innerHTML = c, j = setTimeout(function() {
                        k && !k.initialized && k.trigger("Error", new d.RuntimeError(d.RuntimeError.NOT_INIT_ERR));
                    }, 5e3);
                },
                destroy: function(a) {
                    return function() {
                        a.call(k), clearTimeout(j), g = j = a = k = null;
                    };
                }(this.destroy)
            }, i);
        }
        var h = "flash", i = {};
        return e.addConstructor(h, g), i;
    }), d(T, [ S, r ], function(a, b) {
        var c = {
            slice: function(a, c, d, e) {
                var f = this.getRuntime();
                return 0 > c ? c = Math.max(a.size + c, 0) : c > 0 && (c = Math.min(c, a.size)), 
                0 > d ? d = Math.max(a.size + d, 0) : d > 0 && (d = Math.min(d, a.size)), a = f.shimExec.call(this, "Blob", "slice", c, d, e || ""), 
                a && (a = new b(f.uid, a)), a;
            }
        };
        return a.Blob = c;
    }), d(U, [ S ], function(a) {
        var b = {
            init: function(a) {
                this.getRuntime().shimExec.call(this, "FileInput", "init", {
                    name: a.name,
                    accept: a.accept,
                    multiple: a.multiple
                }), this.trigger("ready");
            }
        };
        return a.FileInput = b;
    }), d(V, [ S, o ], function(a, b) {
        function c(a, c) {
            switch (c) {
              case "readAsText":
                return b.atob(a, "utf8");

              case "readAsBinaryString":
                return b.atob(a);

              case "readAsDataURL":
                return a;
            }
            return null;
        }
        var d = "", e = {
            read: function(a, b) {
                var e = this, f = e.getRuntime();
                return "readAsDataURL" === a && (d = "data:" + (b.type || "") + ";base64,"), e.bind("Progress", function(b, e) {
                    e && (d += c(e, a));
                }), f.shimExec.call(this, "FileReader", "readAsBase64", b.uid);
            },
            getResult: function() {
                return d;
            },
            destroy: function() {
                d = null;
            }
        };
        return a.FileReader = e;
    }), d(W, [ S, o ], function(a, b) {
        function c(a, c) {
            switch (c) {
              case "readAsText":
                return b.atob(a, "utf8");

              case "readAsBinaryString":
                return b.atob(a);

              case "readAsDataURL":
                return a;
            }
            return null;
        }
        var d = {
            read: function(a, b) {
                var d, e = this.getRuntime();
                return (d = e.shimExec.call(this, "FileReaderSync", "readAsBase64", b.uid)) ? ("readAsDataURL" === a && (d = "data:" + (b.type || "") + ";base64," + d), 
                c(d, a, b.type)) : null;
            }
        };
        return a.FileReaderSync = d;
    }), d(X, [ S, h, r, s, y, z, B ], function(a, b, c, d, e, f, g) {
        var h = {
            send: function(a, d) {
                function e() {
                    a.transport = k.mode, k.shimExec.call(j, "XMLHttpRequest", "send", a, d);
                }
                function h(a, b) {
                    k.shimExec.call(j, "XMLHttpRequest", "appendBlob", a, b.uid), d = null, e();
                }
                function i(a, b) {
                    var c = new g();
                    c.bind("TransportingComplete", function() {
                        b(this.result);
                    }), c.transport(a.getSource(), a.type, {
                        ruid: k.uid
                    });
                }
                var j = this, k = j.getRuntime();
                if (b.isEmptyObj(a.headers) || b.each(a.headers, function(a, b) {
                    k.shimExec.call(j, "XMLHttpRequest", "setRequestHeader", b, a.toString());
                }), d instanceof f) {
                    var l;
                    if (d.each(function(a, b) {
                        a instanceof c ? l = b : k.shimExec.call(j, "XMLHttpRequest", "append", b, a);
                    }), d.hasBlob()) {
                        var m = d.getBlob();
                        m.isDetached() ? i(m, function(a) {
                            m.destroy(), h(l, a);
                        }) : h(l, m);
                    } else d = null, e();
                } else d instanceof c ? d.isDetached() ? i(d, function(a) {
                    d.destroy(), d = a.uid, e();
                }) : (d = d.uid, e()) : e();
            },
            getResponse: function(a) {
                var c, f, g = this.getRuntime();
                if (f = g.shimExec.call(this, "XMLHttpRequest", "getResponseAsBlob")) {
                    if (f = new d(g.uid, f), "blob" === a) return f;
                    try {
                        if (c = new e(), ~b.inArray(a, [ "", "text" ])) return c.readAsText(f);
                        if ("json" === a && window.JSON) return JSON.parse(c.readAsText(f));
                    } finally {
                        f.destroy();
                    }
                }
                return null;
            },
            abort: function() {
                var a = this.getRuntime();
                a.shimExec.call(this, "XMLHttpRequest", "abort"), this.dispatchEvent("readystatechange"), 
                this.dispatchEvent("abort");
            }
        };
        return a.XMLHttpRequest = h;
    }), d(Y, [ S, r ], function(a, b) {
        var c = {
            getAsBlob: function(a) {
                var c = this.getRuntime(), d = c.shimExec.call(this, "Transporter", "getAsBlob", a);
                return d ? new b(c.uid, d) : null;
            }
        };
        return a.Transporter = c;
    }), d(Z, [ S, h, B, r, y ], function(a, b, c, d, e) {
        var f = {
            loadFromBlob: function(a) {
                function b(a) {
                    e.shimExec.call(d, "Image", "loadFromBlob", a.uid), d = e = null;
                }
                var d = this, e = d.getRuntime();
                if (a.isDetached()) {
                    var f = new c();
                    f.bind("TransportingComplete", function() {
                        b(f.result.getSource());
                    }), f.transport(a.getSource(), a.type, {
                        ruid: e.uid
                    });
                } else b(a.getSource());
            },
            loadFromImage: function(a) {
                var b = this.getRuntime();
                return b.shimExec.call(this, "Image", "loadFromImage", a.uid);
            },
            getAsBlob: function(a, b) {
                var c = this.getRuntime(), e = c.shimExec.call(this, "Image", "getAsBlob", a, b);
                return e ? new d(c.uid, e) : null;
            },
            getAsDataURL: function() {
                var a, b = this.getRuntime(), c = b.Image.getAsBlob.apply(this, arguments);
                return c ? (a = new e(), a.readAsDataURL(c)) : null;
            }
        };
        return a.Image = f;
    }), d($, [ h, k, l, m, p ], function(a, b, c, d, e) {
        function f(a) {
            var b, c, d, e, f, g = !1, h = null, i = 0;
            try {
                try {
                    h = new ActiveXObject("AgControl.AgControl"), h.IsVersionSupported(a) && (g = !0), 
                    h = null;
                } catch (j) {
                    var k = navigator.plugins["Silverlight Plug-In"];
                    if (k) {
                        for (b = k.description, "1.0.30226.2" === b && (b = "2.0.30226.2"), c = b.split("."); c.length > 3; ) c.pop();
                        for (;c.length < 4; ) c.push(0);
                        for (d = a.split("."); d.length > 4; ) d.pop();
                        do e = parseInt(d[i], 10), f = parseInt(c[i], 10), i++; while (i < d.length && e === f);
                        f >= e && !isNaN(e) && (g = !0);
                    }
                }
            } catch (l) {
                g = !1;
            }
            return g;
        }
        function g(g) {
            var j, k = this;
            g = a.extend({
                xap_url: b.xap_url
            }, g), e.call(this, g, h, {
                access_binary: e.capTrue,
                access_image_binary: e.capTrue,
                display_media: e.capTrue,
                do_cors: e.capTrue,
                drag_and_drop: !1,
                report_upload_progress: e.capTrue,
                resize_image: e.capTrue,
                return_response_headers: function(a) {
                    return a && "client" === k.mode;
                },
                return_response_type: function(a) {
                    return "json" !== a ? !0 : !!window.JSON;
                },
                return_status_code: function(b) {
                    return "client" === k.mode || !a.arrayDiff(b, [ 200, 404 ]);
                },
                select_file: e.capTrue,
                select_multiple: e.capTrue,
                send_binary_string: e.capTrue,
                send_browser_cookies: function(a) {
                    return a && "browser" === k.mode;
                },
                send_custom_headers: function(a) {
                    return a && "client" === k.mode;
                },
                send_multipart: e.capTrue,
                slice_blob: e.capTrue,
                stream_upload: !0,
                summon_file_dialog: !1,
                upload_filesize: e.capTrue,
                use_http_method: function(b) {
                    return "client" === k.mode || !a.arrayDiff(b, [ "GET", "POST" ]);
                }
            }, {
                return_response_headers: function(a) {
                    return a ? "client" : "browser";
                },
                return_status_code: function(b) {
                    return a.arrayDiff(b, [ 200, 404 ]) ? "client" : [ "client", "browser" ];
                },
                send_browser_cookies: function(a) {
                    return a ? "browser" : "client";
                },
                send_custom_headers: function(a) {
                    return a ? "client" : "browser";
                },
                use_http_method: function(b) {
                    return a.arrayDiff(b, [ "GET", "POST" ]) ? "client" : [ "client", "browser" ];
                }
            }), f("2.0.31005.0") && "Opera" !== b.browser || (this.mode = !1), a.extend(this, {
                getShim: function() {
                    return c.get(this.uid).content.Moxie;
                },
                shimExec: function(a, b) {
                    var c = [].slice.call(arguments, 2);
                    return k.getShim().exec(this.uid, a, b, c);
                },
                init: function() {
                    var a;
                    a = this.getShimContainer(), a.innerHTML = '<object id="' + this.uid + '" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="' + g.xap_url + '"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid=' + this.uid + ",target=" + b.global_event_dispatcher + '"/></object>', 
                    j = setTimeout(function() {
                        k && !k.initialized && k.trigger("Error", new d.RuntimeError(d.RuntimeError.NOT_INIT_ERR));
                    }, "Windows" !== b.OS ? 1e4 : 5e3);
                },
                destroy: function(a) {
                    return function() {
                        a.call(k), clearTimeout(j), g = j = a = k = null;
                    };
                }(this.destroy)
            }, i);
        }
        var h = "silverlight", i = {};
        return e.addConstructor(h, g), i;
    }), d(_, [ $, h, T ], function(a, b, c) {
        return a.Blob = b.extend({}, c);
    }), d(ab, [ $ ], function(a) {
        var b = {
            init: function(a) {
                function b(a) {
                    for (var b = "", c = 0; c < a.length; c++) b += ("" !== b ? "|" : "") + a[c].title + " | *." + a[c].extensions.replace(/,/g, ";*.");
                    return b;
                }
                this.getRuntime().shimExec.call(this, "FileInput", "init", b(a.accept), a.name, a.multiple), 
                this.trigger("ready");
            }
        };
        return a.FileInput = b;
    }), d(bb, [ $, l, F ], function(a, b, c) {
        var d = {
            init: function() {
                var a, d = this, e = d.getRuntime();
                return a = e.getShimContainer(), c.addEvent(a, "dragover", function(a) {
                    a.preventDefault(), a.stopPropagation(), a.dataTransfer.dropEffect = "copy";
                }, d.uid), c.addEvent(a, "dragenter", function(a) {
                    a.preventDefault();
                    var c = b.get(e.uid).dragEnter(a);
                    c && a.stopPropagation();
                }, d.uid), c.addEvent(a, "drop", function(a) {
                    a.preventDefault();
                    var c = b.get(e.uid).dragDrop(a);
                    c && a.stopPropagation();
                }, d.uid), e.shimExec.call(this, "FileDrop", "init");
            }
        };
        return a.FileDrop = d;
    }), d(cb, [ $, h, V ], function(a, b, c) {
        return a.FileReader = b.extend({}, c);
    }), d(db, [ $, h, W ], function(a, b, c) {
        return a.FileReaderSync = b.extend({}, c);
    }), d(eb, [ $, h, X ], function(a, b, c) {
        return a.XMLHttpRequest = b.extend({}, c);
    }), d(fb, [ $, h, Y ], function(a, b, c) {
        return a.Transporter = b.extend({}, c);
    }), d(gb, [ $, h, Z ], function(a, b, c) {
        return a.Image = b.extend({}, c, {
            getInfo: function() {
                var a = this.getRuntime(), c = [ "tiff", "exif", "gps" ], d = {
                    meta: {}
                }, e = a.shimExec.call(this, "Image", "getInfo");
                return e.meta && b.each(c, function(a) {
                    var b, c, f, g, h = e.meta[a];
                    if (h && h.keys) for (d.meta[a] = {}, c = 0, f = h.keys.length; f > c; c++) b = h.keys[c], 
                    g = h[b], g && (/^(\d|[1-9]\d+)$/.test(g) ? g = parseInt(g, 10) : /^\d*\.\d+$/.test(g) && (g = parseFloat(g)), 
                    d.meta[a][b] = g);
                }), d.width = parseInt(e.width, 10), d.height = parseInt(e.height, 10), d.size = parseInt(e.size, 10), 
                d.type = e.type, d.name = e.name, d;
            }
        });
    }), d(hb, [ h, m, p, k ], function(a, b, c, d) {
        function e(b) {
            var e = this, h = c.capTest, i = c.capTrue;
            c.call(this, b, f, {
                access_binary: h(window.FileReader || window.File && File.getAsDataURL),
                access_image_binary: !1,
                display_media: h(g.Image && (d.can("create_canvas") || d.can("use_data_uri_over32kb"))),
                do_cors: !1,
                drag_and_drop: !1,
                filter_by_extension: h(function() {
                    return "Chrome" === d.browser && d.version >= 28 || "IE" === d.browser && d.version >= 10;
                }()),
                resize_image: function() {
                    return g.Image && e.can("access_binary") && d.can("create_canvas");
                },
                report_upload_progress: !1,
                return_response_headers: !1,
                return_response_type: function(b) {
                    return "json" === b && window.JSON ? !0 : !!~a.inArray(b, [ "text", "document", "" ]);
                },
                return_status_code: function(b) {
                    return !a.arrayDiff(b, [ 200, 404 ]);
                },
                select_file: function() {
                    return d.can("use_fileinput");
                },
                select_multiple: !1,
                send_binary_string: !1,
                send_custom_headers: !1,
                send_multipart: !0,
                slice_blob: !1,
                stream_upload: function() {
                    return e.can("select_file");
                },
                summon_file_dialog: h(function() {
                    return "Firefox" === d.browser && d.version >= 4 || "Opera" === d.browser && d.version >= 12 || !!~a.inArray(d.browser, [ "Chrome", "Safari" ]);
                }()),
                upload_filesize: i,
                use_http_method: function(b) {
                    return !a.arrayDiff(b, [ "GET", "POST" ]);
                }
            }), a.extend(this, {
                init: function() {
                    this.trigger("Init");
                },
                destroy: function(a) {
                    return function() {
                        a.call(e), a = e = null;
                    };
                }(this.destroy)
            }), a.extend(this.getShim(), g);
        }
        var f = "html4", g = {};
        return c.addConstructor(f, e), g;
    }), d(ib, [ hb, h, l, F, j, k ], function(a, b, c, d, e, f) {
        function g() {
            function a() {
                var e, k, l, m, n, o, p = this, q = p.getRuntime();
                o = b.guid("uid_"), e = q.getShimContainer(), g && (l = c.get(g + "_form"), l && b.extend(l.style, {
                    top: "100%"
                })), m = document.createElement("form"), m.setAttribute("id", o + "_form"), m.setAttribute("method", "post"), 
                m.setAttribute("enctype", "multipart/form-data"), m.setAttribute("encoding", "multipart/form-data"), 
                b.extend(m.style, {
                    overflow: "hidden",
                    position: "absolute",
                    top: 0,
                    left: 0,
                    width: "100%",
                    height: "100%"
                }), n = document.createElement("input"), n.setAttribute("id", o), n.setAttribute("type", "file"), 
                n.setAttribute("name", h.name || "Filedata"), n.setAttribute("accept", j.join(",")), 
                b.extend(n.style, {
                    fontSize: "999px",
                    opacity: 0
                }), m.appendChild(n), e.appendChild(m), b.extend(n.style, {
                    position: "absolute",
                    top: 0,
                    left: 0,
                    width: "100%",
                    height: "100%"
                }), "IE" === f.browser && f.version < 10 && b.extend(n.style, {
                    filter: "progid:DXImageTransform.Microsoft.Alpha(opacity=0)"
                }), n.onchange = function() {
                    var b;
                    this.value && (b = this.files ? this.files[0] : {
                        name: this.value
                    }, i = [ b ], this.onchange = function() {}, a.call(p), p.bind("change", function d() {
                        var a, b = c.get(o), e = c.get(o + "_form");
                        p.unbind("change", d), p.files.length && b && e && (a = p.files[0], b.setAttribute("id", a.uid), 
                        e.setAttribute("id", a.uid + "_form"), e.setAttribute("target", a.uid + "_iframe")), 
                        b = e = null;
                    }, 998), n = m = null, p.trigger("change"));
                }, q.can("summon_file_dialog") && (k = c.get(h.browse_button), d.removeEvent(k, "click", p.uid), 
                d.addEvent(k, "click", function(a) {
                    n && !n.disabled && n.click(), a.preventDefault();
                }, p.uid)), g = o, e = l = k = null;
            }
            var g, h, i = [], j = [];
            b.extend(this, {
                init: function(b) {
                    var f, g = this, i = g.getRuntime();
                    h = b, j = b.accept.mimes || e.extList2mimes(b.accept, i.can("filter_by_extension")), 
                    f = i.getShimContainer(), function() {
                        var a, e, h;
                        a = c.get(b.browse_button), i.can("summon_file_dialog") && ("static" === c.getStyle(a, "position") && (a.style.position = "relative"), 
                        e = parseInt(c.getStyle(a, "z-index"), 10) || 1, a.style.zIndex = e, f.style.zIndex = e - 1), 
                        h = i.can("summon_file_dialog") ? a : f, d.addEvent(h, "mouseover", function() {
                            g.trigger("mouseenter");
                        }, g.uid), d.addEvent(h, "mouseout", function() {
                            g.trigger("mouseleave");
                        }, g.uid), d.addEvent(h, "mousedown", function() {
                            g.trigger("mousedown");
                        }, g.uid), d.addEvent(c.get(b.container), "mouseup", function() {
                            g.trigger("mouseup");
                        }, g.uid), a = null;
                    }(), a.call(this), f = null, g.trigger({
                        type: "ready",
                        async: !0
                    });
                },
                getFiles: function() {
                    return i;
                },
                disable: function(a) {
                    var b;
                    (b = c.get(g)) && (b.disabled = !!a);
                },
                destroy: function() {
                    var a = this.getRuntime(), b = a.getShim(), e = a.getShimContainer();
                    d.removeAllEvents(e, this.uid), d.removeAllEvents(h && c.get(h.container), this.uid), 
                    d.removeAllEvents(h && c.get(h.browse_button), this.uid), e && (e.innerHTML = ""), 
                    b.removeInstance(this.uid), g = i = j = h = e = b = null;
                }
            });
        }
        return a.FileInput = g;
    }), d(jb, [ hb, I ], function(a, b) {
        return a.FileReader = b;
    }), d(kb, [ hb, h, l, x, m, F, r, z ], function(a, b, c, d, e, f, g, h) {
        function i() {
            function a(a) {
                var b, d, e, g, h = this, i = !1;
                if (k) {
                    if (b = k.id.replace(/_iframe$/, ""), d = c.get(b + "_form")) {
                        for (e = d.getElementsByTagName("input"), g = e.length; g--; ) switch (e[g].getAttribute("type")) {
                          case "hidden":
                            e[g].parentNode.removeChild(e[g]);
                            break;

                          case "file":
                            i = !0;
                        }
                        e = [], i || d.parentNode.removeChild(d), d = null;
                    }
                    setTimeout(function() {
                        f.removeEvent(k, "load", h.uid), k.parentNode && k.parentNode.removeChild(k);
                        var b = h.getRuntime().getShimContainer();
                        b.children.length || b.parentNode.removeChild(b), b = k = null, a();
                    }, 1);
                }
            }
            var i, j, k;
            b.extend(this, {
                send: function(l, m) {
                    function n() {
                        var c = t.getShimContainer() || document.body, e = document.createElement("div");
                        e.innerHTML = '<iframe id="' + o + '_iframe" name="' + o + '_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>', 
                        k = e.firstChild, c.appendChild(k), f.addEvent(k, "load", function() {
                            var c;
                            try {
                                c = k.contentWindow.document || k.contentDocument || window.frames[k.id].document, 
                                /^4(0[0-9]|1[0-7]|2[2346])\s/.test(c.title) ? i = c.title.replace(/^(\d+).*$/, "$1") : (i = 200, 
                                j = b.trim(c.body.innerHTML), s.trigger({
                                    type: "progress",
                                    loaded: j.length,
                                    total: j.length
                                }), r && s.trigger({
                                    type: "uploadprogress",
                                    loaded: r.size || 1025,
                                    total: r.size || 1025
                                }));
                            } catch (e) {
                                if (!d.hasSameOrigin(l.url)) return void a.call(s, function() {
                                    s.trigger("error");
                                });
                                i = 404;
                            }
                            a.call(s, function() {
                                s.trigger("load");
                            });
                        }, s.uid);
                    }
                    var o, p, q, r, s = this, t = s.getRuntime();
                    if (i = j = null, m instanceof h && m.hasBlob()) {
                        if (r = m.getBlob(), o = r.uid, q = c.get(o), p = c.get(o + "_form"), !p) throw new e.DOMException(e.DOMException.NOT_FOUND_ERR);
                    } else o = b.guid("uid_"), p = document.createElement("form"), p.setAttribute("id", o + "_form"), 
                    p.setAttribute("method", l.method), p.setAttribute("enctype", "multipart/form-data"), 
                    p.setAttribute("encoding", "multipart/form-data"), p.setAttribute("target", o + "_iframe"), 
                    t.getShimContainer().appendChild(p);
                    m instanceof h && m.each(function(a, c) {
                        if (a instanceof g) q && q.setAttribute("name", c); else {
                            var d = document.createElement("input");
                            b.extend(d, {
                                type: "hidden",
                                name: c,
                                value: a
                            }), q ? p.insertBefore(d, q) : p.appendChild(d);
                        }
                    }), p.setAttribute("action", l.url), n(), p.submit(), s.trigger("loadstart");
                },
                getStatus: function() {
                    return i;
                },
                getResponse: function(a) {
                    if ("json" === a && "string" === b.typeOf(j) && window.JSON) try {
                        return JSON.parse(j.replace(/^\s*<pre[^>]*>/, "").replace(/<\/pre>\s*$/, ""));
                    } catch (c) {
                        return null;
                    }
                    return j;
                },
                abort: function() {
                    var b = this;
                    k && k.contentWindow && (k.contentWindow.stop ? k.contentWindow.stop() : k.contentWindow.document.execCommand ? k.contentWindow.document.execCommand("Stop") : k.src = "about:blank"), 
                    a.call(this, function() {
                        b.dispatchEvent("abort");
                    });
                }
            });
        }
        return a.XMLHttpRequest = i;
    }), d(lb, [ hb, R ], function(a, b) {
        return a.Image = b;
    }), f([ h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z, A, B, C, F ]);
}(this), function() {
    "use strict";
    var a = {}, b = moxie.core.utils.Basic.inArray;
    return function c(d) {
        var e, f;
        for (e in d) f = typeof d[e], "object" !== f || ~b(e, [ "Exceptions", "Env", "Mime" ]) ? "function" === f && (a[e] = d[e]) : c(d[e]);
    }(window.moxie), a.Env = window.moxie.core.utils.Env, a.Mime = window.moxie.core.utils.Mime, 
    a.Exceptions = window.moxie.core.Exceptions, window.mOxie = a, window.o || (window.o = a), 
    a;
}(), function(a, b, c) {
    function d(a) {
        function b(a, b, c) {
            var e = {
                chunks: "slice_blob",
                jpgresize: "send_binary_string",
                pngresize: "send_binary_string",
                progress: "report_upload_progress",
                multi_selection: "select_multiple",
                dragdrop: "drag_and_drop",
                drop_element: "drag_and_drop",
                headers: "send_custom_headers",
                canSendBinary: "send_binary",
                triggerDialog: "summon_file_dialog"
            };
            e[a] ? d[e[a]] = b : c || (d[a] = b);
        }
        var c = a.required_features, d = {};
        return "string" == typeof c ? g.each(c.split(/\s*,\s*/), function(a) {
            b(a, !0);
        }) : "object" == typeof c ? g.each(c, function(a, c) {
            b(c, a);
        }) : c === !0 && (a.multipart || (d.send_binary_string = !0), a.chunk_size > 0 && (d.slice_blob = !0), 
        a.resize.enabled && (d.send_binary_string = !0), g.each(a, function(a, c) {
            b(c, !!a, !0);
        })), d;
    }
    var e = a.setTimeout, f = {}, g = {
        VERSION: "2.1.1",
        STOPPED: 1,
        STARTED: 2,
        QUEUED: 1,
        UPLOADING: 2,
        FAILED: 4,
        DONE: 5,
        GENERIC_ERROR: -100,
        HTTP_ERROR: -200,
        IO_ERROR: -300,
        SECURITY_ERROR: -400,
        INIT_ERROR: -500,
        FILE_SIZE_ERROR: -600,
        FILE_EXTENSION_ERROR: -601,
        FILE_DUPLICATE_ERROR: -602,
        IMAGE_FORMAT_ERROR: -700,
        IMAGE_MEMORY_ERROR: -701,
        IMAGE_DIMENSIONS_ERROR: -702,
        mimeTypes: b.mimes,
        ua: b.ua,
        typeOf: b.typeOf,
        extend: b.extend,
        guid: b.guid,
        get: function(a) {
            var c, d = [];
            "array" !== b.typeOf(a) && (a = [ a ]);
            for (var e = a.length; e--; ) c = b.get(a[e]), c && d.push(c);
            return d.length ? d : null;
        },
        each: b.each,
        getPos: b.getPos,
        getSize: b.getSize,
        xmlEncode: function(a) {
            var b = {
                "<": "lt",
                ">": "gt",
                "&": "amp",
                '"': "quot",
                "'": "#39"
            }, c = /[<>&\"\']/g;
            return a ? ("" + a).replace(c, function(a) {
                return b[a] ? "&" + b[a] + ";" : a;
            }) : a;
        },
        toArray: b.toArray,
        inArray: b.inArray,
        addI18n: b.addI18n,
        translate: b.translate,
        isEmptyObj: b.isEmptyObj,
        hasClass: b.hasClass,
        addClass: b.addClass,
        removeClass: b.removeClass,
        getStyle: b.getStyle,
        addEvent: b.addEvent,
        removeEvent: b.removeEvent,
        removeAllEvents: b.removeAllEvents,
        cleanName: function(a) {
            var b, c;
            for (c = [ /[\300-\306]/g, "A", /[\340-\346]/g, "a", /\307/g, "C", /\347/g, "c", /[\310-\313]/g, "E", /[\350-\353]/g, "e", /[\314-\317]/g, "I", /[\354-\357]/g, "i", /\321/g, "N", /\361/g, "n", /[\322-\330]/g, "O", /[\362-\370]/g, "o", /[\331-\334]/g, "U", /[\371-\374]/g, "u" ], 
            b = 0; b < c.length; b += 2) a = a.replace(c[b], c[b + 1]);
            return a = a.replace(/\s+/g, "_"), a = a.replace(/[^a-z0-9_\-\.]+/gi, "");
        },
        buildUrl: function(a, b) {
            var c = "";
            return g.each(b, function(a, b) {
                c += (c ? "&" : "") + encodeURIComponent(b) + "=" + encodeURIComponent(a);
            }), c && (a += (a.indexOf("?") > 0 ? "&" : "?") + c), a;
        },
        formatSize: function(a) {
            function b(a, b) {
                return Math.round(a * Math.pow(10, b)) / Math.pow(10, b);
            }
            if (a === c || /\D/.test(a)) return g.translate("N/A");
            var d = Math.pow(1024, 4);
            return a > d ? b(a / d, 1) + " " + g.translate("tb") : a > (d /= 1024) ? b(a / d, 1) + " " + g.translate("gb") : a > (d /= 1024) ? b(a / d, 1) + " " + g.translate("mb") : a > 1024 ? Math.round(a / 1024) + " " + g.translate("kb") : a + " " + g.translate("b");
        },
        parseSize: b.parseSizeStr,
        predictRuntime: function(a, c) {
            var d, e;
            return d = new g.Uploader(a), e = b.Runtime.thatCan(d.getOption().required_features, c || a.runtimes), 
            d.destroy(), e;
        },
        addFileFilter: function(a, b) {
            f[a] = b;
        }
    };
    g.addFileFilter("mime_types", function(a, b, c) {
        a.length && !a.regexp.test(b.name) ? (this.trigger("Error", {
            code: g.FILE_EXTENSION_ERROR,
            message: g.translate("File extension error."),
            file: b
        }), c(!1)) : c(!0);
    }), g.addFileFilter("max_file_size", function(a, b, c) {
        var d;
        a = g.parseSize(a), b.size !== d && a && b.size > a ? (this.trigger("Error", {
            code: g.FILE_SIZE_ERROR,
            message: g.translate("File size error."),
            file: b
        }), c(!1)) : c(!0);
    }), g.addFileFilter("prevent_duplicates", function(a, b, c) {
        if (a) for (var d = this.files.length; d--; ) if (b.name === this.files[d].name && b.size === this.files[d].size) return this.trigger("Error", {
            code: g.FILE_DUPLICATE_ERROR,
            message: g.translate("Duplicate file error."),
            file: b
        }), void c(!1);
        c(!0);
    }), g.Uploader = function(a) {
        function h() {
            var a, b, c = 0;
            if (this.state == g.STARTED) {
                for (b = 0; b < E.length; b++) a || E[b].status != g.QUEUED ? c++ : (a = E[b], this.trigger("BeforeUpload", a) && (a.status = g.UPLOADING, 
                this.trigger("UploadFile", a)));
                c == E.length && (this.state !== g.STOPPED && (this.state = g.STOPPED, this.trigger("StateChanged")), 
                this.trigger("UploadComplete", E));
            }
        }
        function i(a) {
            a.percent = a.size > 0 ? Math.ceil(a.loaded / a.size * 100) : 100, j();
        }
        function j() {
            var a, b;
            for (B.reset(), a = 0; a < E.length; a++) b = E[a], b.size !== c ? (B.size += b.origSize, 
            B.loaded += b.loaded * b.origSize / b.size) : B.size = c, b.status == g.DONE ? B.uploaded++ : b.status == g.FAILED ? B.failed++ : B.queued++;
            B.size === c ? B.percent = E.length > 0 ? Math.ceil(B.uploaded / E.length * 100) : 0 : (B.bytesPerSec = Math.ceil(B.loaded / ((+new Date() - A || 1) / 1e3)), 
            B.percent = B.size > 0 ? Math.ceil(B.loaded / B.size * 100) : 0);
        }
        function k() {
            var a = G[0] || H[0];
            return a ? a.getRuntime().uid : !1;
        }
        function l(a, c) {
            if (a.ruid) {
                var d = b.Runtime.getInfo(a.ruid);
                if (d) return d.can(c);
            }
            return !1;
        }
        function m() {
            this.bind("FilesAdded", q), this.bind("CancelUpload", v), this.bind("BeforeUpload", r), 
            this.bind("UploadFile", s), this.bind("UploadProgress", t), this.bind("StateChanged", u), 
            this.bind("QueueChanged", j), this.bind("Error", x), this.bind("FileUploaded", w), 
            this.bind("Destroy", y);
        }
        function n(a, c) {
            var d = this, e = 0, f = [], h = {
                accept: a.filters.mime_types,
                runtime_order: a.runtimes,
                required_caps: a.required_features,
                preferred_caps: F,
                swf_url: a.flash_swf_url,
                xap_url: a.silverlight_xap_url
            };
            g.each(a.runtimes.split(/\s*,\s*/), function(b) {
                a[b] && (h[b] = a[b]);
            }), a.browse_button && g.each(a.browse_button, function(c) {
                f.push(function(f) {
                    var i = new b.FileInput(g.extend({}, h, {
                        name: a.file_data_name,
                        multiple: a.multi_selection,
                        container: a.container,
                        browse_button: c
                    }));
                    i.onready = function() {
                        var a = b.Runtime.getInfo(this.ruid);
                        b.extend(d.features, {
                            chunks: a.can("slice_blob"),
                            multipart: a.can("send_multipart"),
                            multi_selection: a.can("select_multiple")
                        }), e++, G.push(this), f();
                    }, i.onchange = function() {
                        d.addFile(this.files);
                    }, i.bind("mouseenter mouseleave mousedown mouseup", function(d) {
                        I || (a.browse_button_hover && ("mouseenter" === d.type ? b.addClass(c, a.browse_button_hover) : "mouseleave" === d.type && b.removeClass(c, a.browse_button_hover)), 
                        a.browse_button_active && ("mousedown" === d.type ? b.addClass(c, a.browse_button_active) : "mouseup" === d.type && b.removeClass(c, a.browse_button_active)));
                    }), i.bind("error runtimeerror", function() {
                        i = null, f();
                    }), i.init();
                });
            }), a.drop_element && g.each(a.drop_element, function(a) {
                f.push(function(c) {
                    var f = new b.FileDrop(g.extend({}, h, {
                        drop_zone: a
                    }));
                    f.onready = function() {
                        var a = b.Runtime.getInfo(this.ruid);
                        d.features.dragdrop = a.can("drag_and_drop"), e++, H.push(this), c();
                    }, f.ondrop = function() {
                        d.addFile(this.files);
                    }, f.bind("error runtimeerror", function() {
                        f = null, c();
                    }), f.init();
                });
            }), b.inSeries(f, function() {
                "function" == typeof c && c(e);
            });
        }
        function o(a, c, d) {
            var e = new b.Image();
            try {
                e.onload = function() {
                    e.downsize(c.width, c.height, c.crop, c.preserve_headers);
                }, e.onresize = function() {
                    d(this.getAsBlob(a.type, c.quality)), this.destroy();
                }, e.onerror = function() {
                    d(a);
                }, e.load(a);
            } catch (f) {
                d(a);
            }
        }
        function p(a, c, e) {
            function f(a, b, c) {
                var d = z[a];
                switch (a) {
                  case "max_file_size":
                    "max_file_size" === a && (z.max_file_size = z.filters.max_file_size = b);
                    break;

                  case "chunk_size":
                    (b = g.parseSize(b)) && (z[a] = b);
                    break;

                  case "filters":
                    "array" === g.typeOf(b) && (b = {
                        mime_types: b
                    }), c ? g.extend(z.filters, b) : z.filters = b, b.mime_types && (z.filters.mime_types.regexp = function(a) {
                        var b = [];
                        return g.each(a, function(a) {
                            g.each(a.extensions.split(/,/), function(a) {
                                b.push(/^\s*\*\s*$/.test(a) ? "\\.*" : "\\." + a.replace(new RegExp("[" + "/^$.*+?|()[]{}\\".replace(/./g, "\\$&") + "]", "g"), "\\$&"));
                            });
                        }), new RegExp("(" + b.join("|") + ")$", "i");
                    }(z.filters.mime_types));
                    break;

                  case "resize":
                    c ? g.extend(z.resize, b, {
                        enabled: !0
                    }) : z.resize = b;
                    break;

                  case "prevent_duplicates":
                    z.prevent_duplicates = z.filters.prevent_duplicates = !!b;
                    break;

                  case "browse_button":
                  case "drop_element":
                    b = g.get(b);

                  case "container":
                  case "runtimes":
                  case "multi_selection":
                  case "flash_swf_url":
                  case "silverlight_xap_url":
                    z[a] = b, c || (i = !0);
                    break;

                  default:
                    z[a] = b;
                }
                c || h.trigger("OptionChanged", a, b, d);
            }
            var h = this, i = !1;
            "object" == typeof a ? g.each(a, function(a, b) {
                f(b, a, e);
            }) : f(a, c, e), e ? (z.required_features = d(g.extend({}, z)), F = d(g.extend({}, z, {
                required_features: !0
            }))) : i && (h.trigger("Destroy"), n.call(h, z, function(a) {
                a ? (h.runtime = b.Runtime.getInfo(k()).type, h.trigger("Init", {
                    runtime: h.runtime
                }), h.trigger("PostInit")) : h.trigger("Error", {
                    code: g.INIT_ERROR,
                    message: g.translate("Init error.")
                });
            }));
        }
        function q(a, b) {
            [].push.apply(E, b), a.trigger("QueueChanged"), a.refresh();
        }
        function r(a, b) {
            if (z.unique_names) {
                var c = b.name.match(/\.([^.]+)$/), d = "part";
                c && (d = c[1]), b.target_name = b.id + "." + d;
            }
        }
        function s(a, c) {
            function d() {
                k-- > 0 ? e(f, 1e3) : (c.loaded = n, a.trigger("Error", {
                    code: g.HTTP_ERROR,
                    message: g.translate("HTTP Error."),
                    file: c,
                    response: C.responseText,
                    status: C.status,
                    responseHeaders: C.getAllResponseHeaders()
                }));
            }
            function f() {
                var l, o, p, q;
                c.status != g.DONE && c.status != g.FAILED && a.state != g.STOPPED && (p = {
                    name: c.target_name || c.name
                }, j && m.chunks && h.size > j ? (q = Math.min(j, h.size - n), l = h.slice(n, n + q)) : (q = h.size, 
                l = h), j && m.chunks && (a.settings.send_chunk_number ? (p.chunk = Math.ceil(n / j), 
                p.chunks = Math.ceil(h.size / j)) : (p.offset = n, p.total = h.size)), C = new b.XMLHttpRequest(), 
                C.upload && (C.upload.onprogress = function(b) {
                    c.loaded = Math.min(c.size, n + b.loaded), a.trigger("UploadProgress", c);
                }), C.onload = function() {
                    return C.status >= 400 ? void d() : (k = a.settings.max_retries, q < h.size ? (l.destroy(), 
                    n += q, c.loaded = Math.min(n, h.size), a.trigger("ChunkUploaded", c, {
                        offset: c.loaded,
                        total: h.size,
                        response: C.responseText,
                        status: C.status,
                        responseHeaders: C.getAllResponseHeaders()
                    }), "Android Browser" === b.Env.browser && a.trigger("UploadProgress", c)) : c.loaded = c.size, 
                    l = o = null, !n || n >= h.size ? (c.size != c.origSize && (h.destroy(), h = null), 
                    a.trigger("UploadProgress", c), c.status = g.DONE, a.trigger("FileUploaded", c, {
                        response: C.responseText,
                        status: C.status,
                        responseHeaders: C.getAllResponseHeaders()
                    })) : e(f, 1), void 0);
                }, C.onerror = function() {
                    d();
                }, C.onloadend = function() {
                    this.destroy(), C = null;
                }, a.settings.multipart && m.multipart ? (p.name = c.target_name || c.name, C.open("post", i, !0), 
                g.each(a.settings.headers, function(a, b) {
                    C.setRequestHeader(b, a);
                }), o = new b.FormData(), g.each(g.extend(p, a.settings.multipart_params), function(a, b) {
                    o.append(b, a);
                }), o.append(a.settings.file_data_name, l), C.send(o, {
                    runtime_order: a.settings.runtimes,
                    required_caps: a.settings.required_features,
                    preferred_caps: F,
                    swf_url: a.settings.flash_swf_url,
                    xap_url: a.settings.silverlight_xap_url
                })) : (i = g.buildUrl(a.settings.url, g.extend(p, a.settings.multipart_params)), 
                C.open("post", i, !0), C.setRequestHeader("Content-Type", "application/octet-stream"), 
                g.each(a.settings.headers, function(a, b) {
                    C.setRequestHeader(b, a);
                }), C.send(l, {
                    runtime_order: a.settings.runtimes,
                    required_caps: a.settings.required_features,
                    preferred_caps: F,
                    swf_url: a.settings.flash_swf_url,
                    xap_url: a.settings.silverlight_xap_url
                })));
            }
            var h, i = a.settings.url, j = a.settings.chunk_size, k = a.settings.max_retries, m = a.features, n = 0;
            c.loaded && (n = c.loaded = j * Math.floor(c.loaded / j)), h = c.getSource(), a.settings.resize.enabled && l(h, "send_binary_string") && ~b.inArray(h.type, [ "image/jpeg", "image/png" ]) ? o.call(this, h, a.settings.resize, function(a) {
                h = a, c.size = a.size, f();
            }) : f();
        }
        function t(a, b) {
            i(b);
        }
        function u(a) {
            if (a.state == g.STARTED) A = +new Date(); else if (a.state == g.STOPPED) for (var b = a.files.length - 1; b >= 0; b--) a.files[b].status == g.UPLOADING && (a.files[b].status = g.QUEUED, 
            j());
        }
        function v() {
            C && C.abort();
        }
        function w(a) {
            j(), e(function() {
                h.call(a);
            }, 1);
        }
        function x(a, b) {
            b.file && (b.file.status = g.FAILED, i(b.file), a.state == g.STARTED && (a.trigger("CancelUpload"), 
            e(function() {
                h.call(a);
            }, 1)));
        }
        function y(a) {
            a.stop(), g.each(E, function(a) {
                a.destroy();
            }), E = [], G.length && (g.each(G, function(a) {
                a.destroy();
            }), G = []), H.length && (g.each(H, function(a) {
                a.destroy();
            }), H = []), F = {}, I = !1, A = C = null, B.reset();
        }
        var z, A, B, C, D = g.guid(), E = [], F = {}, G = [], H = [], I = !1;
        z = {
            runtimes: b.Runtime.order,
            max_retries: 0,
            chunk_size: 0,
            multipart: !0,
            multi_selection: !0,
            file_data_name: "file",
            flash_swf_url: "js/Moxie.7029eb89.swf",
            silverlight_xap_url: "js/Moxie.xap",
            filters: {
                mime_types: [],
                prevent_duplicates: !1,
                max_file_size: 0
            },
            resize: {
                enabled: !1,
                preserve_headers: !0,
                crop: !1
            },
            send_chunk_number: !0
        }, p.call(this, a, null, !0), B = new g.QueueProgress(), g.extend(this, {
            id: D,
            uid: D,
            state: g.STOPPED,
            features: {},
            runtime: null,
            files: E,
            settings: z,
            total: B,
            init: function() {
                var a = this;
                return "function" == typeof z.preinit ? z.preinit(a) : g.each(z.preinit, function(b, c) {
                    a.bind(c, b);
                }), z.browse_button && z.url ? (m.call(this), void n.call(this, z, function(c) {
                    "function" == typeof z.init ? z.init(a) : g.each(z.init, function(b, c) {
                        a.bind(c, b);
                    }), c ? (a.runtime = b.Runtime.getInfo(k()).type, a.trigger("Init", {
                        runtime: a.runtime
                    }), a.trigger("PostInit")) : a.trigger("Error", {
                        code: g.INIT_ERROR,
                        message: g.translate("Init error.")
                    });
                })) : void this.trigger("Error", {
                    code: g.INIT_ERROR,
                    message: g.translate("Init error.")
                });
            },
            setOption: function(a, b) {
                p.call(this, a, b, !this.runtime);
            },
            getOption: function(a) {
                return a ? z[a] : z;
            },
            refresh: function() {
                G.length && g.each(G, function(a) {
                    a.trigger("Refresh");
                }), this.trigger("Refresh");
            },
            start: function() {
                this.state != g.STARTED && (this.state = g.STARTED, this.trigger("StateChanged"), 
                h.call(this));
            },
            stop: function() {
                this.state != g.STOPPED && (this.state = g.STOPPED, this.trigger("StateChanged"), 
                this.trigger("CancelUpload"));
            },
            disableBrowse: function() {
                I = arguments[0] !== c ? arguments[0] : !0, G.length && g.each(G, function(a) {
                    a.disable(I);
                }), this.trigger("DisableBrowse", I);
            },
            getFile: function(a) {
                var b;
                for (b = E.length - 1; b >= 0; b--) if (E[b].id === a) return E[b];
            },
            addFile: function(a, c) {
                function d(a, c) {
                    var d = [];
                    b.each(j.settings.filters, function(b, c) {
                        f[c] && d.push(function(d) {
                            f[c].call(j, b, a, function(a) {
                                d(!a);
                            });
                        });
                    }), b.inSeries(d, c);
                }
                function h(a) {
                    var f = b.typeOf(a);
                    if (a instanceof b.File) {
                        if (!a.ruid && !a.isDetached()) {
                            if (!i) return !1;
                            a.ruid = i, a.connectRuntime(i);
                        }
                        h(new g.File(a));
                    } else a instanceof b.Blob ? (h(a.getSource()), a.destroy()) : a instanceof g.File ? (c && (a.name = c), 
                    l.push(function(b) {
                        d(a, function(c) {
                            c || (m.push(a), j.trigger("FileFiltered", a)), e(b, 1);
                        });
                    })) : -1 !== b.inArray(f, [ "file", "blob" ]) ? h(new b.File(null, a)) : "node" === f && "filelist" === b.typeOf(a.files) ? b.each(a.files, h) : "array" === f && (c = null, 
                    b.each(a, h));
                }
                var i, j = this, l = [], m = [];
                i = k(), h(a), l.length && b.inSeries(l, function() {
                    m.length && j.trigger("FilesAdded", m);
                });
            },
            removeFile: function(a) {
                for (var b = "string" == typeof a ? a : a.id, c = E.length - 1; c >= 0; c--) if (E[c].id === b) return this.splice(c, 1)[0];
            },
            splice: function(a, b) {
                var d = E.splice(a === c ? 0 : a, b === c ? E.length : b), e = !1;
                return this.state == g.STARTED && (e = !0, this.stop()), this.trigger("FilesRemoved", d), 
                g.each(d, function(a) {
                    a.destroy();
                }), this.trigger("QueueChanged"), this.refresh(), e && this.start(), d;
            },
            bind: function(a, b, c) {
                var d = this;
                g.Uploader.prototype.bind.call(this, a, function() {
                    var a = [].slice.call(arguments);
                    return a.splice(0, 1, d), b.apply(this, a);
                }, 0, c);
            },
            destroy: function() {
                this.trigger("Destroy"), z = B = null, this.unbindAll();
            }
        });
    }, g.Uploader.prototype = b.EventTarget.instance, g.File = function() {
        function a(a) {
            g.extend(this, {
                id: g.guid(),
                name: a.name || a.fileName,
                type: a.type || "",
                size: a.size || a.fileSize,
                origSize: a.size || a.fileSize,
                loaded: 0,
                percent: 0,
                status: g.QUEUED,
                lastModifiedDate: a.lastModifiedDate || new Date().toLocaleString(),
                getNative: function() {
                    var a = this.getSource().getSource();
                    return -1 !== b.inArray(b.typeOf(a), [ "blob", "file" ]) ? a : null;
                },
                getSource: function() {
                    return c[this.id] ? c[this.id] : null;
                },
                destroy: function() {
                    var a = this.getSource();
                    a && (a.destroy(), delete c[this.id]);
                }
            }), c[this.id] = a;
        }
        var c = {};
        return a;
    }(), g.QueueProgress = function() {
        var a = this;
        a.size = 0, a.loaded = 0, a.uploaded = 0, a.failed = 0, a.queued = 0, a.percent = 0, 
        a.bytesPerSec = 0, a.reset = function() {
            a.size = a.loaded = a.uploaded = a.failed = a.queued = a.percent = a.bytesPerSec = 0;
        };
    }, a.plupload = g;
}(window, mOxie), define("plupload", function() {}), define("component/uploader/uploadFileModel", [ "moxtra", "lang", "const", "user/userModel" ], function(a, b, c, d) {
    return a.Model.extend({
        idAttribute: "client_uuid",
        defaults: {
            boardId: "",
            name: "",
            actor: {},
            percent: 20,
            id: "",
            size: 0,
            origSize: 0,
            type: "",
            client_uuid: "",
            sequence: 0,
            uploadUrl: ""
        },
        parse: function(a) {
            var b = MX.pick(a, [ "origSize", "size", "type", "id", "name", "percent", "client_uuid", "uploadUrl" ]);
            return b.actor = new d(Moxtra.getMe(), {
                parse: !0
            }).toJSON(), b;
        }
    });
}), define("component/uploader/base", [ "moxtra", "lang", "plupload", "component/uploader/uploadFileModel", "component/uploader/fileProgress", "uuid" ], function(a, b, c, d, e, f) {
    "use strict";
    var g = MX.logger("Uploader"), h = a.Collection.extend({
        model: d
    }), i = a.Controller.extend({
        tagName: "div",
        className: "mx_swf_container",
        initialize: function(a) {
            a = a || {}, this.className = a.className || "mx_swf_container", this.container = a.container || document.body, 
            this.modules = {}, this.$el.attr("id", this.className), this.map = {};
        },
        initUploader: function(a, b) {
            var c = this;
            this._rendered || (this.$el.appendTo(c.container), this._rendered = !0);
            var d = new window.plupload.Uploader(_.extend({
                runtimes: "html5, flash",
                browse_button: "",
                container: c.className,
                multipart: !1,
                max_file_size: "500mb",
                url: "/board/upload?type=original",
                required_features: "return_response_headers",
                sortable: !0,
                flash_swf_url: "lib/plupload/js/Moxie.7029eb89.swf"
            }, b));
            return d.bind("BeforeUpload", $.proxy(this.onBeforeUpload, this)), d.bind("FilesAdded", $.proxy(this.onFilesAdded, this)), 
            d.bind("FileUploaded", $.proxy(this.onFileUploaded, this)), d.bind("UploadProgress", $.proxy(this.onUploadProgress, this)), 
            d.bind("Error", $.proxy(this.onError, this)), d.bind("Init", function() {
                a.element = $(c.el.lastChild);
            }), d.bind("QueueChanged", $.proxy(this.onQueueChanged, this)), d.bind("UploadComplete", $.proxy(this.onUploadComplete, this)), 
            setTimeout(function() {
                d.init();
            }, 200), a.uploader = d, a;
        },
        onError: function(a, c) {
            this.hide();
            var d = this.modules[this.type] || {};
            switch (console.debug("onError", c), c.code) {
              case window.plupload.FILE_SIZE_ERROR:
                d.error || MX.ui.notifyError(b.upload_file_exceed_size_limit);
                break;

              case window.plupload.HTTP_ERROR:
                if (413 === c.status) {
                    var e;
                    try {
                        e = JSON.parse(c.response);
                    } catch (f) {
                        console.error(f);
                    }
                    if (e) {
                        var g;
                        switch (e.detail_code) {
                          case "EXCEED_UPLOAD_CLIENT_BODY_MAX":
                            g = MX.get("object.user.cap.client_max_body_size", e), g = g / 1024 / 1024, d.error || MX.ui.notifyError(MX.format(b.upload_file_exceed_size_limit_binder_owner, g));
                            break;

                          case "EXCEED_MONTHLY_UPLOAD_MAX":
                            g = MX.get("object.user.cap.monthly_upload_max", e), g = MX.lang.formatSize(g), 
                            d.error || MX.ui.notifyError(MX.format(b.common_msg_reach_limit_monthly_upload, {
                                size: g
                            }));
                            break;

                          default:
                            d.error || MX.ui.notifyError(b.common_msg_reach_limit_pages);
                        }
                    } else d.error || MX.ui.notifyError(b.common_msg_reach_limit_pages);
                } else d.error || MX.ui.notifyError(b.upload_file_failed);
                break;

              case window.plupload.FILE_EXTENSION_ERROR:
              case window.plupload.SECURITY_ERROR:
              case window.plupload.IO_ERROR:
                d.error || MX.ui.notifyError(b.upload_file_failed);
            }
            if (c.file) {
                var h = c.file.client_uuid, i = d.collection.get(h);
                i && d.collection.remove(i), c.file.destroy(), d.error && d.error(c);
            }
        },
        onFileUploaded: function(a, b, c) {
            var d = this.modules[this.type], e = JSON.parse(c.response), f = MX.get("object.board.pages.0.resources.0", e);
            f || (f = MX.get("object.board.resources.0", e));
            var h = d.collection.get(b.client_uuid);
            if (h && f && (h.set({
                sequence: f.sequence,
                percent: 100
            }), g.debug("onUploadProgress", 100)), !f) {
                var i = this.getModel(b.client_uuid);
                i.set("percent", 100);
            }
            d.success && d.success(h, c);
            try {
                d.collection.remove(h), b.destroy();
            } catch (j) {
                console.error(j);
            }
        },
        onUploadProgress: function(a, b) {
            var c = Math.max(50, b.percent), d = this.getModel(b.client_uuid), e = d.get("percent");
            c > e && (d.set("percent", c), g.debug("onUploadProgress", c));
        },
        onBeforeUpload: function(a, b) {
            var c = this.modules[this.type], d = c.collection.get(b.client_uuid);
            if (d) {
                var f = new MX.ui.Notify({
                    autoClose: !1,
                    content: new e({
                        model: d
                    })
                });
                d.on("remove", function() {
                    f && f.close();
                }), setTimeout(function() {
                    f && f.close();
                }, 12e4);
            }
            c.uploader.settings.url = Moxtra.util.makeAccessTokenUrl(b.uploadUrl + "&client_uuid=" + b.client_uuid), 
            c.skip_client_uuid && (c.uploader.settings.url = Moxtra.util.makeAccessTokenUrl(b.uploadUrl));
        },
        onFilesAdded: function(a, b) {
            var c = this.modules[this.type] || {}, d = this, e = c.url;
            if (e) {
                MX.each(b, function(a) {
                    a.client_uuid || (a.client_uuid = f()), a.uploadUrl = MX.isFunction(e) ? e(d.conf, a) : e;
                });
                var d = (c.collection.add(b, _.extend({
                    parse: !0
                }, this.conf)), this);
                MX.each(b, function(a) {
                    d.map[a.client_uuid] = c;
                }), setTimeout(function() {
                    c.beforeUpload ? c.beforeUpload(b, function() {
                        c.uploader.start();
                    }) : c.uploader.start(), c.element.css({
                        left: 0,
                        top: 0,
                        width: 0,
                        height: 0
                    }), $(document.body).click(), d.$el.css({
                        left: -1e3,
                        top: -1e3
                    });
                }, 10);
            }
        },
        onQueueChanged: function() {},
        onUploadComplete: function() {},
        register: function(a, b) {
            var c = this.modules[a];
            return c ? (c.url = b.url, c.success = b.success, c.error = b.error, c.collection) : (c = b, 
            c.collection = new h(), c = this.initUploader(c, b), b.listenTransform, this.modules[a] = c, 
            c.collection);
        },
        getModel: function(a) {
            var b = this.map[a];
            return b.collection.get(a);
        },
        getCollection: function(a) {
            var b = this.modules[a];
            return b ? b.collection : void g.error("{0} not inited in uploader component");
        },
        refresh: function(a, b, c) {
            this.type = a, this.conf = c;
            var d = this.modules[a];
            if (d) if (this.$el.css({
                left: 0,
                top: 0
            }), b && b.length) {
                var e = b.offset();
                e.width = b.outerWidth(), e.height = b.outerHeight(), d.element && d.element.css(e);
            } else d.element && d.element.css({
                left: 0,
                top: 0
            }), d.uploader.refresh();
        },
        hide: function(a) {
            var b = this.modules[a || this.type];
            b && b.element && b.element.css({
                left: -1e3,
                top: -1e3
            });
        },
        unregister: function(a) {
            var b = this.modules[a];
            b && (b.element && b.element.remove(), b.uploader && b.uploader.unbindAll && b.uploader.unbindAll()), 
            this.modules[a] = null;
        }
    });
    return i;
}), define("component/uploader/uploader", [ "moxtra", "component/uploader/base" ], function(a, b) {
    return MX.ui.uploader || (MX.ui.uploader = new b()), MX.ui.uploader;
}), define("meet/topbar/add", [ "moxtra", "app", "const", "lang", "text!template/meet/topbar/add.html", "text!template/meet/topbar/endShareFile.html", "meet/meetBiz", "binder/binderActions", "component/uploader/uploader" ], function(a, b, c, d, e, f, g, h, i) {
    var j = Handlebars.compile(f);
    return a.Controller.extend({
        template: e,
        handleAction: !0,
        events: {
            "click .end-share-file": "_endShare"
        },
        init: function(a) {
            this.profile = a.profile || {}, this.$scope.lang = d, this.$scope.session_key = a.sessionKey || "", 
            this.binderActions = h, this.meetModel = g.getMeetModel(), this.pages = g.getPageList(), 
            this.listenTo(this.meetModel, "change:isMeetPresenter", this.presenterChanged), 
            this.listenTo(this.meetModel, "change:shareType", this.onShare);
        },
        rendered: function() {
            var a, c = this;
            c.$("ul li.addpage-webdoc").remove(), Moxtra.getMe().id || (c.$("ul li.addpage-remote").remove(), 
            c.$("ul li.addpage-binder").remove()), c.$("ul").append(j({
                lang: d
            })), a = i.register("addPageToBinder", {
                browse_button: "addpage_flashuploader",
                url: function() {
                    var a = b.request.toJSON();
                    return "/board/upload?type=original&id=" + a.page;
                }
            }), c.$(".add-file").on("hide.bs.dropdown", function() {
                i.hide("addPageToBinder");
            }), c.$(".add-file").on("shown.bs.dropdown", function() {
                c._shareFile();
            }), c.profile.isPresenter && c.show();
        },
        presenterChanged: function(a) {
            var d = a.toJSON();
            if (d.isMeetPresenter) {
                this.show();
                var e, f = b.request.sequence();
                f && (e = this.pages.get(f), e && "ds" !== e.get("type") && g.setShareType(c.meet.shareType.file));
            } else this.hide(), g.setShareType("", !0);
        },
        show: function() {
            this.$el.removeClass("hide"), $(".meet-topbar-add").removeClass("hide");
        },
        hide: function() {
            this.$el.addClass("hide");
        },
        onShare: function(a, b) {
            b === c.meet.shareType.screen && $(".meet-topbar-add").addClass("hide");
        },
        startShareFile: function() {
            this._shareFile();
        },
        _shareFile: function() {
            if (this.pages.length ? this.$(".end-share-file").removeClass("hide") : this.$(".end-share-file").addClass("hide"), 
            !g.isSharing()) {
                var a, b, c = g.getSharingPage();
                this.pages.length && (c = g.getSharingPage(), c && (a = this.pages.get(c)), a || (a = this.pages.at(0)), 
                a && (b = a.get("sequence"))), g.startShareFile(b);
            }
        },
        _endShare: function() {
            g.stopShareFile();
        },
        refreshUploader: function() {
            var a = this.$el;
            setTimeout(function() {
                i.refresh("addPageToBinder", a.find("#addpage_flashuploader"));
            }, 100);
        }
    });
}), define("text!template/meet/topbar/share.html", [], function() {
    return '{{#if isMeetPresenter}}\r\n<div class="action-section mx-share-screen">\r\n	{{#if sharing}}\r\n	<a class="mx-branding mx-start-ds topbar-action mouse-hand"  data-action="stopDS"><i class="mx-branding micon-screen-share size20"></i> <span class="hidden-xs-inline">{{lang.end_share}}</span></a>\r\n	{{else}}\r\n	<a class="mx-branding mx-start-ds topbar-action {{#if disabled}}disabled{{/if}} mouse-hand"  data-action="startDS"><i class="mx-branding micon-screen-share-empty size20"></i> <span class="hidden-xs-inline">{{lang.share_screen}}</span></a>\r\n	{{/if}}\r\n</div>\r\n{{/if}}\r\n';
}), define("meet/topbar/share", [ "moxtra", "app", "const", "lang", "text!template/meet/topbar/share.html", "meet/meetUtil", "meet/connector/util", "meet/meetBiz" ], function(a, b, c, d, e, f, g, h) {
    var i = Handlebars.compile(e), j = MX.logger("meet:share");
    return a.Controller.extend({
        tagName: "div",
        handleAction: !0,
        init: function(a) {
            this.sessionKey = a.profile.sessionKey, this.$scope.lang = d, this.pages = h.getPageList(), 
            this.meetModel = h.getMeetModel(), this.dsModel = h.getDSModel(), this.disabled = !0, 
            this.listenTo(this.meetModel, "change:isMeetPresenter", this.presenterChanged), 
            this.dsModel.on("change:pStarted", this.onStarted, this), this.dsModel.on("change:pStopped", this.resetDS, this), 
            this.dsModel.once("change:dsConf", this.enableDS, this), this.dsModel.on("change:serverAddr", this.updateConf, this);
            var b = this;
            b.recovery(function() {
                b.dsModel && (b.dsModel.set({
                    dsConf: {}
                }, {
                    silent: !0
                }), b.dsModel.off());
            });
        },
        rendered: function() {},
        enableDS: function() {
            this.disabled = !1, this.refreshUI(this.meetModel);
        },
        presenterChanged: function(a) {
            this.refreshUI(a);
        },
        refreshUI: function(a) {
            var b = a.toJSON(), c = this.dsModel.toJSON();
            this.dsModel.get("serverAddr") && (this.disabled = !1), j.logServer(f.logFormat("share.js -> this.disabled = " + this.disabled, {
                meetId: this.sessionKey
            })), this.$el.empty(), this.$el.append($(i({
                lang: d,
                disabled: this.disabled,
                sharing: c.pStarted,
                isMeetPresenter: b.isMeetPresenter
            })));
        },
        startDS: function() {
            if (!f.isOsSupported()) return void MX.ui.notifyWarning(d.meet_application_os_supported);
            var a = this.meetModel.toJSON(), b = a.sessionKey, c = a.sessionId;
            if (j.logServer(f.logFormat('[User Action] click "Share Screen" ', {
                meetId: b,
                rosterId: c
            })), this.$(".mx-start-ds").hasClass("disabled") || this.creating) return void j.logServer(f.logFormat("[startDS] ds page is creating, so return ", {
                meetId: b,
                rosterId: c
            }));
            if (!f.isBrowserSupported()) {
                var e = "";
                return -1 != navigator.platform.indexOf("Mac") ? e = d.screenshare_msg_browser_supported_on_mac : -1 != navigator.platform.indexOf("Win") && (e = d.screenshare_msg_browser_supported_on_win), 
                MX.ui.notifyWarning(e), void j.logServer(f.logFormat("[startDS] browser not support, so return ", {
                    meetId: b,
                    rosterId: c
                }));
            }
            if (MX.env.isEdge) return MX.ui.notifyWarning(d.edge_browser_not_supported), void j.logServer(f.logFormat("[startDS] edge browser not support, so return ", {
                meetId: b,
                rosterId: c
            }));
            if (MX.env.isIE && !g.isActiveXSupported()) return void j.logServer(f.logFormat("[startDS] IE not support Active X, so return ", {
                meetId: b,
                rosterId: c
            }));
            this._enableDS(!1);
            var i = this, k = !1, l = this.dsModel.toJSON();
            MX.each(this.pages.models, function(a) {
                return "ds" === a.get("type") ? (k = !0, j.logServer(f.logFormat("[startDS] already exist a ds page: " + JSON.stringify(a.toJSON()), {
                    meetId: b,
                    rosterId: c
                })), !1) : void 0;
            }), k ? (j.logServer(f.logFormat("[startDS] already has ds page, only send start request to application.", {
                meetId: b,
                rosterId: c
            })), j.logServer(f.logFormat("[startDS] current ds page is: " + JSON.stringify(l), {
                meetId: b,
                rosterId: c
            })), h.startDS()) : (this._shareButton(!1), this.creating = !0, j.logServer(f.logFormat("[startDS] try to create ds page...", {
                meetId: b,
                rosterId: c
            })), h.createDSPage().success(function(a) {
                j.log(a), j.logServer(f.logFormat("[startDS] create ds page SUCCESS: " + JSON.stringify(a), {
                    meetId: b,
                    rosterId: c
                })), i._shareButton(!0), i.creating = !1;
            }).error(function() {
                MX.ui.notifyError(d.screenshare_msg_start_failed), j.logServer(f.logFormat("[startDS] create ds page ERROR.", {
                    meetId: b,
                    rosterId: c
                })), i._enableDS(!0), i._shareButton(!0), i.creating = !1;
            }));
        },
        stopDS: function() {
            h.stopDS();
        },
        onStarted: function() {
            this.refreshUI(this.meetModel);
        },
        resetDS: function(a) {
            this._enableDS(!0);
            var b = a.getSequence(), c = this.meetModel.toJSON();
            j.logServer(f.logFormat("[resetDS] try to delete ds page.", {
                meetId: c.sessionKey,
                rosterId: c.sessionId
            })), h.destroyDSPage(b).success(function() {
                j.logServer(f.logFormat("[resetDS] delete ds page SUCCESS, sequence: " + b, {
                    meetId: c.sessionKey,
                    rosterId: c.sessionId
                }));
            }).error(function() {
                j.logServer(f.logFormat("[resetDS] delete ds page ERROR, sequence: " + b, {
                    meetId: c.sessionKey,
                    rosterId: c.sessionId
                }));
            }), this._shareButton(!0), this.dsModel.triggerDestoryAction(), this.refreshUI(this.meetModel);
        },
        _enableDS: function(a) {
            var b = (this.$(".mx-start-ds"), $(".meet-topbar-add"));
            b.length && (a ? b.removeClass("hide") : b.addClass("hide"));
        },
        _shareButton: function(a) {
            var b = this.$(".mx-start-ds");
            b.length && (a ? (j.logServer(f.logFormat('Remove class "disabled" from Share Screen button ', {
                meetId: this.sessionKey
            })), b.removeClass("disabled")) : (j.logServer(f.logFormat('Add class "disabled" to Share Screen button ', {
                meetId: this.sessionKey
            })), b.addClass("disabled")));
        },
        updateConf: function(a) {
            a.get("pStarted") && h.updateDSConf(), h.updatePeerConf();
        },
        stopListen: function() {
            this.stopListening();
        }
    });
}), define("text!template/meet/topbar/speaker.html", [], function() {
    return '<div class="meet-who-speaking">\n	<span id="mxMeetSpeaker" class="mx-branding"></span>\n</div>';
}), define("meet/topbar/speaker", [ "moxtra", "lang", "app", "const", "text!template/meet/topbar/speaker.html", "meet/meetBiz" ], function(a, b, c, d, e, f) {
    "use strict";
    return a.Controller.extend({
        template: e,
        handleAction: !0,
        init: function() {
            this.model = f.getAudioModel(), this.participants = f.getParticipantList(), this.networkTipTpl = '<span style="display:inline-block;padding:3px 15px;margin-bottom:-3px;background:#FEFBB9;color:#333;">{0}</span>', 
            this.listenTo(this.model, "change:speaking", this.update), this.listenTo(this.model, "change:networking", this.network), 
            this.listenTo(this.model, "change:nativeConnecting", this.connecting), this.listenTo(this.model, "change:nativeConnected", this.connected);
        },
        rendered: function() {
            this.speaker = this.$("#mxMeetSpeaker");
        },
        update: function(a) {
            var c = a.toJSON(), d = [], e = 0;
            if (MX.each(c.speakers, function(a) {
                return e > 2 ? !1 : void (c.audiences[a] && (d.push(c.audiences[a]), e++));
            }), d.length) {
                clearTimeout(this.timeout);
                var f = MX.format(d.length > 1 ? b.meet_who_are_speaking : b.meet_who_is_speaking, d.join(", ")), g = this;
                this.speaker.text(f), this.timeout = setTimeout(function() {
                    g.speaker.empty();
                }, 3e3);
            }
        },
        network: function(a) {
            var c = a.toJSON(), e = [], f = [], g = {}, h = Moxtra.getMe().sessionId, i = 0;
            MX.each(c.networks, function(a) {
                var b = c.ssrcMapping[a.ssrc];
                e.push(b), g[b] = a.quality || d.meet.network.quality.good;
            }), this.participants.each(function(a) {
                e.indexOf(a.id) > -1 ? a.set({
                    networkQuality: g[a.id]
                }) : a.get("isAudioEnabled") && (a.id !== h && a.set({
                    networkQuality: d.meet.network.quality.bad
                }), a.id !== h && 2 > i && (f.push(a.get("name")), i++));
            }), i > 0 ? (clearTimeout(this.NETWORK_TIMEOUT), $(".mx-viewer-tips .tips-header.others-connecting").removeClass("hide").html(MX.format(this.networkTipTpl, b.audio + ": [" + f.join(", ") + "] " + b.connecting_ellipsis)), 
            this.NETWORK_TIMEOUT = setTimeout(function() {
                $(".mx-viewer-tips .tips-header.others-connecting").addClass("hide").empty();
            }, 1e4)) : $(".mx-viewer-tips .tips-header.others-connecting").addClass("hide").empty();
        },
        connecting: function() {
            Moxtra.getMe().sessionId;
            this.participants.each(function(a) {
                a.set({
                    networkQuality: d.meet.network.quality.bad
                });
            });
        },
        connected: function() {
            var a = this.participants.get(Moxtra.getMe().sessionId);
            a && a.set({
                networkQuality: d.meet.network.quality.good
            });
        }
    });
}), define("text!template/meet/record/recorder.html", [], function() {
    return '<div class="meet-record-container">\n	<span class="recorder-pending hide">\n		<span class="pull-left">\n			<span>\n				<span class="mouse-hand action action-start marginRight10" data-action="start" title="{{lang.click_to_record_this_meet}}"> <i class="micon-circle gray"><span class="icon-record"></span></i>\n				</span>\n				{{lang.start_record}}\n			</span>\n		</span>\n	</span>\n	<span class="recorder-active hide">\n		<span class="recorder-ctrl pull-left">\n			<span class="ctrl-pause">\n				<span class="mouse-hand action action-pause" data-action="pause" title="{{lang.click_to_pause_record}}"> <i class="micon-circle gray"><span class="glyphicon glyphicon-pause"></span></i>\n				</span>\n				{{lang.recording}}\n			</span>\n			<span class="ctrl-resume">\n				<span class="mouse-hand action action-resume marginRight10" data-action="resume" title="{{lang.click_to_resume_record}}"> <i class="micon-circle gray"><span class="icon-record"></span></i>\n				</span>\n				{{lang.meet_recording_is_paused}}\n			</span>\n		</span>\n	</span>\n</div>\n';
}), define("meet/record/recorder", [ "moxtra", "lang", "app", "const", "text!template/meet/record/recorder.html", "meet/meetBiz", "meet/meetUtil" ], function(a, b, c, d, e, f, g) {
    var h = MX.logger("meet:recorder");
    return a.Controller.extend({
        template: e,
        handleAction: !0,
        init: function(a) {
            this.sessionKey = a.profile.sessionKey, this.sessionId = Moxtra.getMe().sessionId, 
            this.boardId = a.profile.boardId, this.boardTags = a.profile.boardTags, this.meetModel = f.getMeetModel(), 
            this.$scope.lang = b, this.isLoading = !1;
        },
        rendered: function() {
            var a = this, b = a._getStorage();
            if (a._log("[recorder] start to render recorder control in meet", !0), !b) {
                var c = this.meetModel.get("latestRecordingState");
                c && (b = {
                    paused: !0
                }, [ d.meet.recordingStatus.started, d.meet.recordingStatus.resumed ].indexOf(c) > -1 && (b.paused = !1));
            }
            if (b) a._log("[recorder] found storage, refresh case."), a._update(!0), a._recording(b.paused ? !1 : !0); else if (a._update(!1), 
            a._log("[recorder] check if meet has auto record!"), a.boardTags.length) {
                for (var e, f = !1, g = 0; g < a.boardTags.length; g++) if (e = a.boardTags[g], 
                e.name === d.meet.tags.autoRecordMeet) {
                    f = "1" === e.string_value;
                    break;
                }
                f && (a._log("[recorder] checked: meet has auto record!"), a.start(!0));
            }
            a.$el.tooltip({
                selector: ".action"
            });
        },
        start: function(a) {
            var c = this;
            return a ? c._log("[recorder] auto start meet recording", !0) : c._log('[User Action] click "Start" record', !0), 
            c.isLoading ? void c._log("Return as is waiting previous callback") : (c._loading(), 
            c._log("[action] try to start record "), void Moxtra.publishMeetRecording(c.sessionKey, Moxtra.const.RECORDING_STARTED).success(function() {
                c._log("[recorder] success started!"), c._loading(!1), c._update(!0), c._recording(!0), 
                c._setStorage(!1);
            }).error(function() {
                c._log("[recorder] failed to start!"), c._loading(!1), c._update(!1), c._recording(!1), 
                MX.ui.Alert(b.failed_to_start_record_meet, {
                    className: "mx-branding-meet-dialog-btn"
                });
            }));
        },
        pause: function() {
            var a = this;
            return a._log('[User Action] click "Pause" record'), a.isLoading ? void a._log("Return as is waiting previous callback") : (a._loading(), 
            a._log("[action] try to pause record"), void Moxtra.publishMeetRecording(a.sessionKey, Moxtra.const.RECORDING_PAUSED).success(function() {
                a._log("[recorder] success paused!"), a._loading(!1), a._recording(!1), a._setStorage(!0);
            }).error(function() {
                a._log("[recorder] failed to paused!"), a._loading(!1), MX.ui.Alert(b.failed_to_pause_record_meet, {
                    className: "mx-branding-meet-dialog-btn"
                });
            }));
        },
        resume: function() {
            var a = this;
            return a._log('[User Action] click "Resume" record'), a.isLoading ? void a._log("Return as is waiting previous callback") : (a._loading(), 
            a._log("[action] try to resume record"), void Moxtra.publishMeetRecording(a.sessionKey, Moxtra.const.RECORDING_RESUMED).success(function() {
                a._log("[recorder] success resumed!"), a._loading(!1), a._recording(!0), a._setStorage(!1);
            }).error(function() {
                a._log("[recorder] failed to resumed!"), a._loading(!1), MX.ui.Alert(b.failed_to_resume_record_meet, {
                    className: "mx-branding-meet-dialog-btn"
                });
            }));
        },
        stop: function() {
            var a = this;
            a._log('[User Action] click "Stop" record');
            var c = a.$(".starter"), d = a._getStorage();
            if (d && c.hasClass("active")) {
                if (a.isLoading) return void a._log("Return as is waiting previous callback");
                a._loading(), a._log("[action] try to stop record "), Moxtra.publishMeetRecording(a.sessionKey, Moxtra.const.RECORDING_STOPPED).success(function() {
                    a._log("[recorder] success stopped!"), a._loading(!1), a._setStorage(!0), c.removeClass("active");
                }).error(function() {
                    a._log("[recorder] failed to stopped!"), a._loading(!1), MX.ui.Alert(b.failed_to_stop_record_meet, {
                        className: "mx-branding-meet-dialog-btn"
                    });
                });
            } else a._log("already paused, no need to send request STOP again");
        },
        _getStorage: function() {
            var a = c.status.get("mxMeetRecorder");
            return a ? a[this.sessionKey] : null;
        },
        _setStorage: function(a) {
            var b = {};
            b[this.sessionKey] = {
                paused: a
            }, c.status.set("mxMeetRecorder", b);
        },
        _recording: function(a) {
            a ? this.$(".recorder-ctrl").addClass("active") : this.$(".recorder-ctrl").removeClass("active");
        },
        _update: function(a) {
            a ? (this.$(".recorder-active").removeClass("hide"), this.$(".recorder-pending").addClass("hide")) : (this.$(".recorder-pending").removeClass("hide"), 
            this.$(".recorder-active").addClass("hide"));
        },
        _log: function(a, b) {
            h.logServer(g.logFormat(a, {
                meetId: this.sessionKey,
                rosterId: this.sessionId
            }), b);
        },
        _loading: function(a) {
            a === !1 ? (this.isLoading = !1, this.$el.loading(!1)) : (this.isLoading = !0, this.$el.loading({
                color: "#fff",
                length: 6,
                width: 2,
                radius: 4,
                left: -3
            }));
        },
        stopListen: function() {}
    });
}), define("text!template/meet/record/recording.html", [], function() {
    return '{{!-- show meet recording info on attendee side --}}\n<div class="meet-record-container">\n	<span class="pull-left">\n	{{#if recording}}\n		<i class="micon-rec size16"></i> {{lang.recording}}\n	{{else}}\n		{{#if paused}}\n		<i class="micon-rec-empty size16"></i> {{lang.meet_recording_is_paused}}\n		{{/if}}\n	{{/if}}\n	</span>\n</div>\n';
}), define("meet/record/recording", [ "moxtra", "lang", "app", "const", "text!template/meet/record/recording.html", "meet/meetBiz" ], function(a, b, c, d, e, f) {
    var g = (MX.logger("meet:recording"), Handlebars.compile(e));
    return a.Controller.extend({
        tagName: "div",
        init: function(a) {
            this.sessionKey = a.profile.sessionKey, this.meetModel = f.getMeetModel(), this.$scope.lang = b, 
            this.listenTo(this.meetModel, "change:latestRecordingState", this.update);
        },
        rendered: function() {
            var a = this.meetModel.get("latestRecordingState");
            a ? this.update(this.meetModel, a) : (this.$el.append($(g({
                lang: b,
                recording: !1,
                paused: !1
            }))), this.adjust(!1, !1));
        },
        update: function(a, c) {
            var e = !1, f = !1;
            [ d.meet.recordingStatus.started, d.meet.recordingStatus.resumed ].indexOf(c) > -1 ? (e = !0, 
            f = !1) : d.meet.recordingStatus.paused === c ? (e = !1, f = !0) : (e = !1, f = !0), 
            this._setStorage(f), this.$el.empty(), this.$el.append($(g({
                lang: b,
                recording: e,
                paused: f
            }))), this.adjust(e, f);
        },
        adjust: function(a, b) {
            a || b ? $(".mx-meet-side").addClass("recording-active") : $(".mx-meet-side").removeClass("recording-active");
        },
        _setStorage: function(a) {
            var b = {};
            b[this.sessionKey] = {
                paused: a
            }, c.status.set("mxMeetRecorder", b);
        }
    });
}), define("text!template/meet/alerts/voiceAlert.html", [], function() {
    return '<div class="mx-meet-voice-alert">\n	<div class="reclaim-alert warning-tip hide">\n		\n	</div>\n	<div class="muted-alert warning-tip hide">\n		<div class="row">\n			<div class="col-sm-11">\n				<span class="message">{{lang.device_mic_muted_tip}}</span>\n			</div>\n			<div class="col-sm-1">\n				<button data-action="closeMutedAlert" class="close">&times;</button>\n			</div>\n		</div>\n	</div>\n	<div class="speaker-alert warning-tip hide">\n		<div class="row">\n			<div class="col-sm-11">\n				<span class="message">{{lang.device_level_speaker_tip}}</span>\n			</div>\n			<div class="col-sm-1">\n				<button data-action="closeSpeakerAlert" class="close">&times;</button>\n			</div>\n		</div>\n	</div>\n	<div class="mic-alert warning-tip hide">\n		<div class="row">\n			<div class="col-sm-11">\n				<span class="message">{{lang.device_level_mic_tip}}</span>\n			</div>\n			<div class="col-sm-1">\n				<button data-action="closeMicAlert" class="close">&times;</button>\n			</div>\n		</div>\n	</div>\n	<div class="mic-status-alert warning-tip hide">\n		<div class="row">\n			<div class="col-sm-11">\n				<span class="message">{{bbcode lang.device_mic_status_tip}}</span>\n			</div>\n			<div class="col-sm-1">\n				<button data-action="closeMicStatusAlert" class="close">&times;</button>\n			</div>\n		</div>\n	</div>\n</div>';
}), define("text!template/meet/alerts/reclaim.html", [], function() {
    return '<div class="row">\n	<div class="col-sm-11">\n		<span class="message">{{lang.meet_reclaim_host_tip}}</span> \n		<div><a class="mouse-hand" data-action="reclaim">{{lang.reclaim_host}}</a></div>\n	</div>\n	<div class="col-sm-1">\n		<button data-action="closeReclaimAlert" class="close">&times;</button>\n	</div>\n</div>';
}), define("meet/alerts/voiceAlert", [ "moxtra", "lang", "app", "const", "text!template/meet/alerts/voiceAlert.html", "text!template/meet/alerts/reclaim.html", "meet/connector/util", "meet/meetBiz" ], function(a, b, c, d, e, f, g, h) {
    var i = MX.logger("meet:voicealert"), j = Handlebars.compile(f);
    return a.Controller.extend({
        template: e,
        handleAction: !0,
        events: {
            "click .mic-status-alert b": "testAudio"
        },
        init: function(a) {
            this.profile = a.profile || {}, this.$scope.lang = b, this.model = h.getAudioModel(), 
            this.listenTo(this.model, "change:deviceWarning", this.update), this.listenTo(this.model, "change:mutedDone", this.onMuted), 
            this.listenTo(this.model, "change:actionDone", this.onAction), this.listenTo(this.model, "change:micStatusUpdated", this.onMicStatus), 
            this.listenTo(this.model, "change:isEnabled", this.onAudioStatus), this.participants = h.getParticipantList(), 
            this.listenTo(this.participants, "add", this.onParticipantAdded), this.meetModel = h.getMeetModel(), 
            this.listenTo(this.meetModel, "change:isMeetHost", this.onHostChanged);
        },
        rendered: function() {
            this.speaker = this.$(".speaker-alert"), this.mic = this.$(".mic-alert"), this.mutedTip = this.$(".muted-alert"), 
            this.micStatusTip = this.$(".mic-status-alert"), this.reclaimTip = this.$(".reclaim-alert");
        },
        closeSpeakerAlert: function() {
            i.logServer(g.logFormat('[User Action] click "X" of Speaker Alert ')), this.speaker.addClass("hide");
        },
        closeMicAlert: function() {
            i.logServer(g.logFormat('[User Action] click "X" of Mic Alert ')), this.mic.addClass("hide");
        },
        closeMutedAlert: function() {
            i.logServer(g.logFormat('[User Action] click "X" of Muted Alert ')), this.mutedTip.addClass("hide");
        },
        closeMicStatusAlert: function() {
            i.logServer(g.logFormat('[User Action] click "X" of Mic Status Alert ')), this.micStatusTip.addClass("hide");
        },
        closeReclaimAlert: function() {
            i.logServer(g.logFormat('[User Action] click "X" of Reclaim Alert ')), this.reclaimTip.addClass("hide");
        },
        update: function(a) {
            var b = a.toJSON();
            0 === b.deviceLevel.speaker ? this.speaker.removeClass("hide") : this.speaker.addClass("hide"), 
            0 === b.deviceLevel.microphone ? b.isMuted || this.mic.removeClass("hide") : this.mic.addClass("hide");
        },
        onMuted: function() {
            i.logServer(g.logFormat("[onMuted] show device_mic_muted_tip tip")), this.mutedTip.removeClass("hide");
        },
        onAction: function(a) {
            var b = a.toJSON();
            b.isEnabled ? b.isMuted || this.mutedTip.addClass("hide") : (this.mutedTip.addClass("hide"), 
            this.micStatusTip.addClass("hide"));
        },
        onMicStatus: function(a) {
            var b = a.toJSON();
            b.isEnabled && !b.micStatus ? this.micStatusTip.removeClass("hide") : this.micStatusTip.addClass("hide");
        },
        onAudioStatus: function(a) {
            var b = a.toJSON();
            b.isEnabled || (this.speaker.addClass("hide"), this.mic.addClass("hide"), this.mutedTip.addClass("hide"), 
            this.micStatusTip.addClass("hide"));
        },
        onParticipantAdded: function(a) {
            a.get("inSession") && a.get("enableReclaim") && !this.reclaimShown && (this.reclaimShown = !0, 
            this.reclaimTip.html(j({
                lang: b
            })).removeClass("hide"));
        },
        onHostChanged: function(a, b) {
            b && this.reclaimTip.addClass("hide");
        },
        reclaim: function() {
            var a = this;
            Moxtra.reclaimMeetHost(this.profile.sessionKey).success(function() {
                a.reclaimTip.addClass("hide"), MX.ui.notifySuccess(b.meet_reclaim_host_success);
            }).error(function() {
                MX.ui.notifyError(b.meet_reclaim_host_failed);
            });
        },
        testAudio: function() {
            this.model.get("isEnabled") && h.configAudio();
        }
    });
}), define("text!template/meet/guideline/emptyUI.html", [], function() {
    return '<div class="mx-meet-guideline-emptyui">\n	<div class="guideline-emptyui-wrap">\n		<div class="guideline-emptyui-container">\n			<ul class="actions">\n				<li class="item">\n					<div class="action-item" data-action="invite">\n						<div class="action-icon"><i class="micon-contact-2x size48"></i></div>\n						<div class="action-title ellipsis">{{lang.invite}}</div>\n					</div>\n				</li>\n				<li class="item share-file-item dropdown">\n					<div class="action-item action-item-disable" data-action="shareFile">\n						<div class="action-icon"><i class="micon-files-2x size48"></i></div>\n						<div class="action-title ellipsis">{{lang.share_file}}</div>\n					</div>\n					<span class="action-share-file" data-toggle="dropdown">&nbsp;</span>\n					{{addPageMenu \'pull-right\' session_key}}\n				</li>\n				<li class="item">\n					<div class="action-item action-item-disable" data-action="shareScreen">\n						<div class="action-icon"><i class="micon-share-2x size48"></i></div>\n						<div class="action-title ellipsis">{{lang.share_screen}}</div>\n					</div>\n				</li>\n			</ul>\n		</div>\n	</div>\n</div>';
}), define("meet/guideline/emptyUI", [ "moxtra", "lang", "app", "text!template/meet/guideline/emptyUI.html", "meet/meetBiz", "binder/binderActions", "component/uploader/uploader" ], function(a, b, c, d, e, f, g) {
    "use strict";
    return a.Controller.extend({
        template: d,
        handleAction: !0,
        init: function(a) {
            this.profile = a.profile || {}, this.$scope.lang = b, this.$scope.session_key = this.profile.sessionKey || "", 
            this.binderActions = f, this.meetModel = e.getMeetModel(), this.pages = e.getPageList(), 
            this.listenTo(this.meetModel, "change:isMeetPresenter", this._onPresenterChanged);
        },
        rendered: function() {
            this._initShareFile(), c.request.sequence() ? this.hide() : this.show(), this._toggleActive(this.profile.isPresenter);
        },
        show: function() {
            $(".mx-viewer-tips .tips-body").removeClass("hide");
        },
        hide: function() {
            $(".mx-viewer-tips .tips-body").addClass("hide");
        },
        invite: function() {
            this.trigger("invite");
        },
        shareScreen: function() {
            this.trigger("shareScreen");
        },
        shareFile: function() {
            var a = this;
            a.pages.length ? a.trigger("shareFile") : setTimeout(function() {
                a.$(".action-share-file").trigger("click"), e.startShareFile(0), g.refresh("addPageToBinder", a.$("#addpage_flashuploader2"));
            }, 100);
        },
        _initShareFile: function() {
            var a, b = this;
            b.$("#addpage_flashuploader").attr("id", "addpage_flashuploader2"), b.$("ul li.addpage-webdoc").remove(), 
            Moxtra.getMe().id || (b.$("ul li.addpage-remote").remove(), b.$("ul li.addpage-binder").remove()), 
            a = g.register("addPageToBinder", {
                browse_button: "addpage_flashuploader2",
                url: function() {
                    var a = c.request.toJSON();
                    return "/board/upload?type=original&id=" + a.page;
                }
            }), b.$(".share-file-item").on("hide.bs.dropdown", function() {
                g.hide("addPageToBinder");
            });
        },
        _onPresenterChanged: function(a) {
            this._toggleActive(a.get("isMeetPresenter"));
        },
        _toggleActive: function(a) {
            a ? this.$(".action-item-disable").removeClass("disabled") : (this.$(".action-item-disable").addClass("disabled"), 
            this.$(".share-file-item").removeClass("open"));
        }
    });
}), define("text!template/common/meetExpriedAlert.html", [], function() {
    return '<div class="maskAlert" style="z-index: 10000; left:0;">\n    <div class="alert alert-warning fade in alertx-warning">\n        <button type="button" class="close" data-action="closeAlert" data-dismiss="alert" aria-hidden="true">&times;</button>\n      <span>\n			<div class="alert-content">\n                <h4 class="alert-heading"></h4>\n                <p>{{bbcode remainingMsg}}</p>\n                <p>{{bbcode maxMsg}}</p>\n\n            </div>\n			<div class="alert-action">\n                <a href="javascript:;" data-action="closeAlert" class="btn btn-primary btn-sm pull-right">{{lang.ok}}</a>\n            </div>\n		</span>\n    </div>\n</div>';
}), define("common/meetExpriedAlert", [ "moxtra", "lang", "text!template/common/meetExpriedAlert.html", "const" ], function(a, b, c) {
    return a.Controller.extend({
        template: c,
        handleAction: !0,
        init: function(a) {
            this.$scope.lang = b, this.$scope.remainingMsg = MX.format(b.cap_meet_duration_expried_alert, {
                remaining: a.remaining + " " + (a.remaining > 1 ? b.minutes : b.minute)
            }), this.$scope.maxMsg = MX.format(b.cap_meet_duration_max_alert, {
                maxDuration: a.maxDuration
            }), this.status = a.status;
        },
        rendered: function() {},
        closeAlert: function() {
            this.destroy();
        }
    });
}), define("text!template/viewer/main.html", [], function() {
    return '<div class="mx-viewer">\n    <div class="mx-viewer-cwrap">\n        <div class="mx-viewer-header">\n\n        </div>\n\n        <div class="mx-viewer-wrap">\n			<a class="mx-branding-viewer-poweredby mxbrand-powered-by-moxtra"></a>\n			<div class="mx-branding-viewer-watermark mx-viewer-container mxbrand-viewer-bg">\n				<ul class="mx-viewer-floatbar"></ul>\n			</div>\n			<div class="mx-viewer-plugins">\n				{{#unless hidePageTitle}}\n				<div class="page-title ">\n					<span class="ellipsis" ></span>\n				</div>\n				{{/unless}}\n			</div>\n			<div class="mx-viewer-tips">\n				<div class="tips-container">\n					<div class="tips-header others-connecting hide"></div>\n					<div class="tips-header self-connecting hide"></div>\n					<div class="tips-body hide"></div>\n					<div class="tips-footer hide"></div>\n				</div>\n			</div>\n			{{#if showApplicationContainer}}\n			<div class="mx-application-container" id="mxApplicationContainer">\n				<div id="mxApplicationWrap" style="width: 0px; height: 0px;">\n					<div class="handle hide"><i class="glyphicon glyphicon-move"></i> {{lang.click_and_move}}</div>\n					<div id="mxMeetPlugin" style="width: 100%; height: 100%;">\n\n					</div>\n				</div>\n			</div>\n			{{/if}}\n\n		</div>\n        <div class="mx-viewer-footer {{#if hideFooter}}hide{{/if}}">\n            <div class="mx-footer-right pull-right"></div>\n            <div class="mx-footer-left"></div>\n        </div>\n		<div class="mx-viewer-side"></div>\n		</div>\n</div>\n';
}), define("text!template/viewer/pager.html", [], function() {
    return '<div class="mx-viewer-pager">\n    <a data-action="nextPage" {{#unless onMobile}}title="{{lang.next_page}}"{{/unless}} href="javascript:;" class="viewer-next mx-viewer-btn pull-right btn-next"><i class="micon-arrow-right"/> </a>\n    <a class=" mx-viewer-btn btn-prev pull-left" {{#unless onMobile}}title="{{lang.prev_page}}"{{/unless}} href="javascript:;"\n       data-action="prevPage"><i class="micon-arrow-left"/></a>\n</div>';
}), define("text!template/viewer/button.html", [], function() {
    return '    <a  id="{{id}}" class="mx-viewer-btn {{className}} mouse-hand" title="{{title}}" {{#if attribute}}{{attribute}}{{/if}} data-action="{{action}}" data-param="{{param}}" ><i class="{{icon}}"/>{{text}}</a>';
}), define("viewer/static", [ "moxtra", "text!template/viewer/button.html" ], function(a, b) {
    var c = MX.ns("MX.viewer"), d = {}, e = {};
    return c.extend({
        btnTpl: Handlebars.compile(b),
        registerPlugin: function(a, b) {
            d[a] = b;
        },
        getPlugin: function(a) {
            return d[a];
        },
        addCommand: function(a, b) {
            e[a] = b;
        },
        getCommands: function() {
            return e;
        }
    }), c;
}), define("viewer/plugin/pager", [ "moxtra", "text!template/viewer/pager.html", "viewer/static", "lang" ], function(a, b, c, d) {
    c.registerPlugin("pager", a.Controller.extend({
        container: "plugins",
        template: b,
        init: function(a) {
            this.$scope.lang = d, this.$scope.onMobile = !!MX.env.isMobile, this.listenTo(a.parent, "onFirstPage", this._onFirstPage), 
            this.listenTo(a.parent, "onLastPage", this._onLastPage), this.listenTo(a.parent, "switchPage", this._onSwitchPage);
        },
        _onSwitchPage: function() {
            this.$(".mx-viewer-btn").removeClass("disabled").tooltip("hide");
        },
        _onLastPage: function() {
            this.$(".btn-next").addClass("disabled").tooltip("destroy");
        },
        _onFirstPage: function() {
            this.$(".btn-prev").addClass("disabled").tooltip("destroy");
        },
        activePanel: function(a) {
            this.$(".btn-" + a).removeClass("disabled");
        },
        unactivePanel: function(a) {
            this.$(".btn-" + a).addClass("disabled");
        }
    }));
}), define("text!template/viewer/thumbnails.html", [], function() {
    return '<div class="mx-viewer-thumbnails">\n    <div class="viewer-thumbnails-actions" style="pointer-events:none">\n        <a data-action="thumbnailsNext"  href="javascript:;" class="viewer-next mx-viewer-btn pull-right"><i class="micon-arrow-right size24"/> </a>\n        <a class=" mx-viewer-btn pull-left" href="javascript:;"\n           data-action="thumbnailsPrev"><i class="micon-arrow-left"/></a>\n    </div>\n    <div class="viewer-thumbnails-wrap">\n        <div class="thumbnails-space">\n\n        </div>\n    </div>\n</div>';
}), define("text!template/viewer/thumbnailItem.html", [], function() {
    return '<li  data-action="gotoPage" data-param="{{sequence}}">\n    <div class="page-cover" title="{{name}}">\n        <div class="page-cover-wrap"><img src="{{blankImg}}"\n           class="lazy" data-original="{{thumbnail}}"></div>\n    </div>\n</li>\n';
}), define("viewer/plugin/thumbnails", [ "moxtra", "app", "lang", "text!template/viewer/thumbnails.html", "text!template/viewer/thumbnailItem.html", "viewer/static" ], function(a, b, c, d, e, f) {
    a.logger("Viewer:Pager");
    f.registerPlugin("thumbnails", a.Controller.extend({
        container: "plugins",
        template: d,
        handleAction: !0,
        init: function(a) {
            this.listenTo(a.parent, "modelChange", this.focusItem), this.listenTo(a.parent, "close", this.hidePanel), 
            this.listenTo(a.parent, "resize", this.onResize), this.parent = a.parent;
            var b = $(MX.viewer.btnTpl({
                title: c.thumbnail,
                action: "toggleThumbnails",
                icon: "micon-thumbnail"
            }));
            b.on("click", $.proxy(this.toggle, this)), this.btn = b, this.isShow = !1, this.parent.getContainer("footerLeft").append(b);
        },
        onResize: function() {
            this.isShow && (this.hidePanel(), this.showPanel());
        },
        show: function() {
            this.btn.show();
        },
        hide: function() {
            this.btn.hide(), this.hidePanel();
        },
        focusItem: function(a) {
            if (a) {
                var b;
                this.sequence && this.$('[data-param="' + this.sequence + '"]').removeClass("active"), 
                b = a.get("sequence");
                var c = this.$('[data-param="' + b + '"]');
                if (c.length) {
                    c.addClass("active");
                    var d, e = c.position().left;
                    d = Math.max(e - 100, 0);
                }
                this.model = a, this.sequence = b;
            }
        },
        rendered: function() {
            this.box = this.$(".thumbnails-space");
        },
        thumbnailsNext: function() {
            var a = this.box.get(0), b = this.box.scrollLeft();
            a.offsetWidth <= a.scrollWidth - b && this.box.animate({
                scrollLeft: "+=" + a.offsetWidth
            }, 200);
        },
        thumbnailsPrev: function() {
            var a = this.box.get(0), b = this.box.scrollLeft();
            b > 0 && (b = Math.max(0, b - a.offsetWidth), this.box.animate({
                scrollLeft: b
            }, 200));
        },
        toggle: function() {
            return this.isShow ? this.hidePanel() : this.showPanel(), this.isShow;
        },
        showPanel: function() {
            var c;
            if (!this.list) {
                var d = this.box;
                this.list = new a.List({
                    renderTo: d,
                    speedup: !0,
                    unifyLazyload: !0,
                    template: e,
                    lazyload: d,
                    $scope: {
                        blankImg: b.const.defaults.blankImg
                    }
                }), c = !0;
            }
            this.list.collection && this.list.collection.$id == this.parent.collection.$id || (this.list.binding(this.parent.collection), 
            this.box.trigger("scroll")), this.parent.collection.$name || this.list.filter(function(a) {
                var b = a.get("type");
                return "ds" == b ? !1 : !0;
            }), this.$el.show(), this.focusItem(this.model), this.isShow = !0;
        },
        hidePanel: function() {
            this.$el.hide(), this.isShow = !1;
        }
    }));
}), define("text!template/viewer/comments.html", [], function() {
    return '<div class="mx-viewer-comments">\n\n    <div class="mx-comments-container">\n       <!--  <div class="more">\n            <a class="btn btn-link">View More</a>\n        </div> -->\n        <div class="prev-pages">\n\n        </div>\n        <div class="last-page">\n\n        </div>\n    </div>\n\n    <div class="page-comment-typeahead-helper" style="display:none">\n    </div>\n    <div class="mx-comment-input row">\n        <div class="col-md-12">\n            <textarea type="text" style="min-height: 50px" class="form-control" name="comments"  placeholder="{{lang.add_comment}}"></textarea>\n        </div>\n    </div>\n</div>\n';
}), define("text!template/viewer/commentItem.html", [], function() {
    return '<div id="comment{{sequence}}" class="row page-comment-item" data-param="{{sequence}}">\n    {{avatarView creator}}\n    <div class="page-comment-context">\n        <div class="comment-entity">\n            {{#if isMyComment}}\n            <button type="button" class="delete" data-action="removePageComment" data-param="{{sequence}}"\n                    aria-hidden="true"><i class="micon-close size12"></i>\n            </button>\n            {{#unless resource}}\n                <button type="button" class="edit-comment pull-right" data-action="editPageComment" data-param="{{sequence}}" aria-hidden="true">\n                    <i class="micon-pencil size12"></i>\n                </button>\n            {{/unless}}\n            {{/if}}\n            <div>\n                {{creator.user.displayName}}\n            </div>\n\n            {{!-- voice comment --}}\n            {{#if resource}}\n            <div class="comment-voice">\n				<a class="play-btn"><i class="micon-play-with-circle size16"></i></a>\n				<div class="voice-progress" style="width: {{durationWitdh}}px;">\n					<div class="bar"></div>\n				</div>\n				<span class="voice-time">{{duration}}</span>\n				<div style="display:none;">\n	        		<audio controls="controls">\n	        			<source src="{{voice}}" type="audio/x-m4a">\n	        			<source src="{{voice}}" type="audio/mpeg">\n	        			{{lang.browser_not_support_audio_tag}}\n					</audio>\n				</div>\n			</div>\n            {{else}}\n            <div class="comment-text">\n                {{linkMode text}}\n            </div>\n            {{/if}}\n\n            <em>\n                {{formatter \'formatDate\' created_time}}\n            </em>\n        </div>\n    </div>\n</div>\n';
}), define("text!template/component/inlineEditor.html", [], function() {
    return '<div class="inline-editor">\n    <form role="form">\n        <div class="form-group">\n            <textarea name="{{bindingPath}}" class="form-control noResize" rows="2"></textarea>\n        </div>\n    </form>\n</div>';
}), define("component/editor/inlineEditor", [ "moxtra", "lang", "text!template/component/inlineEditor.html" ], function(a, b, c) {
    return a.Controller.extend({
        template: c,
        handleAction: !0,
        events: {
            "blur textarea": "submit"
        },
        init: function(c) {
            this.$scope.lang = b, _.extend(this, _.pick(c, [ "replaceElement", "onSubmit", "model", "bindingPath" ])), 
            this.$scope.bindingPath = this.bindingPath, this.replaceElement.hide(), this.render(), 
            this.form = new a.Form({
                form: this.$("form"),
                model: this.model,
                submit: this.submit,
                scope: this
            }), this.replaceElement.after(this.$el);
            var d = this.$("textarea");
            d.on("keyup", function(a) {
                a.keyCode !== Moxtra.const.KEYBOARD_Escape && a.stopPropagation();
            }).on("keydown", function(a) {
                a.stopPropagation();
            });
            var e = this.replaceElement, f = {
                "font-size": e.css("font-size"),
                "font-family": e.css("font-family"),
                color: e.css("color"),
                "line-height": e.css("line-height"),
                height: e.height()
            };
            d.css(f), setTimeout(function() {
                d.autosize(), d.focus();
            }, 100);
        },
        rendered: function() {},
        submit: function() {
            this.model.isValid(!0) && this.onSubmit.call(this, this.model), this.exitEdit();
        },
        exitEdit: function() {
            var a = this.handleEvent;
            a && a.stopPropagation(), this.replaceElement.show(), this.$("textarea").trigger("autosize.destroy"), 
            this.destroy();
        }
    });
}), define("text!template/component/inputTextSelector.html", [], function() {
    return '<div class="input-selector">\n    <div class="input-selector-header">\n        <span class="input-selector-label">&nbsp;</span>\n        <span class="input-selector-help">{{{lang.input_selector_help}}}</span>\n    </div>\n    <div class="input-container">\n    </div>\n</div>\n';
}), define("text!template/component/inputTextSelectorItem.html", [], function() {
    return '<li class="mx-item list-group-item" data-action="autoInput" data-param="{{#if isGroup}}{{group.name}}{{else}}{{user.first_name}}{{/if}}">\n    <img class="img-circle" src="{{avatar}}">\n    <span>{{#if isGroup}}{{group.name}}{{else}}{{user.first_name}}{{/if}}</span>\n</li>\n';
}), define("component/selector/inputTextSelector", [ "moxtra", "lang", "app", "text!template/component/inputTextSelector.html", "text!template/component/inputTextSelectorItem.html" ], function(a, b, c, d, e) {
    MX.logger("InputTextSelector");
    return a.ui.InputTextSelector = a.Controller.extend({
        template: d,
        handleAction: !0,
        init: function(a) {
            this.$scope.lang = b, this.collection = a.collection, this.container = a.renderTo, 
            this.contextBox = a.contextBox, this.textarea = a.textarea, this.recovery(this.collection);
        },
        rendered: function() {
            var c = this;
            this.list = new a.List({
                renderTo: this.container + " .input-container",
                collection: this.collection,
                template: e,
                $scope: {
                    lang: b
                }
            }), this.textarea.bind("focus", function() {
                setTimeout(function() {
                    c.textarea.trigger("keyup");
                }, 300);
            }).bind("blur", function() {
                setTimeout(function() {
                    c.$el.parents(c.container).hide();
                }, 300);
            }), this.listenTo(this.list, "filter", function() {
                c._resizeSelector();
            }), this.list.$el.addClass("list-group"), $(document).resize(function() {
                c._resizeSelector();
            });
        },
        _resizeSelector: function() {
            var a = this, b = a.$el.find(".input-container");
            b.height("");
            var c = a.$el.parent().width(a.textarea.innerWidth()), d = c.height() < a.$el.height() ? c.height() : a.$el.height(), e = a.contextBox.height() + a.contextBox.css("bottom") - a.textarea.parent().height();
            d > e ? c.css("top", "0") : c.css("top", "auto"), d = c.height() < a.$el.height() ? c.height() : a.$el.height(), 
            b.height(d - 26 + "px");
        },
        handleKeyDown: function(a) {
            function b(a, b) {
                var c = a.height(), d = b.position().top - 28, e = b.outerHeight();
                return d > 0 && c > d + e;
            }
            var d, e = this.$el.find(".mx-item.select");
            a.keyCode === c.const.keys.Up ? (e.prev().length && (e.removeClass("select"), d = e.prev(), 
            d.addClass("select"), b(d.parent(), d) || d.parents(".input-container").scrollTop(d.position().top + d.parents(".input-container").scrollTop() - 28)), 
            a.preventDefault()) : a.keyCode === c.const.keys.Down && (e.next().length && (e.removeClass("select"), 
            d = e.next(), d.addClass("select"), b(d.parent(), d) || d.parents(".input-container").scrollTop(d.position().top + d.parents(".input-container").scrollTop() - d.parent().outerHeight() + d.outerHeight() - 28)), 
            a.preventDefault());
        },
        filter: function(a) {
            this.list.filter("" === a ? function(a) {
                var b;
                return b = a.isGroup ? a.group.name.toLowerCase() : a.user.first_name.toLowerCase(), 
                b && "" !== b ? !0 : !1;
            } : function(b) {
                var c;
                return c = b.isGroup ? b.group.name.toLowerCase() : b.user.first_name.toLowerCase(), 
                c && "" !== c ? c.indexOf(a.toLowerCase()) > -1 : !1;
            }), this.$(".mx-item:first-child").addClass("select");
        },
        selectedText: function() {
            var a = this.$(".mx-item.select span");
            return a.length > 0 ? a.html() : "";
        },
        onAutoInput: function(a) {
            this.callback = a;
        },
        autoInput: function(a) {
            this.callback && this.callback(a);
        }
    }), a.ui.InputTextSelector;
}), define("viewer/plugin/comments", [ "moxtra", "app", "lang", "text!template/viewer/comments.html", "text!template/viewer/commentItem.html", "binder/binderBiz", "viewer/static", "component/editor/inlineEditor", "component/selector/inputTextSelector" ], function(a, b, c, d, e, f, g, h, i) {
    "use strict";
    var j = Handlebars.compile(e), k = a.Controller.extend({
        template: e,
        handleAction: !0,
        events: {
            "click .play-btn": "play"
        },
        init: function() {
            if (this.$scope.lang = c, $.extend(this.$scope, this.model.toJSON()), this.model.resource) {
                var a = this.model.resource_length;
                a = (a - a % 100) / 1e3, this.$scope.duration = 3 === (a + "").length ? "0" + a : a, 
                this.$scope.durationWitdh = 4 * a + 40;
            }
            this.listenTo(this.model, "change", this.update);
        },
        rendered: function() {
            if (this.model.resource) {
                var a = this;
                a.$el.find(".bar").css({
                    width: "0%"
                }), a.$el.find("audio").mediaelementplayer({
                    iPadUseNativeControls: !0,
                    iPhoneUseNativeControls: !0,
                    success: function(b) {
                        a.player = b, b.addEventListener("loadedmetadata", function(b) {
                            a._updateDuration(b.currentTarget.duration);
                        }), b.addEventListener("timeupdate", function(b) {
                            a._updateProgress(b.currentTarget.currentTime);
                        }), b.addEventListener("ended", function() {
                            a._endedPlayer();
                        }), b.addEventListener("pause", function() {
                            a._resetPlayer();
                        });
                    }
                });
            }
        },
        update: function() {
            this.model.user.$name || (this.model.user = this.model.creator), $.extend(this.$scope, this.model.toJSON());
            var a = this;
            setTimeout(function() {
                a.updateView(a.$scope);
            }, 500);
        },
        play: function(a) {
            var b = $(a.target).closest("a").find(".micon-play-with-circle");
            b.hasClass("micon-stop") ? (this.player && this.player.stop(), this._resetPlayer()) : (this.player && this.player.play(), 
            b.addClass("micon-stop"));
        },
        _updateDuration: function(a) {
            this.duration = Math.floor(10 * parseFloat(a)) / 10;
            var b = this.duration + "";
            3 == b.length && (b = "0" + b), this.$el.find(".voice-time").html(b), this.$el.find(".voice-progress").css({
                width: 40 + 4 * b + "px"
            });
        },
        _updateProgress: function(a) {
            if (this.duration && 0 !== this.duration) {
                var b = 100 * a / this.duration + "%";
                this.$el.find(".bar").css({
                    width: b
                });
            }
        },
        _endedPlayer: function() {
            this._resetPlayer();
        },
        _resetPlayer: function() {
            this.player.setCurrentTime(0), this.$el.find(".micon-play-with-circle").removeClass("micon-stop"), 
            this.$el.find(".bar").css({
                width: "0%"
            });
        }
    });
    g.registerPlugin("comments", a.Controller.extend({
        template: d,
        container: "side",
        handleAction: !0,
        init: function(a) {
            this.$scope.lang = c, this.countEl = $('<span class="ic-badge"></span>'), this.parent = a.parent;
            var b = $(g.btnTpl({
                title: c.comment,
                action: "toggleComment",
                icon: "micon-comment"
            }));
            this.isShow = !1, b.on("click", $.proxy(this.toggleView, this)), this.countEl.appendTo(b), 
            this.btn = b, this.parent.getContainer("footerRight").append(b), this.recovery(this.comments), 
            this.parent.on("close", this.hidePanel, this), this.parent.on("modelChange", this.update, this);
        },
        show: function() {
            this.btn.show();
        },
        hide: function() {
            this.btn.hide();
        },
        toggleView: function() {
            this.isShow ? this.hidePanel() : this.showPanel({
                isFocus: !0
            });
        },
        showPanel: function(a) {
            this.isShow = !0, this.parent.showSide(), this.parent.userRole === Moxtra.const.BOARD_READ ? this.$(".mx-comment-input").hide() : (this.$('textarea[name="comments"]').show(), 
            a && a.isFocus && this.$(".mx-comment-input textarea").focus()), this.scrollToBottom(), 
            this.btn.tooltip("hide");
        },
        hidePanel: function() {
            this.isShow = !1, this.parent.hideSide();
        },
        rendered: function() {
            var a = this;
            this.$('textarea[name="comments"]').on("keydown", $.proxy(this.postComment, this)).on("keyup", function(b) {
                a.typeAhead(b), b.keyCode !== Moxtra.const.KEYBOARD_Escape && b.stopPropagation();
            }).autosize().trigger("autosize.resize"), this.$el.delegate(".page-comment-item", "mouseenter", function() {
                var b = parseInt($(this).attr("data-param")), c = a.comments.get(b);
                c && Date.now() - c.created_time <= Moxtra.const.LIMITED_COMMENTS_DELETE_TIME && $(this).find(".delete,.edit-comment").css("opacity", "0.8");
            }), this.$el.delegate(".page-comment-item", "mouseleave", function() {
                $(this).find(".delete, .edit-comment").css("opacity", "0");
            }), MX.env.isIE && this.$('textarea[name="comments"]').placeholder(), this.container = this.$(".mx-comments-container");
        },
        update: function(a) {
            if (a.page_type === Moxtra.const.PAGE_TYPE_ANY) return void this.hide();
            this.show(), this.stopListening(this.comments);
            var c = b.request.toJSON(), d = this.parent.model, e = d.get("boardid") || c.page, f = d.get("sequence") || c.sequence;
            if (this.req = c, c.page && f) {
                this.container.empty();
                var g = Moxtra.getBoardPages(e), h = g.get(f);
                if (this.comments = h && h.comments, !this.comments) return;
                this.updateView(), this.listenTo(this.comments, "inited", this.updateView), this.listenTo(this.comments, "add", this.addItem), 
                this.listenTo(this.comments, "remove", this.removeItem);
            } else this.comments.destroy();
        },
        scrollToBottom: function() {
            var a = this;
            setTimeout(function() {
                a.container.scrollTop(a.container.get(0).scrollHeight);
            }, 100);
        },
        updateView: function() {
            if (this.comments) {
                var a = this.comments, b = this, c = b.container;
                c.empty(), a.each(function(a) {
                    b.addItem(a);
                }), b.countEl.text(a.length <= 0 ? "" : a.length);
            }
        },
        addItem: function(a) {
            a.user.$name || (a.user = this.parent.model.parent.members.get(a.user.id));
            var b = this.$("#comment" + a.client_uuid);
            b.length && b.remove(), new k({
                renderTo: this.container,
                model: a
            }), this.countEl.text(this.comments.length);
        },
        removeItem: function(a) {
            this.$("#comment" + a.get("sequence")).remove(), this.countEl.text(this.comments.length);
        },
        editPageComment: function(a) {
            var d = this.comments.get(a), e = b.request.toJSON(), g = this.parent.model, i = g.get("boardid") || e.page, j = g.get("sequence") || e.sequence, k = this.handleEvent, l = $(k.currentTarget).closest(".page-comment-item");
            new h({
                replaceElement: l.find(".comment-entity"),
                model: d,
                bindingPath: "text",
                onSubmit: function() {
                    var b = this, e = d.get("text");
                    $("#comment" + d.get("sequence")).find(".comment-text").text(e), f.updatePageComment(i, j, a, e).success(function() {
                        MX.ui.notifySuccess(c.update_comment_success), b.exitEdit();
                    }).error(function() {
                        MX.ui.notifyError(c.update_comment_failed);
                    });
                }
            });
        },
        removePageComment: function(a) {
            var d = b.request.toJSON(), e = this.parent.model, g = e.get("boardid") || d.page, h = e.get("sequence") || d.sequence, i = this.handleEvent, j = $(i.currentTarget).closest(".page-comment-item");
            MX.ui.Confirm(c.confirm_delete_comment, function() {
                f.removePageComment(g, h, a).success(function() {
                    MX.ui.notifySuccess(c.delete_comment_success), j.remove();
                }).error(function() {
                    MX.ui.notifyError(c.delete_comment_failed);
                });
            });
        },
        postComment: function(a) {
            if (this.typeAheadMode && this.inputSelector.handleKeyDown(a), a.stopPropagation(), 
            a.keyCode === b.const.keys.Enter && !a.shiftKey && (a.preventDefault(), !this.typeAheadMode)) {
                var d = $(a.target), e = $.trim(d.val());
                if (e.length > 0) {
                    var f = this, g = this.parent.model, h = new Moxtra.model.Comment();
                    h.set("text", e), h.create(g).error(function() {
                        MX.ui.notifyError(c.post_comment_failed);
                    }).success(function() {
                        f.scrollToBottom();
                    }), this.container.append(j({
                        text: e,
                        user: {
                            user: Moxtra.getMe()
                        },
                        sequence: h.client_uuid,
                        creator: {
                            user: Moxtra.getMe(),
                            avatar: Moxtra.getMe().avatar
                        }
                    })), d.val("").trigger("autosize.resize");
                }
            }
        },
        typeAhead: function(a) {
            var c = $(a.target), d = c.val(), e = this, f = /(?:^|[\b\s]+)@(\S*)$/, g = this.parent.model.parent;
            if (50 === a.keyCode || this.typeAheadMode && a.keyCode !== b.const.keys.Enter && a.keyCode !== b.const.keys.Up && a.keyCode !== b.const.keys.Down && a.keyCode !== b.const.keys.Escape) if (d && f.test(d)) {
                this.inputSelector || (this.inputSelector = new i({
                    collection: g.members,
                    renderTo: ".page-comment-typeahead-helper",
                    textarea: c,
                    contextBox: $(".mx-comments-container")
                }), this.inputSelector.onAutoInput(function(a) {
                    c.val(c.val().replace(/@[^\s@]*$/, "@" + a + " ")).focus(), e.$(".page-comment-typeahead-helper").hide(), 
                    e.typeAheadMode = !1;
                }), this.recovery(this.inputSelector)), this.$(".page-comment-typeahead-helper").show(), 
                this.typeAheadMode = !0;
                var h = d.match(f)[1];
                this.inputSelector.filter(h), "" === this.inputSelector.selectedText() && this.$(".page-comment-typeahead-helper").hide();
            } else this.typeAheadMode && (this.$(".page-comment-typeahead-helper").hide(), this.typeAheadMode = !1); else a.keyCode !== b.const.keys.Enter || a.shiftKey ? a.keyCode === b.const.keys.Escape && (this.$(".page-comment-typeahead-helper").hide(), 
            this.typeAheadMode = !1) : (a.preventDefault(), this.typeAheadMode ? (c.val(c.val().replace(/@\w*$/g, "@" + this.inputSelector.selectedText() + " ")), 
            this.$(".page-comment-typeahead-helper").hide(), this.typeAheadMode = !1) : this.typeAheadMode = !1);
        },
        resendComment: function() {}
    }));
}), define("viewer/imageView", [ "moxtra", "app" ], function(a, b) {
    "use strict";
    var c = a.logger("Viewer:ImageView");
    return a.Controller.extend({
        tagName: "div",
        className: "mx-viewer-subview mx-viewer-image",
        init: function(a) {
            this.listenTo(a.parent, "modelChange", this._onModelChange), this.listenTo(a.parent, "resize", this.adjustImage), 
            this.parent = a.parent;
        },
        _onModelChange: function(a, b) {
            if (a) {
                var d = this, e = (d.loader = new Image(), a.get("type"));
                return this.model && this.stopListening(this.model), this.model = a, this.listenTo(a, "change:rotate", this.onRotate, this), 
                /image|pdf/.test(e) ? (c.debug("model change in image view"), this.show(a, b)) : void this.hide();
            }
        },
        onRotate: function(a) {
            this.rotate(a);
        },
        show: function(a, c, d) {
            this.isShow = !0;
            var e = this;
            if (e.$el.empty().show(), a) {
                var f = (a.get("sequence"), a.get("rotate") || 0);
                e.$el.loading({
                    length: 7,
                    color: "#fff"
                });
                var g = $(document.createElement("img")).attr({
                    src: b.const.defaults.blankImg,
                    height: "100%",
                    width: "100%"
                });
                g.on("load", function() {
                    e.$el.loading(!1);
                }).on("error", function() {
                    e.$el.loading(!1);
                }), d ? g.attr("src", a.get("originalResource")) : g.attr("src", a.get("source")), 
                g.appendTo(e.el), 0 !== f && this.rotate(f);
            }
        },
        hide: function() {
            this.isShow = !1, this.$el.loading(!1), this.$el.empty(), this.$el.hide();
        },
        rotate: function(a) {
            a % 90 !== 0 && (a = 0);
            var b = "rotate(" + a + "deg)";
            this.$("img").css({
                "-o-transform": b,
                "-webkit-transform": b,
                "-moz-transform": b,
                "-ms-transform": b,
                transform: b
            }), this.parent.zoom(), this.adjustImage(this.parent.viewRealSize);
        },
        adjustImage: function(a) {
            var b = this.parent.model.get("rotate") || 0, c = a.width, d = a.height, e = (d - c) / 2;
            this.$("img").css(b % 180 !== 0 ? {
                height: c,
                width: d,
                left: 0 - e,
                bottom: e
            } : {
                height: d,
                width: c,
                left: 0,
                bottom: 0
            });
        }
    });
}), define("viewer/mediaView", [ "moxtra", "text!template/viewer/audioView.html", "text!template/viewer/videoView.html" ], function(a, b, c) {
    "use strict";
    var d = a.logger("Viewer:AudioView"), e = {
        audio: Handlebars.compile(b),
        video: Handlebars.compile(c)
    };
    return e.note = e.video, a.Controller.extend({
        tagName: "div",
        className: "mx-viewer-subview mx-viewer-media",
        handleAction: MX.env.isMobile ? !0 : !1,
        init: function(a) {
            this.listenTo(a.parent, "modelChange", this._onModelChange), this.listenTo(a.parent, "close", this._onClose), 
            this._player = {}, this.parent = a.parent;
        },
        _onClose: function() {
            if (this.player()) try {
                this.player().pause();
            } catch (a) {}
        },
        _onModelChange: function(a, b) {
            if (a) {
                var c = this, d = a.get("type");
                if (this.model && this.stopListening(this.model), !/audio|video|note/.test(d)) return c.hide();
                c.model = a, this.listenTo(a, "change", function(a) {
                    var b = a.changed;
                    b && (b && void 0 !== b.rotate && c.onRotate(), void 0 !== b.source && (c.player().src = a.get("source")), 
                    "video" === a.get("type") && void 0 !== b.thumbnail && (c.player().poster = a.get("thumbnail")));
                }, this), MX.env.isFF && (this._player = {}, this.$el.empty()), c.show(a, b);
            }
        },
        onRotate: function(a, b) {
            this.rotate(b);
        },
        _onResize: function(a) {
            this.model && "audio" === this.model.get("type") && this.$(".mejs-audio").top(a.height / 2), 
            this.$el.css(a);
        },
        player: function() {
            if (!this.model) return null;
            var a = this.model.get("type");
            return "note" === a && (a = "video"), this._player[a];
        },
        show: function(a, b) {
            var c = this;
            if (c.$el.show(), a) {
                if (MX.env.isMobile) return void c.$el.append(e[a.get("type")](_.extend(a.toJSON(), {
                    isMobile: !0,
                    width: c.parent.viewRealSize.width,
                    height: c.parent.viewRealSize.height
                })));
                var d = a.get("type");
                if ("note" === d && (d = "video"), this.$el.removeClass("video" === d ? "audio" : "video").addClass(d), 
                this.player()) {
                    var f = a.toJSON();
                    c.player().setSrc(f.source);
                    var g = $(c.player()).data("mediaelementplayer");
                    if ("video" === d) {
                        var h = this.parent.viewRealSize;
                        g.setPlayerSize(h.width, h.height), c.player().poster = f.thumbnail, c.$el.addClass("no-svg");
                    } else g.setPlayerSize(400, 30);
                } else c.$el.append(e[a.get("type")](a.toJSON())), c.$(d).mediaelementplayer({
                    iPadUseNativeControls: !0,
                    iPhoneUseNativeControls: !0,
                    flashName: "lib/mediaelement/build/flashmediaelement.f82e1f90.swf",
                    success: function(a) {
                        c._player[d] = a, a.addEventListener("play", function() {
                            c._triggerEvent("play", b);
                        }), a.addEventListener("pause", function() {
                            c._triggerEvent("pause", b);
                        }), a.addEventListener("ended", function() {
                            c._triggerEvent("end", b);
                        }), addEventListener("seeked", function() {
                            c._triggerEvent(c.player.paused ? "pause" : "play", b);
                        }), a.load();
                    }
                });
                var i = a.get("rotate");
                i && i > 0 && c.rotate(i);
            }
        },
        hide: function() {
            var a = this;
            try {
                a.player() && a.player().stop();
            } catch (b) {}
            a.$el.hide(), MX.env.isMobile && a.$el.empty();
        },
        _triggerEvent: function(a, b) {
            var c = this;
            b.suppress_event ? b.suppress_event = !1 : b.trigger("viewer:pageAction", {
                view: c.model.get("type"),
                cmd: a,
                currentTime: c.player().currentTime,
                page_sequence: c.model.get("sequence"),
                video_sequence: c.model.get("sequence")
            });
        },
        playOnMobile: function(a) {
            window.open(a, "", "top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no");
        },
        play: function(a) {
            if (!this.player()) {
                var b = this;
                return void setTimeout(function() {
                    b.play(a);
                }, 1e3);
            }
            try {
                MX.isNumber(a) && a >= 0 && this.player().setCurrentTime(a), this.player().play();
            } catch (c) {
                d.error(c);
            }
        },
        pause: function(a) {
            try {
                MX.isNumber(a) && a >= 0 && this.player().setCurrentTime(a), this.player().pause();
            } catch (b) {
                d.error(b);
            }
        },
        end: function() {
            try {
                this.player().pause(), this.player().setCurrentTime(this.player().duration);
            } catch (a) {
                d.error(a);
            }
        },
        rotate: function(a) {
            a % 90 !== 0 && (a = 0);
            var b = "rotate(" + a + "deg)";
            if (this.$("video").css({
                "-o-transform": b,
                "-webkit-transform": b,
                "-moz-transform": b,
                "-ms-transform": b,
                transform: b
            }), a % 180 !== 0) {
                var c = this.parent.viewRealSize;
                $(this.player()).css({
                    width: c.width,
                    height: c.height
                });
            }
        }
    });
}), define("text!template/viewer/urlView.html", [], function() {
    return '<div class="url-view">\n    <div>\n        {{#when defaults_thumbnail_file \'==\' thumbnail}}\n        <a target="_blank" href="{{url}}"><i class=" micon-web-link size48"></i></a>\n        <br/><br/>\n        {{/when}}\n        {{#when defaults_thumbnail_file \'!=\' thumbnail}}\n        <a target="_blank" href="{{url}}"><img src="{{thumbnail}}"/></a>\n        {{/when}}\n        <p>\n            <a target="_blank" href="{{url}}">{{url}}</a>\n        </p>\n    </div>\n</div>\n';
}), define("viewer/webView", [ "moxtra", "binder/binderBiz", "app", "lang", "text!template/viewer/urlView.html" ], function(a, b, c, d, e) {
    var f = a.logger("Viewer:WebView"), e = Handlebars.compile(e);
    return a.Controller.extend({
        tagName: "div",
        className: "mx-viewer-subview mx-viewer-web",
        init: function(a) {
            this.parent = a.parent, this.listenTo(a.parent, "modelChange", this._onModelChange);
        },
        _onModelChange: function(a, b) {
            if (a) {
                var c = this, d = (c.loader = new Image(), a.get("type"));
                return this.model && this.stopListening(this.model), this.model = a, /url|web/.test(d) ? (this.$el.empty(), 
                this.show(a, b)) : void this.hide();
            }
        },
        _onResize: function(a) {
            this.$el.css(a);
        },
        show: function(a) {
            if (this.$el.show(), a) {
                var b = this;
                this["_load" + MX.capitalize(a.get("type"))](a), this.listenTo(a, "change:vector", function() {
                    b["_load" + MX.capitalize(a.get("type"))](a);
                });
            }
        },
        createIframe: function(a) {
            var b = $(document.createElement("iframe")).appendTo(this.el);
            return a && (a = $.proxy(a, this), b.on("load", function() {
                b.off("load"), a(this);
            })), b;
        },
        _loadWeb: function(a) {
            f.debug(a), this.$el.loading({
                length: 7,
                color: "#fff"
            });
            var b = this;
            $.ajax({
                type: "GET",
                dataType: "html",
                url: Moxtra.util.makeAccessTokenUrl(a.get("source")),
                success: function(c) {
                    b._onGetData(c, a);
                },
                error: function() {
                    b._onError();
                },
                complete: function() {
                    b.$el.loading(!1);
                }
            });
        },
        _onGetData: function(a) {
            /^</gi.test(a) || (a = a.substr(1, a.length - 2)), a = a.replace(/\\"/g, '"').replace(/\\n/g, "").replace(/<a\s([^>]*)href=['"]([^'"]+)/gi, function(a, b, c) {
                return /^(?:https?|ftp|mailto)/i.test(c) || (c = "http://" + c), '<a target="_blank" ' + b + 'href="' + c;
            }), this.iframe && this.iframe.remove();
            var b = this, d = b.model.get("boardid") || c.request.page(), e = b.model.get("sequence") || c.request.page(), f = this.createIframe(function(c) {
                var f = c.contentDocument || c.contentWindow && c.contentWindow.document;
                f && (f.open(), a = ' <base href="/board/' + d + "/" + e + '/"/><style type="text/css">p {margin:2px 0; padding:0}</style>' + a, 
                f.write(a), f.close(), MX.env.isMobile && $(f).swipe({
                    swipeLeft: function() {
                        $(parent.document).trigger("swipeleft");
                    },
                    swipeRight: function() {
                        $(parent.document).trigger("swiperight");
                    },
                    swipeUp: function() {
                        try {
                            f.body.style.height = "", f.body.style.width = "";
                            var a = f.body.scrollTop, d = f.body.scrollHeight, e = b.parent.viewRealSize.height, g = 0;
                            g = a + .8 * e, g > d && (g = d), c.contentWindow.scrollTo(0, g), setTimeout(function() {
                                f.body.style.height = "100%", f.body.style.width = "100%";
                            }, 20);
                        } catch (h) {
                            console.error(h);
                        }
                    },
                    swipeDown: function() {
                        try {
                            f.body.style.height = "", f.body.style.width = "";
                            var a = f.body.scrollTop, d = b.parent.viewRealSize.height, e = 0;
                            e = a - .8 * d, 0 > e && (e = 0), c.contentWindow.scrollTo(0, e), setTimeout(function() {
                                f.body.style.height = "100%", f.body.style.width = "100%";
                            }, 20);
                        } catch (g) {
                            console.error(g);
                        }
                    }
                }));
            });
            f.attr("src", "about:blank"), MX.env.isMobile ? f.attr("scrolling", "no") : f.attr("scrolling", "auto"), 
            this.iframe = f, f.height(this.parent.viewRealSize.height), $(window).bind("resize", function() {
                b.iframe.height(b.parent.viewRealSize.height);
            });
        },
        _loadUrl: function(a) {
            this.$el.loading({
                length: 7,
                color: "#fff"
            });
            var c = a.get("boardid"), d = a.get("sequence") + "";
            a.$name && null !== Moxtra.util.getPublicViewToken() ? a.getPageInfo().setScope(this).success(this._onGetUrl).error(this._onError) : b.getBoardPageData(c, d).scope(this).success(this._onGetUrl).error(this._onError);
        },
        _onError: function() {
            this.$el.loading(!1);
        },
        _onGetUrl: function(a) {
            var b;
            if (a && a.data) {
                var c = a.data.url;
                this.$el.loading(!1), b = this.model.toJSON(), b.url = c, b.lang = d, b.defaults_thumbnail_file = Moxtra.config.defaults.thumbnail_file, 
                this.$el.append(e(b));
            } else this.$el.loading(!1), b = this.model.toJSON(), b.lang = d, this.$el.append(e(b));
        },
        hide: function() {
            this.$el.loading(!1), this.$el.empty(), this.$el.hide();
        }
    });
}), define("viewer/svgView", [ "moxtra", "app", "painter", "binder/binderBiz", "uuid", "const" ], function(a, b, c, d, e, f) {
    var g = a.logger("Viewer:SvgView");
    return window.uuid = e, a.Controller.extend({
        tagName: "div",
        className: "mx-viewer-subview mx-viewer-svg",
        init: function(a) {
            this.listenTo(a.parent, "modelChange", this._onModelChange), this.listenTo(a.parent, "resize", this._onResize), 
            this.parent = a.parent;
        },
        _onModelChange: function(a, c) {
            if (a) {
                var d = this;
                d.model && (d.stopListening(a), d.model.contents && d.stopListening(d.model.contents), 
                MX.Painter.Helper.stopPlay());
                var e = a.get("type");
                if (b.config.global.mx_production) {
                    if (!/whiteboard|pdf|image/.test(e)) return d.hide();
                } else {
                    if (!/whiteboard|pdf|image|ds/.test(e)) return d.hide();
                    if ("ds" === e && c.userRole == f.binder.role.Presenter) return d.hide();
                }
                "whiteboard" == e ? d.$el.css("background-color", "#fff") : d.$el.css("background-color", "transparent"), 
                this.listenTo(a, "change:rotate", this._onRotate), a.contents && (this.listenTo(a.contents, "add", function(b) {
                    d.addElement(b, a.sequence);
                }), this.listenTo(a.contents, "remove", function(a) {
                    d.painter && d.painter.deleteElement(a.client_uuid);
                }), this.listenTo(a.contents, "modelChange", function(b) {
                    d.addElement(b, a.sequence);
                }), a.contents.length || null !== Moxtra.util.getPublicViewToken() && a.getPageInfo()), 
                d.model = a, d.show(a, c);
            }
        },
        _onRotate: function() {
            var a = this.model.toJSON(), b = a.rotate, c = a.width, d = a.height;
            b % 180 != 0 && (c = d, d = a.width), this.painter && this.painter.resize({
                width: c,
                height: d
            }, 1);
        },
        _onResize: function(a) {
            a || (a = this.parent.viewRealSize), this.viewScale = this.parent.viewScaleNumber, 
            this.painter && this.painter.resize(a, this.viewScale);
        },
        show: function(a, b) {
            var c = this;
            if (c.$el.empty(), a) {
                var e = a.toJSON(), f = b.viewRealSize, h = e.width, i = e.height;
                e.rotate % 180 != 0 && (h = i, i = e.width), this.painter = new MX.Painter.Page({
                    displayWidth: f.width,
                    displayHeight: f.height,
                    width: h,
                    height: i,
                    renderTo: this.el
                }), g.debug("init painter", this.painter.id), this._onResize(), c.$el.show(), g.debug("load data ", e);
                var j;
                (j = a.contents) ? this.listenTo(j, "inited", function() {
                    j.each(function(b) {
                        c.addElement(b, a.sequence);
                    });
                }) : (d.getBoardPageData(e.boardid, e.sequence, e.token).scope(this).success(this._onSuccess).error(this._onError), 
                c.$el.loading({
                    length: 7,
                    color: "#fff"
                })), this.trigger("show");
            }
        },
        _onSuccess: function(a) {
            this.$el.loading(!1);
            var b = a && a.data && a.data.sequence, a = MX.pick(a, [ "data.contents" ], {
                format: function() {
                    return "items";
                }
            }), c = this;
            MX.each(a.items, function(a) {
                c.addElement(a, b);
            });
        },
        addElement: function(a, b) {
            if (this.model && (!b || !this.model || b === this.model.get("sequence"))) if (a.is_deleted) this.painter.deleteElement(a.client_uuid); else {
                var c = MX.Painter.Helper.svgToModel(a.svg_tag, a.client_uuid, a, this.model);
                c && this.painter && this.painter.addElement(c);
            }
        },
        _onError: function() {
            this.$el.loading(!1);
        },
        hide: function() {
            var a = this;
            a.$el.empty(), this.painter && this.painter.destroy(), a.$el.hide();
        },
        editable: function(a) {
            var b = this, c = a ? "editable" : "uneditable";
            return this.painter ? (b.painter.editable(a), void b.trigger(c, b.painter)) : (this.testCount || (this.testCount = 0), 
            this.testCount++, void setTimeout(function() {
                b.testCount < 4 && b.editable(a);
            }, 100));
        },
        activeCommand: function(a) {
            this.painter && this.painter.activeCommand(a);
        },
        runCommand: function(a) {
            return this.painter && this.painter.runCommand(a);
        }
    });
}), define("text!template/viewer/dsView.html", [], function() {
    return '<div class="ds-viewer">\n	<div class="ds-container">\n		<div id="attendeeviewer{{sequence}}" class="ds-attendee-viewer"></div>\n		<div class="ds-message-wrapper">\n			<div class="ds-message">\n				<div class="text-center">\n					<i class="message-icon micon-screen-share-big"></i>\n				</div>\n				<div class="text-center">\n					<span class="message">\n						<h4>{{lang.screen_share_uppercase}}</h4>\n						<div class="message-text"></div>\n					</span>\n				</div>\n			</div>\n		</div>\n	</div>\n</div>';
}), define("viewer/dsView", [ "moxtra", "lang", "app", "meet/meetBiz", "meet/connector/util", "text!template/viewer/dsView.html" ], function(a, b, c, d, e, f) {
    var g = Handlebars.compile(f), h = MX.logger("dsView");
    return a.Controller.extend({
        tagName: "div",
        className: "mx-viewer-subview mx-viewer-ds",
        handleAction: !0,
        init: function(a) {
            this.listenTo(a.parent, "modelChange", this._onModelChange), a.parent.collection && this.listenTo(a.parent.collection, "remove", this._onModelRemoved), 
            this.dsModel = d.getDSModel(), this.listenTo(this.dsModel, "change:aLoad", this._AttendeeLoad), 
            this.listenTo(this.dsModel, "change:aConnected", this._AttendeeConnected), this.listenTo(this.dsModel, "change:aStarted", this._AttendeeStarted), 
            this.listenTo(this.dsModel, "change:aReconnect", this._AttendeeReconnect), this.listenTo(this.dsModel, "change:aTimeout", this._AttendeeTimeout), 
            this.listenTo(this.dsModel, "change:aStopped", this._AttendeeStopped), this.listenTo(this.dsModel, "change:aNotSupported", this._AttendeeNotSupported), 
            this.listenTo(this.dsModel, "change:aResize", this._AttendeeResize), this.listenTo(this.dsModel, "change:pStarted", this._PresenterStarted), 
            this.listenTo(this.dsModel, "change:pStopped", this._PresenterStopped), this.listenTo(this.dsModel, "change:pNotSupported", this._PresenterNotSupported), 
            this.listenTo(this.dsModel, "change:destoryAction", this._PresenterDestoryPage);
        },
        _onModelRemoved: function(a) {
            /ds/.test(a.get("type")) && (h.log("[_onModelRemoved] dsview removed, reset dsModel"), 
            this.dsModel.reset());
        },
        _onModelChange: function(a, b) {
            if (a) {
                var c = a.get("type");
                return /ds/.test(c) ? this.show(a, b) : void this.hide();
            }
        },
        show: function(a, b) {
            this.model = a, this.parent = b, h.logServer(e.logFormat("[dsView show] set ds sequence to dsModel, sequence: " + a.get("sequence"))), 
            this.dsModel.setSequence(a.get("sequence")), this.$el.empty().show(), this._render(a), 
            this.start();
        },
        _render: function(a) {
            var c = {
                lang: b
            };
            _.extend(c, a.toJSON()), this.$el.html(g(c)), this._setMessage(b.loading), this.$viewer = this.$(".ds-attendee-viewer"), 
            h.logServer(e.logFormat("[dsView _render] ds page rendered, sequence: " + a.get("sequence")));
        },
        _AttendeeLoad: function() {
            this._setMessage(b.screenshare_msg_attendee_loading), new MX.ui.Notify({
                type: "success",
                content: b.screenshare_msg_status_started
            });
        },
        _AttendeeConnected: function() {
            this.$viewer.empty(), this.$viewer.css("background-color", "#5E5E5A"), this._setMessage();
        },
        _AttendeeStarted: function(a) {
            h.logServer(e.logFormat("[dsView _AttendeeStarted] model: " + JSON.stringify(a.toJSON())));
        },
        _AttendeeReconnect: function() {
            new MX.ui.Notify({
                type: "error",
                content: b.screenshare_msg_attendee_reconnect
            });
        },
        _AttendeeTimeout: function() {
            new MX.ui.Notify({
                type: "error",
                content: b.screenshare_msg_attendee_network_disconnected
            });
        },
        _AttendeeStopped: function(a) {
            h.logServer(e.logFormat("[dsView _AttendeeStopped:begin] attendee stopped, model: " + JSON.stringify(a.toJSON()))), 
            new MX.ui.Notify({
                type: "info",
                content: b.screenshare_msg_status_stopped
            }), this.hide(), this._cleanUp(), h.logServer(e.logFormat("[dsView _AttendeeStopped:end] attendee stopped, model: " + JSON.stringify(a.toJSON())));
        },
        _AttendeeNotSupported: function() {
            -1 != navigator.platform.indexOf("Mac") ? this._setMessage(b.screenshare_msg_browser_supported_on_mac) : -1 != navigator.platform.indexOf("Win") && this._setMessage(b.screenshare_msg_browser_supported_on_win);
        },
        _AttendeeResize: function(a) {
            var b = a.getAttendeeResize();
            h.log("[Attendee] resize: ", b), b.width && this.model.set("width", b.width), b.height && this.model.set("height", b.height), 
            this.parent.zoom();
        },
        _PresenterStarted: function(a) {
            h.logServer(e.logFormat("[dsView _PresenterStarted] model: " + JSON.stringify(a.toJSON()))), 
            this._setMessage(b.screenshare_msg_started);
        },
        _PresenterStopped: function(a) {
            h.logServer(e.logFormat("[dsView _PresenterStopped:begin] presenter stopped, model: " + JSON.stringify(a.toJSON()))), 
            this.hide(), h.logServer(e.logFormat("[dsView _PresenterStopped:end] presenter stopped, model: " + JSON.stringify(a.toJSON())));
        },
        _PresenterNotSupported: function() {
            -1 != navigator.platform.indexOf("Mac") ? this._setMessage(b.screenshare_msg_browser_supported_on_mac) : -1 != navigator.platform.indexOf("Win") && this._setMessage(b.screenshare_msg_browser_supported_on_win);
        },
        _PresenterDestoryPage: function() {
            h.logServer(e.logFormat("[dsView _PresenterDestoryPage] ds page deleted.")), this._cleanUp();
        },
        start: function() {
            h.log("dsView, call biz to start DS"), h.logServer(e.logFormat("[dsView start] try to call biz.startDS()")), 
            d.startDS();
        },
        _setMessage: function(a) {
            var b = this.$(".ds-message .message-text");
            b.empty(), a ? (this.$(".ds-message").removeClass("hide"), b.append(a)) : this.$(".ds-message").addClass("hide");
        },
        _cleanUp: function() {
            if (this.model) {
                var a = this.parent.collection.get(this.model.get("sequence"));
                h.log("hide dsView", a), h.logServer(e.logFormat("[dsView _cleanUp] remove ds model from collection, sequence: " + this.model.get("sequence"))), 
                this.parent.collection.remove(a);
            }
            h.logServer(e.logFormat("[dsView _cleanUp] reset ds model.")), this.dsModel.reset();
        },
        hide: function() {
            h.log("[hide] hide dsview page"), this.$el.loading(!1), this.$el.empty(), this.$el.hide();
        }
    });
}), define("text!template/viewer/fileView.html", [], function() {
    return '<div class="file-view">\n    <div>\n        <div><i class="micon-file-big size64 gray marginLeft10"></i></div>\n        <div class="gray padding15 size16">{{fileSuffix}}</div>\n        <div><span class="JS_FileName file-name size16">{{name}}</span> <span class="file-size gray size14">({{fileSize}})</span></div>\n        <div class="gray">{{lang.preview_not_available}}</div>\n        <div class="marginTop15"><a class="btn btn-default btn-sm file-download JS_download" >{{lang.download}}</a></div>\n    </div>\n</div>\n';
}), define("viewer/fileView", [ "moxtra", "app", "text!template/viewer/fileView.html", "lang", "binder/binderActions" ], function(a, b, c, d, e) {
    "use strict";
    a.logger("Viewer:FileView");
    return a.Controller.extend({
        tagName: "div",
        className: "mx-viewer-subview mx-viewer-file",
        init: function(a) {
            this.listenTo(a.parent, "modelChange", this._onModelChange), this.listenTo(a.parent, "resize", this.adjustImage), 
            this.parent = a.parent, this._contentTpl = Handlebars.compile(c), this.$scope.lang = d;
        },
        _onModelChange: function(a, b) {
            if (a) {
                var c = a.get("type");
                return this.model = a, /any/.test(c) ? this.show(a, b) : void this.hide();
            }
        },
        show: function(a) {
            this.isShow = !0;
            var b, c = this;
            if (c.$el.empty().show(), a) {
                var e = a.parent;
                b = {
                    name: a.name,
                    className: e.fileSuffix,
                    fileSize: e.fileSize,
                    lang: d,
                    fileSuffix: e.fileSuffix
                };
                var f = this._contentTpl(b);
                c.$el.html(f), c.$(".JS_download").click(function() {
                    c.download();
                });
            }
        },
        hide: function() {
            this.isShow = !1, this.$el.empty(), this.$el.hide();
        },
        download: function() {
            var a = this.parent.model, b = this.parent.token, c = this.parent.model.getParent("Board");
            a.isVirtual ? e.downloadResource(c.id, a.sequence, b) : e.downloadResources(c, [ a.client_uuid ], b);
        }
    });
}), define("viewer/command/close", [ "moxtra", "lang", "viewer/static" ], function(a, b, c) {
    c.addCommand("close", function(a) {
        var d = $(c.btnTpl({
            title: b.press_esc_to_close,
            action: "close",
            className: "mx-viewer-close mx-viewer-btn",
            icon: "micon-close  ",
            attribute: "data-placement=bottom"
        }));
        return a.getContainer("plugins").append(d), d;
    });
}), function(a, b) {
    "use strict";
    var c = "undefined" != typeof Element && "ALLOW_KEYBOARD_INPUT" in Element, d = function() {
        for (var a, c, d = [ [ "requestFullscreen", "exitFullscreen", "fullscreenElement", "fullscreenEnabled", "fullscreenchange", "fullscreenerror" ], [ "webkitRequestFullscreen", "webkitExitFullscreen", "webkitFullscreenElement", "webkitFullscreenEnabled", "webkitfullscreenchange", "webkitfullscreenerror" ], [ "webkitRequestFullScreen", "webkitCancelFullScreen", "webkitCurrentFullScreenElement", "webkitCancelFullScreen", "webkitfullscreenchange", "webkitfullscreenerror" ], [ "mozRequestFullScreen", "mozCancelFullScreen", "mozFullScreenElement", "mozFullScreenEnabled", "mozfullscreenchange", "mozfullscreenerror" ], [ "msRequestFullscreen", "msExitFullscreen", "msFullscreenElement", "msFullscreenEnabled", "MSFullscreenChange", "MSFullscreenError" ] ], e = 0, f = d.length, g = {}; f > e; e++) if (a = d[e], 
        a && a[1] in b) {
            for (e = 0, c = a.length; c > e; e++) g[d[0][e]] = a[e];
            return g;
        }
        return !1;
    }(), e = {
        request: function(a) {
            var e = d.requestFullscreen;
            a = a || b.documentElement, /5\.1[\.\d]* Safari/.test(navigator.userAgent) ? a[e]() : a[e](c && Element.ALLOW_KEYBOARD_INPUT);
        },
        exit: function() {
            b[d.exitFullscreen]();
        },
        toggle: function(a) {
            this.isFullscreen ? this.exit() : this.request(a);
        },
        onchange: function() {},
        onerror: function() {},
        raw: d
    };
    return d ? (Object.defineProperties(e, {
        isFullscreen: {
            get: function() {
                return !!b[d.fullscreenElement];
            }
        },
        element: {
            enumerable: !0,
            get: function() {
                return b[d.fullscreenElement];
            }
        },
        enabled: {
            enumerable: !0,
            get: function() {
                return !!b[d.fullscreenEnabled];
            }
        }
    }), b.addEventListener(d.fullscreenchange, function(a) {
        e.onchange.call(e, a);
    }), b.addEventListener(d.fullscreenerror, function(a) {
        e.onerror.call(e, a);
    }), void (a.screenfull = e)) : void (a.screenfull = !1);
}(window, document), define("fullscreen", function() {}), define("viewer/plugin/fullscreen", [ "moxtra", "text!template/viewer/button.html", "viewer/static", "lang", "fullscreen" ], function(a, b, c, d) {
    c.registerPlugin("fullscreen", a.Controller.extend({
        container: "footerLeft",
        template: b,
        init: function(a) {
            _.extend(this.$scope, {
                lang: d,
                title: d.fullscreen,
                icon: "micon-screen-max"
            }), this.parent = a.parent;
        },
        rendered: function() {
            var b, c = !1, d = this.parent;
            screenfull.onchange = function() {
                c = !c, c ? (b.find("i").removeClass("micon-screen-max").addClass("micon-screen-min"), 
                d.fullscreenMode = !0, a.env.isIE && d && d.zoom(1), d.$el.addClass("is-fullscreen")) : (b.find("i").removeClass("micon-screen-min").addClass("micon-screen-max"), 
                _.delay(function() {
                    d.fullscreenMode = !1;
                }, 1e3), d.$el.removeClass("is-fullscreen"));
            };
            var e = this.$el;
            e.on("click", function() {
                screenfull.toggle(d.el), setTimeout(function() {
                    d.zoom();
                }, 2e3), c || (d.trigger("fullscreen"), d.fullscreenMode = !0);
            }), screenfull.enabled && e.hide(), b = e;
        }
    }));
}), define("viewer/plugin/meet", [ "moxtra", "app", "text!template/viewer/button.html", "viewer/static", "lang", "meet/meet" ], function(a, b, c, d, e, f) {
    d.registerPlugin("note", a.Controller.extend({
        container: "footerRight",
        template: c,
        init: function(a) {
            _.extend(this.$scope, {
                lang: e,
                title: e.create_note,
                icon: "micon-rec-empty"
            }), this.parent = a.parent;
        },
        rendered: function() {
            var a = this.parent, c = this.$el;
            c.on("click", function() {
                var d = b.request.page(), e = a.collection, g = new Moxtra.Collection({
                    model: "Moxtra.model.BoardPage"
                }), h = {}, i = [];
                e && e.length > 0 && _.each(e, function(a) {
                    a.file && a.file.pages && (h[a.page_group] = a.file);
                }), _.each(h, function(a) {
                    a.pages && _.each(a.pages, function(a) {
                        g.push(a);
                    });
                }), MX.each(g, function(a) {
                    i.push(a.sequence);
                });
                var j = g.indexOf(a.model);
                0 > j && (j = 0), a.progress(!0), c.addClass("disabled"), f.start({
                    isNote: !0,
                    boardId: d,
                    currPage: j,
                    pages: i,
                    success: function() {
                        a.progress(!1), a.close();
                    }
                });
            });
        }
    }));
}), define("text!template/viewer/optionsMenu.html", [], function() {
    return '<div class="dropdown options-menu dropup">\n    <a class="mx-viewer-btn  mouse-hand dropdown-toggle "  title="{{lang.options}}" data-toggle="dropdown">\n       <i class="micon-more"></i>\n    </a>\n            <ul class="dropdown-menu " role="menu" >\n            	<li>\n                    <a class="mouse-hand" data-id="download"  data-action="downloadPage"  ><i class="micon-download"/>{{lang.download}}</a>\n                </li>\n                <li>\n                    <a class="mouse-hand" data-id="copy" data-action="copyPageTo"  ><i  class="micon-copy"/>{{lang.copy_to}}</a>\n                </li>\n                {{#unless isViewer}}\n                {{#if branding.showTodoTab}}\n                <li>\n                    <a class="mouse-hand" data-id="remove" data-action="createTodo"  ><i  class="micon-todo-empty" />{{lang.create_todo}}</a>\n                </li>\n                {{/if}}\n                <li>\n                    <a class="mouse-hand mxbrand-action-share" data-id="share"  data-action="sharePage" ><i class="micon-share"/>{{lang.share}}</a>\n                </li>\n                <li>\n                    <a class="mouse-hand" data-id="rotate" data-action="rotatePage"  ><i class="micon-rotate" />{{lang.rotate}}</a>\n                </li>\n                <li>\n                    <a class="mouse-hand" data-id="rename" data-action="renameFile"  ><i  class="micon-pencil" />{{lang.rename}}</a>\n                </li>\n                <li>\n                    <a class="mouse-hand" data-id="remove" data-action="removePage"  ><i  class="micon-trash" />{{lang.delete}}</a>\n                </li>\n                {{/unless}}\n            </ul>\n</div>\n\n';
}), define("viewer/plugin/options", [ "moxtra", "text!template/viewer/optionsMenu.html", "viewer/static", "lang", "binder/binderBiz", "binder/binderActions", "app", "admin/branding/helper", "component/dialog/inputDialog" ], function(a, b, c, d, e, f, g, h, i) {
    c.registerPlugin("options", a.Controller.extend({
        container: "footerLeft",
        template: b,
        handleAction: !0,
        init: function(a) {
            this.$scope.lang = d, this.$scope.branding = {
                showTodoTab: h.isShowTodo()
            }, this.parent = a.parent, this.$scope.isViewer = this.parent.userRole === Moxtra.const.BOARD_READ, 
            this.binderActions = f, this.listenTo(a.parent, "modelChange", this._onModelChange);
        },
        _onModelChange: function(a) {
            var b = this.$('[data-id="rotate"]'), c = a.get("type");
            /image|pdf/.test(c) ? b.show() : b.hide(), b = this.$('[data-id="originalResource"]'), 
            /image|pdf/.test(c) && a.originalResource ? b.show() : b.hide();
        },
        rendered: function() {
            this.btns = this.$(".dropdown-menu li");
        },
        filterMenu: function(a) {
            var b, c;
            this.btns.each(function() {
                c = $(this).find("a"), b = c.data("id"), a(b) ? c.show() : c.hide();
            });
        },
        getModelInfo: function() {
            var a, b, c, d = this.parent.model, e = d.get("page_type") === Moxtra.const.PAGE_TYPE_ANY, f = d.getParent("Board"), g = d.file && 1 === d.file.pages.length, h = d.contents.length > 0;
            return a = e ? d.client_uuid : d.page_group, f && (b = f.getCacheObject(a), c = b && b.parent), 
            {
                model: d,
                board: f,
                isResource: e,
                isSingleFile: g,
                hasAnnotate: h,
                fileId: a,
                parent: c
            };
        },
        copyPageTo: function() {
            var a = this.getModelInfo();
            a.board && (a.isResource || a.isSingleFile ? f.copyFilesTo([ a.fileId ], a.board.id, a.parent) : f.copyPageTo(a.board.id, [ a.model.sequence ]));
        },
        sharePage: function() {
            var a = this.getModelInfo();
            a.board && (a.isResource || a.isSingleFile ? f.shareFiles(a.board.id, [ a.fileId ], [], a.parent) : f.sharePages(a.board.id, [ a.model.sequence ]));
        },
        downloadPage: function() {
            var a = this.getModelInfo();
            a.board && (a.isResource || a.isSingleFile ? f.downloadResources(a.board.id, [ a.fileId ]) : f.downloadPages(a.board.id, [ a.model.sequence ]));
        },
        rotatePage: function() {
            var a = this.parent.model.toJSON(), b = this, c = (a.rotate || 0) + 90, f = a.sequence;
            if (c >= 360 && (c -= 360), /note|video/.test(a.type)) {
                MX.ui.notifySuccess(d.rotate_a_page_success);
                var h = b.parent.model;
                (f = h.get("sequence")) && h.set("rotate", c);
            } else e.rotatePages(a.boardid || g.request.page(), [ {
                sequence: a.sequence,
                rotate: c
            } ]).success(function() {
                MX.ui.notifySuccess(d.rotate_a_page_success);
                var a = b.parent.model;
                (f = a.get("sequence")) && a.set("rotate", c);
            }).error(function() {
                MX.ui.notifyError(d.rotate_a_page_failed);
            });
        },
        removePage: function() {
            var a, b, c = this.parent, e = !1, f = this.parent.model, g = f.getParent("Board");
            MX.ui.Confirm(d.binder_delete_this_file, function() {
                f.page_group && g ? (a = g.getCacheObject(f.page_group), a.isVirtual ? b = f.delete() : (a.pages.length > 1 && (e = !0), 
                b = a.delete(), b.success(function() {
                    f.destroy();
                }))) : "BoardFile" === f.parent.$name ? (b = f.parent.delete(), b.success(function() {
                    f.destroy();
                })) : b = f.delete(), b.success(function() {
                    MX.ui.notifySuccess(d.binder_delete_file_success), e ? c.close() : c.nextPage();
                }).error(function() {
                    MX.ui.notifyError(d.binder_delete_resource_file_failed);
                });
            });
        },
        createTodo: function() {
            var a = this.getModelInfo();
            a.board && (a.isResource || a.isSingleFile ? f.createTodo(a.board.id, [], [ a.fileId ], a.parent) : f.createTodo(a.board.id, [ a.model.sequence ], [], a.parent));
        },
        originalResource: function() {
            window.open(this.parent.model.originalResource, "originalResource");
        },
        renameFile: function() {
            var a = this.parent, b = MX.Model.extend({
                defaults: {
                    newName: ""
                },
                validation: {
                    newName: [ {
                        required: !0,
                        msg: d.please_enter_page_title
                    } ]
                }
            }), c = a.model, e = new b();
            e.set("newName", a.getName()), new MX.ui.Dialog(new i({
                model: e,
                title: d.rename,
                input: {
                    name: "newName",
                    placeholder: d.please_enter_page_title
                },
                buttons: [ {
                    text: d.cancel,
                    position: "left",
                    click: function() {
                        this.pop();
                    }
                }, {
                    text: d.done,
                    className: "btn-primary",
                    position: "right",
                    click: "onSubmit"
                } ],
                onSubmit: function() {
                    var a, b = this;
                    if (e.isValid(!0) && !b.inProgress) {
                        b.inProgress = !0, b.dialog.progress();
                        var f, g, h = e.get("newName"), i = c.getParent("Board");
                        if ("BoardFile" === c.parent.$name) c.parent.set("name", h), a = c.parent.update(); else {
                            if (f = c.page_group, g = i.getCacheObject(f), !g) return;
                            g.set("name", h), a = g.update();
                        }
                        a.success(function() {
                            $(".page-title span").text(h).attr("title", h), $(".JS_FileName").text(h), MX.ui.notifySuccess(d.rename_page_title_success), 
                            b.inProgress = !1, b.dialog.progress(!1), b.dialog.close();
                        }).error(function() {
                            MX.ui.notifyError(d.rename_page_title_failed), b.dialog.progress(!1);
                        });
                    }
                }
            }));
        }
    }));
}), define("viewer/plugin/zoom", [ "moxtra", "viewer/static", "lang" ], function(a, b, c) {
    b.registerPlugin("zoom", a.Controller.extend({
        container: "footerLeft",
        tagName: "div",
        handleAction: !0,
        init: function(a) {
            this.parent = a.parent, this.$el.css("display", "inline");
            var d = $(b.btnTpl({
                title: c.zoom_in,
                action: "zoomIn",
                icon: "micon-zoom-in"
            }));
            this.$el.append(d), d = $(b.btnTpl({
                title: c.zoom_out,
                action: "zoomOut",
                icon: "micon-zoom-out"
            })), this.listenTo(a.parent, "modelChange", this._onModelChange), this.$el.append(d);
        },
        _onModelChange: function(a) {
            var b = a.get("type");
            /audio|video|note/.test(b) ? this.$el.addClass("hide") : this.$el.removeClass("hide");
        },
        zoomIn: function() {
            var a = this.parent, b = a.viewScaleNumber + .25;
            2 > b && a.zoom(b);
        },
        zoomOut: function() {
            var a = this.parent, b = a.viewScaleNumber - .25;
            b > .2 && a.zoom(b);
        }
    }));
}), define("text!template/viewer/annotate.html", [], function() {
    return '<div class="mx-annotate dropup">\n    <div class="sub-actions"></div>\n    <div class="actions">\n\n    </div>\n\n</div>';
}), define("viewer/plugin/annotate", [ "moxtra", "app", "lang", "text!template/viewer/annotate.html", "viewer/static", "binder/binderBiz", "component/uploader/uploader" ], function(a, b, c, d, e, f, g) {
    var h = a.logger("Viewer:Annotate"), i = [ {
        action: "activeCommand",
        param: "Line",
        icon: "micon-annotate",
        title: c.tool_draw
    }, {
        action: "activeCommand",
        param: "HighLighter",
        icon: "micon-highlighter",
        title: c.tool_highlighter
    }, {
        action: "activeCommand",
        param: "Text",
        icon: "micon-text",
        title: c.tool_text
    }, {
        action: "uploadImage",
        param: "Image",
        icon: "micon-image",
        title: c.tool_image,
        id: "uploadImageToPage"
    }, {
        action: "activeCommand",
        param: "Arrow",
        icon: "micon-svg-arrow",
        title: c.tool_arrow
    }, {
        action: "activeCommand",
        param: "Shape",
        icon: "micon-shape",
        title: c.tool_shape,
        create: "createShapePickMenu"
    }, {
        action: "activeCommand",
        param: "LaserPointer",
        icon: "micon-laser-pointer",
        title: c.tool_laserpointer
    }, {
        action: "activeCommand",
        icon: "micon-select",
        param: "Select",
        title: c.tool_select
    }, {
        action: "activeCommand",
        param: "Rubber",
        icon: "micon-eraser",
        title: c.tool_eraser
    }, {
        action: "runCommand",
        param: "Undo",
        icon: "micon-undo",
        title: c.tool_undo
    }, {
        action: "runCommand",
        param: "Redo",
        icon: "micon-redo",
        title: c.tool_redo
    } ];
    e.registerPlugin("annotate", a.Controller.extend({
        template: d,
        container: "footerRight",
        handleAction: !0,
        init: function(a) {
            this.parent = a.parent;
            var b = this.parent.getView("svg"), c = this;
            h.debug("init annotate "), this.listenTo(b, "editable", function() {
                c.painter = b.painter, c.initAnnotate(!0);
            }, this), this.listenTo(b, "uneditable", function() {
                c.initAnnotate(!1);
            }, this), this.listenTo(a.parent, "close", this.hidePanel, this), this.listenTo(a.parent, "modelChange", this.onModelChange, this), 
            this.listenTo(a.parent, "resetActiveCommand", this.getCurrentActiveCommand, this), 
            this.btns = {}, this.commands = {};
        },
        getPainter: function() {
            return this.parent.getView("svg").painter || {};
        },
        onModelChange: function(a) {
            if (a) {
                var b = this, c = a.get("type");
                /whiteboard|pdf|image/.test(c) ? b.$el.show() : b.$el.hide(), this.isOpen && (this.hidePanel(), 
                this.showPanel());
            }
        },
        onAddFile: function(a) {
            var c = a.toJSON(), d = this.parent.viewRealSize, e = {
                x: Math.floor(.2 * d.width),
                y: Math.floor(.2 * d.height),
                width: 230,
                height: 180,
                file: c.name,
                url: "",
                percent: c.percent,
                client_uuid: c.client_uuid,
                id: c.client_uuid
            }, f = b.request.toJSON();
            a.set({
                boardId: f.page,
                sequence: f.sequence
            });
            var g = this.getPainter().runCommand("Image", e);
            a.on("change", function(a) {
                var b = a.get("percent");
                100 == b && (b = 95), g.set({
                    percent: b
                }), h.debug("update progress");
            });
        },
        initAnnotate: function(a) {
            this._initFlag !== a && (a ? this.getPainter() && this.getPainter().on("addElement", this.onAddElement, this).on("changeElement", this.onUpdateElement, this).on("deleteElement", this.onRemoveElement, this).on("showLaserPointer", this.onShowLaserPointer, this).on("hideLaserPointer", this.onHideLaserPointer, this).on("updateLaserPointer", this.onUpdateLaserPointer, this).on("activeCommand", this.onActiveCommand, this).on("selectElement", this.onSelectElement, this).editable(!0) : this.getPainter() && this.getPainter().off(null, null, this).editable(!1), 
            this._initFlag = a);
        },
        showLaserPointer: function(a, b) {
            this.getPainter().getCommand("LaserPointer").showLaserPointer(a, b);
        },
        hideLaserPointer: function() {
            this.getPainter().getCommand("LaserPointer").hideLaserPointer();
        },
        updateLaserPointer: function(a, b) {
            this.getPainter().getCommand("LaserPointer").updateLaserPointer(a, b);
        },
        _getButtonCustomRegex: function(a) {
            function b(a, b) {
                var c = e.get(a + b);
                return c ? d[a][b] = c : c = d[a][b], c;
            }
            var c, d = MX.Painter.Page.prototype.defaults, e = Moxtra.storage("annotate"), f = a;
            switch (a || (a = this.getPainter().command || this._type), a) {
              case "Arrow":
                c = /fill|lineSize/, this.btns.fill.updateValue(b(a, "fill")), this.btns.lineSize.updateValue(d.Arrow["stroke-width"]);
                break;

              case "Line":
                c = /color|lineSize/, this.btns.color.updateValue(b(a, "stroke")), this.btns.lineSize.updateValue(d.Line["stroke-width"]);
                break;

              case "HighLighter":
                c = /color|lineSize/, this.btns.color.updateValue(b(a, "stroke")), this.btns.lineSize.updateValue(d.HighLighter["stroke-width"]);
                break;

              case "Text":
                c = /fill|textFont|textSize/, this.btns.fill.updateValue(b(a, "fill")), this.btns.textSize.updateValue(d.Text["font-size"]), 
                this.btns.textFont.updateValue(d.Text["font-family"]);
                break;

              case "Shape":
                c = /color|lineSize|shape/, this.btns.fill.updateValue(b(a, "fill")), this.btns.color.updateValue(b(a, "stroke")), 
                this.btns.lineSize.updateValue(d.Shape["stroke-width"]);
                break;

              default:
                c = /group/;
            }
            return this._type = f, c;
        },
        onActiveCommand: function(a) {
            var b, c = (MX.Painter.Page.prototype.defaults, a);
            if ("Select" == c) {
                var d = this.getPainter().getSelectedModel();
                d && (c = d.get("name"));
            } else this.getPainter().select();
            b = this._getButtonCustomRegex(c), this.showButtons(b);
            var e = this.getPainter().command;
            MX.each(this.commands, function(a, b) {
                a.hasClass("active") && a.removeClass("active"), b == e && a.addClass("active");
            });
        },
        showButtons: function(a) {
            if (this.getPainter() && this.getPainter().command) {
                {
                    this.getPainter().command;
                }
                MX.each(this.btns, function(b, c) {
                    a.test(c) ? b.show() : b.hide();
                });
            }
        },
        onSelectElement: function(a) {
            if (!a) return this.showButtons(this._getButtonCustomRegex());
            var b, c = a.toJSON(), d = this;
            switch (h.debug(c.style), c.name) {
              case "Arrow":
                d.btns.fill.updateValue(c.style.fill), d.btns.lineSize.updateValue(c.style["stroke-width"]), 
                b = /fill|lineSize/;
                break;

              case "Line":
                d.btns.color.updateValue(c.style.stroke), d.btns.lineSize.updateValue(c.style["stroke-width"]), 
                b = /color|lineSize/;
                break;

              case "HighLighter":
                d.btns.color.updateValue(c.style.stroke), d.btns.lineSize.updateValue(c.style["stroke-width"]), 
                b = /color|lineSize/;
                break;

              case "Text":
                d.btns.fill.updateValue(c.style.fill), d.btns.textSize.updateValue(c.style["font-size"]), 
                d.btns.textFont.updateValue(c.style["font-family"]), b = /fill|textSize|textFont/;
                break;

              case "Shape":
                d.btns.color.updateValue(c.style.stroke), d.btns.fill.updateValue(c.style.fill), 
                d.btns.lineSize.updateValue(c.style["stroke-width"]), b = /color|lineSize/, "line" === c.style["data-shape"] && (b = /color|lineSize/);
                break;

              default:
                b = /group/;
            }
            this.showButtons(b);
        },
        onShowLaserPointer: function(a) {
            h.debug("showLaserPointer"), this.trigger("showLaserPointer", this._formatPoint(a));
        },
        onHideLaserPointer: function() {
            h.debug("hideLaserPointer"), this.trigger("hideLaserPointer", this._formatPoint([]));
        },
        onUpdateLaserPointer: function(a) {
            h.debug("updateLaserPointer", a), this.trigger("updateLaserPointer", this._formatPoint(a));
        },
        _formatPoint: function(a) {
            return {
                sequence: this.parent.model.get("sequence") || 0,
                x: a[0] || 0,
                y: a[1] || 0
            };
        },
        onAddElement: function(a) {
            var b = a.get("id"), c = this.getPainter().getView(b), d = MX.Painter.Helper.toSVGText(a, c), e = this.parent.model;
            if (e.$name || (e = Moxtra.getBoardPages(e.get("boardid")).get(e.get("sequence"))), 
            h.debug("addElement", b, d, a.toJSON()), null != d) {
                var f = new Moxtra.model.BoardPageElement(), g = null;
                f.set("svg_tag", d), f.set("client_uuid", b), "Arrow" === a.get("name") && (g = Moxtra.const.PAGE_ELEMENT_TYPE_ARROW), 
                f.create(e, g);
            }
        },
        onUpdateElement: function(a) {
            var b = a.get("id"), c = this.getPainter().getView(b), d = MX.Painter.Helper.toSVGText(a, c), e = this.parent.model;
            h.debug("updateElement", b, d, a.toJSON()), e.$name || (e = Moxtra.getBoardPages(e.get("boardid")).get(e.get("sequence")));
            var f = e.contents.get(b);
            f && null != d && (f.set("svg_tag", d), f.update());
        },
        onRemoveElement: function(a) {
            h.info("deleteElement:", a.get("id"));
            var b = this.parent.model.toJSON();
            f.deleteAnnotation({
                is_deleted: !0,
                client_uuid: a.get("id"),
                boardid: b.boardid,
                sequence: b.sequence
            });
        },
        hidePanel: function() {
            this.parent.getView("svg").editable(!1), this.showButtons(/hideall/), this.$(".actions").removeClass("open"), 
            g.hide("addImageToPage"), this.isOpen = !1, this.$(".J-switch").removeClass("micon-arrow-right").addClass("micon-annotate"), 
            this.parent.inAnnotate = !1;
        },
        hide: function() {
            this.hidePanel(), this.$el.hide();
        },
        show: function() {
            if (this.$el.show(), "whiteboard" === this.parent.model.get("type")) {
                var a = this;
                setTimeout(function() {
                    a.showPanel();
                }, 50);
            }
        },
        showPanel: function() {
            this.parent.getView("svg").editable(!0), this.isOpen = !0, this.$(".actions").addClass("open"), 
            this.$(".J-switch").removeClass("micon-annotate").addClass("micon-arrow-right");
            var a = this;
            this.parent.inAnnotate = !0, setTimeout(function() {
                var b = '[data-param="' + (a.getCurrentActiveCommand() || "Line") + '"]';
                a.$(b).click(), g.refresh("addImageToPage", $("#uploadImageToPage"));
            }, 500), g.refresh("addImageToPage", $("#uploadImageToPage"));
        },
        activeCommand: function(a) {
            this.currBtnEl && this.currBtnEl.removeClass("active"), this.currBtnEl = $(this.handleEvent.currentTarget), 
            this.parent.getView("svg").activeCommand(a), this.currBtnEl.addClass("active"), 
            this.getCurrentActiveCommand(a);
        },
        runCommand: function(a) {
            return this.parent.getView("svg").runCommand(a);
        },
        createShapePickMenu: function(a) {
            var b = '<div class="dropdown dropup"> <a data-toggle="dropdown" class=" mx-viewer-btn  mouse-hand" title="' + c.tool_shape + '" data-action="activeCommand" data-param="Shape" data-original-title=""><i class="micon-shape"></i><span class="caret"></span></a><input type="hidden">' + this._createShapeMenu() + "</div>", d = $(b), e = this;
            d.appendTo(a), d.find(".btn").dropdown();
            d.find("input");
            return d.delegate(".dropdown-menu a", "click", function(a) {
                var b = $(a.currentTarget), c = b.data("value");
                MX.Painter.Page.prototype.defaults.Shape["data-shape"] = c, "line" === c && e.showButtons(/color|lineSize/);
            }), d.find("a.mx-viewer-btn");
        },
        rendered: function() {
            function a(a, b, c) {
                var e = d.painter.getSelectedModel();
                if (e) {
                    a = a || e.get("name"), "color" === b && (b = "stroke");
                    var f = $.extend({}, e.get("style"));
                    f[b] = c, d.painter.update({
                        style: f
                    });
                } else a = d.painter.command, "color" == b && (b = "stroke");
                d.painter.defaults[a][b] = c, m.set(a + b, c);
            }
            var d = this, j = MX.Painter.Page.prototype.defaults, d = this, k = this.$(".actions");
            MX.each(i, function(a) {
                if (a.create) {
                    if (MX.isFunction(d[a.create])) {
                        var b = d[a.create].call(d, k);
                        d.commands[a.param] = b;
                    }
                } else {
                    var b = $(e.btnTpl(a));
                    d.commands[a.param] = b, b.appendTo(k);
                }
            });
            var l = g.register("addImageToPage", {
                browse_button: "uploadImageToPage",
                filters: {
                    mime_types: [ {
                        title: c.image_files,
                        extensions: "jpeg,jpg,gif,png"
                    } ]
                },
                url: function() {
                    var a = b.request.toJSON();
                    return "/board/upload?id=" + a.page + "&seq=" + a.sequence + (f.isSilentMessageOn(a.page) ? "&pnoff=1" : "");
                },
                success: function(a, b) {
                    var c = JSON.parse(b.response), e = MX.get("object.board.pages.0.resources.0", c);
                    if (!e) return d.painter.deleteElement(a.get("client_uuid")), void h.error("upload file fail!");
                    var f = MX.get("object.board.pages.0", c), g = MX.get("object.board", c);
                    h.debug("upload success>", c);
                    var i = new Image(), j = d.painter.getModel(a.get("client_uuid")), k = Moxtra.util.makeAccessTokenUrl("/board/" + g.id + "/" + f.sequence + "/" + encodeURIComponent(e.name));
                    i.onload = function() {
                        j.set({
                            percent: 100
                        }), j.set({
                            url: k
                        }), d.painter.commit("addElement", j);
                    }, i.onerror = function() {
                        MX.ui.notifyError("load image error.");
                    }, setTimeout(function() {
                        i.src = Moxtra.util.makeAccessTokenUrl("/board/" + g.id + "/" + f.sequence + "/" + e.name);
                    }, 1e3);
                    var l = j.clone().set({
                        url: k
                    });
                    d.painter.trigger("changeElement", l, j);
                },
                error: function() {
                    g.refresh("addImageToPage", d.$("#uploadImageToPage"));
                }
            });
            this.listenTo(l, "add", this.onAddFile, this);
            var m = Moxtra.storage("annotate");
            this.createPickerMenu({
                value: j.Shape.fill,
                createMenu: this.createColorMenu,
                update: function(a, b) {
                    var c = b;
                    "transparent" === c && (c = "#ccc"), a.html('<i class="colorpicker-box smail" style="background-image: none !important;background-color: ' + b + '">&nbsp;</i>');
                },
                onSelect: function(b) {
                    a(null, "fill", b);
                }
            }, "fill"), this.createPickerMenu({
                value: j.Line.stroke,
                createMenu: this.createColorMenu,
                update: function(a, b) {
                    var c = b;
                    "transparent" === c && (c = "#ccc"), a.html('<i class="colorpicker-box smail" style="background-image: none !important;background-color: ' + b + '">&nbsp;</i>');
                },
                onSelect: function(b) {
                    a(null, "color", b);
                }
            }, "color"), this.createPickerMenu({
                value: j.Line["stroke-width"],
                update: function(a, b) {
                    b = parseFloat(b), a.html(MX.format('<i style="height:${val}px;background-color:#ccc;display: block;margin-top: ${margin}px ;width: 15px;background-image: none!important;"></i>', {
                        margin: Math.max(15 - b, 0),
                        val: b
                    }));
                },
                createMenu: this.createLineSize,
                onSelect: function(b) {
                    a("Line", "stroke-width", b);
                }
            }, "lineSize"), this.createPickerMenu({
                value: j.Text["font-family"],
                createMenu: this.createFontMenu,
                onSelect: function(b) {
                    a("Text", "font-family", b);
                }
            }, "textFont"), this.createPickerMenu({
                value: j.Text["font-size"] + "px",
                createMenu: this.createFontSizeMenu,
                onSelect: function(b) {
                    a("Text", "font-size", parseInt(b));
                }
            }, "textSize"), this.createPickerMenu({
                value: j.HighLighter["stroke-opacity"],
                createMenu: this.createHighLighterOpacityMenu,
                onSelect: function(b) {
                    a("HighLighter", "stroke-opacity", b);
                }
            }, "opacity"), this.$el.append(e.btnTpl({
                title: c.annotate,
                action: "toggleAnnotate",
                icon: "micon-annotate J-switch"
            }));
        },
        toggleAnnotate: function() {
            this.$(".actions").hasClass("open") ? this.hidePanel() : this.showPanel();
        },
        createFontSizeMenu: function() {
            var a, b, c = [ 8, 10, 12, 14, 16, 18, 20, 22, 24, 28, 32, 36, 40, 48 ], d = [ '<ul class="dropdown-menu xe-font-menu">' ];
            for (a = 0; a < c.length; a++) {
                b = c[a];
                var e = Math.min(b, 20);
                d.push('<li><a data-value="' + b + 'px" style="font-size:' + b + "px;line-height:" + e + 'px;">' + b + "px</a></li>");
            }
            return d.push("</ul>"), d.join("");
        },
        createLineSize: function() {
            var a, b, c = [ 1, 2, 3, 6, 8, 10 ], d = [ '<ul class="dropdown-menu ">' ];
            for (a = 0; a < c.length; a++) b = c[a], d.push('<li><a data-value="' + b + '" ><div style="height:' + b + "px;background-color:#444;margin:" + (15 - b / 2) + 'px 0 "></div></a></li>');
            return d.push("</ul>"), d.join("");
        },
        createHighLighterOpacityMenu: function() {
            var a, b, c = [ .25, .5, .75, 1 ], d = [ '<ul class="dropdown-menu ">' ];
            for (a = 0; a < c.length; a++) b = c[a], d.push('<li><a data-value="' + b + '" style="line-height:10px; opacity:' + b + ';">' + b + "</a></li>");
            return d.push("</ul>"), d.join("");
        },
        createFontMenu: function() {
            var a, b, c = Object.keys(MX.Painter.FONT), d = [ '<ul class="dropdown-menu xe-font-menu">' ];
            for (a = 0; a < c.length; a++) b = c[a], d.push('<li><a data-value="' + b + '" style="font-family:' + b + ', sans-serif;">' + b + "</a></li>");
            return d.push("</ul>"), d.join("");
        },
        createColorMenu: function() {
            var a, b, d = [ '<div class="dropdown-menu colorpicker-menu">' ];
            d.push('<div style="padding-left: 10px"><a href="javascript:;" class="transparent" data-value="transparent" ><i class="micon-color-disabled"></i>' + c.transparent + "</a></div>");
            var e = [ "000000", "993300", "333300", "003300", "003366", "000080", "333399", "333333", "800000", "FF6600", "808000", "008000", "008080", "0000FF", "666699", "808080", "FF0000", "FF9900", "99CC00", "339966", "33CCCC", "0066de", "800080", "969696", "FF00FF", "FFCC00", "FFFF00", "00FF00", "00FFFF", "00CCFF", "993366", "C0C0C0", "FF99CC", "FFCC99", "FFFF99", "CCFFCC", "CCFFFF", "99CCFF", "CC99FF", "FFFFFF" ];
            for (a = 0; a < e.length; a++) b = e[a], d.push('<a href="javascript:;" class="color" data-value="#' + b + '" style="background-color:#' + b + ';">&nbsp;</a>');
            return d.push("</div>"), d.join("");
        },
        _createShapeMenu: function() {
            var a, b, d = [ "rectangle", "triangle", "ellipse", "line" ], e = [ '<ul class="dropdown-menu">' ];
            for (a = 0; a < d.length; a++) b = c["tool_shape_" + d[a]] || d[a], e.push('<li><a href="javascript:;" data-value="' + d[a] + '"><i class="micon-shape-' + d[a] + '"></i>' + b + "</a></li>");
            return e.push("</ul>"), e.join("");
        },
        createPickerMenu: function(a, b, c) {
            var d = '<div class="dropdown options-menu dropup"><button class="btn-link dropdown-toggle " type="button" data-toggle="dropdown"><span class="info showbox"> Fit</span><span class="caret"></span></button><input type="hidden">' + a.createMenu() + "</div>", e = $(d);
            e.hide(), e.appendTo(c || this.$(".sub-actions")), e.find(".btn").dropdown();
            var f = e.find("input");
            return f.on("change", function() {
                a.update ? a.update(e.find(".showbox"), this.value) : e.find(".showbox").html(MX.escapeHTML(this.value));
            }), e.delegate(".dropdown-menu a", "click", function(b) {
                var c = $(b.currentTarget), d = c.data("value");
                f.val(d).trigger("change"), a.onSelect && a.onSelect(d);
            }), a.value && f.val(a.value).trigger("change"), e.updateValue = function(b) {
                a.update ? a.update(e.find(".showbox"), b) : e.find(".showbox").html(MX.escapeHTML(b));
            }, this.btns[b] = e, e;
        },
        uploadImage: function() {
            g.refresh("addImageToPage", $("#uploadImageToPage"));
        },
        getCurrentActiveCommand: function(a) {
            return "string" != typeof a ? this.currentActiveCommand : void (this.currentActiveCommand = a);
        }
    }));
}), define("text!template/viewer/participantSide.html", [], function() {
    return '<div class="mx-meet-side recording-active">\n	<div class="mx-meet-subheader">\n		\n	</div>\n	<div class="side-divider"></div>\n	<div class="mx-meet-participants">\n		<div class="mx-meet-mic-speaker">\n			\n		</div>\n		<div class="mx-meet-participants-container">\n			\n		</div>\n	</div>\n	<div class="side-divider"></div>\n	<div class="mx-meet-chats">\n		\n	</div>\n	<div class="mx-meet-record">\n		\n	</div>\n</div>';
}), define("viewer/plugin/participants", [ "moxtra", "text!template/viewer/participantSide.html", "viewer/static" ], function(a, b, c) {
    c.registerPlugin("participants", a.Controller.extend({
        template: b,
        container: "side",
        handleAction: !0,
        init: function(a) {
            this.parent = a.parent;
        },
        rendered: function() {}
    }));
}), define("text!template/viewer/addPages.html", [], function() {
    return '<div class="viewer-action-group dropup" >\n    <a class="dropdown-toggle mx-viewer-btn mouse-hand" title="{{lang.add_file}}" data-action="refreshUploader" data-toggle="dropdown" >\n        <i  class="{{icon}}"/></a>\n    {{addPageMenu \'pull-right\'}}\n</div>';
}), define("viewer/plugin/addPages", [ "moxtra", "text!template/viewer/addPages.html", "viewer/static", "lang", "binder/binderBiz", "binder/binderActions", "app", "component/uploader/uploader" ], function(a, b, c, d, e, f, g, h) {
    c.registerPlugin("addPages", a.Controller.extend({
        container: "footerRight",
        template: b,
        handleAction: !0,
        init: function(a) {
            this.$scope.lang = d, _.extend(this.$scope, {
                title: d.btn_comment,
                action: "refreshUploader",
                icon: "micon-plus"
            }), this.parent = a.parent, this.binderActions = f;
        },
        rendered: function() {
            this.$el.on("hide.bs.dropdown", function() {
                h.hide("addPageToBinder");
            });
        },
        refreshUploader: function() {
            var a = this.$el;
            setTimeout(function() {
                h.refresh("addPageToBinder", a.find("#addpage_flashuploader"));
            }, 100);
        }
    }));
}), define("viewer/plugin/delete", [ "moxtra", "text!template/viewer/button.html", "viewer/static", "lang", "binder/binderBiz", "app", "const" ], function(a, b, c, d, e, f, g) {
    c.registerPlugin("delete", a.Controller.extend({
        container: "footerRight",
        template: b,
        init: function(a) {
            _.extend(this.$scope, {
                lang: d,
                title: d["delete"],
                icon: "micon-trash",
                className: "mxbrand-hide-delete"
            }), this.parent = a.parent;
        },
        rendered: function() {
            var a = this.parent, b = this.$el;
            b.on("click", function() {
                if (a.model) {
                    var b = a.model.toJSON(), c = f.request.toJSON(), h = b.boardid || c.page, i = b.sequence || c.sequence, j = {};
                    a.roleContext === g.roleContext.meet && (j.className = "mx-branding-meet-dialog-btn"), 
                    MX.ui.Confirm(d.binder_delete_this_file, function() {
                        e.deletePages(h, [ i ]).success(function() {
                            MX.ui.notifySuccess(d.binder_delete_file_success), setTimeout(function() {
                                a.nextPage();
                            }, 200);
                        }).error(function() {
                            MX.ui.notifyError(d.binder_delete_resource_file_failed);
                        });
                    }, null, j);
                }
            }), b.hide();
        }
    }));
}), define("viewer/plugin/editWebdoc", [ "moxtra", "text!template/viewer/button.html", "viewer/static", "lang", "binder/binderActions", "binder/binderPageModel", "app" ], function(a, b, c, d, e, f) {
    c.registerPlugin("editWebdoc", a.Controller.extend({
        container: "footerRight",
        template: b,
        init: function(a) {
            _.extend(this.$scope, {
                lang: d,
                title: d.edit,
                icon: "micon-edit"
            }), this.parent = a.parent, this.listenTo(a.parent, "modelChange", this._onModelChange);
        },
        _onModelChange: function(a) {
            if (a) {
                var b = this, c = (b.loader = new Image(), a.get("type"));
                "web" == c ? this.$el.show() : this.hide();
            }
        },
        _openEditor: function(a) {
            var b = this.parent;
            e.editWebDoc(a.boardid, a.sequence).on("save", function(c) {
                var d = MX.get("pages.0", c);
                if (d) {
                    var e = new f(c.pages[0], {
                        parse: !0,
                        boardid: a.boardid
                    });
                    b.model.set(e.toJSON());
                }
            });
        },
        showPanel: function() {
            var a = this.parent, b = this;
            if (a.model) {
                var c = a.model.toJSON(), d = Moxtra.getBoard(c.boardid).pages.get(c.sequence);
                setTimeout(function() {
                    d && d.isLocked ? b.conflictWarning(c, d) : d.lock().success(function() {
                        b._openEditor(c);
                    }).error(function() {
                        b.conflictWarning(c, d);
                    });
                }, 1e3);
            }
        },
        rendered: function() {
            var a = this.parent, b = this, c = this.$el;
            c.on("click", function() {
                if (a.model) {
                    var c = a.model.toJSON(), d = Moxtra.getBoard(c.boardid).pages.get(c.sequence);
                    d && d.isLocked ? b.conflictWarning(c, d) : d.lock().success(function() {
                        b._openEditor(c);
                    }).error(function() {
                        b.conflictWarning(c, d);
                    });
                }
            }), c.hide();
        },
        conflictWarning: function(a, b) {
            var c = this;
            if (b.isLockByMe) MX.ui.Confirm(d.webdoc_locked_by_self, function() {
                b.lock().success(function() {
                    c._openEditor(a);
                });
            }); else {
                var e = b.parent.members.get(b.editor);
                e = e.user || e, MX.ui.Alert(MX.format(d.webdoc_locked, {
                    username: MX.get("name", e)
                }));
            }
        }
    }));
}), define("viewer/plugin/originalResource", [ "moxtra", "viewer/static", "lang", "app" ], function(a, b, c, d) {
    "use strict";
    b.registerPlugin("originalResource", a.Controller.extend({
        container: "footerLeft",
        handleAction: !0,
        init: function(a) {
            this.$scope.lang = c, _.extend(this.$scope, {
                action: "originalResource",
                className: "mx-viewer-btn-text marginLeft10",
                text: c.view_original_file
            }), this.parent = a.parent, this.listenTo(a.parent, "modelChange", this._onModelChange), 
            this.$el.css("display", "inline").hide();
            var d = $(b.btnTpl(this.$scope));
            this.$el.append(d);
        },
        originalResource: function() {
            var a = this.parent.model, b = a.originalResource;
            if (this.isImg) this.parent.getView("image").show(a, this.parent, !0), this.$el.hide(); else {
                var c = navigator.mimeTypes && navigator.mimeTypes["application/pdf"];
                (this.isPDF && !c || this.isOtherDoc) && (b += "&d"), window.open(b, "originalResource");
            }
        },
        _onModelChange: function(a) {
            var b = a.get("type"), c = "image" === b && a.originalResource, e = d.isMacAgentLocal() || d.isMacAgentAppstore(), f = "pdf" === b && a.file && "PDF" === a.file.fileSuffix, g = !f && "pdf" === b && a.originalResource, h = !1;
            this.isAgent = e, this.isImg = c, this.isPDF = f, this.isOtherDoc = g, e ? (c || f) && (h = !0) : (c || f || g) && (h = !0), 
            h ? this.$el.show() : this.$el.hide();
        }
    }));
}), define("viewer/viewer", [ "moxtra", "app", "lang", "text!template/viewer/main.html", "const", "viewer/plugin/pager", "viewer/plugin/thumbnails", "viewer/plugin/comments", "component/dialog/inputDialog", "admin/branding/helper", "meet/brandingCache", "binder/binderBiz", "viewer/imageView", "viewer/mediaView", "viewer/webView", "viewer/svgView", "viewer/dsView", "viewer/fileView", "viewer/static", "viewer/command/close", "viewer/plugin/fullscreen", "viewer/plugin/meet", "viewer/plugin/options", "viewer/plugin/zoom", "viewer/plugin/annotate", "viewer/plugin/participants", "viewer/plugin/addPages", "viewer/plugin/delete", "viewer/plugin/editWebdoc", "viewer/plugin/originalResource" ], function(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s) {
    var t = a.logger("Viewer");
    a.ns("MX.Viewer");
    var u = [ "pager", "annotate", "comments", "delete", "options", "zoom", "thumbnails", "image", "media", "svg", "web", "note", "fullscreen", "originalResource" ];
    return MX.Viewer = MX.Controller.extend({
        template: d,
        skin: "no-header",
        handleAction: !0,
        keepInstance: !0,
        plugins: [ "pager", "annotate", "editWebdoc", "comments", "options", "thumbnails", "zoom", "note", "fullscreen", "originalResource" ],
        commands: [ "close" ],
        init: function(a) {
            a || (a = {}), _.extend(this, _.pick(a, [ "skin", "plugins", "commands", "userRole", "roleContext", "keepInstance", "disableESC", "showApplicationContainer", "token" ])), 
            a.collection && this.binding(a.collection), this.views = {}, MX.env.isMobile && (this.$scope.hideFooter = !0, 
            a.collection && 1 === a.collection.length && (this.$scope.hidePageTitle = !0)), 
            this.$scope.lang = c, this.$scope.showApplicationContainer = this.showApplicationContainer, 
            j.isShowAddFile() || (this.plugins = _.without(this.plugins, "addPages")), b.isWindowsAgent() && (this.plugins = _.without(this.plugins, "originalResource")), 
            (b.isMacAgentAppstore() || b.isMacAgentLocal()) && (this.plugins = _.without(this.plugins, "note"));
        },
        getPagesCollection: function(a) {
            var b = new Moxtra.Collection({
                model: "Moxtra.model.BoardPage",
                attributeId: "sequence",
                index: [ "page_group" ]
            });
            return a.each(function(a) {
                var c = a.pages;
                if (c.length) c.each(function(a) {
                    b.push(a);
                }); else {
                    var d = new Moxtra.model.BoardPage({
                        sequence: a.client_uuid,
                        client_uuid: a.client_uuid,
                        name: a.displayName,
                        page_type: Moxtra.const.PAGE_TYPE_ANY
                    });
                    d.parent = a, b.push(d);
                }
            }), b;
        },
        binding: function(a) {
            this.collection && this.stopListening(this.collection), "BoardFile" === a.model.$name && (a = this.getPagesCollection(a)), 
            this.collection = a, this.listenTo(this.collection, "remove", this._onRemovePage), 
            this.listenTo(this.collection, "add", this._onAddPage), this.listenTo(this.collection, "annotate", this._onAnnotate), 
            this._currentPageIndex = 0, this._currentSequence = -1, this.viewScale = "Fit";
            var b = this;
            this.listenTo(a, "inited", function() {
                a.length || b._toNoPageStatus();
            });
        },
        _sequenceChange: function() {
            t.debug("sequence change ");
        },
        _onAddPage: function() {
            var a = this.collection.length;
            if (a >= 1) {
                this._toNormalStatus();
                var b = this.getView("pager");
                a - 1 > this._currentPageIndex && b.activePanel("next");
            } else this._toNoPageStatus();
        },
        _onAnnotate: function(a, b) {
            if (a === this.model.get("sequence")) {
                var c = this.getView("svg");
                c && MX.each(b, function(b) {
                    c.addElement(b, a);
                });
            }
        },
        setUserRole: function(a) {
            this.userRole = a, this.model && this.customPluginByRole(this.model.get("pageType") || this.model.page_type);
        },
        customPluginByRole: function(a) {
            "use strict";
            var c, d, f, g, h = {
                addPages: "1",
                annotate: "10",
                comments: "100",
                "delete": "1000",
                meet: "10000",
                note: "100000",
                options: "1000000",
                pager: "10000000",
                participants: "100000000",
                thumbnails: "1000000000",
                zoom: "10000000000",
                close: "100000000000",
                fullscreen: "1000000000000"
            }, i = e.binder.role, j = e.roleContext, l = e.binder.pageType;
            switch (this.userRole) {
              case i.Owner:
              case i.Editor:
                g = "1111111111111";
                break;

              case i.Viewer:
                g = "1111111010100";
                break;

              case i.Host:
              case i.Attendee:
                g = k.getBoolTag(e.meet.tags.disableAttendeeAnnotate) ? "1010100000000" : "1010100000010";
                break;

              case i.Presenter:
                g = "1011111001011";
                break;

              case i.PublicViewer:
                g = "1111010000000";
            }
            switch (this.roleContext) {
              case j.meet:
                d = "1011110001011";
                break;

              case j.note:
                d = "1011010001011";
                break;

              case j.public:
                d = "1111010000000";
                break;

              case j.binder:
                d = "1111011111111";
                break;

              case j.annotate:
                d = "1111010000010";
            }
            switch (a) {
              case l.whiteboard:
              case l.image:
              case l.pdf:
                f = "1111111111111";
                break;

              case l.video:
              case l.audio:
              case l.note:
                f = "1111111111101";
                break;

              case l.any:
                f = "0101111001001";
                break;

              case l.web:
              case l.url:
                f = "1111111111101";
                break;

              case l.ds:
                f = "1000100000000";
                break;

              default:
                f = "0100101000001";
            }
            (b.isIntegrationAgent() || navigator.userAgent.indexOf(e.flags.windowsAgent) > 0) && (f = f.replace(/^\d/, "0")), 
            c = parseInt(g, 2) & parseInt(d, 2) & parseInt(f, 2);
            var m, n, o;
            for (var p in h) o = (parseInt(h[p], 2) & c) > 0, n = o ? "show" : "hide", m = this.getView(p) || this.getCommand(p), 
            m && (!o || o && !this.isNoPage) && m[n]();
        },
        _toNormalStatus: function() {
            this.isNoPage !== !1 && (this.setUserRole(this.userRole), this.isNoPage = !1, this._pagetitle.show());
        },
        _toNoPageStatus: function() {
            this.isNoPage = !0;
            var a = this;
            MX.each(u, function(b) {
                var c = a.getView(b);
                c && a.getView(b).hide();
            }), this._pagetitle.hide();
        },
        _onRemovePage: function(a) {
            this.collection.length < 1 ? this._toNoPageStatus() : a.get("sequence") === b.request.sequence() && (this._currentPageIndex--, 
            this._currentPageIndex < 0 && (this._currentPageIndex = 0), this.nextPage());
        },
        nextPage: function() {
            var a, b, c = this, d = c.collection, e = d.length;
            0 !== e && (a = d.get(c._currentSequence), b = c._currentPageIndex + 1, a || (b = c._currentPageIndex), 
            b = Math.min(b, e - 1), a = d.at(b), a && this.gotoPage(a.get("sequence")), t.debug("nextPage ", b));
        },
        prevPage: function() {
            var a, b = this, c = b.collection, d = c.length;
            if (0 !== d) {
                a = this._currentPageIndex - 1, a = Math.max(a, 0);
                var e = c.at(a);
                e && b.gotoPage(e.get("sequence")), t.debug("prevPage ", a);
            }
        },
        gotoPage: function(a) {
            var b = this, c = b.collection, d = c.get(a);
            (0 === a || !d) && c.length > 0 && (d = c.at(0), a = d.get("sequence")), d && (t.debug("gotoPage", a), 
            this._currentSequence !== a && 0 !== a && (this._currentSequence = a, this._currentPageIndex = c.indexOf(d), 
            this.setModel(d), this.customPluginByRole(d.get("pageType") || d.page_type), this.sendMessage(a), 
            this.trigger("switchPage", {
                page_sequence: a
            })), 0 === this._currentPageIndex && this.trigger("onFirstPage"), b._currentPageIndex === c.length - 1 && this.trigger("onLastPage"));
        },
        setModel: function(a) {
            if (a) {
                this.model = a, t.debug("trigger modelChange type is: [{0}] sequence is:{1}", a.get("type"), a.get("sequence")), 
                this.zoom(), this.trigger("modelChange", a, this);
                var b = "";
                "ds" === a.get("type") ? $(".page-title").hide() : (b = this.getName(), b ? $(".page-title").show() : $(".page-title").hide()), 
                this._pagetitle.text(b).attr("title", b);
            }
        },
        getName: function() {
            var a, b, c = this.model, d = c.get("name");
            return c.get("page_group") && c.getParent && (b = c.getParent("Board"), b && (a = b.getCacheObject(c.get("page_group")), 
            d = a && a.displayName)), d;
        },
        rendered: function() {
            function a() {
                return setTimeout(function() {
                    $(".page-title").hide();
                }, 3e3);
            }
            var b = this, c = b.skin;
            c && b.$el.addClass(c), b._container = b.$(".mx-viewer-container"), b._plugins = b.$(".mx-viewer-plugins"), 
            b._tips = b.$(".mx-viewer-tips"), b._application = b.$(".mx-application-container"), 
            b._floatbar = b.$(".mx-viewer-floatbar"), b._footerLeft = b.$(".mx-footer-left"), 
            b._footerRight = b.$(".mx-footer-right"), b._side = b.$(".mx-viewer-side"), b._wrap = b.$(".mx-viewer-wrap"), 
            b._pagetitle = b.$(".page-title span"), b.createView("media", n), b.createView("image", m), 
            b.createView("web", o), b.createView("ds", q), b.createView("any", r), b.createView("svg", p), 
            MX.each(this.plugins, function(a) {
                var c = s.getPlugin(a);
                c || t.error("not find plugin [{0}]", a), b.createView(a, c);
            });
            var d = s.getCommands();
            this.cmds = {}, MX.each(this.commands, function(a) {
                var c = d[a];
                MX.isFunction(c) && (b.cmds[a] = c(b));
            }), setTimeout(function() {
                b._onAddPage();
            }, 100), this.inAnnotate = !1, this.$(".mx-viewer-btn").tooltip(), MX.env.isMobile && ($("body").swipe({
                swipeLeft: function() {
                    b.nextPage();
                },
                swipeRight: function() {
                    b.prevPage();
                }
            }), $(document).on("swipeleft", function() {
                b.nextPage();
            }).on("swiperight", function() {
                b.prevPage();
            }));
            var e = a();
            $(window).on("mousemove", function() {
                clearTimeout(e), b._pagetitle.text() && $(".page-title").show(), e = a();
            });
        },
        getView: function(a) {
            return this.views[a];
        },
        getCommand: function(a) {
            return this.cmds[a];
        },
        getContainer: function(a) {
            return this["_" + (a || "container")];
        },
        createView: function(a, b) {
            var c = new b({
                parent: this
            });
            return c.renderTo(this.getContainer(c.container || "container")), this.views[a] = c, 
            this.recovery(c);
        },
        open: function(a, c) {
            var d = b.request;
            if (a = a || d.sequence(), !a) return void this.close();
            if (this.show(), c) {
                var e = this.getView(c);
                e && e.showPanel && e.showPanel({
                    page_sequence: a,
                    isFocus: !0
                });
            }
            this.gotoPage(a);
        },
        sendMessage: function(a) {
            a = parseInt(a, 10);
            var c = "", d = "";
            if (this.model) {
                c = this.model.get("boardid");
                var e = this.model.getParent && this.model.getParent("Board");
                if (c ? e || (e = Moxtra.getBoard(c)) : c = e && e.id, e && 0 !== a && this.model.page_group) {
                    var f = e.getCacheObject(this.model.page_group);
                    f && !f.isVirtual && (d = f.client_uuid);
                }
                b.sendMessage({
                    action: "view_binder_page",
                    binder_id: c,
                    page_id: a,
                    file_id: d,
                    session_id: Moxtra.getMe().sessionId,
                    token: this.token
                });
            }
        },
        close: function() {
            this._isOpen && (this._isOpen = !1, this._hide(), this.trigger("close"), this.sendMessage(0), 
            this._currentSequence = -1, this._plugins.css("opacity", 1), this.keepInstance || (this.destroy(), 
            this.$el.remove()), this.trigger("resetActiveCommand", "", this));
        },
        show: function() {
            if (!this._isOpen) {
                var a = this;
                this.$el.show(), $(window).on("keydown.mxViewer", function(b) {
                    var c = b.target && b.target.tagName || "";
                    /INPUT|TEXTAREA/.test(c) || b.keyCode === Moxtra.const.KEYBOARD_BackSpace && a.$el.is(":visible") && (b.stopPropagation(), 
                    b.preventDefault());
                }), $(document.body).addClass("noScroll").on("keyup.mxViewer", $.proxy(a.onKeyUp, a)), 
                this._isOpen = !0, $(window).on("resize", function() {
                    a.zoom(), a.adjustSideWidth();
                });
            }
        },
        onKeyUp: function(a) {
            switch (a.keyCode) {
              case e.keys.Left:
                this.prevPage();
                break;

              case e.keys.Right:
                this.nextPage();
                break;

              case e.keys.Escape:
                this.fullscreenMode || this.disableESC || this.close();
            }
        },
        _hide: function() {
            $(document.body).removeClass("noScroll").off(".mxViewer"), $(window).off(".mxViewer"), 
            this.$el.hide(), $(document.body).removeClass("disable-select");
        },
        zoom: function(a) {
            var b, c, d = this.model, e = this;
            if (d) {
                if (a = parseFloat(a || this.viewScale || "Fit"), isNaN(a)) return this._zoomToFit();
                var f = e.$(".mx-viewer-wrap"), g = f.height(), h = f.width();
                e.viewScaleNumber = a, e.viewScale = a, b = d.get("width") || .8 * h, c = d.get("height") || g;
                var i, j = d.get("rotate") || 0, k = d.get("type");
                /image|video|pdf|note/.test(k) && j % 180 !== 0 && (i = b, b = c, c = i), 300 > b && /video|audio/.test(k) && (b = 300);
                var l = 0;
                l = g > c * a ? (g - c * a) / 2 : 0, e.viewRealSize = {
                    width: b * a,
                    height: c * a,
                    top: l
                }, e._container.css(e.viewRealSize), e.trigger("resize", e.viewRealSize);
            }
        },
        _zoomToFit: function() {
            var a = this.model;
            if (a) {
                var b, c, d, e, f = this, g = f.$(".mx-viewer-wrap"), h = g.height(), i = g.width();
                e = b = a.get("width") || i, c = a.get("height") || h;
                var j, k = a.get("rotate") || 0, l = a.get("type");
                /image|video|pdf|note/.test(l) && k % 180 !== 0 && (j = b, b = c, c = j), /video/.test(l) && 320 > b && (b = 320), 
                /audio/.test(l) && 400 > b && (b = 400);
                var m = b / c || 1;
                c = Math.min(c, h), /web/.test(l) || (d = m * c, b = Math.min(i, d), d !== b && (c = b / m)), 
                (0 === b || 0 === c) && (b = i || 600, c = h || 400), this.viewScaleNumber = b / e, 
                this.viewScale = "Fit", this.viewRealSize = {
                    width: b,
                    height: c,
                    top: (h - c) / 2
                }, this._container.css(this.viewRealSize), this.trigger("resize", this.viewRealSize);
            }
        },
        showSide: function() {
            var a = this.$el;
            if (a.hasClass("open-side") || a.addClass("open-side"), !this._side.is(":visible")) {
                var b = this;
                $(window).on("resize.mxViewer", function() {
                    b.zoom(), b.adjustSideWidth();
                }), this._side.show(), this.adjustSideWidth();
            }
        },
        adjustSideWidth: function() {
            if (this._side.is(":visible")) {
                var a = this.$el.width() - 300;
                this._wrap.width(a), this._plugins.width(a), this._tips.width(a), this._application.width(a);
            }
        },
        hideSide: function(a) {
            this._wrap.width("100%"), this._plugins.width("100%"), this._tips.width("100%"), 
            this._application.width("100%"), this._side.hide(), this.$el.removeClass("open-side"), 
            a || $(window).off("resize.mxViewer");
        },
        showSharingPanel: function() {
            this.roleContext === e.roleContext.meet && (this._container.removeClass("hide"), 
            this._plugins.removeClass("hide"), this._footerLeft.removeClass("hide"), this._footerRight.removeClass("hide"));
        },
        hideSharingPanel: function() {
            this.roleContext === e.roleContext.meet && (this._container.addClass("hide"), this._plugins.addClass("hide"), 
            this._footerLeft.addClass("hide"), this._footerRight.addClass("hide"));
        }
    }), MX.Viewer;
}), define("meet/main", [ "moxtra", "lang", "app", "const", "text!template/meet/main.html", "text!template/meet/participant.html", "meet/meet", "meet/meetBiz", "binder/binderBiz", "meet/audio/audio", "meet/video/video", "meet/meetSubHeader", "meet/participant/participant", "meet/chat/chat", "meet/topbar/topic", "meet/topbar/add", "meet/topbar/share", "meet/topbar/speaker", "meet/record/recorder", "meet/record/recording", "meet/alerts/voiceAlert", "meet/guideline/emptyUI", "meet/meetUtil", "meet/brandingCache", "common/meetExpriedAlert", "binder/newBinderOptions", "viewer/viewer", "component/uploader/base", "component/uploader/fileProgress", "meet/connector/util", "tinycon", "ui" ], function(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z, A, B, C, D) {
    var E = a.logger("meet:main");
    return a.Controller.extend({
        template: e,
        handleAction: !0,
        init: function(a) {
            a = a || {}, this.refreshed = !1, this.profile = a.profile, this.id = this.profile.boardId, 
            this.sessionKey = this.profile.sessionKey, this.sessionId = Moxtra.getMe().sessionId, 
            this.host = this.profile.host || {}, this.$scope.lang = b, this.$scope.exitTooltip = this.profile.isHost ? b.end_meet : b.leave_meet, 
            this.$scope.disableToggleSide = this._disableToggleSide(), this.model = h.getMeetModel(), 
            this.pages = h.getPageList(), this.participants = h.getParticipantList(), this.initViewer();
            var d = this;
            this.pages.once("complete", function() {
                var a = c.request.sequence(), b = d.pages.get(a);
                setTimeout(function() {
                    d._toggleAnnotate(a), b && "ds" !== !b.get("type") && d.openPage(b.get("sequence"));
                }, 500);
            }), this.listenTo(this.pages, "add", this.openDSPage), this.listenTo(this.pages, "remove", this.closeDSPage), 
            this.listenTo(this.pages, "complete", this.showPage), this.listenTo(this.pages, "page:annotate", this.annotatePage), 
            this.listenTo(this.pages, "convert", this.showConvertProgress), this.listenTo(this.model, "change:shareType", this.onShare), 
            this.listenTo(this.model, "change:syncPage", this.switchPage), this.listenTo(this.model, "change:videoState", this.pageAction), 
            this.listenTo(this.model, "change:laserPointer", this.laserPointer), this.listenTo(this.model, "change:isMeetPresenter", this.presenterChanged), 
            this.listenTo(this.model, "change:isEnded", this.meetEnded), this.listenTo(this.model, "change:noPermission", this.forceExit), 
            this.listenTo(this.model, "change:isExpired", this.meetExpired), this.listenTo(this.model, "change:selfLeft", this.onSelfLeft), 
            this.listenTo(this.model, "change:firstSubscribe", this.onFirstSubscribe), this.listenTo(c.request, "change:sequence", this.onUrlChanged), 
            this.listenTo(this.model, "change:isMeetHost", this.onHostChanged), this.closed = !1, 
            this.meetDurationMax = 0, this.recovery(function() {
                Tinycon.setBubble(0), Tinycon.setImage(c.config.settings.favicon), Tinycon.setBubble(0);
            }), MX.env.isIE && $("body").addClass("ie" + MX.env.browserVersion);
        },
        onFirstSubscribe: function(a, b) {
            this.refreshed && b && !this.participants.get(this.sessionId) && (E.logServer(D.logFormat("Meet UI shown, but not in participants. So try to call join meet again.")), 
            MX.api("/meets/" + this.sessionKey, "PUT", {
                action: "join"
            }, function(a) {
                a && a.data && E.logServer(D.logFormat("Send join call SUCCESS (Rejoined)"));
            }));
        },
        onUrlChanged: function(a) {
            var b = this;
            if (a) {
                var c = !a.sequence();
                setTimeout(function() {
                    MX.env.isChrome && MX.env.browserVersion >= 42 || b.videoView && b.videoView.isVideoOpened() && (c = !1), 
                    b._toggleEmptyUI(c);
                }, 50);
            }
        },
        onHostChanged: function(a, c) {
            var d = this;
            d.profile.isHost = c, d.$(".meet-btn-exit i").attr("data-original-title", c ? b.end_meet : b.leave_meet), 
            d._disableToggleSide() ? d.$(".mx-meet-toggleside").addClass("hide") : d.$(".mx-meet-toggleside").removeClass("hide"), 
            d.recorderView && d.recorderView.destroy && d.recorderView.destroy(), d.recordingView && d.recordingView.destroy && d.recordingView.destroy(), 
            d._renderRecord(!0), d.viewer && (d._disableToggleSide() ? d.viewer.hideSide() : d.viewer.showSide());
        },
        rendered: function() {
            var a = this;
            c.status.get("mxMeetId") === this.sessionKey ? (c.sendMessage({
                action: "resume_meet",
                binder_id: a.id,
                session_key: a.sessionKey,
                session_id: Moxtra.getMe().sessionId
            }), a.refreshed = !0) : c.status.set("mxMeetId", this.sessionKey), this.recovery(function() {
                c.status.remove("mxMeetId");
            }), this._renderEmptyUI(), this.subheaderView = new l({
                profile: this.profile,
                renderTo: ".mx-meet-subheader"
            }), this.recovery(this.subheaderView), this.participantView = new m({
                profile: this.profile,
                renderTo: ".mx-meet-participants-container"
            }), this.recovery(this.participantView), this.chatView = new n({
                profile: this.profile,
                renderTo: ".mx-meet-chats"
            }), this.recovery(this.chatView), x.getBoolTag(d.meet.tags.hideInvite) || x.getBoolTag(d.meet.tags.hideAttendeeInvite) && !this.profile.isHost || this._renderTopic(), 
            this.speakerView = new r({
                renderTo: ".meet-topbar-speaker"
            }), this.recovery(this.speakerView), x.getBoolTag(d.meet.tags.hideShareFile) || this._renderAddFile(), 
            x.getBoolTag(d.meet.tags.hideSharing) || this._renderShareScreen(), x.getBoolTag(d.meet.tags.hideAudio) || x.getBoolTag(d.meet.tags.hideAudioVoip) && x.getBoolTag(d.meet.tags.hideAudioTelephony) || this._renderAudio(), 
            x.getBoolTag(d.meet.tags.hideVideo) || this._renderVideo(), this._renderRecord(), 
            this.voiceAlertView = new u({
                profile: this.profile,
                renderTo: ".mx-meet-mic-speaker"
            }), this.recovery(this.voiceAlertView), this.bindWindowEvents(), h.start(this.id, this.sessionKey), 
            h.setAppConfig(x.getAppConfig()), this.model.set({
                zone: this.profile.zone,
                boardOwner: this.profile.boardOwner,
                isMeetPresenter: this.profile.isPresenter,
                sessionKey: this.profile.sessionKey,
                boardId: this.profile.boardId,
                hostId: MX.get("host.id", this.profile)
            }, {
                silent: !0
            }), this.$("i[title]").tooltip();
            try {
                MX.env.isChrome && (this._updateScrollBar(), this.recovery(function() {
                    a._updateScrollBar(!1);
                }));
                var b = Moxtra.getMe(), e = "";
                b.name || b.email ? e = "Name: " + b.name + " Email: " + b.email : (e = "join meet as guest", 
                this.profile.selfName && (e = "Name: " + this.profile.selfName)), e = this.profile.isHost ? "[User Info] HOST " + e : "[User Info] ATTENDEE " + e, 
                E.logServer(D.logFormat(e, {
                    meetId: this.sessionKey
                }));
                var f = x.getStringTag(d.meet.tags.endPage);
                f && c.status.set("mxMeetAnchorHref", f);
                var g = "[Meet Tab] ";
                this.refreshed && (g += "(just refreshed) "), g += parseInt(1e7 * Math.random()), 
                E.logServer(D.logFormat(g, {
                    meetId: this.sessionKey
                }));
            } catch (i) {
                console.error(i);
            }
            Tinycon.setBubble(0), Tinycon.setImage(c.config.settings.faviconMeet), Tinycon.setBubble(0);
        },
        _renderEmptyUI: function() {
            var a = !0;
            if ((this.profile.isInvisible || x.getBoolTag(d.meet.tags.hideInvite)) && (a = !1), 
            !this.profile.isHost && x.getBoolTag(d.meet.tags.hideAttendeeInvite) && (a = !1), 
            !c.isIntegrationEnabled() && a && !x.getBoolTag(d.meet.tags.hideShareFile) && !x.getBoolTag(d.meet.tags.hideSharing)) {
                var b = this;
                b.emptyUIView = new v({
                    profile: b.profile,
                    renderTo: ".tips-container .tips-body"
                }), b.recovery(b.emptyUIView), b.emptyUIView.on("invite", function() {
                    b.subheaderView && b.subheaderView.invite && b.subheaderView.invite();
                }), b.emptyUIView.on("shareFile", function() {
                    b.addFileView && b.addFileView.startShareFile && b.addFileView.startShareFile();
                }), b.emptyUIView.on("shareScreen", function() {
                    b.shareView && b.shareView.startDS && b.shareView.startDS();
                });
            }
        },
        _renderTopic: function() {
            this.topicView = new o({
                profile: this.profile,
                renderTo: ".meet-topbar-topic"
            }), this.recovery(this.topicView);
        },
        _renderAddFile: function() {
            var a = this;
            a.addFileView = new p({
                profile: a.profile,
                sessionKey: a.sessionKey,
                renderTo: ".meet-topbar-add"
            }), a.recovery(a.addFileView), a.profile.isPresenter && a._enableDragDrop();
        },
        _renderShareScreen: function() {
            this.shareView = new q({
                profile: this.profile,
                renderTo: ".meet-topbar-ds"
            }), this.recovery(this.shareView);
        },
        _renderAudio: function() {
            this.audioView = new j({
                profile: this.profile,
                renderTo: ".meet-topbar-mic"
            }), this.recovery(this.audioView);
        },
        _renderVideo: function() {
            var a = this;
            a.videoView = new k({
                renderTo: ".mx-meet-video"
            }), MX.env.isChrome && MX.env.browserVersion >= 42 || (a.videoView.on("opened", function() {
                a._toggleEmptyUI(!1);
            }), a.videoView.on("closed", function() {
                c.request.sequence() || a._toggleEmptyUI(!0);
            })), a.recovery(a.videoView);
        },
        _renderRecord: function(a) {
            if (this.profile.isHost) {
                if (x.userCap.allow_meet_recording ? ($(".mx-meet-side").addClass("recording-active"), 
                c.isIntegrationEnabled() && w.isIntegrationAutoRecord() ? (this.recordingView = new t({
                    profile: this.profile,
                    renderTo: ".mx-meet-record"
                }), this.recovery(this.recordingView)) : (this.recorderView = new s({
                    profile: this.profile,
                    renderTo: ".mx-meet-record"
                }), this.recovery(this.recorderView))) : $(".mx-meet-side").removeClass("recording-active"), 
                !a) {
                    var b = x.userCap.meet_duration_max;
                    b && (this.meetDurationMax = b, this._startTimer(b));
                }
            } else $(".mx-meet-side").addClass("recording-active"), this.recordingView = new t({
                profile: this.profile,
                renderTo: ".mx-meet-record"
            }), this.recovery(this.recordingView);
        },
        toggleSide: function() {
            var a = this.$(".meet-btn-toggle");
            a.hasClass("active") ? (a.removeClass("active"), this.viewer && this.viewer.hideSide(!0)) : (a.addClass("active"), 
            this.viewer && this.viewer.showSide());
        },
        _hideSide: function() {
            this.viewer && this.viewer.hideSide(!0), this.$(".meet-btn-toggle").removeClass("active");
        },
        exitMeet: function() {
            E.logServer(D.logFormat('[User Action] click "Exit Meet" '));
            var a = this.profile, d = {
                title: a.isHost ? b.end_meet : b.leave_meet,
                buttons: [],
                iframeShim: !0,
                content: a.isHost ? b.meet_msg_end_confirm : b.meet_msg_leave_confirm
            }, e = [], f = this;
            d.buttons.push({
                text: b.cancel,
                click: function() {
                    this.close(), E.logServer(D.logFormat('[User Action] click "Cancel" '));
                }
            }), MX.each(this.pages.models, function(a) {
                E.log(a.toJSON());
                var b = a.get("type");
                b && "ds" !== b && e.push(a.get("sequence"));
            });
            var g = !1;
            if (a.isHost && e.length > 0) {
                if (c.isIntegrationEnabled()) {
                    var j = c.integration.get("extension");
                    if (j) {
                        var k = JSON.parse(j);
                        g = k.save_meet && k.save_meet.auto_save;
                    }
                }
                g || d.buttons.push({
                    text: b.end_and_save,
                    className: "ta-save-meet",
                    click: function() {
                        E.logServer(D.logFormat('[User Action] click "End and Save" '));
                        var a = this, d = function() {
                            a.close();
                        }, g = function() {
                            a.close();
                        }, h = function() {
                            a.close();
                        };
                        this.push({
                            content: new MX.ui.BinderSelector({
                                title: b.save_meet_to,
                                buttons: [ {
                                    text: b.save,
                                    position: "right",
                                    className: "btn-warning mx-branding-meet-dialog-btn",
                                    click: "copyPageToBinder"
                                } ],
                                onChange: function() {},
                                newBinder: function() {
                                    var a = this;
                                    this.dialog.push(new z({
                                        onCreatedBinder: function(b) {
                                            a.copyPageTo(b);
                                        }
                                    }));
                                },
                                copyPageToBinder: function() {
                                    var a = this.value();
                                    if (!a) return void MX.ui.Alert(b.select_one_binder, {
                                        className: "mx-branding-meet-dialog-btn"
                                    });
                                    var c = $(this.handleEvent.currentTarget);
                                    c.text(b.saving_ellipsis), c.addClass("disabled"), this.copyPageTo(a);
                                },
                                copyPageTo: function(a) {
                                    i.copyPages(a, f.id, e).success(function() {
                                        E.debug("copy binderId ", f.id, " to ", a), MX.isArray(a) && a.length && (a = a[0]), 
                                        c.sendMessage({
                                            action: "save",
                                            binder_id: a,
                                            session_key: f.sessionKey,
                                            session_id: Moxtra.getMe().sessionId
                                        });
                                    }).error(function() {
                                        E.debug("copy pages error!");
                                    }), f._exitMeet(d, g, h);
                                }
                            })
                        });
                    }
                });
            }
            d.buttons.push({
                text: a.isHost ? b.end : b.leave,
                className: "btn-warning mx-branding-meet-dialog-btn ta-exit-meet",
                click: function() {
                    E.logServer(D.logFormat(a.isHost ? '[User Action] click "End" ' : '[User Action] click "Leave" '));
                    var d = $(this.handleEvent.currentTarget), i = this;
                    d.text(a.isHost ? b.ending_ellipsis : b.leaving_ellipsis), d.addClass("disabled");
                    var j = function() {
                        i.close();
                    }, k = function() {
                        d.text(a.isHost ? b.end : b.leave), d.removeClass("disabled"), i.close();
                    }, l = function() {
                        i.close();
                    };
                    if (a.isHost && e.length > 0 && g) {
                        var m = f.id, n = MX.format("{0}.{1}", f.sessionKey, Date.now());
                        h.saveMeetAsBinder(m, n).success(function(a) {
                            E.log(a), c.sendMessage({
                                action: "save",
                                binder_id: a.data && a.data.id || a.object && a.object.board && a.object.board.id,
                                session_key: f.sessionKey,
                                session_id: Moxtra.getMe().sessionId
                            }), f._exitMeet(j, k, l);
                        }).error(function(a) {
                            c.sendMessage({
                                action: "fail",
                                session_key: f.sessionKey,
                                session_id: Moxtra.getMe().sessionId,
                                error_code: a.xhr && a.xhr.status || "404",
                                error_message: " save meet failed"
                            }), MX.ui.notifyError(b.meet_save_failed);
                        });
                    } else f._exitMeet(j, k, l);
                }
            }), E.logServer(D.logFormat("[Show] Exit_Meet dialog"));
            var l = new MX.ui.Dialog(d);
            this.recovery(function() {
                try {
                    l.close();
                } catch (a) {
                    console.error(a);
                }
            });
        },
        _exitMeet: function(a, b, d, e) {
            var f = this, h = this.profile, e = e || {};
            c.isIntegrationEnabled() ? _.extend(h, {
                success: function() {
                    a && a(), f.close();
                },
                error: function() {
                    b && b(), f.close();
                }
            }) : (d && d(), this.close()), E.logServer(D.logFormat("Try to call exit(end/leave) meet api...")), 
            g.exit(_.extend(h, e, {
                isSendMessage: !0
            }));
        },
        bindWindowEvents: function() {
            if (!(navigator.userAgent.indexOf(d.flags.windowsAgent) > 0)) {
                var a = this;
                MX.env.isIE || (MX.env.isSafari || (window.onbeforeunload = function() {
                    return b.meet_msg_in_progress;
                }), window.onunload = function(b) {
                    E.log("page unloading...");
                    try {
                        b.clientX <= 0 && b.clientY < 0 && (h.stopApplication(), a._exitMeet(null, null, null, {
                            async: !1
                        }));
                    } catch (c) {
                        E.error("page unloaded", c);
                    }
                });
            }
        },
        initViewer: function() {
            if (!this.viewer) {
                this.viewer = new A({
                    plugins: [ "pager", "annotate", "thumbnails", "zoom", "participants", "delete", "fullscreen" ],
                    commands: [],
                    collection: this.pages,
                    skin: "default",
                    renderTo: "body",
                    disableESC: !0,
                    showApplicationContainer: !0,
                    keepInstance: !1,
                    userRole: this.profile.isPresenter ? d.binder.role.Presenter : d.binder.role.Attendee,
                    roleContext: d.roleContext.meet
                }), this.viewer.show(), this.recovery(this.viewer), this._bindViewer(), this._disableToggleSide() ? this.viewer.hideSide() : this.viewer.showSide();
                var a = this;
                this.viewer.on("fullscreen", function() {
                    a._hideSide();
                }), this.viewer.$(".mx-branding-viewer-poweredby").addClass("active"), this.viewer.hideSharingPanel();
            }
        },
        onShare: function(a, b) {
            if (this.viewer) if (h.isSharing(b)) {
                this.viewer.showSharingPanel();
                var d = c.request.sequence() || h.getSharingPage();
                d && this.viewer.gotoPage(d);
            } else this.viewer.hideSharingPanel();
        },
        switchPage: function(a, b) {
            this.openPage(b);
        },
        openDSPage: function(a) {
            if ("ds" === a.get("type")) {
                if (this.model.get("isMeetPresenter")) {
                    var b = c.request.sequence() || 0;
                    h.setDSAnchorPage(b);
                }
                this.pages.updatePageIndex(), this.openPage(a.get("sequence")), this.viewer && this.viewer.zoom("Fit"), 
                E.logServer(D.logFormat("[main openDSPage] listening event: Added DS page, sequence: " + a.get("sequence")));
            }
            if (this.model.get("isMeetPresenter") && "" === this.model.get("shareType") && "ds" !== a.get("type") && c.isIntegrationEnabled()) {
                var e = c.status.get("mxMeetShareType");
                if (!e || void 0 === e[this.sessionKey]) return h.startShareFile(a.get("sequence")), 
                this.pages.updatePageIndex(), void this.openPage(a.get("sequence"));
            }
            "whiteboard" === a.get("type") && this.model.get("isMeetPresenter") && this.model.get("shareType") === d.meet.shareType.file && (this.pages.updatePageIndex(), 
            this.openPage(a.get("sequence")));
        },
        closeDSPage: function(a) {
            if ("ds" === a.get("type")) {
                if (this.model.get("isMeetPresenter")) {
                    var b = h.getDSAnchorPage();
                    this.openPage(b);
                }
                this.viewer.getView("ds").hide(), E.logServer(D.logFormat("[main closeDSPage] listening event: Removed DS page, sequence: " + a.get("sequence")));
            }
        },
        openPage: function(a) {
            this.viewer && (a ? (this.viewer.showSharingPanel(), c.request.sequence(a), this.viewer.gotoPage(a)) : this.viewer.hideSharingPanel(), 
            h.setSharingPage(a));
        },
        showPage: function() {
            if (E.log(this.pages.length), this.pages.length) {
                if (x.getBoolTag(d.meet.tags.autoFullscreen) && this._hideSide(), !h.isSharing()) return;
                var a = this._getCurrentPage() || c.request.sequence();
                if (!a || !this.pages.get(a)) {
                    var b = this.pages.at(0);
                    "ds" !== b.get("type") && this.openPage(b.get("sequence"));
                }
            } else c.request.sequence("");
        },
        annotatePage: function(a) {
            var b, c = a.sequence;
            this.viewer && (b = this.viewer.getView("svg")), b && MX.each(a.contents, function(a) {
                b.addElement(a, c);
            });
        },
        initConvertProgress: function(c) {
            var d = this;
            if (d.convertModelClass || (d.convertModelClass = a.Model.extend({
                precent: 0,
                name: ""
            })), d.convertModels = d.convertModels || {}, !d.convertModels[c.client_uuid]) {
                d.convertModels[c.client_uuid] = new d.convertModelClass({
                    percent: 0,
                    name: MX.format(b.converting_file_progress.replace("{1}/{2}:", ""), c.name)
                });
                {
                    new MX.ui.Notify({
                        autoClose: !1,
                        content: new C({
                            model: d.convertModels[c.client_uuid]
                        })
                    });
                }
            }
        },
        showConvertProgress: function(a, c) {
            var d = this;
            c.creator = c.creator || {};
            var e = c.client_uuid, f = d.convertModels && d.convertModels[e];
            0 === a ? (Moxtra.getMe().id !== c.creator.id && MX.ui.notifySuccess(MX.format(b.upload_file_success_with_actor, c.creator.name || c.creator.first_name || "", c.name)), 
            d.initConvertProgress(c)) : -1 === a ? f && (f.set({
                percent: 100,
                name: MX.format(b.converting_file_progress, c.name, c.converted_pages, c.total_pages)
            }), MX.ui.notifyError(b.convert_file_failed), f = null, delete d.convertModels[e]) : 100 === a ? f && (f.set({
                percent: a,
                name: MX.format(b.converting_file_progress, c.name, c.converted_pages, c.total_pages)
            }), f = null, delete d.convertModels[e]) : f ? f.set({
                percent: a,
                name: MX.format(b.converting_file_progress, c.name, c.converted_pages, c.total_pages)
            }) : d.initConvertProgress(c);
        },
        pageAction: function(a, b) {
            E.log("pageAction from subscribe");
            var c = this.viewer.getView("media"), d = this._getCurrentPage();
            c && MX.each(b, function(a) {
                if (a.page_sequence === d) {
                    var b = a.action_timestamp / 1e3;
                    switch (a.status) {
                      case "VIDEO_PLAYING":
                        c.play(b);
                        break;

                      case "VIDEO_PAUSED":
                        c.pause(b);
                        break;

                      case "VIDEO_STOPPED":
                        c.end();
                    }
                }
            });
        },
        laserPointer: function(a, b) {
            var c = this.viewer.getView("annotate");
            if (c && b.page_sequence === this._getCurrentPage()) if (E.log("update laser pointer from subscribe", b), 
            b.px > 0 || b.py > 0) c.showLaserPointer(!0), c.updateLaserPointer(b.px, b.py); else {
                var d = c.$('a[data-param="LaserPointer"]');
                d.length && !d.hasClass("active") && c.hideLaserPointer(!0);
            }
        },
        _getCurrentPage: function() {
            var a = 0;
            return this.viewer && this.viewer.model ? this.viewer.model.get("sequence") : a;
        },
        _toggleAnnotate: function() {},
        _bindViewer: function() {
            var a = this;
            this.viewer.on("switchPage", function(b) {
                c.request.sequence(b.page_sequence, !1), h.isSharing() && h.publishSwitchPage(b.page_sequence), 
                a._toggleAnnotate(b.page_sequence), a.pointTimer && clearInterval(a.pointTimer);
            }), this.viewer.on("viewer:pageAction", function(a) {
                h.publishPageAction(a);
            });
            var b = this.viewer.getView("annotate");
            b && (a.pointArray = [], b.on("showLaserPointer", function(b) {
                h.publishLaserPointer(b), a.pointArray = [], clearInterval(a.pointTimer), a.pointTimer = setInterval(function() {
                    console.log("pointTimer");
                    var b = a.pointArray.pop();
                    a.pointArray.length = 0, b && (console.log("publishLaserPointer"), h.publishLaserPointer(b));
                }, 1e3);
            }), b.on("hideLaserPointer", function(b) {
                h.publishLaserPointer(b), a.pointTimer && clearInterval(a.pointTimer);
            }), b.on("updateLaserPointer", function(b) {
                E.log("main -> updateLaserPointer"), a.pointArray.push(b);
            }), this.recovery(function() {
                a.pointTimer && clearInterval(a.pointTimer);
            }));
        },
        _startTimer: function(a) {
            var b = c.status.get("mxMeetTimer") || {}, d = 0, e = 0, f = 60 * c.config.thresholds.meetDurationLimitation * 1e3, g = a, h = this;
            if (b[this.sessionKey]) d = Date.now() - b[this.sessionKey]; else {
                var i = {};
                i[this.sessionKey] = Date.now(), c.status.set("mxMeetTimer", i);
            }
            if (g = a - f - d, 0 > g) {
                if (e = f + g, 0 > e) return;
                e = Math.ceil(Math.abs(e) / 6e4), g = 100;
            } else e = Math.ceil(f / 6e4);
            this.alertTimer = setTimeout(function() {
                h.recovery(new y({
                    renderTo: $(".mx-meet"),
                    maxDuration: h._formatDuration(a),
                    remaining: e
                }));
            }, g);
        },
        _formatDuration: function(a) {
            var c = Math.ceil(a / 6e4), d = 0;
            if (c >= 60) {
                var e = [];
                return d = parseInt(c / 60), e.push(d), e.push(d > 1 ? b.hours : b.hour), c %= 60, 
                c > 0 && (e.push(c), e.push(c > 1 ? b.minutes : b.minute)), e.join(" ");
            }
            return c + " " + (c > 1 ? b.minutes : b.minute);
        },
        presenterChanged: function(a) {
            var b = d.binder.role.Attendee, c = a.get("isMeetPresenter"), e = this;
            c ? (b = d.binder.role.Presenter, e._enableDragDrop()) : e._disableDragDrop(), this.viewer && this.viewer.setUserRole(b), 
            h.presenterChanged(), setTimeout(function() {
                e.viewer && e.viewer.getView("ds").hide();
            }, 500);
        },
        meetEnded: function() {
            this.closed || (this.profile.isHost || MX.ui.notifyInfo(b.meet_ended), E.logServer(D.logFormat("Meet is ended, try to close meet UI & unsubscribe")), 
            this.close({
                ended: !0
            }));
        },
        forceExit: function() {
            E.logServer(D.logFormat("Meet is forced to exit, post message")), E.logServer(D.logFormat("Meet is forced to exit, try to close meet UI & unsubscribe")), 
            this.close({
                ended: !0
            });
        },
        meetExpired: function() {
            E.logServer(D.logFormat("Meet is expired, try to close meet UI & unsubscribe")), 
            this.close({
                ended: !0
            });
            var a = this.profile;
            this.profile.isHost ? (_.extend(a, {
                isSendMessage: !0
            }), this.meetDurationMax && MX.ui.notifyInfo(MX.format(b.cap_meet_duration_max_alert, {
                maxDuration: this._formatDuration(this.meetDurationMax)
            })), E.logServer(D.logFormat("Meet is expired, End Meet (host side) ", {
                meetId: this.sessionKey
            }))) : (E.logServer(D.logFormat("Meet is expired, attendee post message", {
                meetId: this.sessionKey
            })), E.logServer(D.logFormat("Meet is expired, Leave Meet (attendee side) ", {
                meetId: this.sessionKey
            }))), g.exit(a);
        },
        onSelfLeft: function() {
            E.logServer(D.logFormat("Already left meet in some place.")), this.close();
        },
        close: function(a) {
            if (a = a || {}, E.log("meet closed..."), $("#" + d.style.meetBrandingId).remove(), 
            !this.closed) {
                this.closed = !0, h.stopApplication(), E.logServer(D.logFormat("Meet is closing...")), 
                clearTimeout(this.alertTimer), c.status.remove("mxMeetTimer"), window.onbeforeunload = null, 
                window.onunload = null;
                var b = this;
                [ "participantView", "chatView", "topicView", "recorderView" ].forEach(function(a) {
                    b[a] && b[a].stopListen && b[a].stopListen();
                }), h.stop(this.id), this.viewer && (this.viewer.hideSide(), this.viewer.close()), 
                this.$el.remove();
                var e = "";
                if (e = this.profile.isHost ? "end" : a.ended ? "leave_as_ended" : "leave", c.sendMessage({
                    action: e,
                    binder_id: this.id,
                    session_key: this.sessionKey,
                    session_id: this.sessionId
                }), E.logServer(D.logFormat("Meet closed!", {
                    meetId: this.sessionKey
                }), !0), c.isIntegrationEnabled()) try {
                    window.close();
                } catch (f) {
                    console.error(f);
                }
            }
        },
        reclaimHost: function() {
            Moxtra.reclaimMeetHost(this.profile.sessionKey).success(function() {
                MX.ui.notifySuccess(b.meet_reclaim_host_success);
            }).error(function() {
                MX.ui.notifyError(b.meet_reclaim_host_failed);
            });
        },
        _enableDragDrop: function() {
            var a = this;
            a.dragdrop = new B({
                className: "mx_swf_container_dragdrop",
                container: a.$el
            }), a.dragdrop.register("dragPageToMeet", {
                browse_button: "uploadDragDropInMeetHidden",
                drop_element: "mxBody",
                drop_message: b.drop_your_file_to_meet,
                url: function() {
                    return "/board/upload?type=original&id=" + a.id;
                }
            }), setTimeout(function() {
                a.dragdrop.refresh("dragPageToMeet", a.$("#uploadDragDropInMeetHidden"));
            }, 300), a.recovery(function() {
                a._disableDragDrop();
            });
        },
        _disableDragDrop: function() {
            this.dragdrop && this.dragdrop.unregister("dragPageToMeet");
        },
        _updateScrollBar: function(a) {
            var b = "scroll-bar-style", c = [], d = $("#" + b);
            a === !1 ? d.remove() : (d.length && d.remove(), c.push('<style id="' + b + '">'), 
            c.push("*::-webkit-scrollbar-track-piece {background-color: #ccc;-webkit-border-radius:0;}"), 
            c.push("*::-webkit-scrollbar {width: 10px;}"), c.push("</style>"), $("html head").append(c.join("\r\n")));
        },
        _toggleEmptyUI: function(a) {
            this.emptyUIView && (a ? this.emptyUIView.show() : this.emptyUIView.hide());
        },
        _disableToggleSide: function() {
            var a = !1;
            return x.getBoolTag(d.meet.tags.hideParticipant) ? a = !0 : (!this.profile.isHost && x.getBoolTag(d.meet.tags.hideAttendeeParticipant) && (a = !0), 
            !this.profile.isHost && Moxtra.getMe().id && Moxtra.getMe().id === MX.get("host.id", this.profile) && (a = !1)), 
            a;
        }
    });
}), define("text!template/meet/intro.html", [], function() {
    return '<div class="page-body">\r\n	<div id="mxPageBody_Col_1">\r\n		<div class="mx-meet-calendar">\r\n			<div class="top-bar">\r\n				<div id="mxMeetCalendar"></div>\r\n			</div>\r\n			<div class="meet-actions">\r\n				<ul>\r\n					{{#if branding.showMeetNow}}\r\n					<li class="mx-branding-meetnow hide">\r\n						<a href="#mymeet?action=start_with_contact" target="{{tabName}}" oncontextmenu="return false;" class="mouse-hand"><i class="micon-start-meet size20"></i> {{lang.meet_now}}</a>\r\n					</li>\r\n					{{/if}}\r\n					<li>\r\n						<a data-action="joinMeet" class="mouse-hand"><i class="micon-join-meet size20"></i> {{lang.join_meet}}</a>\r\n					</li>\r\n					{{#if branding.showScheduleMeet}}\r\n					<li class="mx-branding-schedulemeet hide">\r\n						<a data-action="scheduleMeet" class="mouse-hand"><i class="micon-schedule size20"></i> {{lang.schedule_meet}}</a>\r\n					</li>\r\n					{{/if}}\r\n				</ul>\r\n			</div>\r\n		</div>\r\n	</div>\r\n	<div id="mxPageBody_Col_2">\r\n		<div class="page-body">\r\n			<div class="mx-meet-list-header">\r\n				<div class="day">Tuesday</div>\r\n				<div class="date">May 6, 2014</div>\r\n			</div>\r\n			<div class="mx-meet-list">\r\n				\r\n			</div>\r\n		</div>\r\n	</div>\r\n</div>\r\n\r\n';
}), define("text!template/meet/management/meetItem.html", [], function() {
    return '<li class="mx-item">\n	<div class="mx-meet-item {{#if board.session.isPast}}mx-meet-ended{{/if}}" ta-param="{{board.id}}">\n		<div class="section item-flag">\n			{{#if board.session.isPast}}\n			<i class="micon-meet-empty size20"></i>\n			{{else}}\n			<i class="micon-meet size20 meet-active"></i>\n			{{/if}}\n		</div>\n		<div class="section item-wrap">\n			<div class="item-title">\n				<div class="meet-topic ellipsis mouse-hand {{#unless board.session.isPast}}meet-active{{/unless}}" data-action="viewMeet" data-param="{{board.id}}"><strong ta-param="{{board.name}}">{{board.name}}</strong></div>\n				<div class="meet-time {{#unless board.session.isPast}}meet-active{{/unless}}">\n					<span class="pull-left">\n					{{#if board.session.recordings.length}}\n						{{#when board.session.recordings.length \'==\' 1}}\n							{{#each board.session.recordings}}\n							<a class="mouse-hand" data-action="playRecording" data-param="{{../../board.id}},{{sequence}},{{name}}"><i class="micon-play-with-circle size16"></i></a>\n							{{/each}}\n						{{/when}}\n						{{#when board.session.recordings.length \'>\' 1}}\n						<span class="dropdown pull-left">\n							<a class="mouse-hand recording-video" id="recordings{{board.id}}" data-toggle="dropdown"><i class="micon-video size12 blue"></i></a>\n							<ul class="dropdown-menu pull-right" aria-labelledby="recordings{{board.id}}">\n								{{#each board.session.recordings}}\n						        <li><a class="mouse-hand" data-action="playRecording" data-param="{{../../board.id}},{{sequence}},{{name}}"><i class="micon-play-with-circle size16"></i> {{name}}</a></li>\n						        {{/each}}\n						    </ul>\n					    </span>\n				    	{{/when}}\n				    {{else}}\n				    	{{#if board.session.recording}}\n				    	<a class="mouse-hand" data-action="playRecording" data-param="{{board.id}},{{board.session.recording}},{{lang.recording}}"><i class="micon-play-with-circle size16"></i></a>\n				    	{{/if}}\n					{{/if}}\n					</span>\n					<span class="pull-right">\n					{{#if board.session.scheduled_start_time}}\n						{{formatShortTime board.session.scheduled_start_time}}\n					{{else}}\n						{{formatShortTime board.session.start_time}}\n					{{/if}}\n					</span>\n				</div>\n			</div>\n			<div class="item-summary">\n				<ul>\n					<li>{{lang.meet_host}}: {{board.session.host}}</li>\n					{{#if board.session.isActive}}\n					<li>{{lang.in_progress}}</li>\n					{{else}}\n					<li>{{formatDuration board.session.duration}}</li>\n					{{/if}}\n					<li>\n						{{board.members.length}}\n						{{#when board.members.length \'==\' 1}}\n						 {{lang.participant}}\n						{{/when}}\n						{{#when board.members.length \'>\' 1}}\n						 {{lang.meet_participants}}\n						{{/when}}\n					</li>\n					<li><a class="mouse-hand meet-action-ics" title="{{lang.import_icalendar}}" data-placement="top" data-action="downloadICS" data-param="{{board.session.session_key}}" style="text-decoration: none;"><i class="micon-calendar size14"></i></a></li>\n					<li><a class="mouse-hand" data-action="viewMeet" data-param="{{board.id}}">{{lang.view}}</a></li>\n					{{#if board.session.editable}}\n					<li><a class="mouse-hand" data-action="editMeet" data-param="{{board.id}}">{{lang.edit}}</a></li>\n					{{/if}}\n				</ul>\n			</div>\n			<div class="item-participants">\n				{{#each board.members}}\n					{{#when @index \'<\' 10}}\n						<img class="img-circle pull-left {{#if group}}mx-noborder mx-noborder-radius{{/if}}" src="{{avatar}}" data-param="{{user.email}}" title="{{user.name}}"/>\n					{{/when}}\n					{{#when @index \'==\' 10}}\n						<span class="pull-left" style="padding-top:10px;">...</span>\n					{{/when}}\n				{{/each}}\n				{{#if board.session.joinable}}\n					{{#if board.session.isActive}}\n						{{#if autoJoinMeet}}\n						<a class="btn btn-warning btn-sm pull-right meet-action-btn" href="#mymeet?action=join_from_calendar&binderid={{board.id}}" target="{{tabName}}" oncontextmenu="return false;">{{lang.join}}</a>\n						{{else}}\n						<a class="btn btn-warning btn-sm pull-right meet-action-btn" data-action="joinScheduledMeet" data-param="{{board.id}},{{board.session.session_key}}">{{lang.join}}</a>\n						{{/if}}\n					{{else}}\n						{{#if board.session.isHost}}\n						<a class="btn btn-warning btn-sm pull-right meet-action-btn" href="#mymeet?action=start_from_calendar&binderid={{board.id}}" target="{{tabName}}"  oncontextmenu="return false;">{{lang.start}}</a>\n						{{else}}\n							{{#if autoJoinMeet}}\n							<a class="btn btn-warning btn-sm pull-right meet-action-btn" href="#mymeet?action=join_from_calendar&binderid={{board.id}}" target="{{tabName}}" oncontextmenu="return false;">{{lang.join}}</a>\n							{{else}}\n							<a class="btn btn-warning btn-sm pull-right meet-action-btn" data-action="joinScheduledMeet" data-param="{{board.id}},{{board.session.session_key}}">{{lang.join}}</a>\n							{{/if}}\n						{{/if}}\n					{{/if}}\n				{{else}}\n					{{#if board.session.isInvited}}\n						{{#unless board.session.isPast}}\n						<a class="btn pull-right meet-action-btn" data-action="decline" data-param="{{board.id}}"><i class="glyphicon glyphicon-remove-circle gray"></i></a>\n						<button class="btn btn-warning btn-sm pull-right" data-action="accept" data-param="{{board.id}}">{{lang.accept}}</button>\n						{{/unless}}\n					{{else}}\n						{{#if board.session.startable}}\n						<a class="btn btn-warning btn-sm pull-right meet-action-btn" href="#mymeet?action=start_from_calendar&binderid={{board.id}}" target="{{tabName}}"  oncontextmenu="return false;">{{lang.start}}</a>\n						{{/if}}\n					{{/if}}\n				{{/if}}\n			</div>\n		</div>\n	</div>\n</li>\n';
}), define("text!template/meet/management/emptyItem.html", [], function() {
    return '<div class="mx-empty-view ">\n	<div class="center"><img src="themes/images/empty-icon-meet.a28e046d.png"></div>\n	<div class="center title">{{lang.meet_empty_headline}}</div>\n	<div class="center subtitle">{{lang.meet_empty_subtitle}}</div>\n	<!-- <div class="extra">\n		<hr/>\n		<div class="notes">Lorem ipsum dolor sit amet, consectetur elit, sed do elusmod tempor incididunt ut labore et dolore</div>\n		<div class="links">\n			<a class="mouse-hand">Elusmod Tempor</a>\n			&bull;\n			<a class="mouse-hand">Incididunt Ut</a>\n		</div>\n	</div> -->\n</div>';
}), define("text!template/meet/player.html", [], function() {
    return '<video poster="{{thumbnail}}" width="100%" height="100%"  style="width:100%;height:100%"\n        controls  preload="none">\n    <source src="{{source}}" type="video/mp4"/>\n    {{lang.browser_not_support_video_tag}}\n</video>';
}), define("meet/player", [ "moxtra", "lang", "text!template/meet/player.html" ], function(a, b, c) {
    return a.Controller.extend({
        title: "",
        buttons: [ {
            text: b.done,
            className: "btn-primary",
            click: function() {
                this.close();
            }
        }, {
            text: b.back,
            position: "left",
            className: "btn-default",
            click: function() {
                this.pop();
            }
        } ],
        template: c,
        init: function(a) {
            this.$scope.lang = b, this.$scope.source = a.source, _.extend(this, a);
        },
        rendered: function() {
            var a = this;
            setTimeout(function() {
                a.$el.mediaelementplayer({
                    iPadUseNativeControls: !0,
                    iPhoneUseNativeControls: !0,
                    flashName: "lib/mediaelement/build/flashmediaelement.f82e1f90.swf",
                    success: function(a, b, c) {
                        a.load();
                        var d = c.controls.find(".mejs-time-rail"), e = d.width(), f = function() {
                            d.css("width", e - 1 + "px");
                        };
                        c.container.on("controlsshown", function() {
                            setTimeout(f, 500), c.container.on("mouseover", f);
                        }), c.container.on("controlshidden", function() {
                            setTimeout(f, 300);
                        }), c.globalBind("resize", function() {
                            e = d.width(), setTimeout(f, 300);
                        });
                    }
                });
            }, 1e3);
        }
    });
}), define("text!template/meet/management/startForm.html", [], function() {
    return '<div class="start-meet">\n	<div id="startMeetForm">\n		<div class="form-group">\n			<input type="text" placeholder="{{placeholder}}" data-error-style="inline" class="form-control" name="meetTopic">\n		</div>\n	</div>\n	<div class="user-selector">\n		\n	</div>\n</div>';
}), define("meet/management/startForm", [ "moxtra", "lang", "app", "text!template/meet/management/startForm.html", "meet/meet", "meet/meetUtil", "component/selector/userSelector" ], function(a, b, c, d, e, f) {
    "use strict";
    return a.Controller.extend({
        title: b.meet_invite_participants,
        template: d,
        handleAction: !0,
        init: function(a) {
            a = a || {}, this.startDirect = a.startDirect, this.defaultInvitedUsers = a.defaultInvitedUsers, 
            this.originalBoardId = a.originalBoardId, this.index = parseInt(1e3 * Math.random());
            var d = "#mymeet?action=start_with_contacts&index=" + this.index, e = Moxtra.getMe();
            this.buttons = [ {
                text: b.cancel,
                className: "btn-default",
                click: "onCancel"
            }, {
                position: "right",
                id: "btnStartMeet",
                href: d,
                hrefTarget: c.config.global.meetTabName,
                text: b.start_meet,
                className: "btn-primary",
                click: "onStart"
            } ], this.startDirect && (delete this.buttons[1].href, delete this.buttons[1].hrefTarget), 
            this.$scope.lang = b, this.$scope.placeholder = MX.format(b.meet_topic, {
                name: e.first_name || e.email
            });
        },
        rendered: function() {
            var a = this, b = {
                autoFocus: !1,
                expandSelected: !1,
                notifySelected: !0,
                needMessage: !1
            };
            a.defaultInvitedUsers && (b.defaultSelected = a.defaultInvitedUsers), a.userSelector = new MX.ui.UserSelector(b), 
            a.userSelector.renderTo(a.$(".user-selector")), a.startDirect && a.dialog && setTimeout(function() {
                $(".modal-dialog button.close").click(function() {
                    a._gotoCalendar();
                });
            }, 1e3);
        },
        onCancel: function() {
            this.dialog && this.dialog.close(), this.startDirect && this._gotoCalendar();
        },
        onStart: function() {
            var a = [], d = this.userSelector.value(), g = {}, h = {}, i = this.$("#startMeetForm input").val(), j = "_" + this.index + "_" + Moxtra.getMe().id, k = this;
            if (d.each(function(b) {
                var c = b.toJSON();
                a.push(MX.isUndefined(c.isTeam) ? {
                    email: c.email
                } : {
                    group_id: c.id
                });
            }), console.log(a), k.startDirect) {
                var l;
                f.showMeetFeed(k.originalBoardId, d) && (l = k.originalBoardId), e.start({
                    backHref: "#mymeet?action=default",
                    forceStart: !0,
                    topic: i,
                    users: a,
                    boardId: l,
                    success: function() {},
                    error: function() {
                        k._gotoCalendar(), MX.ui.Alert(b.contact_start_meet_failed);
                    }
                });
            }
            g[j] = a, c.localStatus.set("mxMeetInvitees", g), h[j] = i, c.localStatus.set("mxMeetTopic", h), 
            setTimeout(function() {
                k.dialog.close();
            }, 100);
        },
        _gotoCalendar: function() {
            c.navigate("/meetintro", !0);
        }
    });
}), define("text!template/meet/management/joinForm.html", [], function() {
    return '<div>\n	<form id="meetIdForm">\n		<div class="form-group">\n			<input type="text" name="meetId" class="form-control" data-error-style="inline" placeholder="{{lang.meet_id}}" autofocus/>\n		</div>\n	</form>\n</div>';
}), define("meet/management/joinForm", [ "moxtra", "lang", "app", "text!template/meet/management/joinForm.html", "meet/meet" ], function(a, b, c, d) {
    var e = (MX.logger("meet:intro:join"), a.Model.extend({
        defaults: {
            meetId: ""
        },
        validation: {
            meetId: [ {
                required: !0,
                msg: b.meet_id_required
            }, {
                pattern: /(\d+|\s*)/,
                msg: b.meet_id_format_error
            } ]
        }
    }));
    return a.Controller.extend({
        template: d,
        title: b.join_meet,
        handleAction: !0,
        init: function(a) {
            if (this.$scope.lang = b, this.model = new e(), _.extend(this, a), this.buttons = [ {
                text: b.cancel,
                className: "btn-default",
                click: "onClickCancel"
            } ], this.autoJoinMeet = c.isAutoJoinMeet(), this.autoJoinMeet) {
                var d, f = parseInt(1e3 * Math.random());
                this.index = f, d = "#mymeet?action=join&index=" + f, this.buttons.push({
                    id: "btnJoinMeetDialog",
                    href: d,
                    hrefTarget: c.config.global.meetTabName,
                    text: b.join,
                    className: "btn-primary disabled",
                    click: "onClickJoin"
                });
            } else this.buttons.push({
                id: "btnJoinMeetDialog",
                text: b.join,
                className: "btn-primary disabled",
                click: "onClickJoin"
            });
        },
        rendered: function() {
            this.form = new a.Form({
                parent: this,
                form: this.$("#meetIdForm"),
                model: this.model,
                submit: this.submit,
                scope: this
            });
            var b = this;
            setTimeout(function() {
                var a = $("#btnJoinMeetDialog");
                a.removeAttr("href"), a.addClass("disabled"), b.$("input").focus(), b.$("input").on("keyup mouseleave", function(d) {
                    var e, f = $(this).val().trim();
                    f ? (e = b._parseHref(b._parseKey(f)), a.attr("href", e), a.removeClass("disabled"), 
                    b.$(".has-error .help-inline").empty(), b.$(".has-error").removeClass("has-error"), 
                    13 === d.keyCode && window.open(e, c.config.global.meetTabName)) : (a.removeAttr("href"), 
                    a.addClass("disabled"));
                });
            }, 500);
        },
        onClickCancel: function() {
            this.dialog.close(), this.onJoinDone();
        },
        onClickJoin: function() {
            this.model.isValid(!0) && this.submit();
        },
        submit: function() {
            var a = this._parseKey(this.model.get("meetId")), b = {}, d = this;
            a && (this.autoJoinMeet ? (b["_" + this.index] = a, c.status.set("mxMeetJoinId", b)) : c.sendMessage({
                action: "request_join_meet",
                binder_id: null,
                session_key: a,
                session_id: Moxtra.getMe().sessionId
            }), setTimeout(function() {
                d.dialog.close();
            }, 100));
        },
        _parseKey: function(a) {
            return a = a || "", a.replace(/(-|\s*)/gi, "");
        },
        _parseHref: function(a) {
            var b = "#mymeet?action=join&index=" + this.index;
            return b += "&session_key=" + a, this._href = b, b;
        },
        onJoinDone: function() {}
    });
}), define("text!template/meet/management/scheduleForm.html", [], function() {
    return '<div class="mx-meet-schedule">\n	<form>\n		<div class="form-group">\n			<input id="scheduleTopic" type="text" class="form-control" placeholder="{{placeholder}}" value="{{name}}" />\n		</div>\n		<div class="form-group">\n			<div class="input-group">\n			  <span class="input-group-addon date-addon">{{lang.starts}}</span>\n			  <input id="scheduleStartDate" type="text" class="form-control" placeholder="{{lang.start_date}}">\n			</div>\n		</div>\n		<div class="form-group">\n			<div class="input-group">\n			  <span class="input-group-addon date-addon">{{lang.ends}}</span>\n			  <input id="scheduleEndDate" type="text" class="form-control" placeholder="{{lang.end_date}}">\n			</div>\n		</div>\n		{{#if editable}}\n		<div class="form-group">\n			<div class="meet-link">\n				<span>{{meetLink}}</span>\n			</div>\n		</div>\n		{{/if}}\n		<div class="form-group">\n			<div class="agenda-action">\n				<textarea id="scheduleAgenda" placeholder="{{lang.agenda}}" class="meet-agenda">{{session.agenda}}</textarea>\n				<a class="mouse-hand" data-action="zoomAgendaText"><i class="micon-full-screen icon-zoom-meet-agenda"></i></a>\n			</div>\n		</div>\n		\n		{{#if showJBH}}\n		<!-- <div class="form-group">\n			<div class="jbh-setting">\n				<input type="checkbox" id="joinBeforeHost" {{#if session.milliseconds_allowed_to_join_before_start}}checked{{/if}}/>\n				<label for="joinBeforeHost">{{lang.enable_join_before_host_tip}}</label>\n			</div>\n		</div> -->\n		{{/if}}\n		\n		{{#if allowRecording}}\n		<div class="form-group">\n			<div class="recording-setting">\n				<input type="checkbox" id="autoRecording" {{#if autoRecording}}checked{{/if}}/>\n				<label for="autoRecording">{{lang.record_this_meet_tip}}</label>\n			</div>\n		</div>\n		{{/if}}\n		<div class="form-group">\n			<div class="row invite-action">\n				<a class="mouse-hand invite pull-left" data-action="invite"><i class="micon-user-add"></i> {{lang.invite}}</a>\n				<span class="pull-right total-invitees"></span>\n			</div>\n		</div>\n		<div class="form-group">\n			<div class="invite-section">\n				<div class="invitees">\n\n				</div>\n			</div>\n		</div>\n		{{#if editable}}\n		<div class="form-group">\n			<a class="mouse-hand delete-meet-schedule" data-action="deleteMeet" data-param="{{id}}">{{lang.delete_meet}}</a>\n		</div>\n		{{/if}}\n	</form>\n</div>\n';
}), define("text!template/meet/management/invitee.html", [], function() {
    return '<li class="mx-item">\n	<div class="row">\n		<div class="col-sm-1">\n			<img src="{{#if group}}{{teamAvatar}}{{else}}{{avatar}}{{/if}}" class="invitee-avatar img-circle {{#if group}}mx-noborder mx-noborder-radius{{/if}}">\n		</div>\n		{{#if group}}\n		<div class="col-sm-7">\n			<div class="invitee-name ellipsis marginTop5">{{group.name}}</div>\n		</div>\n		<div class="col-sm-3">\n			<div class="gray marginTop5 pull-right">\n				({{lang.accepted}})\n			</div>\n		</div>\n		<div class="col-sm-1">\n			{{#unless meetHost}}\n			<span class="delete" data-action="removeInvitee" data-param="{{cid}}"><i class="micon-trash size18 blue"></i></span>\n			{{/unless}}\n		</div>\n		{{else}}\n		<div class="col-sm-7">\n			<div class="invitee-name ellipsis">{{name}} {{#if meetHost}}({{lang.meet_host}}){{/if}}</div>\n			<div class="invitee-email ellipsis">{{email}}</div>\n		</div>\n		<div class="col-sm-3">\n			<div class="gray marginTop5 pull-right">\n			{{#when type \'!=\' \'BOARD_OWNER\'}}\n				{{#when status \'==\' \'BOARD_MEMBER\'}}({{lang.accepted}}){{/when}}\n				{{#when status \'==\' \'BOARD_INVITED\'}}({{lang.pending}}){{/when}}\n			{{/when}}\n			</div>\n		</div>\n		<div class="col-sm-1">\n			{{#unless meetHost}}\n			<span class="delete" data-action="removeInvitee" data-param="{{cid}}"><i class="micon-trash size18 blue"></i></span>\n			{{/unless}}\n		</div>\n		{{/if}}\n	</div>\n</li>\n';
}), define("contacts/contactCollection", [ "moxtra", "user/userModel" ], function(a, b) {
    return a.Collection.extend({
        model: b,
        fetch: function(a) {
            new MX.ChainObject(function() {
                MX.api("/contacts", "GET", a, this.callback, this);
            }).scope(this).success(this._parseData);
        },
        comparator: function(a) {
            var b = a.get("displayName") || "";
            return b.toLowerCase();
        },
        _parseData: function(a) {
            this.reset(a.data, {
                parse: !0
            }), this.trigger("complete");
        }
    });
}), define("text!template/meet/management/agenda.html", [], function() {
    return '<div class="agenda-zoom-wrap">\n	<div>\n		<button type="button" class="close" data-action="exitZoom">&times;</button>\n		<h4 class="ellipsis">{{lang.agenda}}</h4>\n	</div>\n	<textarea class="form-control meet-agenda-zoom vertResize" value="{{agenda}}" placeholder="{{lang.agenda}}" {{#if readyonly}}readonly{{/if}} autofocus>{{agenda}}</textarea>\n</div>';
}), define("meet/management/agenda", [ "moxtra", "lang", "text!template/meet/management/agenda.html" ], function(a, b, c) {
    return a.Controller.extend({
        template: c,
        handleAction: !0,
        init: function(a) {
            this.$scope.lang = b, this.$scope.agenda = a.agenda || "", this.$scope.readyonly = a.readyonly || !1, 
            _.extend(this, a);
        },
        rendered: function() {},
        exitZoom: function() {
            this.handleEvent.preventDefault(), this.handleEvent.stopPropagation(), this.onClose(this.$("textarea").val());
        },
        onClose: function() {}
    });
}), define("meet/management/scheduleForm", [ "moxtra", "lang", "const", "app", "text!template/meet/management/scheduleForm.html", "text!template/meet/management/invitee.html", "user/userModel", "contacts/contactCollection", "meet/management/agenda", "meet/meetUtil", "component/selector/userSelector" ], function(a, b, c, d, e, f, g, h, i, j) {
    var k = MX.logger("meet:schedule:form");
    return a.Controller.extend({
        template: e,
        title: b.schedule_meet,
        handleAction: !0,
        daysDiff: 0,
        offsetAdjustment: 0,
        buttons: [ {
            position: "left",
            text: b.cancel,
            className: "btn-default",
            click: "onClickCancel"
        }, {
            id: "btnSchedule",
            loadingText: b.schedule,
            text: b.schedule,
            className: "btn-primary",
            click: "onClickSchedule"
        } ],
        init: function(a) {
            if (a = a || {}, this.participants = [], this.originalMembers = [], this.$scope.lang = b, 
            this.$scope.allowRecording = a.allowRecording, this.$scope.editable = !!a.editable, 
            a.editable) {
                this.meetLink = MX.format("{0}/{1}", MX.getOrigin(), a.model.session.session_key), 
                this.$scope.meetLink = this.meetLink;
                var d = a.model.tags.get(c.meet.tags.autoRecordMeet) || {};
                this.$scope.autoRecording = "1" == d.string_value, this.buttons = [ {
                    text: b.cancel,
                    className: "btn-default",
                    click: "onClickCancel"
                }, {
                    id: "btnSchedule",
                    loadingText: b.update,
                    text: b.update,
                    className: "btn-primary",
                    click: "onClickSchedule"
                } ];
            }
            var e = Moxtra.getMe();
            this.defaultTopic = MX.format(b.meet_topic, {
                name: e.first_name || e.email
            }), this.$scope.placeholder = this.defaultTopic, this.invitees = new h(), this.listenTo(this.invitees, "add", this.updateTotalInvitees), 
            this.listenTo(this.invitees, "remove", this.updateTotalInvitees), _.extend(this, a);
        },
        rendered: function() {
            this.inviteeList = new a.List({
                parent: this,
                renderTo: this.$(".invitees"),
                collection: this.invitees,
                template: f,
                sortable: !1,
                $scope: {
                    lang: b,
                    teamAvatar: Moxtra.config.group.avatar
                }
            }), this.$el.find("#autoRecording").mxCheckbox({
                checkIcon: "micon-checkbox",
                checkedIcon: "micon-checkbox-checked"
            }), this.$el.find("#joinBeforeHost").mxCheckbox({
                checkIcon: "micon-checkbox",
                checkedIcon: "micon-checkbox-checked"
            });
            var c, d = this._getTiming(), e = Date.now(), h = "xdsoftDatetimepicker" + parseInt(100 * Math.random(), 10), i = "xdsoftDatetimepicker" + parseInt(100 * Math.random(), 10), j = this;
            if (this.editable) {
                this.scheduleStartTimestamp = this.model.session.scheduled_start_time, this.scheduleEndTimestamp = this.model.session.scheduled_end_time;
                var k = this.model.id;
                MX.each(this.model.members, function(a) {
                    var b, c = new g();
                    a.group ? (c.set({
                        userid: a.group.id
                    }), c.set(a), j.invitees.add(c)) : (b = c.parse(a, {
                        boardid: k
                    }), "BOARD_OWNER" === b.type && (b.meetHost = !0), a.avatar && (b.avatar = a.avatar), 
                    j.participants.push(b.email), j.invitees.add(c.set(b)));
                });
            } else {
                this.scheduleStartTimestamp = d, this.scheduleEndTimestamp = d + 36e5;
                var l = new g(), m = Moxtra.getMe(), n = l.parse(m), o = [];
                if (n.avatar = m.avatar, n.displayName = m.name || m.first_name || m.last_name || m.email, 
                n.meetHost = !0, o.push(l.set(n)), this.members && this.members.length) {
                    var p = [];
                    MX.each(this.members, function(a) {
                        var b, c = new g();
                        if (a.group) {
                            if (b = a.group.id, p.indexOf(b) > -1) return;
                            p.push(b);
                        } else b = a.user.id;
                        c.set({
                            userid: b
                        }), c.set(a), c.set(a.user), o.push(c), j.originalMembers.push(a);
                    });
                }
                this.participants.push(m.email), this.invitees.add(o);
            }
            this.$("#scheduleStartDate").datetimepicker({
                id: h,
                timepicker: !0,
                scrollInput: !1,
                scrollMonth: !1,
                minDate: 0,
                lang: Moxtra.getMe().language,
                format: this._getPickerFormat(this.scheduleStartTimestamp),
                formatTime: "HH:mm",
                formatDate: "YYYY-MMMM-DD",
                step: 30,
                value: this._formatDate(this.scheduleStartTimestamp),
                customizedOffset: this.customizedOffset,
                onChangeMonth: function(a) {
                    if (a) {
                        var b = a.getTime() + j.customizedOffset;
                        e > b ? $("#" + h + " .xdsoft_timepicker").removeClass("active") : $("#" + h + " .xdsoft_timepicker").addClass("active");
                    }
                },
                onClose: function(a) {
                    if (a) {
                        var b = a.getTime() + j.customizedOffset;
                        b < Date.now() && (b = d), this.setOptions({
                            format: j._getPickerFormat(b),
                            value: j._formatDate(b)
                        }), c = b, j.$("#scheduleEndDate").data("schedule-end-date", b + 36e5), j.$("#scheduleEndDate").val(j._formatDate(b + 36e5)), 
                        j.scheduleStartTimestamp = b, j.scheduleEndTimestamp = b + 36e5;
                    }
                }
            }), this.$("#scheduleEndDate").datetimepicker({
                id: i,
                timepicker: !0,
                scrollInput: !1,
                scrollMonth: !1,
                minDate: 0,
                lang: Moxtra.getMe().language,
                format: this._getPickerFormat(this.scheduleEndTimestamp),
                formatTime: "HH:mm",
                formatDate: "YYYY-MMMM-DD",
                step: 30,
                value: this._formatDate(this.scheduleEndTimestamp),
                customizedOffset: this.customizedOffset,
                onShow: function() {
                    var a, b = j.$("#scheduleEndDate").data("schedule-end-date");
                    c && (a = j._formatDate(c, "YYYY/MM/DD")), this.setOptions({
                        format: j._getPickerFormat(b),
                        value: j.$("#scheduleEndDate").val(),
                        minDate: a || !1
                    });
                },
                onChangeMonth: function(a) {
                    if (a) {
                        var b = a.getTime() + j.customizedOffset;
                        e > b ? $("#" + i + " .xdsoft_timepicker").removeClass("active") : $("#" + i + " .xdsoft_timepicker").addClass("active");
                    }
                },
                onClose: function(a) {
                    if (a) {
                        var b = a.getTime() + j.customizedOffset, e = c;
                        e || (e = d), e > b && (b = e + 36e5), this.setOptions({
                            format: j._getPickerFormat(b),
                            value: j._formatDate(b)
                        }), j.scheduleEndTimestamp = b;
                    }
                }
            }), MX.env.isIE && (this.$("#scheduleTopic").placeholder(), this.$("#scheduleAgenda").placeholder()), 
            this.recovery(function() {
                j.$("#scheduleStartDate").datetimepicker("destroy"), j.$("#scheduleEndDate").datetimepicker("destroy");
            }), this.$("i[title]").tooltip();
        },
        zoomAgendaText: function() {
            var a = this.$("#scheduleAgenda").val(), b = this, c = new i({
                agenda: a,
                onClose: function(a) {
                    b.$("#scheduleAgenda").val(a), b.dialog.$(".modal-dialog").removeClass("agenda-zoom-container"), 
                    b.dialog.pop();
                }
            });
            this.recovery(c), this.dialog.push({
                content: c,
                hideHeader: !0,
                className: "agenda-zoom-container"
            });
        },
        invite: function() {
            var a = this, c = new MX.ui.UserSelector({
                title: b.meet_invite_participants,
                buttons: [ {
                    position: "left",
                    text: b.back,
                    className: "btn-default",
                    click: function() {
                        a.dialog.pop();
                    }
                }, {
                    text: b.invite,
                    className: "btn-primary",
                    click: "onSelectDone"
                } ],
                onSelectDone: function() {
                    var b = this.value();
                    b.length && b.each(function(b) {
                        var c = new g();
                        MX.isUndefined(b.isTeam) ? (b.id || (b.id = b.email), a.invitees.add(c.parse(b))) : (c.set({
                            userid: b.id,
                            group: b
                        }), a.invitees.add(c));
                    }), a.dialog.pop();
                }
            });
            this.recovery(c), this.dialog.push({
                hideClose: !0,
                content: c
            });
        },
        deleteMeet: function() {
            this.handleEvent.preventDefault(), this.handleEvent.stopPropagation();
            var a = this;
            MX.ui.Confirm(b.meet_confirm_delete_meet, function() {
                a.dialog.progress(), a.model.delete().success(function() {
                    MX.ui.notifySuccess(b.meet_delete_success), a.dialog.progress(!1), a.dialog.close(), 
                    a.onActionDone();
                }).error(function() {
                    a.dialog.progress(!1), MX.ui.notifyError(b.meet_delete_meet_failed);
                });
            });
        },
        onClickCancel: function() {
            this.dialog.close();
        },
        onClickSchedule: function() {
            var a = this.$("#scheduleTopic").val(), c = this.$("#scheduleAgenda").val(), e = d.config.settings.joinBeforeHost, f = this;
            if (a.length || (a = this.defaultTopic), this.dialog.getButton("btnSchedule").button("loading"), 
            this.editable) {
                this.model.set("name", a), this.model.session.set("scheduled_start_time", this.scheduleStartTimestamp), 
                this.model.session.set("scheduled_end_time", this.scheduleEndTimestamp), this.model.session.set("agenda", c), 
                this.model.session.set("milliseconds_allowed_to_join_before_start", e), this.dialog.progress();
                var g = this.model.session.update().success(function() {
                    MX.ui.notifySuccess(b.meet_update_success), f.dialog.progress(!1), f.dialog.close(), 
                    f.onActionDone(), f._inviteUsers(f.model.id);
                }).error(function() {
                    f.dialog.progress(!1), f.dialog.getButton("btnSchedule").button("reset"), MX.ui.notifyError(b.meet_update_failed);
                });
                "emptyRequest" == g.$name && (k.log("meet info no change, just invite user"), this.dialog.progress(!1), 
                this.dialog.close(), this._inviteUsers(this.model.id)), f._setAutoRecord(f.model.id);
            } else {
                this.dialog.progress();
                var h;
                j.showMeetFeed(this.originalBinderId, this.invitees.models) && (h = this.originalBinderId), 
                Moxtra.scheduleMeet(a, this.scheduleStartTimestamp, this.scheduleEndTimestamp, {
                    agenda: c,
                    joinBeforeHost: e,
                    originalBinderId: h
                }).success(function(a) {
                    MX.ui.notifySuccess(b.meet_schedule_success), f.dialog.progress(!1), f.dialog.close(), 
                    f.onActionDone(), f._setAutoRecord(a.id), f._inviteUsers(a.id);
                }).error(function() {
                    f.dialog.progress(!1), f.dialog.getButton("btnSchedule").button("reset"), MX.ui.notifyError(b.meet_schedule_failed);
                });
            }
        },
        removeInvitee: function(a) {
            this.handleEvent.preventDefault(), this.handleEvent.stopPropagation();
            var b, c = this, d = c.invitees.get(a);
            d && (c.invitees.remove(d), b = d.get("sequence"), c.editable && b && (k.log("remove invitee: ", d), 
            c.model.removeUser(b)));
        },
        updateTotalInvitees: function() {
            var a = this.invitees.length, c = "";
            a ? (c = a > 1 ? MX.format(b.multi_participants, a) : b.one_participant, this.$(".total-invitees").html(c)) : this.$(".total-invitees").empty();
        },
        onActionDone: function() {},
        _inviteUsers: function(a) {
            var b = [], d = [], e = [];
            if (MX.each(this.invitees.models, function(a) {
                var c = a.toJSON();
                c.group ? e.push({
                    group_id: c.group.id
                }) : b.push(c.email);
            }), d = _.difference(b, this.participants), MX.each(d, function(a) {
                e.push({
                    email: a
                });
            }), a) {
                var f = Moxtra.getBoard(a);
                f && e.length && (k.log("invite users ", e), f.inviteUsers(e, c.binder.role.Editor));
            } else k.error("Not found newly created board, so cannot invite users");
        },
        _setAutoRecord: function(a) {
            var b, d = this.$("#autoRecording").prop("checked"), e = Moxtra.getBoard(a);
            try {
                b = e.tags.get(c.meet.tags.autoRecordMeet), b ? (b.set("string_value", d ? "1" : "0"), 
                b.update()) : d && (b = new Moxtra.model.BoardTag(), b.set("name", c.meet.tags.autoRecordMeet), 
                b.set("string_value", "1"), b.create(e));
            } catch (f) {
                k.error(f);
            }
        },
        _getTiming: function() {
            var a, b = Date.now() + 24 * this.daysDiff * 3600 * 1e3 + 6e4 * this.offsetAdjustment, c = moment(b);
            return c.minutes() >= 30 ? (b += 18e5, a = moment(b), new Date(a.year(), a.months(), a.date(), a.hours()).getTime()) : new Date(c.year(), c.months(), c.date(), c.hours(), 30).getTime();
        },
        _formatDate: function(a, b) {
            var c = Moxtra.getMe().timezone || "";
            b || (b = "LLL");
            try {
                return moment(a).tz(c).format(b);
            } catch (d) {
                return k.error("no such timezone in momentjs ", c), moment(a).format(b);
            }
        },
        _getPickerFormat: function() {
            return "LLL";
        }
    });
}), define("text!template/meet/management/meetInfo.html", [], function() {
    return '<div class="mx-meet-info">\n	<form>\n		{{#if session.isPast}}\n		<div class="form-group">\n			<input id="meetInfoTopic" type="text" class="form-control" value="{{name}}"/>\n		</div>\n		{{else}}\n		<div class="form-group">\n			<div class="row section">\n				<label for="inputEmail3" class="col-sm-2 control-label">{{lang.topic}}</label>\n				<div class="col-sm-10">\n					<div class="ellipsis">{{name}}</div>\n				</div>\n			</div>\n		</div>\n		{{/if}}\n		<div class="form-group">\n			<div class="row section">\n				<label for="inputEmail3" class="col-sm-2 control-label">{{lang.starts}}</label>\n				<div class="col-sm-10">\n					<div class="ellipsis">\n						{{#if session.scheduled_start_time}}\n						 {{formatFullDateTime session.scheduled_start_time}}\n						{{else}}\n						 {{formatFullDateTime session.start_time}}\n						{{/if}}\n					</div>\n				</div>\n			</div>\n		</div>\n		<div class="form-group">\n			<div class="row section">\n				<label for="inputEmail3" class="col-sm-2 control-label">{{lang.ends}}</label>\n				<div class="col-sm-10">\n					<div class="ellipsis">\n						{{#if session.scheduled_end_time}}\n						 {{formatFullDateTime session.scheduled_end_time}}\n						{{else}}\n						 {{formatFullDateTime session.end_time}}\n						{{/if}}\n					</div>\n				</div>\n			</div>\n		</div>\n		<div class="form-group">\n			<div class="row section">\n				<div class="col-sm-12">\n					<span>{{meetLink}}</span>\n				</div>\n			</div>\n		</div>\n		{{#if session.agenda}}\n		<div class="form-group">\n			<div class="row title-section">\n				<div><strong>{{lang.agenda}}</strong></div>\n			</div>\n		</div>\n		<div class="form-group">\n			<div class="agenda-action">\n				<textarea id="agendaInfo" class="meet-agenda" readonly="">{{session.agenda}}</textarea>\n				<a class="mouse-hand" data-action="zoomAgendaText"><i class="micon-full-screen icon-zoom-meet-agenda"></i></a>\n			</div>\n		</div>\n		{{/if}}\n		\n		{{#if showJBH}}\n		{{#if session.milliseconds_allowed_to_join_before_start}}\n		<!-- <div class="form-group">\n			<div class="jbh-setting">\n				<input type="checkbox" id="joinBeforeHost" checked disabled="disabled"/>\n				<label for="joinBeforeHost">\n					{{lang.enable_join_before_host_tip}}\n				</label>\n			</div>\n		</div> -->\n		{{/if}}\n		{{/if}}\n		\n		{{#if autoRecording}}\n		<div class="form-group">\n			<div class="recording-setting">\n				<input type="checkbox" id="autoRecording" checked disabled="disabled"/>\n				<label for="autoRecording">\n					{{lang.record_this_meet_tip}}\n				</label>\n			</div>\n		</div>\n		{{/if}}\n		\n		{{#if session.recordings.length}}\n		<div class="form-group">\n			<div class="row title-section">\n				<div><strong>{{lang.recordings}}</strong> ({{session.recordings.length}})</div>\n			</div>\n		</div>\n		<div class="form-group">\n			<div class="row section">\n				<div class="col-sm-12">\n					<ul class="mx-list section-recordings">\n					{{#each session.recordings}}\n						<li class="mx-item">\n							<div class="row">\n								<div class="col-sm-12">\n									<span>{{name}}</span>\n									<div class="pull-right dropdown" style="display: inline-block;">\n										<a class="mouse-hand" data-toggle="dropdown"><i class="micon-more size16"></i></a>\n										<ul role="menu" class="dropdown-menu pull-right">\n								            <li><a class="mouse-hand" data-param="{{sequence}}" data-action="downloadRecording" title="{{../../lang.download}}"><i class="micon-download size16"></i><span> {{../../lang.download}}</span></a></li>\n								            <li><a class="mouse-hand" data-param="{{sequence}}" data-action="copyRecording" title="{{../../lang.copy_to}}"><i class="micon-copy size16"></i><span> {{../../lang.copy_to}}</span></a></li>\n								            {{#if ../session.isHost}}\n								            <li><a class="mouse-hand mxbrand-action-share" data-param="{{sequence}}" data-action="shareRecording" title="{{../../lang.share}}"><i class="micon-share size16"></i><span> {{../../lang.share}}</span></a></li>\n								            {{/if}}\n								        </ul>\n									</div>\n									<a class="mouse-hand pull-right marginRight10" data-action="playRecording" data-param="{{sequence}},{{name}}"><i class="micon-play-with-circle size16"></i></a>\n								</div>\n							</div>\n						</li>\n					{{/each}}\n					</ul>\n				</div>\n			</div>\n		</div>\n		{{/if}}\n		<div class="form-group">\n			<div class="row title-section">\n				<div>\n					<strong>{{lang.meet_participants}} </strong> ({{members.length}})\n				</div>\n			</div>\n		</div>\n		<div class="form-group">\n			<div class="row section">\n				<div class="col-sm-12">\n					<ul class="mx-list section-invitees">\n					{{#each members}}\n						<li class="mx-item">\n							<div class="row">\n								<div class="col-sm-1">\n									<img src="{{avatar}}" class="invitee-avatar img-circle {{#if group}}mx-noborder mx-noborder-radius{{/if}}">\n								</div>\n								<div class="col-sm-8">\n									{{#if group}}\n									<div class="invitee-name ellipsis marginTop5">{{group.name}}</div>\n									{{else}}\n									<div class="invitee-name ellipsis">\n										{{#if user.name}}\n											{{user.name}}\n										{{else}}\n											{{#if user.first_name}}\n												{{user.first_name}}\n											{{else}}\n												{{user.email}}\n											{{/if}}\n										{{/if}}\n										{{#when type \'==\' \'BOARD_OWNER\'}}\n										 ({{../../../lang.meet_host}})\n										{{/when}}\n									</div>\n									<div class="invitee-email ellipsis">{{user.email}}</div>\n									{{/if}}\n								</div>\n								<div class="col-sm-3">\n									<div class="gray marginTop5 pull-right">\n									{{!-- only scheduled meet show status --}}\n									{{#unless ../session.isPast}}\n										{{#if group}}\n											({{../../../lang.accepted}})\n										{{else}}\n											{{#when type \'!=\' \'BOARD_OWNER\'}}\n												{{#when status \'==\' \'BOARD_MEMBER\'}}({{../../../../../lang.accepted}}){{/when}}\n												{{#when status \'==\' \'BOARD_INVITED\'}}({{../../../../../lang.pending}}){{/when}}\n											{{/when}}\n										{{/if}}\n									{{/unless}}\n									</div>\n								</div>\n							</div>\n						</li>\n					{{/each}}\n					</ul>\n				</div>\n			</div>\n		</div>\n		{{#if session.isHost}}\n		<div class="form-group">\n			<div class="section-delete">\n				<a class="mouse-hand" data-action="deleteMeet" data-param="{{id}}">{{lang.delete_meet}}</a>\n			</div>\n		</div>\n		{{/if}}\n	</form>\n</div>\n';
}), define("meet/management/meetInfo", [ "moxtra", "lang", "app", "const", "text!template/meet/management/meetInfo.html", "meet/player", "binder/binderBiz", "binder/newBinderOptions", "meet/management/agenda", "common/share", "component/selector/binderSelector", "ui" ], function(a, b, c, d, e, f, g, h, i, j) {
    return a.Controller.extend({
        template: e,
        title: b.meet_info,
        handleAction: !0,
        buttons: [ {
            text: b.done,
            className: "btn-primary",
            click: "onClickOk"
        } ],
        init: function(a) {
            if (!a || !a.model || !a.model.session) return this.invalidMeet = !0, this.template = "<span>" + b.meet_has_canceled + "</span>", 
            void (this.buttons = [ {
                text: b.done,
                className: "btn-primary",
                click: "onClickOk"
            } ]);
            if (this.meetLink = MX.format("{0}/{1}", MX.getOrigin(), a.model.session.session_key), 
            this.boardId = a.model.id, this.$scope.lang = b, this.$scope.meetLink = this.meetLink, 
            a.model.tags) {
                var c = a.model.tags.get(d.meet.tags.autoRecordMeet) || {};
                this.$scope.autoRecording = "1" == c.string_value;
            }
            a.model.session.editable && (this.buttons = [ {
                text: b.edit,
                className: "btn-default",
                position: "left",
                click: "onClickEdit"
            }, {
                text: b.done,
                className: "btn-primary",
                click: "onClickOk"
            } ]), _.extend(this, a);
        },
        rendered: function() {
            if (!this.invalidMeet) {
                var a = this;
                a.$("#joinBeforeHost").mxCheckbox({
                    checkIcon: "micon-checkbox",
                    checkedIcon: "micon-checkbox-checked"
                }), a.$("#autoRecording").mxCheckbox({
                    checkIcon: "micon-checkbox",
                    checkedIcon: "micon-checkbox-checked"
                }), a.$("#meetInfoTopic").on("blur", function() {
                    a._updateTopic();
                });
            }
        },
        zoomAgendaText: function() {
            var a = this.$("#agendaInfo").val(), b = this, c = new i({
                agenda: a,
                readyonly: !0,
                onClose: function() {
                    b.dialog.$(".modal-dialog").removeClass("agenda-zoom-container"), b.dialog.pop();
                }
            });
            this.recovery(c), this.dialog.push({
                content: c,
                hideHeader: !0,
                className: "agenda-zoom-container"
            });
        },
        deleteMeet: function() {
            this.handleEvent.preventDefault(), this.handleEvent.stopPropagation();
            var a = this;
            MX.ui.Confirm(b.meet_confirm_delete_meet, function() {
                a.dialog.progress(), a.model.delete().success(function() {
                    MX.ui.notifySuccess(b.meet_delete_success), a.dialog.progress(!1), a.dialog.close(), 
                    a.onActionDone();
                }).error(function() {
                    a.dialog.progress(!1), MX.ui.notifyError(b.meet_delete_meet_failed);
                });
            });
        },
        playRecording: function(a, c) {
            var d = MX.format("/board/{0}/{1}", this.boardId, a);
            d = Moxtra.util.makeAccessTokenUrl(d), this.dialog.push({
                content: new f({
                    title: c,
                    source: d,
                    buttons: [ {
                        text: b.done,
                        className: "btn-primary",
                        click: function() {
                            this.close();
                        }
                    }, {
                        text: b.back,
                        position: "left",
                        className: "btn-default",
                        click: function() {
                            this.pop();
                        }
                    } ]
                })
            });
        },
        copyRecording: function(a) {
            var c = this, d = [ a ];
            this.dialog.push({
                content: new MX.ui.BinderSelector({
                    title: b.copy_to,
                    buttons: [ {
                        text: b.copy,
                        position: "right",
                        className: "btn-primary",
                        click: "copyPageToBinder"
                    } ],
                    onChange: function() {},
                    newBinder: function() {
                        var a = this;
                        this.dialog.push(new h({
                            onCreatedBinder: function(b) {
                                a.copyPageTo(b);
                            }
                        }));
                    },
                    copyPageToBinder: function() {
                        var a = this.value();
                        return a ? void this.copyPageTo(a) : void MX.ui.Alert(b.select_one_binder);
                    },
                    copyPageTo: function(a) {
                        g.copyBinderResources(a, c.boardId, d).success(function() {
                            MX.ui.notifySuccess(b.recording_copied_success);
                        }).error(function() {
                            MX.ui.notifyError(b.recording_copied_failed);
                        }), this.dialog.pop();
                    }
                })
            });
        },
        downloadRecording: function(a) {
            var c, d, e = this, f = "hiddenDownloader";
            d = MX.format("/board/{0}/{1}?d=", this.boardId, a), d = Moxtra.util.makeAccessTokenUrl(d), 
            c = document.getElementById(f), null === c && (c = document.createElement("iframe"), 
            c.id = f, c.style.display = "none", document.body.appendChild(c)), c.src = d, this.download_started || (this.download_started = !0, 
            setTimeout(function() {
                e.download_started = !1, MX.ui.notifyInfo(b.download_started);
            }, 1e3));
        },
        shareRecording: function(a) {
            this.dialog.push(new j({
                type: "resource",
                binderId: this.boardId,
                resourceSequence: a,
                buttons: [ {
                    position: "left",
                    text: b.back,
                    className: "btn-default",
                    click: function() {
                        this.pop();
                    }
                } ]
            }));
        },
        onActionDone: function() {},
        onActionEdit: function() {},
        onClickEdit: function() {
            var a = this.model.id;
            this.dialog.close(), this.onActionEdit(a);
        },
        onClickOk: function() {
            this.dialog.close();
        },
        _updateTopic: function() {
            var a = this, c = a.model.name, d = $.trim(a.$("#meetInfoTopic").val());
            d.length ? d !== c && (a.model.name = d, a.model.localChanged = {
                name: d
            }, a.model.update().success(function() {
                MX.ui.notifySuccess(b.update_meet_topic_success);
            }).error(function() {
                MX.ui.notifyError(b.update_meet_topic_failed);
            })) : a.$("#meetInfoTopic").val(c);
        }
    });
}), define("common/userCap", [ "moxtra" ], function() {
    return {
        isAllowMeetRecording: function() {
            return this._val("allow_meet_recording");
        },
        getMaxHistory: function() {
            return this._val("board_history_max");
        },
        getMaxMeetDuration: function() {
            return this._val("meet_duration_max");
        },
        getMaxCloudSize: function() {
            return this._val("user_cloud_max");
        },
        _val: function(a) {
            var b = Moxtra.getMe().cap || {};
            return b[a];
        }
    };
}), define("meet/meetIntro", [ "moxtra", "lang", "app", "const", "text!template/meet/intro.html", "text!template/meet/management/meetItem.html", "text!template/meet/management/emptyItem.html", "meet/meet", "meet/player", "common/loadingDialog", "meet/management/startForm", "meet/management/joinForm", "meet/management/scheduleForm", "meet/management/meetInfo", "common/userCap", "admin/branding/helper", "component/selector/userSelector", "component/templateHelper" ], function(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p) {
    var q = MX.logger("meet:schedule"), r = Handlebars.compile(g);
    return a.Controller.extend({
        template: e,
        handleAction: !0,
        init: function() {
            this.$scope.lang = b, this.$scope.branding = {
                showMeetNow: p.isShowMeetNow(),
                showScheduleMeet: p.isShowScheduleMeet()
            }, this.$scope.tabName = c.config.global.meetTabName, $(this.container).addClass("mx-layout-three");
        },
        rendered: function() {
            var d, e = this;
            MX.loading(!0), Moxtra.onReady(function() {
                p.isShowMeetNow() ? e.$(".mx-branding-meetnow").removeClass("hide") : e.$(".mx-branding-meetnow").remove(), 
                p.isShowScheduleMeet() ? e.$(".mx-branding-schedulemeet").removeClass("hide") : e.$(".mx-branding-schedulemeet").remove(), 
                e.$("#mxMeetCalendar").datetimepicker({
                    id: "mxMeetDatetimepicker",
                    inline: !0,
                    timepicker: !1,
                    todayButton: !1,
                    scrollMonth: !1,
                    scrollTime: !1,
                    scrollInput: !1,
                    lang: Moxtra.getMe().language,
                    formatTime: "HH:mm",
                    formatDate: "YYYY-MMMM-DD",
                    customizedOffset: Moxtra.getTimezoneOffset(),
                    onChangeMonth: function(a) {
                        if (a) {
                            setTimeout(function() {
                                e._markDate();
                            }, 500);
                            var b = a.getTime();
                            b !== d && (d = b, e._updateHeader(b), e._getMeetList(b));
                        }
                    },
                    onChangeDateTime: function(a) {
                        if (a) {
                            setTimeout(function() {
                                e._markDate();
                            }, 50);
                            var b = a.getTime();
                            b !== d && (d = b, e._updateHeader(b), e._getMeetList(b));
                        }
                    }
                }), setTimeout(function() {
                    e._markDate();
                }, 200), MX.loading(!1);
            }), e._updateHeader();
            var g = c.isAutoJoinMeet();
            e.listenTo(Moxtra.getMe(), "firstSubscribe", function() {
                e.meets = Moxtra.getMeetList(), e.list = new a.List({
                    parent: e,
                    renderTo: ".mx-meet-list",
                    collection: e.meets,
                    template: f,
                    emptyTemplate: r({
                        lang: b
                    }),
                    sortable: !1,
                    unifyLazyload: !1,
                    syncModel: [ "status" ],
                    syncField: {
                        board: [ "name", "users" ],
                        "board.session": [ "session_status", "scheduled_start_time", "start_time", "scheduled_end_time", "end_time" ]
                    },
                    $scope: {
                        lang: b,
                        tabName: c.config.global.meetTabName,
                        autoJoinMeet: g
                    }
                }), e._onTimer(), e.$el.tooltip({
                    selector: ".meet-action-ics"
                });
            }), e.recovery(function() {
                e._offTimer(), e.meets && e.meets.destroy(), e.dates && e.dates.destroy();
            });
        },
        startMeet: function() {
            var a = new k();
            this.recovery(a), new MX.ui.Dialog({
                content: a,
                disableKeyboard: !0
            });
        },
        joinMeet: function() {
            var a = new l();
            this.recovery(a), new MX.ui.Dialog({
                content: a,
                disableKeyboard: !0
            });
        },
        scheduleMeet: function() {
            var a, c = this, d = 0, e = 0, f = j.genDialog({
                title: b.schedule_meet,
                disableKeyboard: !0
            });
            try {
                a = moment().tz(Moxtra.getMe().timezone).format("YYYY-MM-DD"), a && this.daysDiffTimestamp && (d = moment(moment(this.daysDiffTimestamp).format("YYYY-MM-DD")).diff(moment(a), "days"));
            } catch (g) {
                console.error(g);
            }
            try {
                this.daysDiffTimestamp && (e = moment().tz(Moxtra.getMe().timezone).utcOffset() - moment(moment(this.daysDiffTimestamp).format("YYYY-MM-DD 23:59:59")).tz(Moxtra.getMe().timezone).utcOffset());
            } catch (g) {
                console.error(g);
            }
            var h = new m({
                allowRecording: o.isAllowMeetRecording(),
                customizedOffset: Moxtra.getTimezoneOffset(),
                offsetAdjustment: e,
                daysDiff: d,
                onActionDone: function() {
                    c._markDate();
                }
            });
            c.recovery(h), f.push({
                content: h
            });
        },
        editMeet: function(a) {
            var c = this, d = j.genDialog({
                title: b.schedule_meet,
                disableKeyboard: !0
            });
            Moxtra.loadBoard(a).success(function() {
                var b = new m({
                    allowRecording: o.isAllowMeetRecording(),
                    customizedOffset: Moxtra.getTimezoneOffset(),
                    model: Moxtra.getBoard(a),
                    editable: !0,
                    onActionDone: function() {
                        c._markDate();
                    }
                });
                c.recovery(b), d.push({
                    content: b
                });
            }).error(function() {
                MX.ui.notifyError(b.system_unknown_error), setTimeout(function() {
                    d.close();
                }, 800);
            });
        },
        viewMeet: function(a) {
            var c = this, d = j.genDialog({
                title: b.meet_info,
                disableKeyboard: !0
            }), e = function() {
                var b = new n({
                    model: Moxtra.getBoard(a),
                    onActionDone: function() {
                        c._markDate();
                    },
                    onActionEdit: function(a) {
                        c.editMeet(a);
                    }
                });
                c.recovery(b), d.push({
                    content: b
                });
            };
            Moxtra.loadBoard(a).success(function() {
                e();
            }).error(function() {
                e();
            });
        },
        startScheduledMeet: function(a) {
            var c = this;
            c.$el.loading({
                length: 15
            }), setTimeout(function() {
                Moxtra.loadBoard(a).success(function() {
                    var e = Moxtra.getBoard(a), f = e.tags.get(d.meet.tags.autoRecordMeet) || {};
                    h.startAssigned({
                        autoRecord: "1" == f.string_value,
                        boardId: a,
                        sessionKey: MX.get("session.session_key", e),
                        topic: e.name,
                        success: function() {
                            c.$el.loading(!1);
                        },
                        error: function() {
                            MX.ui.notifyError(b.contact_start_meet_failed), c.$el.loading(!1);
                        }
                    });
                });
            }, 300);
        },
        joinScheduledMeet: function(a, b) {
            c.sendMessage({
                action: "request_join_meet",
                binder_id: a,
                session_key: b,
                session_id: Moxtra.getMe().sessionId
            });
        },
        accept: function(a) {
            var c = Moxtra.getUserBoard(a);
            c && c.board && c.board.acceptInvite().success(function() {
                MX.ui.notifySuccess(b.invite_accept_success);
            }).error(function() {
                MX.ui.notifyError(b.invite_accept_failed);
            });
        },
        decline: function(a) {
            MX.ui.Confirm(b.invite_decline_confirm, function() {
                var c = Moxtra.getUserBoard(a);
                c && c.board && c.board.declineInvite().success(function() {
                    MX.ui.notifySuccess(b.invite_decline_success);
                }).error(function() {
                    MX.ui.notifyError(b.invite_decline_failed);
                });
            });
        },
        playRecording: function(a, c, d) {
            var e = MX.format("/board/{0}/{1}", a, c);
            e = Moxtra.util.makeAccessTokenUrl(e), new MX.ui.Dialog({
                disableKeyboard: !0,
                content: new i({
                    title: d,
                    source: e,
                    buttons: [ {
                        text: b.done,
                        className: "btn-primary",
                        click: function() {
                            this.close();
                        }
                    } ]
                })
            });
        },
        downloadICS: function(a) {
            var c, d, e = this, f = "hiddenICSDownloader";
            d = MX.format("/board/calendar?key={0}", a), d = Moxtra.util.makeAccessTokenUrl(d), 
            c = document.getElementById(f), null === c && (c = document.createElement("iframe"), 
            c.id = f, c.style.display = "none", document.body.appendChild(c)), c.src = d, this.download_started || (this.download_started = !0, 
            setTimeout(function() {
                e.download_started = !1, MX.ui.notifyInfo(b.download_started);
            }, 500));
        },
        _markDate: function() {
            q.log("_markDate");
            var a = this.$("#mxMeetDatetimepicker"), b = a.find("td.xdsoft_current"), c = parseInt(b.data("year")), d = parseInt(b.data("month")), e = this;
            q.log("_markDate for year month ", c, d), this.dates && this.stopListening(this.dates), 
            this.dates = Moxtra.getMonthMeetCount(c, d), this.listenTo(this.dates, "inited", function() {
                e._updateCalendar();
            }), this._updateCalendar();
        },
        _updateCalendar: function() {
            var a = this.$("#mxMeetDatetimepicker");
            a.find("td.xdsoft_date").removeClass("active"), MX.each(this.dates, function(b) {
                if (b && b.count > 0) {
                    var c = MX.format('td.xdsoft_date[data-year="{0}"][data-month="{1}"][data-date="{2}"]', b.year, b.month, b.day);
                    a.find(c).addClass("active");
                }
            });
        },
        _updateHeader: function(a) {
            this.daysDiffTimestamp = a, this.selectedTimestamp = a || Date.now();
            var b;
            if (a) b = moment(a); else try {
                b = moment(Date.now()).tz(Moxtra.getMe().timezone);
            } catch (c) {
                b = moment(Date.now());
            }
            this.$(".mx-meet-list-header .day").html(b.format("dddd")), this.$(".mx-meet-list-header .date").html(b.format("LL"));
        },
        _getMeetList: function(a) {
            this._getMeetListData(a), this._onTimer(a);
        },
        _getMeetListData: function(a) {
            this.meets = Moxtra.getMeetList(a), this.list.binding(this.meets);
        },
        _onTimer: function(a) {
            var b = this;
            clearInterval(b.MEET_LIST_TIMER), this.MEET_LIST_TIMER = setInterval(function() {
                b._getMeetListData(a);
            }, c.config.settings.meetListTimer);
        },
        _offTimer: function() {
            clearInterval(this.MEET_LIST_TIMER);
        }
    });
}), define("text!template/meet/mymeet.html", [], function() {
    return '<div class="mymeet-wrap">\n	{{#if showHeader}}\n	<header class="main-header mx-branding-header hide">\n	    <a class="mx-branding-header-logo mx-logo pull-left" target="_blank"></a>\n	</header>\n	{{/if}}\n	<div class="mymeet-container">\n		\n	</div>\n</div>';
}), define("text!template/meet/mymeet/info.html", [], function() {
    return '<div class="mymeet-info">\n	{{#if inIntegration}}\n	<div class="info-item info-title">\n		<span class="size24">{{info}}</span>\n	</div>\n	{{else}}\n	<div class="info-item info-title">\n		{{lang.meet_finished_tip}}\n	</div>\n	<div class="info-item info-img">\n		<img src="themes/images/meet/meet_ending.08fd6dfe.jpeg"/>\n	</div>\n	<div class="info-item info-more">\n		<span>\n			Moxtra: {{info}}\n		</span>\n		{{#if showLearnMore}}\n		<a href="http://www.moxtra.com/?web">\n			{{lang.learn_more}}\n		</a>\n		{{/if}}\n	</div>\n	{{/if}}\n	\n	{{#if showClose}}\n	<div class="info-item info-close">\n		<a class="btn" data-action="closeWindow">{{lang.close}}</a>\n	</div>\n	{{/if}}\n	\n</div>';
}), define("text!template/meet/mymeet/preparing.html", [], function() {
    return '<div class="mymeet-preparing">\n	<!-- <span style="display: inline-block; position: relative;padding-right:30px;">\n		{{info}} \n		<span style="display: inline-block;position: absolute; right:0;top:0;">\n			<span class="animation-ellipsis" style="position: absolute; left:0;"></span>\n		</span>\n	</span> -->\n	\n	<span class="preparing-wrap">\n		{{info}}\n		<span class="animation-outer">\n			<span class="animation-inner animation-ellipsis"></span>\n		</span>\n	</span>\n</div>';
}), define("meet/mymeet", [ "moxtra", "lang", "app", "const", "text!template/meet/mymeet.html", "text!template/meet/mymeet/info.html", "text!template/meet/mymeet/preparing.html", "meet/meet", "meet/management/startForm" ], function(a, b, c, d, e, f, g, h, i) {
    "use strict";
    var j = "#mymeet?action=default", k = Handlebars.compile(f), l = Handlebars.compile(g);
    return a.Controller.extend({
        template: e,
        handleAction: !0,
        init: function() {
            this.inIntegration = c.isIntegrationEnabled(), this.$scope.showHeader = !this.inIntegration;
        },
        rendered: function() {
            var a, d, e, f, g, h, j = this, k = !1, l = function() {}, m = [], n = c.request.params() || {}, o = {};
            this.inIntegration && (this.$el.addClass("apiView"), this.$el.MoxtraPowerBy(!0)), 
            this._setWinName(), c.request.get("params.action") && "default" !== c.request.get("params.action") ? this._showPreparing(b.we_are_preparing_your_meet) : this._showInfo(b.moxtra_tagline, {
                "default": !0
            }), o.c_user = n.c_user, o.token = n.token, o.subscribe = !1, Moxtra.verifyToken(o).success(function() {
                switch (a = n.action || "default", d = n.binderid || "", e = n.session_key || "", 
                f = n.index || "", g = n.email || "", h = n.unique_id || "", [ 1, "1", !0, "true" ].indexOf(n.select_user) > -1 && (k = !0), 
                a.toLowerCase()) {
                  case "join":
                    e ? j._join(e) : setTimeout(function() {
                        var a = c.status.get("mxMeetJoinId") || "";
                        j._join(a["_" + f]);
                    }, 300);
                    break;

                  case "join_from_calendar":
                    j._joinFromCalendar(d);
                    break;

                  case "start_from_calendar":
                    j._startFromCalendar(d);
                    break;

                  case "start_from_binder":
                    j._startFromBinder(d);
                    break;

                  case "start_with_contact":
                    g ? m.push({
                        email: g
                    }) : h && m.push({
                        unique_id: h
                    }), j._startWithContact(m, null, {
                        originalBoardId: n.originalboardid
                    });
                    break;

                  case "start_with_contacts":
                    if (k) {
                        var o = function(a) {
                            var b, c = {
                                startDirect: !0
                            };
                            a && (c.defaultInvitedUsers = a, c.originalBoardId = n.originalboardid), b = new i(c), 
                            j.recovery(b), new MX.ui.Dialog({
                                content: b,
                                disableKeyboard: !0
                            });
                        };
                        l = function(a) {
                            var b = Moxtra.getMe();
                            b.revision ? o(a) : (b.subscribe(), Moxtra.onReady(function() {
                                o(a);
                            }));
                        }, d ? Moxtra.loadBoard(d).success(function() {
                            var a, b = Moxtra.getBoard(d), c = Moxtra.getMe();
                            a = MX.filter(b.members, function(a) {
                                return a.user && a.user.id !== c.id || a.isGroup ? !0 : void 0;
                            }), l(a);
                        }).error(function() {
                            l();
                        }) : l();
                    } else setTimeout(function() {
                        var a = c.localStatus.get("mxMeetInvitees") || {}, b = c.localStatus.get("mxMeetTopic") || "", e = d + "_" + f + "_" + Moxtra.getMe().id;
                        m = a[e] || [];
                        var g = c.localStatus.get("mxMeetOriginalId") || {};
                        j._startWithContact(m, b[e], {
                            originalBoardId: g[e]
                        });
                    }, 300);
                    break;

                  case "default":
                    j.inIntegration && j.$el.MoxtraPowerBy(!1), j.$("header").removeClass("hide"), j._clearWinName(), 
                    c.request.set("params.action", ""), c.request.sequence(""), j._showInfo(b.moxtra_tagline, {
                        "default": !0,
                        actionType: "leave_as_ended"
                    });
                }
            }).error(function() {
                j._clearWinName(), "default" === c.request.get("params.action") ? j._showInfo(b.moxtra_tagline, {
                    "default": !0,
                    actionType: "leave_as_ended"
                }) : j._showInfo(b.system_unknown_error, {
                    actionType: "fail"
                });
            });
        },
        closeWindow: function() {
            window.close();
        },
        tryAgain: function() {
            location.reload();
        },
        _join: function(a) {
            var d = this;
            h.join({
                backHref: j,
                sessionKey: a,
                success: function() {
                    c.status.remove("mxMeetJoinId");
                },
                error: function() {
                    d._clearWinName(), d._showInfo(b.meet_id_invalid, {
                        actionType: "fail"
                    });
                }
            });
        },
        _joinFromCalendar: function(a) {
            var c = this;
            Moxtra.loadBoard(a).success(function() {
                var d = Moxtra.getBoard(a), e = Moxtra.getMe();
                d ? setTimeout(function() {
                    h.joinAssigned({
                        backHref: j,
                        sessionKey: d.session.session_key,
                        userName: e.name || e.first_name || e.email || b.guest,
                        topic: d.name,
                        success: function() {},
                        error: function() {
                            c._clearWinName(), c._showInfo(b.join_meet_but_has_ended, {
                                actionType: "leave_as_ended"
                            });
                        }
                    });
                }, 300) : MX.ui.Alert(b.need_refresh_browser);
            }).error(function() {
                MX.ui.Alert(b.need_refresh_browser);
            });
        },
        _startFromCalendar: function(a) {
            var c = this;
            Moxtra.loadBoard(a).complete(function() {
                var e = Moxtra.getBoard(a);
                e ? setTimeout(function() {
                    var f = e.tags.get(d.meet.tags.autoRecordMeet) || {};
                    h.startAssigned({
                        backHref: j,
                        autoRecord: "1" == f.string_value,
                        boardId: a,
                        sessionKey: MX.get("session.session_key", e),
                        topic: e.name,
                        success: function() {},
                        error: function() {
                            c._clearWinName(), c._showInfo(b.contact_start_meet_failed, {
                                actionType: "fail"
                            });
                        }
                    });
                }, 300) : MX.ui.Alert(b.need_refresh_browser);
            });
        },
        _startFromBinder: function(a) {
            var c = this;
            h.start({
                backHref: j,
                boardId: a,
                error: function() {
                    c._clearWinName(), c._showInfo(b.contact_start_meet_failed, {
                        actionType: "fail"
                    });
                }
            });
        },
        _startWithContact: function(a, d, e) {
            e = e || {};
            var f = this;
            h.start({
                backHref: j,
                forceStart: !0,
                topic: d,
                users: a,
                boardId: e.originalBoardId,
                success: function() {
                    c.localStatus.remove("mxMeetInvitees"), c.localStatus.remove("mxMeetOriginalId");
                },
                error: function() {
                    f._clearWinName(), f._showInfo(b.contact_start_meet_failed, {
                        actionType: "fail"
                    });
                }
            });
        },
        _showPreparing: function(a) {
            this.$(".mymeet-container").empty().append($(l({
                info: a,
                lang: b
            })));
            var c, d = this.$(".animation-ellipsis"), e = 0;
            this.$(".mymeet-preparing").animate({
                "font-size": "150%",
                opacity: 1
            }, "slow", function() {
                c = setInterval(function() {
                    var a = "";
                    a = e % 4 === 0 ? "" : e % 4 == 1 ? "." : e % 4 == 2 ? ".." : "...", d.text(a), 
                    e++;
                }, 500);
            }), this.recovery(function() {
                clearInterval(c);
            });
        },
        _showInfo: function(a, c) {
            c = c || {}, this.inIntegration && c["default"] && (a = b.meet_ended), this.$(".mymeet-container").empty().append($(k({
                info: a,
                inIntegration: this.inIntegration,
                showClose: !!opener,
                showLearnMore: navigator.userAgent.indexOf(d.flags.windowsAgent) < 0,
                lang: b
            })));
        },
        _setWinName: function() {
            window.name = c.config.global.meetTabName;
        },
        _clearWinName: function() {
            window.name = "";
        }
    });
}), define("text!template/meet/viewer.html", [], function() {
    return '<div class="container">\r\n	<div class="mx-meet-loading" style="padding-top: 20px;">\r\n		{{lang.loading}}\r\n	</div>\r\n</div>';
}), define("meet/viewer", [ "moxtra", "lang", "app", "const", "text!template/meet/viewer.html", "meet/meet", "meet/main", "meet/brandingCache", "admin/branding/helper" ], function(a, b, c, d, e, f, g, h, i) {
    MX.logger("meet:viewer");
    return a.Controller.extend({
        template: "<div></div>",
        rendered: function() {
            this.loading();
            var a = this;
            f.load({
                success: function(b) {
                    a.initViewer(b);
                },
                error: function() {
                    a.close();
                }
            });
        },
        initViewer: function(a) {
            var b = this;
            Moxtra.getMe().revision ? this._load(a) : Moxtra.verifyToken({
                suppressEvent: !0,
                subscribe: !1
            }).success(function() {
                b._load(a);
            }).error(function() {
                b._load(a);
            });
        },
        loading: function(a) {
            a = a || 50, this.container.find(".progress-bar").css({
                width: a + "%"
            });
        },
        close: function() {
            this.loading(!1), this.$el.remove(), c.request.navigate("mymeet", null, null, {
                action: "default"
            });
        },
        _load: function(a) {
            if (this.loading(60), !a || !a.boardId || !a.sessionKey) return this.close(), !1;
            h.clear();
            var b = Moxtra.getBoard(a.boardId);
            b && (h.boardTags = b.tags), h.userCap = MX.get("boardOwner.cap", a) || Moxtra.getMe().cap;
            var c, e = MX.get("host.groups", a) || MX.get("boardOwner.groups", a), f = "", g = "#" + d.style.brandingId, j = this;
            f = $(g).html(), $(g).empty(), this.recovery(function() {
                $(g).append(f);
            }), e && e.length && MX.each(e, function(a) {
                return a.status === d.group.userStatus.member ? (c = a.group.id, !1) : void 0;
            }), c ? (h.orgId = c, Moxtra.loadGroupInfo(c).success(function(b) {
                i.loadMeetStyle(b), h.org = b, j._renderMeet(a);
            }).error(function() {
                i.loadStyle(), h.org = Moxtra.getMyGroup(), j._renderMeet(a);
            })) : this._renderMeet(a);
        },
        _renderMeet: function(a) {
            this.loading(80);
            var b = this;
            setTimeout(function() {
                b.loading(100), setTimeout(function() {
                    b.recovery(new g({
                        profile: a,
                        renderTo: "body"
                    })), b.container.empty();
                }, 100);
            }, 200);
        }
    });
}), define("text!template/mobile/mobile.html", [], function() {
    return '<div class="mx-mobile">\n	<div class="transition-header bottomLineBlue {{#if options}}{{#when options.type \'==\' \'joinmeet\'}}bottomLineOrange{{/when}}{{/if}}">\n		<div class="center"><a class="mx-logo" href="javascript:;"></a></div>\n		<div class="center">\n			<span>\n				<button class="btn btn-primary " data-action="gotoApp" data-param="{{url}}">{{action}}</button>\n				<button class="btn btn-default  marginLeft15" data-action="gotoStore">{{lang.get_the_app}}</button>\n			</span>\n		</div>\n	</div>\n	<div class="transition-body">\n		{{#if options}}\n		<div class="center {{#when options.type \'==\' \'joinmeet\'}}meet-icon{{/when}}">\n			{{#when options.type \'==\' \'publicview\'}}\n			<img class="thumb" src="{{options.src}}" />\n			{{/when}}\n			{{#when options.type \'==\' \'joinconversation\'}}\n			<img class="thumb img-circle" src="{{options.src}}" />\n			{{/when}}\n			{{#when options.type \'==\' \'joinbinder\'}}\n			<img class="thumb" src="{{options.src}}" />\n			{{/when}}\n			{{#when options.type \'==\' \'joinmeet\'}}\n			<i class="micon-meet-empty orange"></i>\n			{{/when}}\n			{{#when options.type \'==\' \'joincontact\'}}\n			<span>{{bbcode options.desc}}</span>\n			{{/when}}\n		</div>\n		{{/if}}\n		<div class="center info-title">\n			{{bbcode title}}\n		</div>\n		{{#if options}}\n		{{#unless error}}\n			{{#when options.type \'==\' \'joinmeet\'}}\n			<div class="center info-meetid">\n				{{lang.meet_id_colon}} {{options.formattedMeetId}}\n			</div>\n			<div class="center info-meethost">\n				{{bbcode options.host}}\n			</div>\n			{{/when}}\n			{{#when options.status \'==\' \'inprogress\'}}\n			<div class="center info-meet-inprogress" data-action="gotoApp" data-param="{{url}}">\n				{{lang.meet_in_progress_uppercase}}\n			</div>\n			{{/when}}\n			{{#when options.status \'==\' \'expired\'}}\n			<div class="center info-meet-expired">\n				{{lang.join_meet_but_has_ended}}\n			</div>\n			{{/when}}\n			{{#when options.status \'==\' \'scheduled\'}}\n			<div class="center info-meet-scheduled">\n				{{options.scheduledDate}}\n			</div>\n			{{/when}}\n		{{/unless}}\n		{{/if}}\n		{{#if showContinue}}\n		<div class="center info-continue">\n			<a href="javascript:;" data-action="gotoWeb" class="continue-action">{{lang.proceed_to_mobile_site}}</a>\n		</div>\n		{{/if}}\n		{{#if error}}\n		<div class="center info-error">\n			<div class="alert alert-danger">\n				{{errorMsg}}\n			</div>\n		</div>\n		{{/if}}\n	</div>\n</div>';
}), define("mobile/mobileBiz", [ "moxtra", "lang", "app" ], function(a, b, c) {
    var d = MX.logger("mobileBiz");
    return {
        getPublicViewUrl: function(a) {
            return MX.env.isAndroid ? "moxtra://?action=view&token=" + a : "moxtra://?viewtoken=" + a;
        },
        getViewBinderUrl: function(a) {
            return "moxtra://?action=view&binderid=" + a;
        },
        getJoinBinderUrl: function(a) {
            return "moxtra://?action=join&token=" + a;
        },
        getJoinMeetUrl: function(a) {
            return MX.env.isAndroid ? "moxtra://?action=join&sessioncode=" + a : "moxtra://?sessioncode=" + a;
        },
        getScheduledMeetUrl: function(a) {
            return "moxtra://?action=meetschedule&binderid=" + a;
        },
        getJoinContactUrl: function(a) {
            return "moxtra://?action=add_contact&token=" + a;
        },
        getViewInviteUrl: function() {
            return "moxtra://?action=view_invite";
        },
        getDefaultUrl: function() {
            return "moxtra://?action=view_invite";
        },
        open: function(a) {
            var b = new Date().getTime();
            try {
                d.log("switch url = ", a), location.href = a;
            } catch (e) {
                d.log("not found native app, turn to app store");
            }
            setTimeout(function() {
                var a = new Date().getTime();
                1e3 > a - b && (location.href = c.config.global.appstore_url);
            }, 5);
        }
    };
}), define("binder/joinBinderModel", [ "moxtra", "lang", "app", "const" ], function(a, b, c, d) {
    return a.Model.extend({
        idAttribute: "boardId",
        defaults: {
            boardId: "",
            boardMembers: {},
            name: "",
            thumbnail: d.defaults.binder.thumbnail,
            isChat: !1,
            ownerAvatar: d.defaults.user.avatar,
            ownerName: "",
            inviteeEmail: "",
            inviteeId: "",
            inviteeExist: !0,
            tokenAcceptor: "",
            tokenAccepted: !1,
            token: ""
        },
        setData: function(a, b) {
            this.set({
                boardId: a.id,
                name: a.name,
                isChat: !!a.isconversation,
                token: b
            }), a.thumbnail && this.set({
                thumbnail: "/board/" + a.id + "/" + a.thumbnail
            });
            var c = MX.filter(a.users, {
                status: d.binder.status.invite
            });
            c = c && c[0].user || {}, this.set({
                inviteeEmail: c.email,
                inviteeId: c.id,
                inviteeExist: !!c.id
            });
            var e = MX.filter(a.users, {
                status: d.binder.status.member
            }), f = {}, g = "";
            if (MX.each(e, function(a) {
                f[a.user.id] = a, a.type !== d.binder.role.Owner && (g = a.user.email);
            }), this.set({
                boardMembers: f
            }), this.set({
                tokenAcceptor: g,
                tokenAccepted: !c.email
            }), a.isconversation) {
                var h, i = MX.filter(a.users, {
                    type: d.binder.role.Owner
                });
                i = i && i[0].user || {}, h = i.picture4x || i.picture2x || i.picture || null, h && this.set({
                    ownerAvatar: MX.format("/board/{0}/{1}/{2}", a.id, i.id, h)
                }), this.set({
                    ownerName: i.name || i.first_name || i.email || ""
                });
            }
        }
    });
}), define("mobile/mobile", [ "moxtra", "lang", "app", "const", "text!template/mobile/mobile.html", "mobile/mobileBiz", "binder/binderBiz", "binder/joinBinderModel", "meet/meetUtil" ], function(a, b, c, d, e, f, g, h, i) {
    var j = Handlebars.compile(e);
    return a.Controller.extend({
        template: '<div class="page-body"></div>',
        handleAction: !0,
        init: function() {
            this.type = c.request.module() || "", this.token = c.request.page() || "";
        },
        rendered: function() {
            this.progress(!0);
            {
                var a = this.type.toLowerCase(), e = this.token, j = b.view_in_app, k = "", l = !1, m = this, n = "", o = {};
                c.request.params();
            }
            switch (a) {
              case "view":
                var p = c.status.get("mxPublicView"), q = e;
                p && (q = p[e] || e), l = !MX.env.isChromeOniOS, g.verifyInvitationToken(q).success(function(a) {
                    var c = a && a.object && a.object.board;
                    c && (k = c.name || ""), k = MX.format(b.mobile_public_view_title, MX.escapeHTML(k)), 
                    k = MX.format("[i]{0}[/i]", k), n = f.getPublicViewUrl(q), o.type = "publicview", 
                    o.src = d.defaults.binder.thumbnail, c && c.thumbnail && (o.src = "/board/" + c.id + "/" + c.thumbnail), 
                    m.showSuccess(j, k, n, l, o);
                }).error(function() {
                    m.showError();
                });
                break;

              case "detail":
                k = b.mobile_welcome_to_moxtra, n = f.getViewBinderUrl(e), setTimeout(function() {
                    m.showSuccess(j, k, n, l);
                }, 300);
                break;

              case "viewinvite":
                k = b.mobile_welcome_to_moxtra_invitations, n = f.getViewInviteUrl(), setTimeout(function() {
                    m.showSuccess(j, k, n, l);
                }, 300);
                break;

              case "joinbinder":
                j = b.join_via_app, g.verifyInvitationToken(e).success(function(a) {
                    var c, d, g = new h();
                    g.setData(a.object.board, e), c = g.toJSON(), d = f.getJoinBinderUrl(e, c.boardId, c.inviteeEmail), 
                    c.isChat ? (k = MX.format(b.mobile_join_chat_title, MX.escapeHTML(c.ownerName)), 
                    o.type = "joinconversation", o.src = c.ownerAvatar) : (k = MX.format(b.mobile_join_binder_title, MX.escapeHTML(c.name)), 
                    o.type = "joinbinder", o.src = c.thumbnail), k = MX.format("[i]{0}[/i]", k), m.showSuccess(j, k, d, l, o);
                }).error(function() {
                    m.showError();
                });
                break;

              case "joincontact":
              case "contactjoin":
                if ("app" === e) m.gotoStore(), m.showSuccess(b.get_the_app, k, c.config.global.appstore_url, !1); else {
                    j = b.open_the_app, n = "moxtra://";
                    var r = {
                        type: "USER_REQUEST_CONTACT_VIEW_INVITATION",
                        params: [ {
                            name: "USER_REQUEST_CONTACT_INVITE_TOKEN",
                            string_value: e
                        } ]
                    };
                    $.ajax({
                        url: "/user",
                        data: JSON.stringify(r),
                        global: !1,
                        type: "POST",
                        dataType: "json",
                        timeout: 6e4,
                        contentType: "application/json; charset=UTF-8",
                        success: function(a) {
                            var c = MX.get("object.user.contacts.0.user.name", a) || MX.get("object.user.contacts.0.user.email", a);
                            o.type = "joincontact", o.desc = MX.format(b.contact_invitation_title, c), m.showSuccess(j, k, n, !1, o);
                        },
                        error: function() {
                            m.showError();
                        }
                    });
                }
                break;

              case "joinmeet":
                j = b.join_via_app, o.type = "joinmeet", o.meetId = e, MX.api(MX.format("/meets/{0}", e), "GET", null, function(a) {
                    if ("RESPONSE_SUCCESS" === a.code) {
                        n = f.getJoinMeetUrl(e);
                        var c = i.parseMeetInfo(a);
                        c.hasSession ? (k = c.title, o.host = c.host, o.meetId = c.meetId, o.formattedMeetId = i.formatMeetId(c.meetId), 
                        c.isActive && (o.status = "inprogress"), c.isScheduled && (o.status = "scheduled", 
                        c.joinBeforeHost || (o.scheduledDate = MX.format(b.join_meet_but_ahead_of_scheduled, {
                            date: c.scheduledDate
                        }), Date.now() > c.scheduledStartTime && (o.scheduledDate = b.join_meet_within_minutes_of_scheduled), 
                        n = f.getScheduledMeetUrl(c.boardId))), c.isExpired && (o.status = "expired"), setTimeout(function() {
                            m.showSuccess(j, k, n, l, o);
                        })) : setTimeout(function() {
                            m.showSuccess(j, k, n, l, o);
                        }, 300);
                    } else setTimeout(function() {
                        m.showError(b.meet_id_invalid);
                    }, 300);
                });
                break;

              case "api.newbinder":
                j = b.open_the_app, k = b.mobile_welcome_to_moxtra, n = f.getDefaultUrl(), m.showSuccess(j, k, n, l), 
                m.gotoApp(n);
            }
        },
        showSuccess: function(a, c, d, e, f) {
            this.progress(!1), this.$el.html($(j({
                lang: b,
                action: a,
                title: c,
                url: d,
                showContinue: e,
                options: f,
                error: !1
            })));
        },
        showError: function(a) {
            a = a || b.mobile_read_token_error, this.progress(!1), this.$el.html($(j({
                lang: b,
                action: b.open_the_app,
                title: "",
                url: f.getDefaultUrl(),
                showContinue: !1,
                error: !0,
                errorMsg: a
            })));
        },
        gotoApp: function(a) {
            f.open(a);
        },
        gotoStore: function() {
            location.href = c.config.global.appstore_url;
        },
        gotoWeb: function() {
            c.navigate("/viewmobile/" + this.token, !0);
        }
    });
}), define("note/add", [ "moxtra", "app", "lang", "text!template/meet/topbar/add.html", "binder/binderActions", "component/uploader/uploader" ], function(a, b, c, d, e, f) {
    return a.Controller.extend({
        template: d,
        handleAction: !0,
        init: function() {
            this.$scope.lang = c, this.binderActions = e, this.$scope.session_key = "Video_Clip";
        },
        rendered: function() {
            this.$("ul li.addpage-webdoc").remove();
            f.register("addPageToBinder", {
                browse_button: "addpage_flashuploader",
                url: function() {
                    var a = b.request.toJSON();
                    return "/board/upload?type=original&id=" + a.page;
                }
            });
            this.$(".add-file").on("hide.bs.dropdown", function() {
                f.hide("addPageToBinder");
            }), this.show();
        },
        refreshUploader: function() {
            var a = this.$el;
            setTimeout(function() {
                f.refresh("addPageToBinder", a.find("#addpage_flashuploader"));
            }, 100);
        },
        show: function() {
            this.$el.removeClass("hide");
        }
    });
}), define("text!template/note/main.html", [], function() {
    return '<div class="mx-meet mx-note">\r\n    <header class="mx-branding-note-header">\r\n    	<div class="mx-meet-header row">\r\n    		<div class="col-xs-12">\r\n    			<a class="mouse-hand pull-left"><i class="mx-branding-note-logo mx-logo-white"></i></a>\r\n    			\r\n    			<div class="pull-right">\r\n    				<div class="meet-btn-exit topbar-action" data-action="stopNote"><i class="mx-branding micon-close size20" data-placement="bottom" title="{{lang.end_note}}"></i></div>\r\n    			</div>\r\n    			<div class="meet-topbar-mic pull-right">\r\n    				\r\n    			</div>\r\n    			<div class="meet-topbar-add pull-right">\r\n    				\r\n    			</div>\r\n    		</div>\r\n    	</div>\r\n		<div class="mx-note-recorder">\r\n			<ul class="list-inline disabled">\r\n				<li><span class="rocorder-btn"><i class="icon-record-diabled"></i></span></li>\r\n				<li><span class="recorder-timer">{{lang.loading}}</span></li>\r\n				<li><span class="rocorder-btn"><i class="glyphicon glyphicon-stop"></i></span></li>\r\n			</ul>\r\n		</div>\r\n    </header>\r\n    <div id="mxMeetPlugin"></div>\r\n    <div class="mx-meet-webrtc">\r\n    	<div id="localvideo"><video id="sourcevid" muted="true" autoplay style="width:100px;height:100px;" class="hide"></video></div>\r\n		<div id="remotevideovid1"><video id="remotevid1" autoplay class="hide"></video></div>\r\n		<div id="remotevideovid2"><video id="remotevid2" autoplay class="hide"></video></div>\r\n		<div id="remotevideovid3"><video id="remotevid3" autoplay class="hide"></video></div>\r\n		<div id="remotevideovid4"><video id="remotevid4" autoplay class="hide"></video></div>\r\n    </div>\r\n    <a id="uploadDragDropInNoteHidden" class="hide"></a>\r\n</div>';
}), define("text!template/note/audio.html", [], function() {
    return '<div class="meet-audio-wrap topbar-action">\n	{{#if enabled}}\n		<span class="dropdown pull-right">\n		{{#if muted}}\n		<a id="mxMeetAudio" class="mx-btn mouse-hand" title="{{lang.unmute}}" data-action="unmuteSelf" data-placement="bottom"><i class="mx-branding micon-mic-muted size20"></i></a>\n		{{else}}\n		<a id="mxMeetAudio" class="mx-btn mouse-hand" title="{{lang.mute}}" data-action="muteSelf" data-placement="bottom"><i class="mx-branding micon-mic size20"></i></a>\n		{{/if}}\n		</span>\n	{{else}}\n	<span><a id="mxMeetAudioOff" class="mx-btn mouse-hand disabled" data-action="enableAudio" title="{{lang.enable_voice}}" data-placement="bottom"><i class="mx-branding micon-speaker-disabled size20"></i> <span class="mx-branding caret caret-white"></span></a></span>\n	{{/if}}\n</div>';
}), define("note/noteModel", [ "moxtra", "lang", "app" ], function(a, b) {
    return a.Model.extend({
        defaults: {
            id: "",
            sessionKey: "",
            name: "",
            time: 0,
            isStopped: !1
        },
        validation: {
            name: [ {
                required: !0,
                msg: b.name_is_required
            } ]
        },
        setId: function(a) {
            this.set({
                id: a
            });
        },
        getId: function() {
            return this.get("id");
        },
        setSessionKey: function(a) {
            this.set({
                sessionKey: a
            });
        },
        getSessionKey: function() {
            return this.get("sessionKey");
        },
        setName: function(a) {
            a = $("<div/>").text(a).text(), this.set({
                name: a
            });
        },
        setTime: function(a) {
            this.set({
                time: a
            });
        },
        getTime: function() {
            var a = this.get("time"), c = [], d = Math.floor(a / 36e5), e = Math.floor(a % 36e5 / 6e4), f = Math.ceil(a % 36e5 % 6e4 / 1e3);
            return 60 == f && (e++, f = 0), 60 == e && (d++, e = 0), 0 >= d && 0 >= e && 0 >= f && (f = 1), 
            d > 0 && (c.push(d), c.push(d > 1 ? b.hours : b.hour)), e > 0 && (c.push(e), c.push(e > 1 ? b.minutes : b.minute)), 
            f >= 0 && (c.push(f), c.push(f > 1 ? b.seconds : b.second)), c.join(" ");
        },
        setStopped: function(a) {
            this.set({
                isStopped: !!a
            });
        }
    });
}), define("text!template/note/recorder.html", [], function() {
    return '<ul class="list-inline">\r\n	<li class="recorder-ctrl"><a class="mouse-hand" data-action="pauseNote"><i class="glyphicon glyphicon-pause"></i></a></li>\r\n	<li><span class="recorder-timer">0:00:00</span></li>\r\n	<li><a class="mouse-hand" data-action="stopNote"><i class="glyphicon glyphicon-stop"></i></a></li>\r\n</ul>\r\n';
}), define("text!template/note/recordBtn.html", [], function() {
    return '<a class="mouse-hand" data-action="recordNote"><i class="icon-record"></i></a>';
}), define("text!template/note/pauseBtn.html", [], function() {
    return '<a class="mouse-hand" data-action="pauseNote"><i class="glyphicon glyphicon-pause"></i></a>';
}), define("text!template/note/ejectBtn.html", [], function() {
    return '<a class="mouse-hand" data-action="exitNote"><i class="glyphicon glyphicon-eject"></i></a>';
}), define("note/recorder", [ "moxtra", "lang", "app", "const", "text!template/note/recorder.html", "text!template/note/recordBtn.html", "text!template/note/pauseBtn.html", "text!template/note/ejectBtn.html", "meet/meetBiz" ], function(a, b, c, d, e, f, g, h, i) {
    var j = MX.logger("noteRecorder");
    return a.Controller.extend({
        template: e,
        handleAction: !0,
        init: function(a) {
            this.model = a.model, this.sessionId = Moxtra.getMe().sessionId, this.started = !1;
        },
        rendered: function() {
            this.timer = this.$(".recorder-timer"), this._start();
        },
        recordNote: function() {
            this._toggleControl(), this.started ? i.controlRecording("resume").success(function() {}).error(function() {}) : this._start();
        },
        pauseNote: function() {
            this._toggleControl(!0), i.controlRecording("pause").success(function() {}).error(function() {});
        },
        stopRecorder: function() {
            this.timer.stopwatch().stopwatch("stop");
            var a = this.timer.stopwatch().stopwatch("getTime"), b = i.isNoteStopped();
            this.model.setTime(a), this.model.setStopped(!0), this.$(".recorder-ctrl").html("<span>&nbsp;&nbsp;</span>");
            var d, e = this.model.toJSON(), f = this;
            d = i.getNoteStorage() || {}, e.isStopped && !b && (j.log("send recording comand: stop"), 
            i.controlRecording("stop").success(function() {
                c.sendMessage({
                    action: "stop_note",
                    binder_id: e.id,
                    session_key: e.sessionKey,
                    session_id: f.sessionId,
                    isNote: !0,
                    destination_binder_id: d.srcId || e.id || ""
                }), i.setNoteStopped(!0);
            }).error(function() {}));
        },
        _start: function() {
            var a, b = this;
            a = i.getNoteStorage() || {}, a.timerId && clearInterval(a.timerId), a.startTime ? (b.started = !0, 
            b.timer.stopwatch({
                startTime: new Date().getTime() - a.startTime
            }).stopwatch("start"), b._checkTimer(b.timer.data("stopwatch").timerID), i.isNoteStopped() && (j.log("note has stopped!!!"), 
            setTimeout(function() {
                b.stopRecorder(1500);
            }, 1500))) : i.controlRecording("start").success(function() {
                c.sendMessage({
                    action: "start_note",
                    binder_id: b.model.getId(),
                    session_key: b.model.getSessionKey(),
                    session_id: b.sessionId,
                    isNote: !0,
                    destination_binder_id: a.srcId || b.model.getId() || ""
                }), b.started = !0, a.startTime = new Date().getTime(), b.timer.stopwatch({
                    startTime: 0
                }).stopwatch("start"), a.timerId = b.timer.data("stopwatch").timerID, i.setNoteStorage(a), 
                b._checkTimer(a.timerId);
            }).error(function() {});
        },
        _toggleControl: function(a) {
            a ? (this.timer.stopwatch().stopwatch("stop"), this.model.setTime(this.timer.stopwatch().stopwatch("getTime")), 
            this.$(".recorder-ctrl").html(f)) : (this.timer.stopwatch().stopwatch("start"), 
            this.$(".recorder-ctrl").html(g));
        },
        _checkTimer: function(a) {
            var b, c = function() {
                location.href.indexOf("note/") > 0 ? (j.log("_checkTimer after 1.5s"), b = setTimeout(c, 1500)) : (j.log("_clear Timer interval: ", a), 
                clearTimeout(b), clearInterval(a));
            };
            c();
        }
    });
}), define("text!template/note/save.html", [], function() {
    return '<div>\r\n    <form role="form" id="saveNoteForm">\r\n    	<div class="form-group">\r\n            <label for="noteName">{{duration}}</label>\r\n        </div>\r\n        <div class="form-group">\r\n            <label for="noteName">{{lang.note_name}}</label>\r\n            <input type="text" class="form-control" autofocus data-error-style="inline" name="name" id="noteName" placeholder="{{lang.note_name}}">\r\n        </div>\r\n        <div>\r\n        	<p class="mx-text-warning">{{lang.save_note_warning_hint}}</p>\r\n        </div>\r\n    </form>\r\n</div>';
}), define("note/save", [ "moxtra", "lang", "app", "text!template/note/save.html" ], function(a, b, c, d) {
    return a.Controller.extend({
        template: d,
        title: b.save_note,
        handleAction: !0,
        buttons: [ {
            text: b.exit_without_saving,
            className: "btn-default",
            click: "onExitNote"
        }, {
            text: b.save,
            className: "btn-primary",
            click: "onClickSave"
        } ],
        init: function(a) {
            _.extend(this, a), this.$scope.lang = b, this.$scope.duration = MX.format(b.note_duration, this.model.getTime());
        },
        rendered: function() {
            this.form = new a.Form({
                parent: this,
                form: this.$("#saveNoteForm"),
                model: this.model,
                submit: this.submit,
                scope: this
            });
        },
        onClickSave: function() {
            this.model.isValid(!0) && this.submit();
        },
        submit: function() {
            this.onSaveNote(this.model.get("name"));
        }
    });
}), define("note/main", [ "moxtra", "lang", "app", "const", "text!template/note/main.html", "text!template/note/audio.html", "note/noteModel", "meet/meet", "meet/meetBiz", "note/recorder", "note/save", "note/add", "binder/newBinderOptions", "viewer/viewer", "admin/branding/helper", "component/uploader/base", "component/uploader/fileProgress", "component/templateHelper" ], function(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q) {
    var r = Handlebars.compile(f), s = MX.logger("noteMain");
    return a.Controller.extend({
        template: e,
        handleAction: !0,
        init: function(a) {
            var c = this;
            a = a || {}, this.profile = a.profile, this.id = this.profile.boardId, this.sessionKey = this.profile.sessionKey, 
            this.host = this.profile.host, this.sessionId = Moxtra.getMe().sessionId, this.$scope.lang = b, 
            this.model = new g(), this.model.setId(this.id), this.model.setName(this.profile.topic), 
            this.model.setSessionKey(this.sessionKey), this.pages = i.getPageList(), this.dsModel = i.getDSModel(), 
            this.audioModel = i.getAudioModel(), this.meetModel = i.getMeetModel(), this.initViewer(), 
            Moxtra.verifyToken().complete(function() {
                c.buildToken();
            }), this.listenTo(this.pages, "complete", this.showPage), this.listenTo(this.pages, "convert", this.showConvertProgress), 
            this.dsModel.on("change:serverAddr", this.updateDSConf, this), this.audioModel.once("change:audioConf", this.enableAudio, this), 
            this.audioModel.once("change:uiEnabled", this.startNote, this), this.audioModel.on("change:uiEnabled change:uiMuted", this.audioChanged, this), 
            this.meetModel.once("change:isMeetPresenter", this.handleChange, this), MX.env.isIE && $("body").addClass("ie" + MX.env.browserVersion);
        },
        rendered: function() {
            var a = this;
            Moxtra.onReady(function() {
                o.isShowAddFile() && (a.addFileView = new l({
                    sessionKey: a.sessionKey,
                    renderTo: ".meet-topbar-add"
                }), a.recovery(a.addFileView), a._enableDragDrop());
            }), this.$(".meet-topbar-mic").empty().append($(r({
                lang: b,
                enabled: !1,
                muted: !0
            }))), this.bindWindowEvents(), i.start(this.id, this.sessionKey), this.meetModel.set({
                zone: this.profile.zone
            }, {
                silent: !0
            }), this.$("i[title]").tooltip();
        },
        buildToken: function() {
            var a = this;
            this.view_token = "";
            var b = new Moxtra.util.Request();
            b.success(function() {
                var b = Moxtra.getBoard(a.id);
                b && b.createViewToken(!0).success(function() {
                    a.view_token = b.view_token;
                });
            }).wait(function() {
                return Moxtra.getBoard(a.id);
            }).invoke("success", a);
        },
        bindWindowEvents: function() {
            if (!(navigator.userAgent.indexOf(d.flags.windowsAgent) > 0)) {
                var a = this;
                MX.env.isIE || (MX.env.isSafari || (window.onbeforeunload = function() {
                    return b.note_msg_in_progress;
                }), window.onunload = function(b) {
                    s.log("page unloading...");
                    try {
                        b.clientX <= 0 && b.clientY < 0 && a._exitMeet();
                    } catch (c) {
                        s.error("page unloaded", c);
                    }
                });
            }
        },
        startNote: function() {
            s.log("Start Note: 3, 2, 1...");
            var a = this;
            this.$el.splashScreen({
                textLayers: [ 3, 2, 1 ],
                callback: function() {
                    a.$(".mx-note-recorder").empty(), a.recorder = new j({
                        model: a.model,
                        renderTo: ".mx-note-recorder"
                    }), a.recovery(a.recorder);
                }
            });
        },
        stopNote: function() {
            var a, d = this, e = !0, f = [];
            a = i.getNoteStorage() || {}, this.recorder && d.recorder.pauseNote(), (a.srcId || c.isIntegrationWebsdk()) && (e = !1), 
            f = this.recorder && this.recorder.started ? [ {
                position: "left",
                text: b.cancel,
                className: "btn-default",
                click: function() {
                    d.recorder && d.recorder.recordNote(), this.close();
                }
            }, {
                text: b.exit_without_saving,
                className: "btn-default",
                click: "onExitNote"
            }, {
                text: b.save,
                className: "btn-primary mx-branding-note-dialog-btn",
                click: "onClickSave"
            } ] : [ {
                position: "left",
                text: b.cancel,
                className: "btn-default",
                click: function() {
                    this.close();
                }
            }, {
                text: b.exit_without_saving,
                className: "btn-primary mx-branding-note-dialog-btn",
                click: "onExitNote"
            } ], new MX.ui.Dialog({
                content: new k({
                    model: d.model,
                    buttons: f,
                    onSaveNote: function(c) {
                        d.recorder && d.recorder.stopRecorder(), e ? this.dialog.push({
                            content: new MX.ui.BinderSelector({
                                title: b.save_note_to,
                                buttons: [ {
                                    text: b.save,
                                    position: "right",
                                    className: "btn-primary mx-branding-note-dialog-btn",
                                    click: "saveNoteToBinder"
                                } ],
                                onChange: function() {},
                                newBinder: function() {
                                    var a = this;
                                    this.dialog.push(new m({
                                        onCreatedBinder: function(b) {
                                            a.saveNoteTo(b);
                                        }
                                    }));
                                },
                                saveNoteToBinder: function() {
                                    var a = $(this.handleEvent.currentTarget);
                                    a.text(b.saving_ellipsis), a.addClass("disabled");
                                    var c = this.value();
                                    c = c || [], this.saveNoteTo(c[0]);
                                },
                                saveNoteTo: function(a) {
                                    d._saveNote(c, a), this.dialog.close();
                                }
                            })
                        }) : (d._saveNote(c, a.srcId), this.dialog.close());
                    },
                    onExitNote: function() {
                        d.recorder && d.recorder.stopRecorder(), i.controlRecording("cancel").success(function() {}).error(function() {}), 
                        s.log("exit without saving"), d._postNoteMessage("cancel_note"), d.exitNote(), this.dialog.close();
                    }
                })
            });
        },
        _saveNote: function(a, b) {
            var c = this;
            b ? i.controlRecording("save", a, b).success(function() {
                c._postNoteMessage("save_note", b), c.exitNote();
            }).error(function() {}) : (c._postNoteMessage("save_note"), c.exitNote());
        },
        endNote: function() {
            {
                var a = this;
                i.getNoteStorage() || {};
            }
            new MX.ui.Dialog({
                title: b.end_note,
                buttons: [ {
                    text: b.no,
                    click: function() {
                        this.close();
                    }
                }, {
                    text: b.yes,
                    className: "btn-primary mx-branding-note-dialog-btn",
                    click: function() {
                        a._postNoteMessage("cancel_note"), a.exitNote(), this.close();
                    }
                } ],
                content: b.exit_without_saving_confirm
            });
        },
        exitNote: function() {
            var a = this, b = this.profile;
            b.isHost = !0, _.extend(b, {
                isNote: !0,
                success: function() {
                    a.close();
                },
                error: function() {
                    a.close();
                }
            }), h.exit(b);
        },
        _postNoteMessage: function(a, b) {
            var d = this, e = i.getNoteStorage() || {};
            b || (b = e.srcId || d.model.getId() || "");
            var f = {
                action: a,
                binder_id: d.model.getId(),
                session_key: d.model.getSessionKey(),
                session_id: d.sessionId,
                isNote: !0,
                destination_binder_id: b
            };
            "save_note" === a && (f.share_url = MX.format("{0}/v/{1}", location.origin, d.view_token), 
            f.download_url = MX.format("{0}/board/{1}/downloadnote?d=1&t={2}", location.origin, d.model.getId(), d.view_token)), 
            c.sendMessage(f);
        },
        initViewer: function() {
            this.viewer || (this.viewer = new n({
                plugins: [ "pager", "annotate", "thumbnails", "zoom", "delete" ],
                commands: [],
                collection: this.pages,
                skin: "default",
                renderTo: "body",
                disableESC: !0,
                showApplicationContainer: !0,
                userRole: d.binder.role.Presenter,
                roleContext: d.roleContext.note
            }), this.recovery(this.viewer), this._customizeViewer(), this._bindViewer(), this.viewer.$(".mx-branding-viewer-poweredby").addClass("active"));
        },
        enableAudio: function() {
            i.joinAudio();
        },
        audioChanged: function(a) {
            var c = this.$(".meet-topbar-mic"), d = a.toJSON();
            c.empty(), c.append($(r({
                lang: b,
                enabled: d.uiEnabled,
                muted: d.uiMuted
            })));
        },
        _getCurrentPage: function() {
            var a = 0;
            return this.viewer && this.viewer.model ? this.viewer.model.get("sequence") : a;
        },
        _customizeViewer: function() {},
        _bindViewer: function() {
            var a = this;
            this.viewer.on("switchPage", function(b) {
                c.request.sequence(b.page_sequence, !1), i.publishSwitchPage(b.page_sequence).success(function(a) {
                    s.log(a);
                }), a._toggleAnnotate(b.page_sequence), a.pointTimer && clearInterval(a.pointTimer);
            }), this.viewer.on("viewer:pageAction", function(a) {
                i.publishPageAction(a);
            });
            var b = this.viewer.getView("annotate");
            b && (a.pointArray = [], b.on("showLaserPointer", function(b) {
                i.publishLaserPointer(b), a.pointArray = [], a.pointTimer = setInterval(function() {
                    console.log("pointTimer");
                    var b = a.pointArray.pop();
                    a.pointArray.length = 0, b && (console.log("publishLaserPointer"), i.publishLaserPointer(b));
                }, 1e3);
            }), b.on("hideLaserPointer", function(b) {
                i.publishLaserPointer(b), a.pointTimer && clearInterval(a.pointTimer);
            }), b.on("updateLaserPointer", function(b) {
                s.log("main -> updateLaserPointer"), a.pointArray.push(b);
            }), this.recovery(function() {
                a.pointTimer && clearInterval(a.pointTimer);
            }));
        },
        _toggleAnnotate: function(a) {
            if (a && this.viewer) {
                var b = this.viewer.collection.get(a);
                b && [ d.binder.pageType.whiteboard, d.binder.pageType.image, d.binder.pageType.pdf ].indexOf(b.get("pageType")) > -1 ? this.viewer.getView("annotate").showPanel() : this.viewer.getView("annotate").hidePanel();
            }
        },
        showPage: function() {
            if (this.pages.length) {
                if (c.status.get("mxNote") && c.status.get("mxNote").currPage) {
                    var a = this.pages.at(c.status.get("mxNote").currPage);
                    this.openPage(a.get("sequence")), c.status.set("mxNote", {
                        srcId: c.status.get("mxNote").srcId
                    });
                } else if (c.request.sequence()) this.openPage(c.request.sequence()); else if (!this._getCurrentPage()) {
                    var a = this.pages.at(0);
                    this.openPage(a.get("sequence"));
                }
            } else c.request.sequence("");
        },
        handleChange: function() {
            var a, b = this._getCurrentPage();
            b || (a = this.pages.at(0), a && (b = a.get("sequence"))), b && (s.log("note: publish switch page ", b), 
            i.publishSwitchPage(b));
        },
        initConvertProgress: function(c) {
            var d = this, e = a.Model.extend({
                percent: 0,
                name: ""
            });
            d.convertModel = new e({
                percent: 0,
                name: MX.format(b.converting_file_progress, c.name, 0, 0)
            });
            new MX.ui.Notify({
                autoClose: !1,
                content: new q({
                    model: d.convertModel
                })
            });
        },
        showConvertProgress: function(a, c) {
            c.creator = c.creator || {}, 0 === a ? this.initConvertProgress(c) : -1 === a ? (this.convertModel && (this.convertModel.set({
                percent: 100,
                name: MX.format(b.converting_file_progress, c.name, c.converted_pages, c.total_pages)
            }), MX.ui.notifyError(b.convert_file_failed)), this.convertModel = null) : 100 === a ? (this.convertModel && this.convertModel.set({
                percent: a,
                name: MX.format(b.converting_file_progress, c.name, c.converted_pages, c.total_pages)
            }), this.convertModel = null) : (this.convertModel || this.initConvertProgress(c), 
            this.convertModel.set({
                percent: a,
                name: MX.format(b.converting_file_progress, c.name, c.converted_pages, c.total_pages)
            }));
        },
        openPage: function(a) {
            this.viewer && this.viewer.open(a);
        },
        muteSelf: function() {
            i.muteAudio(!0);
        },
        unmuteSelf: function() {
            i.unmuteAudio();
        },
        updateDSConf: function() {
            i.updatePeerConf();
        },
        close: function() {
            s.log("note closed..."), window.onbeforeunload = null, window.onunload = null, i.stop(this.id), 
            setTimeout(function() {
                var a = c.status.get("mxMeetAnchorHref") || "";
                location.href !== a && (s.log("goback to: ", a), location.href = a);
            }, 1e3), this.viewer && this.viewer.close(), this.$el.remove();
        },
        _enableDragDrop: function() {
            var a = this;
            a.dragdrop = new p({
                className: "mx_swf_container_dragdrop",
                container: a.$el
            }), a.dragdrop.register("dragPageToNote", {
                browse_button: "uploadDragDropInNoteHidden",
                drop_element: "mxBody",
                drop_message: b.drop_your_file_to_note,
                url: function() {
                    return "/board/upload?type=original&id=" + a.id;
                }
            }), setTimeout(function() {
                a.dragdrop.refresh("dragPageToNote", a.$("#uploadDragDropInNoteHidden"));
            }, 300), a.recovery(function() {
                a._disableDragDrop();
            });
        },
        _disableDragDrop: function() {
            this.dragdrop && this.dragdrop.unregister("dragPageToNote");
        }
    });
}), define("note/viewer", [ "moxtra", "lang", "app", "meet/meet", "note/main" ], function(a, b, c, d, e) {
    var f = MX.logger("noteViewer");
    return a.Controller.extend({
        template: "<div></div>",
        rendered: function() {
            this.loading(), this.$scope.lang = b;
            var a = this;
            d.load({
                success: function(b) {
                    a.initViewer(b);
                },
                error: function() {
                    a.close();
                }
            });
        },
        initViewer: function(a) {
            if (f.log(a), this.loading(80), !a || !a.boardId || !a.sessionKey) return this.close(), 
            !1;
            var b = this;
            setTimeout(function() {
                b.loading(100), setTimeout(function() {
                    b.recovery(new e({
                        profile: a,
                        renderTo: "body"
                    })), b.container.empty();
                }, 500);
            }, 500);
        },
        loading: function(a) {
            a = a || 50, this.container.find(".progress-bar").css({
                width: a + "%"
            });
        },
        close: function() {
            this.loading(!1), this.$el.remove(), c.request.module("/binder", !0);
        }
    });
}), define("text!template/services/services.html", [], function() {
    return '<div class="mx-integration-services">\n	<div class="service-list">\n		<div class="integration-header">\n			<h4>{{lang.integrations}}</h4>\n			<p class="size16">{{lang.service_integrations_summary}}</p>\n		</div>\n		<div class="integration-search">\n			<div class="form-with-icon input-with-search">\n				<i class="micon-search icon-control"></i>\n				<button type="button" class="close input-close hide" data-action="removeSearchKey" aria-hidden="true">\n					<span>&times;</span>\n				</button>\n				<input id="searchIntegration" class="form-control input-sm" type="text" placeholder="{{lang.search}}">\n			</div>\n		</div>\n		<div class="integration-services">\n			<ul class="mx-list">\n				<li id="emailService" class="integration-service-item shown-static">\n\n				</li>\n				{{#each services}}\n				<li id="{{name}}Service" class="integration-service-item {{#unless integrations.length}}has-summary{{/unless}}">\n					<div class="panel-group">\n						<div class="mx-panel panel panel-default panel-large">\n							<div class="panel-heading">\n								<h4 class="panel-title">\n\n								</h4>\n							</div>\n							<div id="collapse{{name}}" class="panel-collapse collapse">\n								<div class="panel-body">\n									<div class="new-integration-item">\n										<div class="col-sm-10">\n											<div class="new-integration-item-name">\n												<a class="mouse-hand" data-action="newIntegration" data-param="{{name}}">{{formatServiceName name ../lang.add_a_new_service_integration}}</a>\n											</div>\n										</div>\n										<div class="col-sm-2">\n											<span class="pull-right new-integration-item-action">\n												<a class="btn btn-sm btn-primary add-new" data-action="newIntegration" data-param="{{name}}">{{../lang.add}}</a>\n											</span>\n										</div>\n									</div>\n									<div class="summary">\n										{{formatServiceSummary name}}\n									</div>\n									<div class="{{name}}-integrations">\n\n									</div>\n								</div>\n							</div>\n						</div>\n					</div>\n				</li>\n				{{/each}}\n				<li id="zapierService" class="integration-service-item shown-static">\n\n				</li>\n			</ul>\n\n			<div class="integration-feedback row">\n				<div>\n					{{bbcode lang.service_integrations_feedback_note}}\n				</div>\n				<div>\n					{{bbcode lang.service_integrations_feedback_action}}\n				</div>\n				<div class="feedback-form col-sm-6 hide">\n					<textarea class="vertResize noOutline" rows="3" placeholder="{{lang.send_feedback_hint}}"></textarea>\n					<div class="row paddingTop15">\n						<a class="btn btn-primary pull-right" data-action="sendFeedback">{{lang.send}}</a>\n						<a class="btn btn-default pull-right" data-action="hideFeedback">{{lang.cancel}}</a>\n					</div>\n				</div>\n			</div>\n		</div>\n	</div>\n	<div class="service-detail hide">\n\n	</div>\n</div>\n';
}), define("text!template/services/integrationItem.html", [], function() {
    return '<li class="integration-item mx-item mx-hover-effect" data-action="viewIntegration" data-param="{{actor_file_name}},{{uniqueId}}">\n	<div class="col-sm-11">\n		<div class="integration-postas">\n			{{formatPostAsTo post_as boardName}}\n		</div>\n		<div class="integration-actor">\n			{{formatCreatedByOnDate actor.user.displayName created_time}}\n		</div>\n		<div class="integration-description ellipsis">\n			{{description}}\n		</div>\n	</div>\n	<div class="col-sm-1 integration-action">\n		<span class="dropdown pull-right">\n			<i class="micon-arrow-right"></i>\n		</span>\n	</div>\n</li>';
}), define("text!template/services/servicePanelHeader.html", [], function() {
    return '<div data-toggle="collapse" href="#collapse{{service.name}}" style="cursor: pointer;" class="service-header collapsed">\n	<div class="row">\n		<div class="col-sm-9">\n			<i class="arrow micon-arrow-right pull-left"></i>\n			<img src="images/service/{{service.name}}.png" class="service-logo pull-left" />\n			<div class="service-tagline">\n				<div class="service-name">{{service.displayName}}</div>\n				<div class="service-note ellipsis">{{tagline}}</div>\n			</div>\n		</div>\n		<div class="col-sm-3">\n			<span class="pull-right service-header-action">\n				{{#if service.integrations.length}}\n				<span class="total-integration">{{service.integrations.length}} {{lang.configured}}</span>\n				{{else}}\n				<span class="btn btn-sm btn-primary add-new" data-action="newIntegration" data-param="{{service.name}}">{{lang.add}}</span>\n				{{/if}}\n			</span>\n		</div>\n	</div>\n</div>';
}), define("text!template/services/zapierService.html", [], function() {
    return '<div class="panel-group">\n	<div class="mx-panel panel panel-default panel-large">\n		<div class="panel-heading">\n			<h4 class="panel-title">\n				<div data-toggle="collapse" href="#collapsezapier" style="cursor: pointer;" class="service-header collapsed">\n					<div class="row">\n						<div class="col-sm-12">\n							<i class="arrow micon-arrow-right pull-left"></i>\n							<img src="images/service/zapier.png" class="service-logo pull-left" />\n							<div class="service-tagline">\n								<div class="service-name">Zapier</div>\n								<div class="service-note ellipsis">{{lang.zapier_tagline}}</div>\n							</div>\n						</div>\n					</div>\n				</div>\n			</h4>\n		</div>\n		<div id="collapsezapier" class="panel-collapse collapse">\n			<div class="panel-body" style="border-top: none;">\n				<ul class="steps">\n					<li class="row">\n						<div class="col-sm-12">\n							<div class="size16">\n								{{lang.zapier_summary}}\n							</div>\n							<br />\n							<div class="size16">\n								{{lang.zapier_usage}}\n							</div>\n						</div>\n					</li>\n					<li class="row">\n						<div class="col-sm-12">\n							<div class="size16">\n								<a href="https://zapier.com/zapbook/moxtra/" target="_blank">{{lang.check_available_zaps}}</a>\n							</div>\n						</div>\n					</li>\n				</ul>\n			</div>\n		</div>\n	</div>\n</div>';
}), define("text!template/services/emailService.html", [], function() {
    return '<div class="panel-group">\n	<div class="mx-panel panel panel-default panel-large">\n		<div class="panel-heading">\n			<h4 class="panel-title">\n				<div data-toggle="collapse" href="#collapseemail" style="cursor: pointer;" class="service-header collapsed">\n					<div class="row">\n						<div class="col-sm-12">\n							<i class="arrow micon-arrow-right pull-left"></i>\n							<img src="images/service/email.png" class="service-logo pull-left" />\n							<div class="service-tagline">\n								<div class="service-name">{{lang.email}}</div>\n								<div class="service-note ellipsis">{{lang.email_service_tagline}}</div>\n							</div>\n						</div>\n					</div>\n				</div>\n			</h4>\n		</div>\n		<div id="collapseemail" class="panel-collapse collapse">\n			<div class="panel-body" style="border-top: none;">\n				<ul class="steps">\n					<li class="row">\n						<div class="col-sm-12">\n							<div class="size16">\n								{{lang.email_service_summary}}\n							</div>\n							<br />\n							<div class="size16">\n								{{lang.email_service_usage}}\n							</div>\n							<br />\n							<div class="size16">\n								{{lang.email_service_follow_steps}}\n							</div>\n						</div>\n					</li>\n					<li class="row">\n						<div class="col-sm-2">\n							<b>{{lang.step}} 1</b>\n						</div>\n						<div class="col-sm-10">\n							<div>{{lang.email_service_step1}}</div>\n							<div>\n								<img class="image-small" src="themes/images/services/email/step1.0bf2f376.png" />\n							</div>\n						</div>\n					</li>\n					<li class="row">\n						<div class="col-sm-2">\n							<b>{{lang.step}} 2</b>\n						</div>\n						<div class="col-sm-10">\n							<div>{{lang.email_service_step2}}</div>\n							<div>\n								<img class="image-normal" src="themes/images/services/email/step2.aeff9492.png" />\n							</div>\n						</div>\n					</li>\n					<li class="row">\n						<div class="col-sm-2">\n							<b>{{lang.step}} 3</b>\n						</div>\n						<div class="col-sm-10">\n							<div>{{lang.email_service_step3}}</div>\n							<div>\n								<img class="image-normal" src="themes/images/services/email/step3.e6d580df.png" />\n							</div>\n						</div>\n					</li>\n					<li class="row">\n						<div class="col-sm-2">\n							<b>{{lang.step}} 4</b>\n						</div>\n						<div class="col-sm-10">\n							{{lang.email_service_step4}}\n						</div>\n					</li>\n					<li class="row">\n						<div class="col-sm-2">\n							<b>{{lang.step}} 5</b>\n						</div>\n						<div class="col-sm-10">\n							{{lang.email_service_step5}}\n						</div>\n					</li>\n				</ul>\n			</div>\n		</div>\n	</div>\n</div>\n';
}), define("text!template/services/integration/header.html", [], function() {
    return '<div class="integration-header">\n	<div class="row title">\n		<img src="images/service/{{name}}.png" class="service-logo pull-left" />\n		<div class="pull-left marginLeft15">\n			<div class="name">{{displayName}}</div>\n			<div class="tagline">{{tagline}}</div>\n		</div>\n		<a class="btn btn-link mx-circle pull-right" data-action="exitDetail">{{closeText}}</a>\n	</div>\n\n	<div>\n		<p class="size16">\n			{{bbcode summary}}\n			{{#if usage}}\n				{{bbcode usage}}\n			{{/if}}\n		</p>\n		{{#if auth}}\n		<p class="size16">{{auth}}</p>\n		{{/if}}\n	</div>\n	<hr />\n</div>';
}), define("services/helper", [ "moxtra", "lang" ], function(a, b) {
    "use strict";
    return {
        taglines: {
            github: b.github_tagline,
            hubspot: b.hubspot_tagline,
            zendesk: b.zendesk_tagline,
            jira: b.jira_tagline,
            zoho: b.zoho_tagline,
            salesforce: b.salesforce_tagline,
            quickbooks: b.quickbooks_tagline,
            incoming: b.incoming_tagline,
            crashlytics: b.crashlytics_tagline,
            twitter: b.twitter_tagline,
            trello: b.trello_tagline,
            intercom: b.intercom_tagline,
            appsignal: b.appsignal_tagline,
            mailchimp: b.mailchimp_tagline,
            pivotaltracker: b.pivotaltracker_tagline,
            formstack: b.formstack_tagline,
            yo: b.yo_tagline,
            paypal: b.paypal_tagline,
            supportbee: b.supportbee_tagline,
            chargify: b.chargify_tagline,
            olark: b.olark_tagline,
            opbeat: b.opbeat_tagline,
            datadog: b.datadog_tagline,
            pagerduty: b.pagerduty_tagline,
            chargebee: b.chargebee_tagline,
            raygun: b.raygun_tagline,
            postmark: b.postmark_tagline,
            stripe: b.stripe_tagline,
            netlify: b.netlify_tagline,
            fulcrum: b.fulcrum_tagline,
            librato: b.librato_tagline,
            opsgenie: b.opsgenie_tagline,
            bitbucket: b.bitbucket_tagline
        },
        summaries: {
            github: b.github_summary,
            hubspot: b.hubspot_summary,
            jira: b.jira_summary,
            quickbooks: b.quickbooks_summary,
            salesforce: b.salesforce_summary,
            zendesk: b.zendesk_summary,
            zoho: b.zoho_summary,
            incoming: b.incoming_summary,
            crashlytics: b.crashlytics_summary,
            twitter: b.twitter_summary,
            trello: b.trello_summary,
            intercom: b.intercom_summary,
            appsignal: b.appsignal_summary,
            mailchimp: b.mailchimp_summary,
            pivotaltracker: b.pivotaltracker_summary,
            formstack: b.formstack_summary,
            yo: b.yo_summary,
            paypal: b.paypal_summary,
            supportbee: b.supportbee_summary,
            chargify: b.chargify_summary,
            olark: b.olark_summary,
            opbeat: b.opbeat_summary,
            datadog: b.datadog_summary,
            pagerduty: b.pagerduty_summary,
            chargebee: b.chargebee_summary,
            raygun: b.raygun_summary,
            postmark: b.postmark_summary,
            stripe: b.stripe_summary,
            netlify: b.netlify_summary,
            fulcrum: b.fulcrum_summary,
            librato: b.librato_summary,
            opsgenie: b.opsgenie_summary,
            bitbucket: b.bitbucket_summary
        },
        usages: {
            github: b.github_usage,
            hubspot: b.hubspot_usage,
            quickbooks: b.quickbooks_usage,
            salesforce: b.salesforce_usage,
            jira: b.jira_usage,
            zendesk: b.zendesk_usage,
            zoho: b.zoho_usage
        },
        authNotes: {
            quickbooks: b.authed_integration,
            salesforce: b.authed_integration
        }
    };
}), define("services/header", [ "moxtra", "lang", "text!template/services/integration/header.html", "services/helper" ], function(a, b, c, d) {
    "use strict";
    return a.Controller.extend({
        template: c,
        handlaAction: !0,
        init: function(a) {
            this.service = a.service, this.$scope.lang = b, this.$scope.closeText = a.closeText || b.close, 
            this.$scope.name = this.service.name, this.$scope.displayName = this.service.displayName, 
            this.$scope.tagline = d.taglines[this.service.name] || "", this.$scope.summary = d.summaries[this.service.name] || "", 
            this.$scope.usage = d.usages[this.service.name] || "", this.$scope.auth = d.authNotes[this.service.name] || "";
        },
        rendered: function() {}
    });
}), define("services/listener", [ "moxtra", "lang" ], function(a, b) {
    "use strict";
    return {
        onMessage: function(a) {
            var c, d = function() {}, a = a || {}, e = a.cancel || d, f = a.create || d, g = a.update || d;
            return c = function(a) {
                var c, d = a.data;
                try {
                    c = JSON.parse(d);
                } catch (a) {
                    console.error(a), c = {};
                }
                switch ("alert" === c.from && c.frameHeight && (c.frameHeight += 80, $("#integrationIframe").css({
                    "min-height": c.frameHeight + "px"
                })), c.action) {
                  case "cancel":
                    e();
                    break;

                  case "create":
                    MX.ui.notifySuccess(b.create_service_integration_success), f(c.sequence);
                    break;

                  case "update":
                    MX.ui.notifySuccess(b.update_service_integration_success), g();
                }
            }, "undefined" != typeof window.addEventListener ? window.addEventListener("message", c, !1) : "undefined" != typeof window.attachEvent && window.attachEvent("onmessage", c), 
            c;
        },
        offMessage: function(a) {
            "undefined" != typeof window.addEventListener ? window.removeEventListener("message", a, !1) : "undefined" != typeof window.attachEvent && window.detachEvent("onmessage", a);
        }
    };
}), define("text!template/services/integrationNew.html", [], function() {
    return '<div class="mx-integration-new">\n	\n</div>';
}), define("text!template/services/integration/addInline.html", [], function() {
    return '<div class="new-integration">\n	<ul class="inputs">\n		<li>\n			<div>\n				<b class="size18">{{lang.post_to_binder}}</b>\n			</div>\n			<div class="row">\n				<div class="col-sm-4">\n					<span class="size16 gray">{{lang.new_post_to_binder_note}}</span>\n				</div>\n				<div class="col-sm-8">\n					<div>\n						<button id="binderSelector" data-action="selectBinder" value="{{lang.select_binder}}" class="form-control " type="button">\n							<span class="pull-left ellipsis gray binder-name">{{lang.select_binder}}</span>\n							<span class="micon-arrow-right size16 gray pull-right"></span>\n						</button>\n					</div>\n				</div>\n			</div>\n		</li>\n		<li>\n			<div>\n				<b class="size18">{{lang.action}}</b>\n			</div>\n			<div class="row">\n				<div class="col-sm-4">\n					<span class="size16 gray">{{lang.new_post_as_action_note}}</span>\n				</div>\n				<div class="col-sm-8">\n					<div class="btn-group marginTop15" style="width: 100%;">\n						<button id="actionSelector" type="button" class="form-control pull-left" data-toggle="dropdown" data-postas="chat">\n							<span class="dropmenu-label pull-left current">{{lang.post_as_chat}}</span>\n							<span class="micon-arrow-down size16 gray pull-right"></span>\n						</button>\n						<ul class="dropdown-menu action-menu" role="menu" style="width: 100%;">\n							<li style="padding: 5px 0;">\n								<a class="mouse-hand" data-action="postAs" data-param="chat" style="padding-left: 12px;">{{lang.post_as_chat}}</a>\n							</li>\n							<li style="padding: 5px 0;">\n								<a class="mouse-hand" data-action="postAs" data-param="page" style="padding-left: 12px;">{{lang.post_as_page}}</a>\n							</li>\n							<li style="padding: 5px 0;">\n								<a class="mouse-hand" data-action="postAs" data-param="todo" style="padding-left: 12px;">{{lang.post_as_todo}}</a>\n							</li>\n						</ul>\n					</div>\n				</div>\n			</div>\n		</li>\n\n		{{#if allowCustomize}}\n		<li>\n			<div>\n				<b class="size18">{{lang.service_customize_template}}</b> ({{lang.optional}})\n			</div>\n			<div class="row">\n				<div class="col-sm-4">\n					{{!-- For page, we support HTML format. For todo, we support text format. --}}\n					<span class="customize-template-note size16 gray">{{lang.service_customize_template_chat_note}}</span>\n                    <br>\n                    <span>\n                        <a class="btn-link" data-action="showSample" href="javascript:;">{{lang.service_customize_template_sample}}</a>\n                    </span>\n				</div>\n				<div class="col-sm-8">\n					<textarea id="customizeTemplate" class="customize-template form-control vertResize" rows="3" placeholder="{{lang.service_customize_template}}"></textarea>\n					<textarea id="customizeTemplate2" class="customize-template form-control vertResize marginTop15 hide" rows="3" placeholder="{{lang.service_customize_template}}"></textarea>\n				</div>\n			</div>\n		</li>\n		{{/if}}\n\n		<li {{#unless allowCustomize}}style="border-bottom: none;"{{/unless}}>\n			<div>\n				<b class="size18">{{lang.description}}</b> ({{lang.optional}})\n			</div>\n			<div class="row">\n				<div class="col-sm-4">\n					<span class="size16 gray">{{lang.new_integration_description_note}}</span>\n				</div>\n				<div class="col-sm-8">\n					<input id="description" type="text" class="form-control" placeholder="{{lang.optional_description}}"/>\n				</div>\n			</div>\n		</li>\n\n		{{#if allowCustomize}}\n		<li>\n			<div>\n				<b class="size18">{{lang.service_customize_name}}</b> ({{lang.optional}})\n			</div>\n			<div class="row">\n				<div class="col-sm-4">\n					<span class="size16 gray">{{lang.service_customize_name_note}}</span>\n				</div>\n				<div class="col-sm-8">\n					<input id="customizeName" type="text" class="form-control" placeholder="{{lang.service_customize_name}}"/>\n				</div>\n			</div>\n		</li>\n		<li style="border-bottom: none;">\n			<div class="row">\n				<div class="col-sm-4">\n					<b class="size18">{{lang.service_customize_icon}}</b> ({{lang.optional}})\n				</div>\n				<div class="col-sm-8">\n					<div class="size14 gray paddingTop5">\n						{{lang.size}}: 128 * 128\n					</div>\n				</div>\n			</div>\n			<div class="row">\n				<div class="col-sm-4">\n					<span class="size16 gray">{{lang.service_customize_icon_note}}</span>\n				</div>\n				<div class="col-sm-8">\n					<div class="customize-icon-action">\n						<a id="customizeicon_flash" class="mouse-hand">{{lang.upload}}</a>\n						<a id="removeCustomizeIcon" class="mouse-hand marginLeft10 hide" data-action="removeCustomizeIcon">{{lang.remove}}</a>\n					</div>\n					<div class="customize-icon hide">\n						<img src="" style="width: 128px; height: 128px;"/>\n					</div>\n				</div>\n			</div>\n		</li>\n		{{/if}}\n\n		<li>\n			<div class="row">\n				<div class="col-sm-4"></div>\n				<div class="col-sm-8">\n					<a id="saveIntegration" class="btn btn-primary" data-action="saveIntegration">{{lang.create_integration}}</a>\n				</div>\n			</div>\n		</li>\n	</ul>\n</div>\n';
}), define("text!template/services/integration/addIframe.html", [], function() {
    return '<div class="new-integration">\n	<ul class="inputs">\n		<li style="border-bottom: none;">\n			<div>\n				<b class="size18">{{lang.post_to_binder}}</b>\n			</div>\n			<div class="row">\n				<div class="col-sm-4">\n					<span class="size16 gray">{{lang.new_post_to_binder_note}}</span>\n				</div>\n				<div class="col-sm-8">\n					<div>\n						<button id="binderSelector" data-action="selectBinder" value="{{lang.select_binder}}" class="form-control " type="button">\n							<span class="pull-left ellipsis gray binder-name">{{lang.select_binder}}</span>\n							<span class="micon-arrow-right size16 gray pull-right"></span>\n						</button>\n					</div>\n				</div>\n			</div>\n		</li>\n		<li style="margin-left: -20px; margin-right: -20px;">\n			<div class="integration-iframe hide" style="width: 100%; height: 100%;">\n				<iframe id="integrationIframe" style="width: 100%; height: 100%;min-height: 450px;border:none;" scrolling="auto"></iframe>\n			</div>\n		</li>\n	</ul>\n</div>';
}), define("text!template/services/customTemplate/chatTemplateHelp.html", [], function() {
    return '<div>\n    <p>\n        <b>BBCode example:</b>\n    </p>\n    <p>\n        Zookeeper says there are [b] {{stat.amount.animals}} animals [/b] in the zoo. Everyday [b] {{stat.amount.visitors}} guests [/b] visit the zoo. [style color="red"] Most of the visitors are from [b] {{stat.country[0].name}} [/b] [/style].\n    </p>\n    <p>\n        This will be displayed in the binder as:\n    </p>\n    <p>\n        Zookeeper says there are <b>276 animals</b> in the zoo. Everyday <b>4532 guests</b> visit the zoo. <span style="color: #ff0000;">Most of the visitors are from <strong>Canada.</strong></span>\n    </p>\n\n\n    <p>\n        <b>Plain Text example:</b>\n    </p>\n    <p>\n    Zookeeper says there are {{stat.amount.animals}} animals in the zoo. Everyday {{stat.amount.visitors}} guests visit the zoo. Most of the visitors are from {{stat.country[0].name}}.\n    </p>\n\n    <p>\n        <b>This will be displayed in the binder as:</b>\n    </p>\n\n    <p>\n        Zookeeper says there are 276 animals in the zoo. Everyday 4532 guests visit the zoo. Most of the visitors are from Canada.\n    </p>\n\n</div>\n';
}), define("text!template/services/customTemplate/pageTemplateHelp.html", [], function() {
    return '<div>\n    <p>\n        <b>HTML example:</b>\n    </p>\n    <p>\n        Zookeeper says there are &lt;b&gt; {{stat.amount.animals}} animals &lt;/b&gt; in the zoo. Everyday &lt;b&gt; {{stat.amount.visitors}} guests &lt;/b&gt; visit the zoo. &lt;p style="color:red"&gt; Most of the visitors are from &lt;b&gt; {{stat.country[0].name}} &lt;/b&gt; &lt;/p&gt;.\n\n    </p>\n    <p>\n        <b>This will be displayed in the binder as:</b>\n    </p>\n    <p>\n        Zookeeper says there are <b>276 animals</b> in the zoo. Everyday <b>4532 guests</b> visit the zoo.\n        <br>\n        <span style="color: #ff0000;">Most of the visitors are from <strong>Canada.</strong></span>\n    </p>\n\n\n</div>\n';
}), define("text!template/services/customTemplate/todoTemplateHelp.html", [], function() {
    return "<div>\n    <p>\n        <b>Plain Text example:</b>\n    </p>\n    <p>\n        Zookeeper says there are {{stat.amount.animals}} animals in the zoo. Everyday {{stat.amount.visitors}} guests visit the zoo. Most of the visitors are from {{stat.country[0].name}}.\n    </p>\n    <p>\n        <b>This will be displayed in the binder as:</b>\n    </p>\n    <p>\n        Zookeeper says there are 276 animals in the zoo. Everyday 4532 guests visit the zoo. Most of the visitors are from Canada.\n    </p>\n\n\n</div>\n";
}), define("services/integrationNew", [ "moxtra", "lang", "app", "services/header", "services/listener", "text!template/services/integrationNew.html", "text!template/services/integration/addInline.html", "text!template/services/integration/addIframe.html", "text!template/services/customTemplate/chatTemplateHelp.html", "text!template/services/customTemplate/pageTemplateHelp.html", "text!template/services/customTemplate/todoTemplateHelp.html", "binder/newBinderOptions", "component/selector/binderSelector", "component/uploader/uploader" ], function(a, b, c, d, e, f, g, h, i, j, k, l, m, n) {
    "use strict";
    var o = Handlebars.compile(g), p = Handlebars.compile(h);
    return a.Controller.extend({
        template: f,
        handleAction: !0,
        events: {
            "mouseover #customizeicon_flash": "_refreshUploader"
        },
        init: function(a) {
            this.service = a.service;
        },
        rendered: function() {
            var a = c.request.get("params.binderid"), f = !1, g = this;
            "incoming" === this.service.name && (f = !0), this.recovery(new d({
                closeText: b.cancel,
                renderTo: ".mx-integration-new",
                service: this.service
            })), [ "salesforce", "quickbooks", "trello" ].indexOf(this.service.name) > -1 ? (this.$el.append(p({
                lang: b
            })), this._isIframe = !0, this.msgCallback = e.onMessage({
                cancel: function() {
                    g._updateBinderSelector("");
                },
                create: function(a) {
                    g.trigger("close"), g.trigger("added", g._selectedBinderId + "_" + a), g._offMessage();
                },
                update: function() {
                    g.trigger("close"), g._offMessage();
                }
            }), this.recovery(function() {
                g._offMessage();
            })) : (this.$el.append(o({
                lang: b,
                allowCustomize: f
            })), f && setTimeout(function() {
                g._initUploader(), g.postAs();
            }, 300)), a && setTimeout(function() {
                g._updateBinderSelector(a);
            }, 300);
        },
        selectBinder: function() {
            var a = this;
            new MX.ui.Dialog({
                content: new MX.ui.BinderSelector({
                    title: b.select_binder,
                    buttons: [ {
                        text: b.tool_select,
                        position: "right",
                        className: "btn-primary",
                        click: "chooseBinder"
                    } ],
                    newBinder: function() {
                        var a = this;
                        this.dialog.push(new l({
                            onCreatedBinder: function(b) {
                                setTimeout(function() {
                                    a.setBinder(b);
                                }, 500);
                            }
                        }));
                    },
                    chooseBinder: function() {
                        var a = this.value();
                        this.setBinder(MX.get("0", a));
                    },
                    setBinder: function(b) {
                        a._updateBinderSelector(b), this.dialog.close();
                    }
                })
            });
        },
        postAs: function(a) {
            a = a || "chat";
            var c = {
                chat: b.post_as_chat,
                page: b.post_as_page,
                todo: b.post_as_todo
            }, d = {
                chat: b.service_customize_template_chat_note,
                page: b.service_customize_template_page_note,
                todo: b.service_customize_template_todo_note
            }, e = {
                chat: b.service_customize_chat_text_template,
                page: b.service_customize_template,
                todo: b.service_customize_todo_name_template
            };
            this.$("#customizeTemplate").attr("placeholder", e[a]), this.$("#actionSelector span.current").text(c[a]), 
            this.$("#actionSelector").data("postas", a), this.$(".customize-template-note").text(d[a]), 
            "todo" === a ? this.$("#customizeTemplate2").removeClass("hide").attr("placeholder", b.service_customize_todo_desc_template) : "chat" === a ? this.$("#customizeTemplate2").removeClass("hide").attr("placeholder", b.service_customize_chat_bbcode_template) : this.$("#customizeTemplate2").addClass("hide");
        },
        saveIntegration: function(a) {
            if (a) {
                var c, d = MX.get("board", Moxtra.getUserBoard(a)), e = {}, f = this.$("#description").val(), g = this.$("#actionSelector").data("postas"), h = {}, i = this;
                if (h.picture_url = i.customizeIconPath, h.first_name = $.trim(i.$("#customizeName").val()), 
                d) {
                    e.description = f || "", e.post_as = g;
                    var j = $.trim($("#customizeTemplate").val()), k = $.trim($("#customizeTemplate2").val());
                    if ("chat" === g && !j && k) return void MX.ui.notifyWarning(b.service_customize_chat_bbcode_template_warning);
                    j && (e.customize_template = j), "chat" !== g && "todo" !== g || !k || (e.customize_template2 = k), 
                    c = new Moxtra.model.BoardViewToken(), c.set("note", JSON.stringify(e)), c.createIntegration(d, i.service, h).success(function(c) {
                        MX.ui.notifySuccess(b.create_service_integration_success), i.$("#binderSelector .binder-name").addClass("gray").text(b.select_binder), 
                        i.$("#saveIntegration").data("param", ""), i.$("#description").val(""), i.trigger("close");
                        var d, e = MX.get("object.board.view_tokens.0.sequence", c);
                        d = a + "_" + e, i.trigger("added", d);
                    }).error(function() {
                        MX.ui.notifyError(b.create_service_integration_failed);
                    });
                }
            } else MX.ui.notifyWarning(b.select_one_binder), this.$("#binderSelector").addClass("has-error");
        },
        exitDetail: function() {
            this.trigger("close"), this._offMessage();
        },
        removeCustomizeIcon: function() {
            this.customizeIconPath = "", this.$("#removeCustomizeIcon").addClass("hide"), this.$(".customize-icon").addClass("hide"), 
            this.$(".customize-icon img").attr("src", "");
        },
        _initUploader: function() {
            var a = this;
            n.register("customizeIcon", {
                browse_button: "customizeicon_flash",
                filters: {
                    mime_types: [ {
                        title: b.image_files,
                        extensions: "jpeg,jpg,gif,png"
                    } ]
                },
                showNotification: !0,
                multi_selection: !1,
                url: function() {
                    return "/board/" + a._selectedBinderId + "/customizeicon?type=avatar&width=128&height=128";
                },
                beforeUpload: function(c, d) {
                    if (a._selectedBinderId) d(); else {
                        MX.ui.notifyWarning(b.select_one_binder);
                        var e = this;
                        MX.each(c, function(a) {
                            e.uploader.removeFile(a), e.collection.remove(a.id);
                        });
                    }
                },
                success: function(b, c) {
                    var d = JSON.parse(c.response);
                    if (d && d.object && d.object.board && d.object.board.resources) {
                        var e = d.object.board.resources[0] || {};
                        a.customizeIconPath = [ "/board", a._selectedBinderId, e.sequence ].join("/"), a.$(".customize-icon img").attr("src", a.customizeIconPath), 
                        a.$(".customize-icon").removeClass("hide"), a.$("#removeCustomizeIcon").removeClass("hide");
                    }
                    n.refresh("customizeIcon", a.$("#customizeicon_flash"));
                },
                error: function() {
                    n.refresh("customizeIcon", a.$("#customizeicon_flash"));
                }
            });
        },
        _refreshUploader: function() {
            setTimeout(function() {
                n.refresh("customizeIcon", $("#customizeicon_flash"));
            }, 100);
        },
        _updateBinderSelector: function(a) {
            this.$("#binderSelector").removeClass("has-error"), this._selectedBinderId = a;
            var c = MX.get("board", Moxtra.getUserBoard(a));
            c ? (this.$("#binderSelector .binder-name").removeClass("gray").text(c.name), this._isIframe ? (this.$(".integration-iframe").removeClass("hide"), 
            this.$("#integrationIframe").attr("src", MX.format("/alert/#create?service={0}&binder_id={1}", this.service.name, a))) : this.$("#saveIntegration").data("param", a)) : (this.$("#binderSelector .binder-name").addClass("gray").text(b.select_binder), 
            this._isIframe ? (this.$(".integration-iframe").addClass("hide"), this.$("#integrationIframe").attr("src", "")) : this.$("#saveIntegration").data("param", ""));
        },
        _offMessage: function() {
            this.msgCallback && e.offMessage(this.msgCallback);
        },
        showSample: function() {
            var a = {
                chat: i,
                page: j,
                todo: k
            }, c = this.$("#actionSelector").data("postas");
            new MX.ui.Dialog({
                width: 850,
                content: a[c],
                buttons: [ {
                    position: "right",
                    text: b.close,
                    click: function() {
                        this.close();
                    }
                } ]
            });
        }
    });
}), define("text!template/services/integrationView.html", [], function() {
    return '<div class="mx-integration-view">\n	\n</div>';
}), define("text!template/services/integration/detail.html", [], function() {
    return '<div class="integration-detail">\n	<div class="integration-infos">\n		<ul class="infos">\n			<li>\n				<div>\n					<b class="size18">{{lang.post_to_binder}}</b>\n				</div>\n				<div class="row">\n					<div class="col-sm-4">\n						<span class="size16 gray">{{lang.view_post_to_binder_note}}</span>\n					</div>\n					<div class="col-sm-8">\n						<input type="text" class="form-control readyonly" readonly="readonly" value="{{binder.name}}" />\n					</div>\n				</div>\n			</li>\n			{{#if integration.post_as}}\n			<li>\n				<b class="size18">{{lang.action}}</b>\n				<div class="row">\n					<div class="col-sm-4">\n						<span class="size16 gray">{{lang.view_post_as_action_note}}</span>\n					</div>\n					<div class="col-sm-8">\n						<input type="text" class="form-control readyonly" readonly="readonly" value="{{formatPostAs integration.post_as}}" />\n					</div>\n				</div>\n			</li>\n			{{/if}}\n			{{#ifCond integration.customize_template \'||\' integration.customize_template2}}\n			<li>\n				<div>\n					<b class="size18">{{lang.service_customize_template}}</b> ({{lang.optional}})\n				</div>\n				<div class="row">\n					<div class="col-sm-4">\n						{{!-- For page, we support HTML format. For todo, we support text format. --}}\n						<span class="customize-template-note size16 gray">{{formatServiceCustomizeTemplate integration.post_as}}</span>\n					</div>\n					<div class="col-sm-8">\n						<textarea class="customize-template form-control vertResize" rows="3" readonly="readonly">{{integration.customize_template}}</textarea>\n						{{#if integration.customize_template2}}\n						<textarea class="customize-template form-control vertResize marginTop15" rows="3" readonly="readonly">{{integration.customize_template2}}</textarea>\n						{{/if}}\n					</div>\n				</div>\n			</li>\n			{{/ifCond}}\n			<li>\n				<div>\n					<b class="size18">{{lang.description}}</b> ({{lang.optional}})\n				</div>\n				<div class="row">\n					<div class="col-sm-4">\n						<span class="size16 gray">{{lang.view_integration_description_note}}</span>\n					</div>\n					<div class="col-sm-8">\n						<input type="text" class="form-control readyonly" readonly="readonly" value="{{integration.description}}" />\n					</div>\n				</div>\n			</li>\n			{{#if showWebhookLink}}\n			<li>\n				<div>\n					<b class="size18">{{lang.webhook_url}}</b>\n				</div>\n				<div class="row">\n					<div class="col-sm-4">\n						<span class="size16 gray">{{formatServiceName displayName lang.view_webhook_url_note}}</span>\n					</div>\n					<div class="col-sm-8">\n						<input type="text" class="form-control readyonly" readonly="readonly" value="{{link}}" />\n						<div class="marginTop8"><a class="btn btn-sm btn-default pull-right" id="copyWebhookLink">{{lang.copy}}</a></div>\n					</div>\n				</div>\n			</li>\n			{{/if}}\n			{{#if integration.actor_file_as.first_name}}\n			<li>\n				<div>\n					<b class="size18">{{lang.service_customize_name}}</b> ({{lang.optional}})\n				</div>\n				<div class="row">\n					<div class="col-sm-4">\n						<span class="size16 gray">{{lang.service_customize_name_note}}</span>\n					</div>\n					<div class="col-sm-8">\n						<input type="text" class="form-control" readonly="readonly" value="{{integration.actor_file_as.first_name}}"/>\n					</div>\n				</div>\n			</li>\n			{{/if}}\n			{{#if integration.actor_file_as.picture_url}}\n			<li style="border-bottom: none;">\n				<div class="row">\n					<div class="col-sm-4">\n						<b class="size18">{{lang.service_customize_icon}}</b> ({{lang.optional}})\n					</div>\n					<div class="col-sm-8">\n						<div class="size14 gray paddingTop5">\n							{{lang.size}}: 128 * 128\n						</div>\n					</div>\n				</div>\n				<div class="row">\n					<div class="col-sm-4">\n						<span class="size16 gray">{{lang.service_customize_icon_note}}</span>\n					</div>\n					<div class="col-sm-8">\n						<div class="customize-icon">\n							<img src="{{integration.actor_file_as.picture_url}}" style="width: 128px; height: 128px;"/>\n						</div>\n					</div>\n				</div>\n			</li>\n			{{/if}}\n			<li>\n				<div class="row">\n					<div class="col-sm-4"></div>\n					<div class="col-sm-8">\n						<a class="btn btn-default btn-delete pull-right" data-action="removeIntegration" data-param="{{binder.id}}">{{lang.delete}}</a>\n						{{#if editable}}\n						<a class="btn btn-primary pull-right marginRight10" data-action="edit" id="editIntegration">{{lang.edit}}</a>\n						{{/if}}\n					</div>\n				</div>\n			</li>\n		</ul>\n\n\n		<div class="integration-iframe hide" style="width: 100%; height: 100%;">\n			<br />\n			<iframe id="integrationIframe" style="width: 100%; height: 100%; min-height: 450px;border:none;" scrolling="auto"></iframe>\n		</div>\n	</div>\n	{{#if showInstructions}}\n	<div class="integration-instructions">\n		<div class="instructions-setup row {{#if expandInstruction}}active{{/if}}" data-action="toggleInstructions">\n			<div class="col-sm-10">\n				<div class="instructions-title">{{lang.setup_instructions}}</div>\n				<div class="instructions-tagline">\n					{{formatServiceName displayName lang.follow_steps_to_add_integration}}\n				</div>\n			</div>\n			<div class="col-sm-2">\n				<span class="pull-right gray toggle-icon">\n					<i class="micon-arrow-right size20"></i>\n					<i class="micon-arrow-down size20"></i>\n				</span>\n			</div>\n		</div>\n		<div class="instructions-steps {{#unless expandInstruction}}hide{{/unless}}">\n\n		</div>\n	</div>\n	{{/if}}\n</div>';
}), define("text!template/services/instructions/github.html", [], function() {
    return '<ul class="steps">\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 1</b>\n		</div>\n		<div class="col-sm-10">\n			{{lang.github_step1}}\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 2</b>\n		</div>\n		<div class="col-sm-10">\n			<div>{{lang.github_step2}}</div>\n			<div>\n				<!-- <img src="themes/images/services/github/step2.19e43de3.png" style="width: 150px;"/> -->\n				<img class="image-small" {{imgSrcL10n \'themes/images/services/github/step2.19e43de3.png\'}} />\n			</div>\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 3</b>\n		</div>\n		<div class="col-sm-10">\n			<div>{{lang.github_step3}}</div>\n			<div>\n				<img class="image-small" src="themes/images/services/github/step3.8953b503.png" />\n			</div>\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 4</b>\n		</div>\n		<div class="col-sm-10">\n			<div>{{lang.github_step4}}</div>\n			<div>\n				<img class="image-extra-large" src="themes/images/services/github/step4.9a8f78a1.png" />\n			</div>\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 5</b>\n		</div>\n		<div class="col-sm-10">\n			<div>{{lang.github_step5}}</div>\n			<div class="webhook-url">\n				<h5>{{lang.webhook_url}}</h5>\n				<div class="url-link">{{link}}</div>\n			</div>\n			<div>\n				<img class="image-extra-large" src="themes/images/services/github/step5.f8d48759.png" />\n			</div>\n			<div>\n				<br />\n				<ul>\n					<li class="list-style">{{formatWebhookUrl lang.github_step5_1 link}}</li>\n					<li class="list-style">{{lang.github_step5_2}}</li>\n					<li class="list-style">{{lang.github_step5_3}}</li>\n					<li class="list-style">{{lang.github_step5_4}}</li>\n					<li class="list-style">{{lang.github_step5_5}}</li>\n				</ul>\n			</div>\n		</div>\n	</li>\n</ul>\n';
}), define("text!template/services/instructions/hubspot.html", [], function() {
    return '<h4>{{lang.hubspot_steps_title}}</h4>\n<ul class="steps">\n	<li class="list-style">{{lang.hubspot_steps_1}}</li>\n	<li class="list-style">{{lang.hubspot_steps_2}}</li>\n</ul>\n<h5>{{lang.hubspot_steps_1_title}}</h5>\n<ul class="steps">\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 1</b>\n		</div>\n		<div class="col-sm-10">\n			<div>{{lang.hubspot_steps_1_step1}}</div>\n			<div>\n				<img class="image-normal" src="themes/images/services/hubspot/step1_1.5a9d3fe6.png" />\n			</div>\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 2</b>\n		</div>\n		<div class="col-sm-10">\n			<div>{{lang.hubspot_steps_1_step2}}</div>\n			<div>\n				<img class="image-extra-large" src="themes/images/services/hubspot/step1_2.a6cfbe82.png" />\n			</div>\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 3</b>\n		</div>\n		<div class="col-sm-10">\n			<div>{{lang.hubspot_steps_1_step3}}</div>\n			<div>\n				<img class="image-normal" src="themes/images/services/hubspot/step1_3.b6d60d31.png" />\n			</div>\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 4</b>\n		</div>\n		<div class="col-sm-10">\n			{{lang.hubspot_steps_1_step4}}\n		</div>\n	</li>\n</ul>\n<h5>{{lang.hubspot_steps_2_title}}</h5>\n<ul class="steps">\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 1</b>\n		</div>\n		<div class="col-sm-10">\n			{{lang.hubspot_steps_2_step1}}\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 2</b>\n		</div>\n		<div class="col-sm-10">\n			{{lang.hubspot_steps_2_step2}}\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 3</b>\n		</div>\n		<div class="col-sm-10">\n			{{lang.hubspot_steps_2_step3}}\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 4</b>\n		</div>\n		<div class="col-sm-10">\n			<div>{{lang.hubspot_steps_2_step4}}</div>\n			<div class="webhook-url">\n				<h5>{{lang.webhook_url}}</h5>\n				<div class="url-link">{{link}}</div>\n			</div>\n			<div>\n				<img class="image-extra-large" src="themes/images/services/hubspot/step2_4.590b8021.png" />\n			</div>\n		</div>\n	</li>\n</ul>\n';
}), define("text!template/services/instructions/jira.html", [], function() {
    return '<ul class="steps">\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 1</b>\n		</div>\n		<div class="col-sm-10">\n			<div>\n				{{lang.jira_step1}}\n			</div>\n			<div>\n				<img class="image-normal" src="themes/images/services/jira/step1.831e26f3.png" />\n			</div>\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 2</b>\n		</div>\n		<div class="col-sm-10">\n			<div>\n				{{lang.jira_step2}}\n			</div>\n			<div>\n				<img class="image-normal" src="themes/images/services/jira/step2.30d2a494.png" />\n			</div>\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 3</b>\n		</div>\n		<div class="col-sm-10">\n			<div>\n				{{lang.jira_step3}}\n			</div>\n			<div class="webhook-url">\n				<h5>{{lang.webhook_url}}</h5>\n				<div class="url-link">{{link}}</div>\n			</div>\n			<div>\n				<img class="image-large" src="themes/images/services/jira/step3.bd42b61b.png" />\n			</div>\n		</div>\n	</li>\n</ul>\n';
}), define("text!template/services/instructions/zendesk.html", [], function() {
    return '<ul class="steps">\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 1</b>\n		</div>\n		<div class="col-sm-10">\n			{{lang.zendesk_step1}}\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 2</b>\n		</div>\n		<div class="col-sm-10">\n			<div>\n				{{lang.zendesk_step2}}\n			</div>\n			<div>\n				<img class="image-normal" src="themes/images/services/zendesk/step2.562a5f4e.png" />\n			</div>\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 3</b>\n		</div>\n		<div class="col-sm-10">\n			<div>\n				{{lang.zendesk_step3}}\n			</div>\n			<div>\n				<img class="image-extra-large" src="themes/images/services/zendesk/step3.308bbbb7.png" />\n			</div>\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 4</b>\n		</div>\n		<div class="col-sm-10">\n			<div>\n				{{lang.zendesk_step4}}\n			</div>\n			<div class="webhook-url">\n				<h5>{{lang.webhook_url}}</h5>\n				<div class="url-link">{{link}}</div>\n			</div>\n			<div>\n				<img class="image-extra-large" src="themes/images/services/zendesk/step4.0674b4d0.png" />\n			</div>\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 5</b>\n		</div>\n		<div class="col-sm-10">\n			{{lang.zendesk_step5}}\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 6</b>\n		</div>\n		<div class="col-sm-10">\n			{{formatWebhookUrl lang.zendesk_step6 link}}\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 7</b>\n		</div>\n		<div class="col-sm-10">\n			{{lang.zendesk_step7}}\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 8</b>\n		</div>\n		<div class="col-sm-10">\n			{{lang.zendesk_step8}}\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 9</b>\n		</div>\n		<div class="col-sm-10">\n			{{lang.zendesk_step9}}\n		</div>\n	</li>\n</ul>\n<h4>{{lang.zendesk_example_title}}</h4>\n<ul class="steps">\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 1</b>\n		</div>\n		<div class="col-sm-10">\n			<div>\n				{{lang.zendesk_example_step1}}\n			</div>\n			<div>\n				<img class="image-normal" src="themes/images/services/zendesk/trigger1.b86f9a4d.png" />\n			</div>\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 2</b>\n		</div>\n		<div class="col-sm-10">\n			<div>\n				{{lang.zendesk_example_step2}}\n			</div>\n			<div>\n				<img class="image-extra-large" src="themes/images/services/zendesk/trigger2.401cc149.png" />\n			</div>\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 3</b>\n		</div>\n		<div class="col-sm-10">\n			{{lang.zendesk_example_step3}}\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 4</b>\n		</div>\n		<div class="col-sm-10">\n			{{lang.zendesk_example_step4}}\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 5</b>\n		</div>\n		<div class="col-sm-10">\n			{{lang.zendesk_example_step5}}\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 6</b>\n		</div>\n		<div class="col-sm-10">\n			{{lang.zendesk_example_step6}}\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 7</b>\n		</div>\n		<div class="col-sm-10">\n			<div>\n				{{lang.zendesk_example_step7}}\n			</div>\n			<div>\n				<img class="image-extra-large" src="themes/images/services/zendesk/trigger7.f8528c7d.png" />\n			</div>\n		</div>\n	</li>\n</ul>\n';
}), define("text!template/services/instructions/zoho.html", [], function() {
    return '<h4>{{lang.zoho_steps_title}}</h4>\n<ul class="steps">\n	<li class="list-style">{{lang.zoho_steps_1}}</li>\n	<li class="list-style">{{lang.zoho_steps_2}}</li>\n	<li class="list-style">{{lang.zoho_steps_3}}</li>\n</ul>\n<h5>{{lang.zoho_steps_1_title}}</h5>\n<ul class="steps">\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 1</b>\n		</div>\n		<div class="col-sm-10">\n			{{lang.zoho_steps_1_step1}}\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 2</b>\n		</div>\n		<div class="col-sm-10">\n			{{lang.zoho_steps_1_step2}}\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 3</b>\n		</div>\n		<div class="col-sm-10">\n			{{lang.zoho_steps_1_step3}}\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 4</b>\n		</div>\n		<div class="col-sm-10">\n			<div>{{lang.zoho_steps_1_step4}}</div>\n			<div class="webhook-url">\n				<h5>{{lang.webhook_url}}</h5>\n				<div class="url-link">{{link}}</div>\n			</div>\n			<div>\n				<img class="image-large" src="themes/images/services/zoho/create.9b8c925c.png" />\n			</div>\n		</div>\n	</li>\n</ul>\n<h5>{{lang.zoho_steps_2_title}}</h5>\n<ul class="steps">\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 1</b>\n		</div>\n		<div class="col-sm-10">\n			{{lang.zoho_steps_2_step1}}\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 2</b>\n		</div>\n		<div class="col-sm-10">\n			{{lang.zoho_steps_2_step2}}\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 3</b>\n		</div>\n		<div class="col-sm-10">\n			{{lang.zoho_steps_2_step3}}\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 4</b>\n		</div>\n		<div class="col-sm-10">\n			{{lang.zoho_steps_2_step4}}\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 5</b>\n		</div>\n		<div class="col-sm-10">\n			<div>{{lang.zoho_steps_2_step5}}</div>\n			<div>\n				<img class="image-large" src="themes/images/services/zoho/associate.f052d842.png" />\n			</div>\n		</div>\n	</li>\n</ul>\n<h5>{{lang.zoho_steps_3_title}}</h5>\n<ul class="steps">\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 1</b>\n		</div>\n		<div class="col-sm-10">\n			{{lang.zoho_steps_3_step1}}\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 2</b>\n		</div>\n		<div class="col-sm-10">\n			{{lang.zoho_steps_3_step2}}\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 3</b>\n		</div>\n		<div class="col-sm-10">\n			{{lang.zoho_steps_3_step3}}\n		</div>\n	</li>\n	<li class="row">\n		<div class="col-sm-2">\n			<b>{{lang.step}} 4</b>\n		</div>\n		<div class="col-sm-10">\n			{{lang.zoho_steps_3_step4}}\n		</div>\n	</li>\n</ul>\n';
}), define("text!template/services/instructions/incomingWebhooks.html", [], function() {
    return '<ul class="steps">\n\n    <li class="row">\n\n        <div class="cov>sm-12">\n            <div class="webhook-url">\n                <h5>{{lang.webhook_url}}</h5>\n                <div class="url-link">{{link}}</div>\n            </div>\n        </div>\n\n    </li>\n\n    <li class="row">\n\n        <div class="col-sm-12">\n            <h4>{{lang.incoming_sending_message}}</h4>\n            <div class="incoming-instructions">\n                <p>{{lang.incoming_option1}}</p>\n                <p class="indent">{{bbcode lang.incoming_option1_desc}}</p>\n                <p class="indent">Content-Type: application/x-www-form-urlencoded</p>\n                <p class="indent">{{lang.incoming_message_sample}}</p>\n                <p class="indent">payload="This is a line of text in a binder.\\nAnd this is another line of text."</p>\n\n                <p>{{lang.incoming_option2}}</p>\n                <p class="indent">{{lang.incoming_option2_desc}} </p>\n                <p class="indent">{{bbcode lang.incoming_message_requirement}}</p>\n                <p class="indent">Content-Type: application/json</p>\n                <p class="indent">{{lang.incoming_message_sample}}</p>\n                <p class="indent">{"text": "This is a line of text in a binder.\\nAnd this is another line of text."}</p>\n            </div>\n        </div>\n\n    </li>\n</ul>\n\n\n\n';
}), define("text!template/services/instructions/crashlytics.html", [], function() {
    return '\n<div class="crashlytics-instructions">\n    <p>\n        {{lang.crashlytics_steps_to_add}}\n    </p>\n    <p> {{formatWebhookUrl lang.crashlytics_follow_the_url_instructions link}} </p>\n</div>\n';
}), define("text!template/services/instructions/intercom.html", [], function() {
    return '<ul class="steps">\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 1</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.intercom_step1}}</p>\n            <div>\n                <img class="image-small" src="themes/images/services/intercom/step1.52c8f6bb.png" />\n            </div>\n        </div>\n\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 2</b>\n        </div>\n        <div class="col-sm-10">\n            <div><p>{{ bbcode lang.intercom_step2}}</p></div>\n            <div>\n                <img class="image-extra-large" src="themes/images/services/intercom/step2.3d12fd33.png" />\n            </div>\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 3</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{formatWebhookUrl lang.intercom_step3_sub1 link}}</p>\n            <ul>\n                <li>1) {{lang.intercom_step3_note1}}</li>\n                <li>2) {{lang.intercom_step3_note2}}</li>\n                <li>3) {{lang.intercom_step3_note3}}</li>\n                <li>4) {{lang.intercom_step3_note4}}</li>\n            </ul>\n            <br>\n            <div>\n                <img class="image-extra-large" src="themes/images/services/intercom/step3.303e09e0.png" />\n            </div>\n            <div>\n                <br>\n                <p>{{bbcode lang.intercom_step3_sub2}}</p>\n            </div>\n\n            <div>\n                <p>{{bbcode lang.intercom_step3_sub3}}</p>\n            </div>\n        </div>\n    </li>\n\n\n</ul>\n';
}), define("text!template/services/instructions/appsignal.html", [], function() {
    return '<ul class="steps">\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 1</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.appsignal_step1}}</p>\n\n        </div>\n\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 2</b>\n        </div>\n        <div class="col-sm-10">\n            <div><p>{{ formatWebhookUrl lang.appsignal_step2 link}}</p></div>\n            <div>\n                <img class="image-extra-large" src="themes/images/services/appsignal/step2.a39dab35.png" />\n            </div>\n        </div>\n    </li>\n\n\n</ul>\n';
}), define("text!template/services/instructions/mailchimp.html", [], function() {
    return '<ul class="steps">\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 1</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.mailchimp_step1}}</p>\n            <div>\n                <img class="image-extra-large" src="themes/images/services/mailchimp/step1.2a625c7b.png" />\n            </div>\n        </div>\n\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 2</b>\n        </div>\n        <div class="col-sm-10">\n            <div><p>{{ bbcode lang.mailchimp_step2}}</p></div>\n            <div>\n                <img class="image-extra-large" src="themes/images/services/mailchimp/step2.758b65ab.png" />\n            </div>\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 3</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{ bbcode lang.mailchimp_step3}}</p>\n\n            <div>\n                <img class="image-extra-large" src="themes/images/services/mailchimp/step3.463d6259.png" />\n            </div>\n\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 4</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{ formatWebhookUrl lang.mailchimp_step4 link}}</p>\n\n            <div>\n                <img class="image-large" src="themes/images/services/mailchimp/step4.d29da329.png" />\n            </div>\n\n        </div>\n    </li>\n\n</ul>\n';
}), define("text!template/services/instructions/formstack.html", [], function() {
    return '<ul class="steps">\n    <p class="row">{{lang.formstack_title}}</p>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 1</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.formstack_step1}}</p>\n            <div>\n                <img class="image-extra-large" src="themes/images/services/formstack/step1.a16b7bc4.png" />\n            </div>\n        </div>\n\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 2</b>\n        </div>\n        <div class="col-sm-10">\n            <div><p>{{ bbcode lang.formstack_step2}}</p></div>\n\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 3</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.formstack_step3}}</p>\n\n            <div>\n                <img class="image-extra-large" src="themes/images/services/formstack/step3.267164eb.png" />\n            </div>\n\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 4</b>\n        </div>\n        <div class="col-sm-10">\n            <p>\n                <ul >\n                    <li style="list-style: circle">{{ bbcode lang.formstack_step4_sub1}}</li>\n                    <li style="list-style: circle">{{ formatWebhookUrl lang.formstack_step4_sub2 link}}</li>\n                    <li style="list-style: circle">{{ bbcode lang.formstack_step4_sub3}}</li>\n                </ul>\n\n            </p>\n\n            <div>\n                <img class="image-large" src="themes/images/services/formstack/step4.a9781331.png" />\n            </div>\n\n        </div>\n    </li>\n\n</ul>\n';
}), define("text!template/services/instructions/pivotaltracker.html", [], function() {
    return '<ul class="steps">\n\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 1</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.pivotaltracker_step1}}</p>\n            <div>\n                <img class="image-normal" src="themes/images/services/pivotaltracker/step1.84a7a2bb.png" />\n            </div>\n        </div>\n\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 2</b>\n        </div>\n        <div class="col-sm-10">\n            <div><p>{{ bbcode lang.pivotaltracker_step2}}</p></div>\n\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 3</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{ formatWebhookUrl lang.pivotaltracker_step3 link}}</p>\n\n            <div>\n                <img class="image-large" src="themes/images/services/pivotaltracker/step3.8e5c5728.png" />\n            </div>\n            <br>\n            <br>\n            <p>\n                {{ lang.pivotaltracker_tips}}\n            </p>\n        </div>\n\n    </li>\n\n\n</ul>\n';
}), define("text!template/services/instructions/yo.html", [], function() {
    return '<ul class="steps">\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 1</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.yo_step1}}</p>\n\n        </div>\n\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 2</b>\n        </div>\n        <div class="col-sm-10">\n            <div><p>{{ formatWebhookUrl lang.yo_step2_sub1 link}}</p></div>\n            <div>\n                <img class="image-large" src="themes/images/services/yo/step2.1dcae108.png" />\n            </div>\n            <br>\n            <div><p>{{ bbcode lang.yo_step2_sub2}}</p></div>\n        </div>\n    </li>\n\n\n</ul>\n';
}), define("text!template/services/instructions/paypal.html", [], function() {
    return '<ul class="steps">\n        <p class="row">{{bbcode lang.paypal_note}}</p>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 1</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.paypal_step1}}</p>\n            <div>\n                <img class="image-small" src="themes/images/services/paypal/step1.ca61b34a.png" />\n            </div>\n        </div>\n\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 2</b>\n        </div>\n        <div class="col-sm-10">\n            <div><p>{{ bbcode lang.paypal_step2}}</p></div>\n            <div>\n                <img class="image-small" src="themes/images/services/paypal/step2.6776f3dd.png" />\n            </div>\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 3</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.paypal_step3}}</p>\n\n            <div>\n                <img class="image-extra-large" src="themes/images/services/paypal/step3.cc736498.png" />\n            </div>\n\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 4</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.paypal_step4}}</p>\n\n            <div>\n                <img  class="image-extra-large" src="themes/images/services/paypal/step4.3b008558.png" />\n            </div>\n\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 5</b>\n        </div>\n        <div class="col-sm-10">\n            <p>\n                {{bbcode lang.paypal_step5_sub1}}\n            </p>\n            <p>\n            <ul >\n                <li style="list-style: circle">{{formatWebhookUrl lang.paypal_step5_sub2 link}}</li>\n                <li style="list-style: circle">{{bbcode lang.paypal_step5_sub3}}</li>\n                <li style="list-style: circle">{{bbcode lang.paypal_step5_sub4}}</li>\n            </ul>\n\n            </p>\n\n            <div>\n                <img class="image-extra-large" src="themes/images/services/paypal/step5.0bd60235.png" />\n            </div>\n\n        </div>\n    </li>\n\n</ul>\n';
}), define("text!template/services/instructions/supportbee.html", [], function() {
    return '<ul class="steps">\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 1</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.supportbee_step1}}</p>\n            <div>\n                <img class="image-large" src="themes/images/services/supportbee/step1.e14acc73.png" />\n            </div>\n        </div>\n\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 2</b>\n        </div>\n        <div class="col-sm-10">\n            <div><p>{{ bbcode lang.supportbee_step2}}</p></div>\n            <div>\n                <img class="image-small" src="themes/images/services/supportbee/step2.8f05385a.png" />\n            </div>\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 3</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{ bbcode lang.supportbee_step3}}</p>\n\n            <div>\n                <img class="image-normal" src="themes/images/services/supportbee/step3.a178b4bc.png" />\n            </div>\n\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 4</b>\n        </div>\n        <div class="col-sm-10">\n            <p>\n                {{ formatWebhookUrl lang.supportbee_step4_sub1 link}}\n                <br>\n                {{ bbcode lang.supportbee_step4_sub2}}\n            </p>\n\n            <div>\n                <img class="image-normal" src="themes/images/services/supportbee/step4.7ce6b59b.png" />\n            </div>\n\n        </div>\n    </li>\n\n</ul>\n';
}), define("text!template/services/instructions/chargify.html", [], function() {
    return '<ul class="steps">\n\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 1</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.chargify_step1}}</p>\n            <div>\n                <img class="image-small" src="themes/images/services/chargify/step1.b330acb0.png" />\n            </div>\n        </div>\n\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 2</b>\n        </div>\n        <div class="col-sm-10">\n            <div><p>{{ bbcode lang.chargify_step2}}</p></div>\n            <div>\n                <img class="image-extra-large" src="themes/images/services/chargify/step2.4a951bb3.png" />\n            </div>\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 3</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.chargify_step3}}</p>\n\n            <div>\n                <img class="image-extra-large" src="themes/images/services/chargify/step3.650610c9.png" />\n            </div>\n\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 4</b>\n        </div>\n        <div class="col-sm-10">\n            <p>\n            <ul >\n                <li style="list-style: circle">{{ bbcode lang.chargify_step4_sub1}}</li>\n                <li style="list-style: circle">{{ bbcode lang.chargify_step4_sub2}}</li>\n                <li style="list-style: circle">{{ formatWebhookUrl lang.chargify_step4_sub3 link}}</li>\n            </ul>\n\n            </p>\n\n            <div>\n                <img class="image-normal" src="themes/images/services/chargify/step4.2c4bcf33.png" />\n            </div>\n            <br>\n            <p>\n                {{ bbcode lang.chargify_step4_sub4}}\n            </p>\n        </div>\n    </li>\n\n</ul>\n';
}), define("text!template/services/instructions/olark.html", [], function() {
    return '<ul class="steps">\n\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 1</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.olark_step1}}</p>\n            <div>\n                <img class="image-extra-large" src="themes/images/services/olark/step1.bc7f459f.png" />\n            </div>\n        </div>\n\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 2</b>\n        </div>\n        <div class="col-sm-10">\n            <div><p>{{ bbcode lang.olark_step2}}</p></div>\n            <div>\n                <img  class="image-small" src="themes/images/services/olark/step2.1ef16b8c.png" />\n            </div>\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 3</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.olark_step3}}</p>\n\n            <div>\n                <img class="image-large" src="themes/images/services/olark/step3.8cb5b48a.png" />\n            </div>\n\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 4</b>\n        </div>\n        <div class="col-sm-10">\n            <p>\n            <ul >\n                <li style="list-style: circle">{{ formatWebhookUrl lang.olark_step4_sub1 link}}</li>\n                <li style="list-style: circle">{{ bbcode lang.olark_step4_sub2}}</li>\n                <li style="list-style: circle">{{ bbcode lang.olark_step4_sub3}}</li>\n            </ul>\n\n            </p>\n\n            <div>\n                <img class="image-extra-large" src="themes/images/services/olark/step4.29e6d542.png" />\n            </div>\n            <br>\n\n        </div>\n    </li>\n\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 5</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.olark_step5}}</p>\n\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{bbcode lang.olark_note}}</b>\n        </div>\n        <div class="col-sm-10">\n            <ul >\n                <li style="list-style: circle">{{ bbcode lang.olark_note1}}</li>\n                <li style="list-style: circle">{{ bbcode lang.olark_note2}}</li>\n            </ul>\n\n        </div>\n    </li>\n\n</ul>\n';
}), define("text!template/services/instructions/opbeat.html", [], function() {
    return '<ul class="steps">\n\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 1</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.opbeat_step1}}</p>\n            <div>\n                <img class="image-small" src="themes/images/services/opbeat/step1.7fb3fd18.png" />\n            </div>\n        </div>\n\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 2</b>\n        </div>\n        <div class="col-sm-10">\n            <p>\n            <ul >\n                <li style="list-style: circle">{{ bbcode lang.opbeat_step2_sub1}}</li>\n                <li style="list-style: circle">{{ formatWebhookUrl lang.opbeat_step2_sub2 link}}</li>\n            </ul>\n\n            </p>\n            <div>\n                <img class="image-normal" src="themes/images/services/opbeat/step2.93b98073.png" />\n            </div>\n            <br>\n            <p>\n                {{ bbcode lang.opbeat_step2_sub3}}\n            </p>\n        </div>\n    </li>\n\n\n</ul>\n';
}), define("text!template/services/instructions/datadog.html", [], function() {
    return '<ul class="steps">\n\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 1</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.datadog_step1}}</p>\n            <div>\n                <img class="image-normal" src="themes/images/services/datadog/step1.9d2f15a4.png" />\n            </div>\n        </div>\n\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 2</b>\n        </div>\n        <div class="col-sm-10">\n            <div><p>{{ bbcode lang.datadog_step2}}</p></div>\n\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 3</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{formatWebhookUrl lang.datadog_step3 link}}</p>\n\n            <div>\n                <img class="image-extra-large" src="themes/images/services/datadog/step3.b9ee23f9.png" />\n            </div>\n\n        </div>\n    </li>\n\n\n\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{bbcode lang.datadog_usage}}</b>\n        </div>\n        <div class="col-sm-10">\n            <p>\n                {{bbcode lang.datadog_usage_desc}}\n            </p>\n\n        </div>\n    </li>\n\n</ul>\n';
}), define("text!template/services/instructions/pagerduty.html", [], function() {
    return '<ul class="steps">\n\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 1</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.pagerduty_step1_sub1}}</p>\n            <p>{{bbcode lang.pagerduty_step1_sub2}}</p>\n            <div>\n                <img class="image-large" src="themes/images/services/pagerduty/step1.cfa040bb.png" />\n            </div>\n        </div>\n\n    </li>\n\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 2</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.pagerduty_step2}}</p>\n\n            <div>\n                <img class="image-small" src="themes/images/services/pagerduty/step2.c6ceb79b.png" />\n            </div>\n\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 3</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{formatWebhookUrl lang.pagerduty_step3_sub1 link}}</p>\n\n            <div>\n                <img class="image-extra-large" src="themes/images/services/pagerduty/step3.1e0e37dd.png" />\n            </div>\n            <br>\n            <p>\n                {{bbcode lang.pagerduty_step3_sub2}}\n            </p>\n        </div>\n    </li>\n\n\n\n\n</ul>\n';
}), define("text!template/services/instructions/chargebee.html", [], function() {
    return '<ul class="steps">\n\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 1</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.chargebee_step1}}</p>\n            <div>\n                <img class="image-large" src="themes/images/services/chargebee/step1.b05267c3.png" />\n            </div>\n        </div>\n\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 2</b>\n        </div>\n        <div class="col-sm-10">\n            <div><p>{{ bbcode lang.chargebee_step2}}</p></div>\n            <div>\n                <img class="image-normal" src="themes/images/services/chargebee/step2.dfc650a1.png" />\n            </div>\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 3</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{formatWebhookUrl lang.chargebee_step3 link}}</p>\n\n            <div>\n                <img class="image-extra-large" src="themes/images/services/chargebee/step3.a0ecebc8.png" />\n            </div>\n\n        </div>\n    </li>\n\n\n\n</ul>\n';
}), define("text!template/services/instructions/raygun.html", [], function() {
    return '<ul class="steps">\n\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 1</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.raygun_step1}}</p>\n            <div>\n                <img class="image-small" src="themes/images/services/raygun/step1.c23b63d7.png" />\n            </div>\n        </div>\n\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 2</b>\n        </div>\n        <div class="col-sm-10">\n            <div><p>{{ bbcode lang.raygun_step2}}</p></div>\n            <div>\n                <img class="image-normal" src="themes/images/services/raygun/step2.24ffe2e2.png" />\n            </div>\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 3</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{formatWebhookUrl lang.raygun_step3_sub1 link}}</p>\n\n            <div>\n                <img class="image-normal" src="themes/images/services/raygun/step3.2b34ac93.png" />\n            </div>\n            <br>\n            <p>{{bbcode lang.raygun_step3_sub2}}</p>\n\n        </div>\n    </li>\n\n\n\n\n\n</ul>\n';
}), define("text!template/services/instructions/postmark.html", [], function() {
    return '<ul class="steps">\n\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 1</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.postmark_step1}}</p>\n            <div>\n                <img class="image-large" src="themes/images/services/postmark/step1.2e1e765b.png" />\n            </div>\n        </div>\n\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 2</b>\n        </div>\n        <div class="col-sm-10">\n            <div>\n                <ul >\n                    <li style="list-style: circle">{{ bbcode lang.postmark_step2_sub1}}</li>\n                    <li style="list-style: circle">{{ formatWebhookUrl lang.postmark_step2_sub2 link}}</li>\n\n                </ul>\n            </div>\n            <div>\n                <img class="image-large" src="themes/images/services/postmark/step2.66f89aae.png" />\n            </div>\n            <br>\n            <p>{{ bbcode lang.postmark_step2_sub3}}</p>\n        </div>\n    </li>\n\n\n\n\n\n\n</ul>\n';
}), define("text!template/services/instructions/stripe.html", [], function() {
    return '<ul class="steps">\n\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 1</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.stripe_step1}}</p>\n            <div>\n                <img class="image-small" src="themes/images/services/stripe/step1.def9c5ac.png" />\n            </div>\n        </div>\n\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 2</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.stripe_step2}}</p>\n            <div>\n                <img class="image-extra-large" src="themes/images/services/stripe/step2.9d2a697f.png" />\n            </div>\n        </div>\n\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 3</b>\n        </div>\n        <div class="col-sm-10">\n            <p>\n                {{ formatWebhookUrl lang.stripe_step3_sub1 link}}\n            </p>\n            <p>\n                {{ bbcode lang.stripe_step3_sub2}}\n            </p>\n            <div>\n                <ul >\n                    <li style="list-style: circle">{{ bbcode lang.stripe_step3_event1}}</li>\n                    <li style="list-style: circle">{{ bbcode lang.stripe_step3_event2}}</li>\n                    <li style="list-style: circle">{{ bbcode lang.stripe_step3_event3}}</li>\n                    <li style="list-style: circle">{{ bbcode lang.stripe_step3_event4}}</li>\n                </ul>\n            </div>\n            <div>\n                <img class="image-normal" src="themes/images/services/stripe/step3.5a7a6dff.png" />\n            </div>\n            <br>\n            <p>\n                {{ bbcode lang.stripe_step3_sub3}}\n            </p>\n        </div>\n    </li>\n\n\n\n\n\n\n</ul>\n';
}), define("text!template/services/instructions/netlify.html", [], function() {
    return '<ul class="steps">\n\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 1</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.netlify_step1}}</p>\n            <div>\n                <img class="image-extra-large" src="themes/images/services/netlify/step1.49147d03.png" />\n            </div>\n        </div>\n\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 2</b>\n        </div>\n        <div class="col-sm-10">\n            <div><p>{{ bbcode lang.netlify_step2}}</p></div>\n            <div>\n                <img  class="image-extra-large" src="themes/images/services/netlify/step2.2bc8f707.png" />\n            </div>\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 3</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.netlify_step3}}</p>\n\n            <div>\n                <img class="image-large" src="themes/images/services/netlify/step3.37272158.png" />\n            </div>\n\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 4</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{formatWebhookUrl lang.netlify_step4_sub1 link}}</p>\n\n            <div>\n                <img class="image-large" src="themes/images/services/netlify/step4.462817be.png" />\n            </div>\n            <br>\n            <p>{{bbcode lang.netlify_step4_sub2}}</p>\n        </div>\n    </li>\n\n</ul>\n';
}), define("text!template/services/instructions/fulcrum.html", [], function() {
    return '<ul class="steps">\n\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 1</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.fulcrum_step1_sub1}}</p>\n            <p>{{bbcode lang.fulcrum_step1_sub2}}</p>\n            <div>\n                <img class="image-normal" src="themes/images/services/fulcrum/step1.996cec68.png" />\n            </div>\n        </div>\n\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 2</b>\n        </div>\n        <div class="col-sm-10">\n            <div><p>{{ bbcode lang.fulcrum_step2}}</p></div>\n            <div>\n                <img  class="image-small" src="themes/images/services/fulcrum/step2.6ef788bd.png" />\n            </div>\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 3</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.fulcrum_step3}}</p>\n\n            <div>\n                <img class="image-normal" src="themes/images/services/fulcrum/step3.3a07b5fc.png" />\n            </div>\n\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 4</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{formatWebhookUrl lang.fulcrum_step4_sub1 link}}</p>\n\n            <div>\n                <img class="image-extra-large" src="themes/images/services/fulcrum/step4.1d5e1f14.png" />\n            </div>\n            <br>\n            <p>{{bbcode lang.fulcrum_step4_sub2}}</p>\n        </div>\n    </li>\n\n</ul>\n';
}), define("text!template/services/instructions/librato.html", [], function() {
    return '<ul class="steps">\n\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 1</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.librato_step1}}</p>\n            <div>\n                <img class="image-small" src="themes/images/services/librato/step1.a9898849.png" />\n            </div>\n        </div>\n\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 2</b>\n        </div>\n        <div class="col-sm-10">\n            <div><p>{{ bbcode lang.librato_step2}}</p></div>\n            <div>\n                <img  class="image-large" src="themes/images/services/librato/step2.75d50213.png" />\n            </div>\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 3</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.librato_step3}}</p>\n\n            <div>\n                <img class="image-large" src="themes/images/services/librato/step3.8eb55d18.png" />\n            </div>\n\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 4</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{formatWebhookUrl lang.librato_step4 link}}</p>\n\n            <div>\n                <img class="image-large" src="themes/images/services/librato/step4.8242801c.png" />\n            </div>\n\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 5</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.librato_step5}}</p>\n\n            <div>\n                <img class="image-small" src="themes/images/services/librato/step5.69e9b338.png" />\n            </div>\n\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 6</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.librato_step6_sub1}}</p>\n\n            <div>\n                <img class="image-extra-large" src="themes/images/services/librato/step6.6212d12a.png" />\n            </div>\n            <br>\n            <p>{{bbcode lang.librato_step6_sub2}}</p>\n        </div>\n    </li>\n\n</ul>\n';
}), define("text!template/services/instructions/opsgenie.html", [], function() {
    return '<ul class="steps">\n\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 1</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{bbcode lang.opsgenie_step1}}</p>\n            <div>\n                <img class="image-small" src="themes/images/services/opsgenie/step1.c8b9e2dd.png" />\n            </div>\n        </div>\n\n    </li>\n\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 2</b>\n        </div>\n        <div class="col-sm-10">\n            <p>{{formatWebhookUrl lang.opsgenie_step2_sub1 link}}</p>\n\n            <div>\n                <img class="image-extra-large" src="themes/images/services/opsgenie/step2.892d011f.png" />\n            </div>\n            <br>\n            <p>{{bbcode lang.opsgenie_step2_sub2}}</p>\n\n        </div>\n    </li>\n\n\n</ul>\n';
}), define("text!template/services/instructions/bitbucket.html", [], function() {
    return '<ul class="steps">\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 1</b>\n        </div>\n        <div class="col-sm-10">\n            <div><p>{{ bbcode lang.bitbucket_step1}}</p></div>\n            <div>\n                <img class="image-small" src="themes/images/services/bitbucket/step1.31bb9561.png" />\n            </div>\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 2</b>\n        </div>\n        <div class="col-sm-10">\n            <div><p>{{ bbcode lang.bitbucket_step2}}</p></div>\n            <div>\n                <img class="image-normal" src="themes/images/services/bitbucket/step2.daf5d2bd.png" />\n            </div>\n        </div>\n    </li>\n    <li class="row">\n        <div class="col-sm-2">\n            <b>{{lang.step}} 3</b>\n        </div>\n        <div class="col-sm-10">\n            <div><p>{{ formatWebhookUrl lang.bitbucket_step3_sub1 link}}</p></div>\n            <div>\n                <img class="image-large" src="themes/images/services/bitbucket/step3.692fb76f.png" />\n            </div>\n            <br>\n            <div><p>{{ bbcode lang.bitbucket_step3_sub2}}</p></div>\n        </div>\n    </li>\n\n\n</ul>\n';
}), define("services/integrationView", [ "moxtra", "lang", "app", "const", "services/header", "services/listener", "text!template/services/integrationView.html", "text!template/services/integration/detail.html", "text!template/services/instructions/github.html", "text!template/services/instructions/hubspot.html", "text!template/services/instructions/jira.html", "text!template/services/instructions/zendesk.html", "text!template/services/instructions/zoho.html", "text!template/services/instructions/incomingWebhooks.html", "text!template/services/instructions/crashlytics.html", "text!template/services/instructions/intercom.html", "text!template/services/instructions/appsignal.html", "text!template/services/instructions/mailchimp.html", "text!template/services/instructions/formstack.html", "text!template/services/instructions/pivotaltracker.html", "text!template/services/instructions/yo.html", "text!template/services/instructions/paypal.html", "text!template/services/instructions/supportbee.html", "text!template/services/instructions/chargify.html", "text!template/services/instructions/olark.html", "text!template/services/instructions/opbeat.html", "text!template/services/instructions/datadog.html", "text!template/services/instructions/pagerduty.html", "text!template/services/instructions/chargebee.html", "text!template/services/instructions/raygun.html", "text!template/services/instructions/postmark.html", "text!template/services/instructions/stripe.html", "text!template/services/instructions/netlify.html", "text!template/services/instructions/fulcrum.html", "text!template/services/instructions/librato.html", "text!template/services/instructions/opsgenie.html", "text!template/services/instructions/bitbucket.html", "zeroclipboard" ], function(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z, A, B, C, D, E, F, G, H, I, J, K, L) {
    "use strict";
    var M = Handlebars.compile(h), N = {
        github: Handlebars.compile(i),
        hubspot: Handlebars.compile(j),
        jira: Handlebars.compile(k),
        zendesk: Handlebars.compile(l),
        zoho: Handlebars.compile(m),
        incoming: Handlebars.compile(n),
        crashlytics: Handlebars.compile(o),
        intercom: Handlebars.compile(p),
        appsignal: Handlebars.compile(q),
        mailchimp: Handlebars.compile(r),
        formstack: Handlebars.compile(s),
        pivotaltracker: Handlebars.compile(t),
        yo: Handlebars.compile(u),
        paypal: Handlebars.compile(v),
        supportbee: Handlebars.compile(w),
        chargify: Handlebars.compile(x),
        olark: Handlebars.compile(y),
        opbeat: Handlebars.compile(z),
        datadog: Handlebars.compile(A),
        pagerduty: Handlebars.compile(B),
        chargebee: Handlebars.compile(C),
        raygun: Handlebars.compile(D),
        postmark: Handlebars.compile(E),
        stripe: Handlebars.compile(F),
        netlify: Handlebars.compile(G),
        fulcrum: Handlebars.compile(H),
        librato: Handlebars.compile(I),
        opsgenie: Handlebars.compile(J),
        bitbucket: Handlebars.compile(K)
    };
    return a.Controller.extend({
        template: g,
        handleAction: !0,
        init: function(a) {
            this.service = a.service, this.integration = a.integration, this.expandInstruction = a.expandInstruction, 
            this.token = this.integration.token, this.link = this.getLink(this.integration.token), 
            this.binderId = this.integration.boardId;
        },
        getLink: function(a) {
            return location.hostname.match("moxtra.com") ? MX.format("https://api.moxtra.com/webhooks/{0}", a) : MX.format("https://api.grouphour.com/webhooks/{0}", a);
        },
        rendered: function() {
            var a, g = MX.env.detectFlash(), h = this.link, i = !1, j = this.service.name, k = this;
            [ "salesforce", "quickbooks", "trello" ].indexOf(this.service.name) > -1 && (this._isIframe = !0, 
            this.integration.actor && this.integration.actor.get("user.id") === Moxtra.getMe().id && (i = !0, 
            this.msgCallback = f.onMessage({
                cancel: function() {
                    k._toggleIframe(!1);
                },
                create: function() {
                    k.trigger("close"), k._offMessage();
                },
                update: function() {
                    k.trigger("close"), k._offMessage();
                }
            }), this.recovery(function() {
                k._offMessage();
            }))), this.recovery(new e({
                renderTo: ".mx-integration-view",
                service: this.service
            })), this.$el.append(M({
                binder: MX.get("board", Moxtra.getUserBoard(this.binderId)) || {
                    id: this.integration.boardId,
                    name: this.integration.boardName
                },
                link: this.link,
                integration: this.integration,
                editable: i,
                displayName: this.service.displayName,
                expandInstruction: this.expandInstruction,
                showInstructions: !this._isIframe,
                showWebhookLink: !this._isIframe,
                lang: b
            })), setTimeout(function() {
                var a = N[j];
                a && (k.$(".instructions-steps").empty().append(a({
                    link: k.link,
                    lang: b
                })), k.expandInstruction && setTimeout(function() {
                    $(".mx-integration-services").scrollTop($(".integration-instructions").offset().top - 60);
                }, 100));
            }, 100), c.isMacAgentAppstore() || c.isMacAgentLocal() ? this.$("#copyWebhookLink").on("click", function() {
                c.sendMessage({
                    action: "request_copy_text",
                    text: h,
                    session_id: Moxtra.getMe().sessionId
                }), setTimeout(function() {
                    MX.ui.notifySuccess(b.link_copied_to_clipboard);
                }, 300);
            }) : (g.isSupported && (!c.isIntegrationAgent() || navigator.userAgent.indexOf(d.flags.windowsAgent) > 0) && (L.config({
                swfPath: "lib/zeroclipboard/dist/ZeroClipboard.a573941f.swf"
            }), a = new L(this.$("#copyWebhookLink")), a.setText(h), a.on("ready", function(a) {
                var c = a.client;
                c.on("beforecopy", function() {
                    c.setText(h);
                }), c.on("aftercopy", function() {
                    MX.ui.notifySuccess(b.link_copied_to_clipboard);
                });
            })), this.recovery(function() {
                g.isSupported && L.prototype._singleton && L.destroy();
            }));
        },
        exitDetail: function() {
            this.trigger("close"), this._offMessage();
        },
        edit: function() {
            [ "salesforce", "quickbooks" ].indexOf(this.service.name) > -1 && (this._toggleIframe(!0), 
            $(".mx-integration-services").scrollTop($(".mx-integration-services").height()));
        },
        removeIntegration: function(a) {
            if (a) {
                var c, d = this;
                c = function() {
                    var c = MX.get("board", Moxtra.getUserBoard(a));
                    c ? d.integration.removeIntegration(c, d.service).success(function() {
                        MX.ui.notifySuccess(b.delete_service_integration_success), d.trigger("close");
                    }).error(function() {
                        MX.ui.notifyError(b.delete_service_integration_failed);
                    }) : MX.ui.notifyError(b.delete_service_integration_failed);
                }, MX.ui.Confirm(b.delete_service_integration_confirm, function() {
                    if (d._isIframe) {
                        var a = MX.get("actor.user.id", d.integration);
                        Moxtra.removeIntegrationTrigger(d.token, a).success(function() {
                            c();
                        }).error(function() {
                            MX.ui.notifyError(b.delete_service_integration_failed);
                        });
                    } else c();
                });
            }
        },
        toggleInstructions: function() {
            var a = this.$(".instructions-steps"), b = this.$(".instructions-setup");
            a.hasClass("hide") ? (a.removeClass("hide"), b.addClass("active")) : (a.addClass("hide"), 
            b.removeClass("active"));
        },
        _toggleIframe: function(a) {
            a ? (this.$(".integration-iframe").removeClass("hide"), this.$("#integrationIframe").attr("src", MX.format("/alert/#edit?token={0}", this.token)), 
            this.$("#editIntegration").addClass("hide")) : (this.$(".integration-iframe").addClass("hide"), 
            this.$("#integrationIframe").attr("src", ""), this.$("#editIntegration").removeClass("hide"));
        },
        _offMessage: function() {
            this.msgCallback && f.offMessage(this.msgCallback);
        }
    });
}), define("user/userBiz", [ "moxtra", "user/userModel" ], function(a) {
    return {
        updateProfile: function(b) {
            return new a.ChainObject(function() {
                MX.api("/users/me", "PUT", {
                    data: b
                }, this.callback, this);
            });
        },
        updateEmail: function(b) {
            return new a.ChainObject(function() {
                MX.api("/users/me", "PUT", {
                    data: {
                        email: b
                    },
                    action: "update_email"
                }, this.callback, this);
            });
        },
        changePassword: function(b, c) {
            return new a.ChainObject(function() {
                MX.api("/users/me", "PUT", {
                    data: {
                        old_password: b,
                        new_password: c
                    },
                    action: "change_password"
                }, this.callback, this);
            });
        },
        sendFeedback: function(b, c) {
            return new a.ChainObject(function() {
                MX.api("/users/me", "PUT", {
                    data: {
                        message: b,
                        subject: c
                    },
                    action: "send_feedback"
                }, this.callback, this);
            });
        },
        removePhoto: function() {
            return new a.ChainObject(function() {
                MX.api("/users/me", "PUT", {
                    action: "remove_photo"
                }, this.callback, this);
            });
        },
        resendVerifyEmail: function() {
            return new a.ChainObject(function() {
                MX.api("/users/me", "PUT", {
                    action: "resend_verify_email"
                }, this.callback, this);
            });
        },
        getSSOLoginOptions: function(b) {
            return new a.ChainObject(function() {
                MX.api("/users/me", "GET", {
                    data: {
                        email: b
                    },
                    action: "read_sso_options"
                }, this.callback, this);
            });
        }
    };
}), define("services/services", [ "moxtra", "lang", "app", "text!template/services/services.html", "text!template/services/integrationItem.html", "text!template/services/servicePanelHeader.html", "text!template/services/zapierService.html", "text!template/services/emailService.html", "services/integrationNew", "services/integrationView", "services/helper", "user/userBiz" ], function(a, b, c, d, e, f, g, h, i, j, k, l) {
    "use strict";
    var m = Handlebars.compile(f), n = Handlebars.compile(g), o = Handlebars.compile(h);
    return a.Controller.extend({
        template: d,
        handleAction: !0,
        events: {
            "click .integration-feedback b": "showFeedback",
            "keyup #searchIntegration": "onSearch"
        },
        init: function() {
            this.services = Moxtra.getServices(), this.$scope.lang = b, this.$scope.services = this.services, 
            c.request.sequence() && c.request.sequence("", !1);
        },
        rendered: function() {
            var d = this;
            Moxtra.onReady(function() {
                d.services.each(function(c) {
                    d[c.name + "List"] = new a.List({
                        renderTo: "." + c.name + "-integrations",
                        collection: c.integrations,
                        className: "mx-list single-service-integrations",
                        template: e,
                        syncModel: [ "note" ],
                        sortable: !1,
                        unifyLazyload: !1,
                        hideLoading: !0,
                        $scope: {
                            lang: b
                        }
                    }), d[c.name + "List"].binding(c.integrations), d.listenTo(c.integrations, "inited", function() {
                        d._updateServiceInfo(c.name);
                    }), d.listenTo(c.integrations, "add", function() {
                        d._updateServiceInfo(c.name);
                    }), d.listenTo(c.integrations, "remove", function() {
                        d._updateServiceInfo(c.name);
                    }), d._updateServiceInfo(c.name);
                }), d.$("li#zapierService").empty().append(n({
                    lang: b
                })), d.$("li#emailService").empty().append(o({
                    lang: b
                }));
            }), d.listenTo(c.request, "change:sequence", function() {
                c.request.sequence() || d._toggle(!0);
            });
        },
        viewIntegration: function(a, b, d) {
            var e, f, g, d = d || {}, h = this;
            f = Moxtra.getService(a), f && (g = f.integrations.get(b), g && (this._toggle(!1), 
            c.request.sequence(a, !1), e = new j({
                service: f,
                integration: g,
                expandInstruction: !!d.expandInstruction,
                renderTo: ".service-detail"
            }), e.on("close", function() {
                h._toggle(!0), c.request.sequence("", !1);
            }), this.$el.scrollTop(0), this.recovery(e)));
        },
        newIntegration: function(a) {
            var b, d, e = this;
            d = Moxtra.getService(a), d && (this._toggle(!1), c.request.sequence(a, !1), b = new i({
                service: d,
                renderTo: ".service-detail"
            }), b.on("close", function() {
                e._toggle(!0), c.request.set("params.binderid", ""), c.request.sequence("", !1);
            }), b.on("added", function(b) {
                e.viewIntegration(a, b, {
                    expandInstruction: !0
                });
            }), this.$el.scrollTop(0), this.recovery(b));
        },
        showFeedback: function() {
            this.$(".feedback-form").removeClass("hide"), this.$(".feedback-form textarea").focus(), 
            $(".mx-integration-services").scrollTop($(".integration-services").height());
        },
        hideFeedback: function() {
            this.$(".feedback-form").addClass("hide");
        },
        sendFeedback: function() {
            var a = this.$(".feedback-form textarea").val(), c = this;
            a.length && l.sendFeedback(a, "Service Integration Feedback").success(function() {
                c.$(".feedback-form textarea").val(""), c.$(".feedback-form").addClass("hide"), 
                MX.ui.notifySuccess(b.send_feedback_success);
            }).error(function() {
                MX.ui.notifySuccess(b.send_feedback_failed);
            });
        },
        onSearch: function(a) {
            var c = $(a.target), d = $.trim(c.val()), e = k.taglines;
            if (e.email = b.email_service_tagline, e.zapier = b.zapier_tagline, d.length > 0) {
                d = d.toLowerCase(), this.$(".integration-search .input-close").removeClass("hide");
                var f = [];
                MX.each(e, function(a, b) {
                    (a.toLowerCase().indexOf(d) > -1 || b.toLowerCase().indexOf(d) > -1) && f.push("#" + b + "Service");
                }), this.$(".integration-service-item").addClass("hide"), this.$(f.join(",")).removeClass("hide");
            } else this.$(".integration-search .input-close").addClass("hide"), this._reloadList();
        },
        removeSearchKey: function() {
            this._reloadList(), this.$(".integration-search .input-close").addClass("hide"), 
            this.$("#searchIntegration").val("");
        },
        _reloadList: function() {
            this.$(".integration-service-item").removeClass("hide");
        },
        _updateServiceInfo: function(a) {
            var c = Moxtra.getService(a), d = "#" + c.name + "Service";
            this.$(d + " h4.panel-title").empty().append(m({
                service: c,
                tagline: k.taglines[a] || "",
                lang: b
            })), c.integrations.length ? this.$("li" + d).removeClass("has-summary") : this.$("li" + d).addClass("has-summary");
        },
        _toggle: function(a) {
            a ? (this.$(".service-list").removeClass("hide"), this.$(".service-detail").addClass("hide")) : (this.$(".service-list").addClass("hide"), 
            this.$(".service-detail").removeClass("hide").empty());
        }
    });
}), define("mx.meet", function() {});